!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e){return null!=e&&(Array.isArray(e)||ArrayBuffer.isView(e))}function o(e){return null!=e&&"function"==typeof e.Dispose}n.r(t);function i(e,t,n){return e.has(t)?[!0,e.get(t)]:[!1,n]}function u(e){const t=e;return"number"==typeof t.offset?t.offset:1===e.kind?0:-6e4*e.getTimezoneOffset()}class s{static id(e){return s.idMap.has(e)||s.idMap.set(e,++s.count),s.idMap.get(e)}}function a(e){let t=0,n=5381;const r=e.length;for(;t<r;)n=33*n^e.charCodeAt(t++);return n}function c(e){return 2654435761*e|0}function f(e){return 0===e.length?0:e.reduce((e,t)=>(e<<5)+e^t)}function l(e){if(null==e)return 0;switch(typeof e){case"boolean":return e?1:0;case"number":return c(e);case"string":return a(e);default:if(function(e){return null!=e&&"function"==typeof e.GetHashCode}(e))return e.GetHashCode();if(r(e)){const t=e.length,n=new Array(t);for(let r=0;r<t;r++)n[r]=l(e[r]);return f(n)}return a(String(e))}}function h(e,t,n){if(null==e)return null==t;if(null==t)return!1;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}function w(e,t){return h(e,t,d)}function d(e,t){return e===t||(null==e?null==t:null!=t&&("object"==typeof e&&(function(e){return null!=e&&"function"==typeof e.Equals}(e)?e.Equals(t):r(e)?r(t)&&w(e,t):e instanceof Date&&(t instanceof Date&&0===g(e,t)))))}function g(e,t){let n,r;return"offset"in e&&"offset"in t?(n=e.getTime(),r=t.getTime()):(n=e.getTime()+u(e),r=t.getTime()+u(t)),n===r?0:n<r?-1:1}function p(e,t){return e===t?0:e<t?-1:1}function m(e,t,n){if(null==e)return null==t?0:1;if(null==t)return-1;if(e.length!==t.length)return e.length<t.length?-1:1;for(let r=0,o=0;r<e.length;r++)if(o=n(e[r],t[r]),0!==o)return o;return 0}function y(e,t){return m(e,t,S)}function S(e,t){return e===t?0:null==e?null==t?0:-1:null==t?1:"object"!=typeof e?e<t?-1:1:function(e){return null!=e&&"function"==typeof e.CompareTo}(e)?e.CompareTo(t):r(e)&&r(t)?y(e,t):e instanceof Date&&t instanceof Date?g(e,t):1}function v(e,t,n){return e(t,n)<0?t:n}function M(e,t,n){return e(t,n)>0?t:n}function P(e){let t=e;return e=>void 0===e?t:void(t=e)}s.idMap=new WeakMap,s.count=0;function b(e,t){if(null==t)return null;if(t.length>1)return t;let n;switch(e){case 2:n=(e,n)=>t(e)(n);break;case 3:n=(e,n,r)=>t(e)(n)(r);break;case 4:n=(e,n,r,o)=>t(e)(n)(r)(o);break;case 5:n=(e,n,r,o,i)=>t(e)(n)(r)(o)(i);break;case 6:n=(e,n,r,o,i,u)=>t(e)(n)(r)(o)(i)(u);break;case 7:n=(e,n,r,o,i,u,s)=>t(e)(n)(r)(o)(i)(u)(s);break;case 8:n=(e,n,r,o,i,u,s,a)=>t(e)(n)(r)(o)(i)(u)(s)(a);break;default:throw new Error("Uncurrying to more than 8-arity is not supported: "+e)}return n.__CURRIED__=t,n}function T(e,t){if(null!=t){if("__CURRIED__"in t)return t.__CURRIED__;switch(e){case 2:return e=>n=>t(e,n);case 3:return e=>n=>r=>t(e,n,r);case 4:return e=>n=>r=>o=>t(e,n,r,o);case 5:return e=>n=>r=>o=>i=>t(e,n,r,o,i);case 6:return e=>n=>r=>o=>i=>u=>t(e,n,r,o,i,u);case 7:return e=>n=>r=>o=>i=>u=>s=>t(e,n,r,o,i,u,s);case 8:return e=>n=>r=>o=>i=>u=>s=>a=>t(e,n,r,o,i,u,s,a);default:throw new Error("Currying to more than 8-arity is not supported: "+e)}}}function C(e,t,n){if(null==t)return null;if("__CURRIED__"in t){t=t.__CURRIED__;for(let e=0;e<n.length;e++)t=t(n[e]);return t}switch(e){case 1:return e=>t.apply(null,n.concat([e]));case 2:return e=>r=>t.apply(null,n.concat([e,r]));case 3:return e=>r=>o=>t.apply(null,n.concat([e,r,o]));case 4:return e=>r=>o=>i=>t.apply(null,n.concat([e,r,o,i]));case 5:return e=>r=>o=>i=>u=>t.apply(null,n.concat([e,r,o,i,u]));case 6:return e=>r=>o=>i=>u=>s=>t.apply(null,n.concat([e,r,o,i,u,s]));case 7:return e=>r=>o=>i=>u=>s=>a=>t.apply(null,n.concat([e,r,o,i,u,s,a]));case 8:return e=>r=>o=>i=>u=>s=>a=>c=>t.apply(null,n.concat([e,r,o,i,u,s,a,c]));default:throw new Error("Partially applying to more than 8-arity is not supported: "+e)}}function N(e,t){if(e.has(t))return e.get(t);throw new Error(`The given key '${t}' was not present in the dictionary.`)}function I(e,t){return null!=t&&Object.getPrototypeOf(e).constructor===Object.getPrototypeOf(t).constructor}function G(e,t){return function(e,t){e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}(e,t||E),e}function E(){}function k(e,t){if(e===t)return 0;if(null==t)return-1;for(;null!=e.tail;){if(null==t.tail)return 1;const n=S(e.head,t.head);if(0!==n)return n;e=e.tail,t=t.tail}return null==t.tail?0:-1}function x(e,t){this.head=e,this.tail=t}function D(e,t,...n){this.tag=0|e,this.name=t,this.fields=n}function R(e,t){const n={},r=null==t?Object.keys(e):t(e);for(let t=0;t<r.length;t++)n[r[t]]=e[r[t]];return n}function A(e,t,n){if(e===t)return!0;if(I(e,t)){const r=null==n?Object.keys(e):n(e);for(let n=0;n<r.length;n++)if(!d(e[r[n]],t[r[n]]))return!1;return!0}return!1}function O(e,t,n){if(e===t)return 0;if(I(e,t)){const r=null==n?Object.keys(e):n(e);for(let n=0;n<r.length;n++){const o=S(e[r[n]],t[r[n]]);if(0!==o)return o}return 0}return-1}function F(){}E.prototype.toString=function(){return"{"+Object.keys(this).map(e=>e+" = "+String(this[e])).join(";\n ")+"}"},E.prototype.GetHashCode=function(){return function(e){if(null==e)return 0;switch(typeof e){case"boolean":return e?1:0;case"number":return c(e);case"string":return a(e);default:return c(s.id(e))}}(this)},E.prototype.Equals=function(e){return this===e},x.prototype.toString=function(){return"["+Array.from(this).map(e=>String(e)).join("; ")+"]"},x.prototype.toJSON=function(){return Array.from(this)},x.prototype[Symbol.iterator]=function(){let e=this;return{next:()=>{const t=e;return e=e.tail,{done:null==t.tail,value:t.head}}}},x.prototype.GetHashCode=function(){return f(Array.from(this).map(l))},x.prototype.Equals=function(e){return 0===k(this,e)},x.prototype.CompareTo=function(e){return k(this,e)},D.prototype.toString=function(){const e=this.fields.length;return 0===e?this.name:1===e?this.name+" "+String(this.fields[0]):this.name+" ("+this.fields.map(e=>String(e)).join(",")+")"},D.prototype.toJSON=function(){return 0===this.fields.length?this.name:[this.name].concat(this.fields)},D.prototype.GetHashCode=function(){const e=this.fields.map(e=>l(e));return e.splice(0,0,c(this.tag)),f(e)},D.prototype.Equals=function(e){return this===e||I(this,e)&&this.tag===e.tag&&w(this.fields,e.fields)},D.prototype.CompareTo=function(e){return this===e?0:I(this,e)?this.tag===e.tag?y(this.fields,e.fields):this.tag<e.tag?-1:1:-1},F.prototype.toString=function(){return"{"+Object.keys(this).map(e=>e+" = "+String(this[e])).join(";\n ")+"}"},F.prototype.toJSON=function(){return R(this)},F.prototype.GetHashCode=function(){return f(Object.keys(this).map(e=>l(this[e])))},F.prototype.Equals=function(e){return A(this,e)},F.prototype.CompareTo=function(e){return O(this,e)};const L=G((function(e){this.contents=e}),F),z=G((function(e){this.stack=Error().stack,this.message=e}),E);function B(e){return Object.keys(e).filter(e=>"message"!==e&&"stack"!==e)}const H=G((function(){z.call(this)}),z);H.prototype.toString=function(){const e=B(this),t=e.length;return 0===t?this.message:1===t?this.message+" "+String(this[e[0]]):this.message+" ("+e.map(e=>String(this[e])).join(",")+")"},H.prototype.toJSON=function(){return R(this,B)},H.prototype.GetHashCode=function(){return f(B(this).map(e=>l(this[e])))},H.prototype.Equals=function(e){return A(this,e,B)},H.prototype.CompareTo=function(e){return O(this,e,B)};G((function(e,t,n){this.arg1=e,this.arg2=0|t,this.arg3=0|n,this.message="The match cases were incomplete"}),H),G((function(){}),E);class W{constructor(e,t,n,r,o,i){this.fullname=e,this.generics=t,this.constructor=n,this.fields=r,this.cases=o,this.enumCases=i}toString(){return function e(t){const n=null==t.generics||K(t)?[]:t.generics;return n.length>0?t.fullname+"["+n.map(t=>e(t)).join(",")+"]":t.fullname}(this)}Equals(e){return j(this,e)}CompareTo(e){return _(this,e)}}function U(e){return null!=e.generics?e.generics:[]}function j(e,t){return""===e.fullname?""===t.fullname&&h(q(e),q(t),([e,t],[n,r])=>e===n&&j(t,r)):e.fullname===t.fullname&&h(U(e),U(t),j)}function _(e,t){return e.fullname!==t.fullname?e.fullname<t.fullname?-1:1:m(U(e),U(t),_)}new W("System.Object"),new W("Microsoft.FSharp.Core.Unit"),new W("System.Char"),new W("System.String"),new W("System.Boolean"),new W("System.SByte"),new W("System.Byte"),new W("System.Int16"),new W("System.UInt16"),new W("System.Int32"),new W("System.UInt32"),new W("System.Single"),new W("System.Double"),new W("System.Decimal");function K(e){return e.fullname.endsWith("[]")}function q(e){if(null!=e.fields)return e.fields();throw new Error(`${e.fullname} is not an F# record type`)}const J=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const X=G((function(e,t){this.JustDown=e,this.Held=t}),F);const Y=new X(!1,!1);class V{constructor(e){this.value=e}toString(){return String(this.value)}toJSON(){return this.value}GetHashCode(){return l(this.value)}Equals(e){return null!=e&&d(this.value,e instanceof V?e.value:e)}CompareTo(e){return null==e?1:S(this.value,e instanceof V?e.value:e)}}function Z(e){return null==(e=void 0===e?null:e)||e instanceof V?new V(e):e}function $(e,t){if(null==e){if(!t)throw new Error("Option has no value");return null}return e instanceof V?e.value:e}G((function(e,t,n){D.call(this,e,t,n)}),D);const Q=G((function(e,t,n){D.call(this,e,t,n)}),D);var ee={GetHashCode(){return f([this.s,this.e].concat(this.c))},Equals(e){return!this.cmp(e)},CompareTo(e){return this.cmp(e)}},te="[big.js] ",ne=te+"Invalid ",re=ne+"decimal places",oe=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function ie(e,t){var n,r,o;if(0===t&&1/t<0)t="-0";else if(!oe.test(t+=""))throw Error(ne+"number");for(e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),o=t.length,r=0;r<n&&r<o&&"0"==t.charAt(r);)++r;if(r==o)e.c=[e.e=0];else for(e.e=n-r-1,e.c=[],n=0;r<o;)e.c[n++]=+t.charAt(r++);return e=ue(e,ae.DP,ae.RM)}function ue(e,t,n,r){var o=e.c,i=e.e+t+1;if(i<o.length){if(1===n)r=o[i]>=5;else if(2===n)r=o[i]>5||5==o[i]&&(r||i<0||void 0!==o[i+1]||1&o[i-1]);else if(3===n)r=r||!!o[0];else if(r=!1,0!==n)throw Error("[big.js] Invalid rounding mode");if(i<1)o.length=1,r?(e.e=-t,o[0]=1):o[0]=e.e=0;else{if(o.length=i--,r)for(;++o[i]>9;)o[i]=0,i--||(++e.e,o.unshift(1));for(i=o.length;!o[--i];)o.pop()}}else if(n<0||n>3||n!==~~n)throw Error("[big.js] Invalid rounding mode");return e}function se(e,t,n,r){var o,i,u=e.constructor,s=!e.c[0];if(void 0!==n){if(n!==~~n||n<(3==t)||n>1e6)throw Error(3==t?ne+"precision":re);for(n=r-(e=new u(e)).e,e.c.length>++r&&ue(e,n,u.RM),2==t&&(r=e.e+n+1);e.c.length<r;)e.c.push(0)}if(o=e.e,n=(i=e.c.join("")).length,2!=t&&(1==t||3==t&&r<=o||o<=u.NE||o>=u.PE))i=i.charAt(0)+(n>1?"."+i.slice(1):"")+(o<0?"e":"e+")+o;else if(o<0){for(;++o;)i="0"+i;i="0."+i}else if(o>0)if(++o>n)for(o-=n;o--;)i+="0";else o<n&&(i=i.slice(0,o)+"."+i.slice(o));else n>1&&(i=i.charAt(0)+"."+i.slice(1));return e.s<0&&(!s||4==t)?"-"+i:i}ee.abs=function(){var e=new this.constructor(this);return e.s=1,e},ee.cmp=function(e){var t,n=this.constructor,r=new n(this),o=(e=new n(e),r.c),i=e.c,u=r.s,s=e.s,a=r.e,c=e.e;if(!o[0]||!i[0])return o[0]?u:i[0]?-s:0;if(u!=s)return u;if(t=u<0,a!=c)return a>c^t?1:-1;for(s=Math.max(o.length,i.length),u=0;u<s;u++)if((a=u<o.length?o[u]:0)!=(c=u<i.length?i[u]:0))return a>c^t?1:-1;return 0},ee.div=function(e){var t=this.constructor,n=new t(this),r=(e=new t(e),n.c),o=e.c,i=n.s==e.s?1:-1,u=t.DP;if(u!==~~u||u<0||u>1e6)throw Error(re);if(!o[0])throw Error("[big.js] Division by zero");if(!r[0])return new t(0*i);var s,a,c,f,l,h=o.slice(),w=s=o.length,d=r.length,g=r.slice(0,s),p=g.length,m=e,y=m.c=[],S=0,v=u+(m.e=n.e-e.e)+1;for(m.s=i,i=v<0?0:v,h.unshift(0);p++<s;)g.push(0);do{for(c=0;c<10;c++){if(s!=(p=g.length))f=s>p?1:-1;else for(l=-1,f=0;++l<s;)if(o[l]!=g[l]){f=o[l]>g[l]?1:-1;break}if(!(f<0))break;for(a=p==s?o:h;p;){if(g[--p]<a[p]){for(l=p;l&&!g[--l];)g[l]=9;--g[l],g[p]+=10}g[p]-=a[p]}for(;!g[0];)g.shift()}y[S++]=f?c:++c,g[0]&&f?g[p]=r[w]||0:g=[r[w]]}while((w++<d||void 0!==g[0])&&i--);return y[0]||1==S||(y.shift(),m.e--),S>v&&ue(m,u,t.RM,void 0!==g[0]),m},ee.eq=function(e){return!this.cmp(e)},ee.gt=function(e){return this.cmp(e)>0},ee.gte=function(e){return this.cmp(e)>-1},ee.lt=function(e){return this.cmp(e)<0},ee.lte=function(e){return this.cmp(e)<1},ee.minus=ee.sub=function(e){var t,n,r,o,i=this.constructor,u=new i(this),s=(e=new i(e),u.s),a=e.s;if(s!=a)return e.s=-a,u.plus(e);var c=u.c.slice(),f=u.e,l=e.c,h=e.e;if(!c[0]||!l[0])return l[0]?(e.s=-a,e):new i(c[0]?u:0);if(s=f-h){for((o=s<0)?(s=-s,r=c):(h=f,r=l),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else for(n=((o=c.length<l.length)?c:l).length,s=a=0;a<n;a++)if(c[a]!=l[a]){o=c[a]<l[a];break}if(o&&(r=c,c=l,l=r,e.s=-e.s),(a=(n=l.length)-(t=c.length))>0)for(;a--;)c[t++]=0;for(a=t;n>s;){if(c[--n]<l[n]){for(t=n;t&&!c[--t];)c[t]=9;--c[t],c[n]+=10}c[n]-=l[n]}for(;0===c[--a];)c.pop();for(;0===c[0];)c.shift(),--h;return c[0]||(e.s=1,c=[h=0]),e.c=c,e.e=h,e},ee.mod=function(e){var t,n=this.constructor,r=new n(this),o=(e=new n(e),r.s),i=e.s;if(!e.c[0])throw Error("[big.js] Division by zero");return r.s=e.s=1,t=1==e.cmp(r),r.s=o,e.s=i,t?new n(r):(o=n.DP,i=n.RM,n.DP=n.RM=0,r=r.div(e),n.DP=o,n.RM=i,this.minus(r.times(e)))},ee.plus=ee.add=function(e){var t,n=this.constructor,r=new n(this),o=(e=new n(e),r.s),i=e.s;if(o!=i)return e.s=-i,r.minus(e);var u=r.e,s=r.c,a=e.e,c=e.c;if(!s[0]||!c[0])return c[0]?e:new n(s[0]?r:0*o);if(s=s.slice(),o=u-a){for(o>0?(a=u,t=c):(o=-o,t=s),t.reverse();o--;)t.push(0);t.reverse()}for(s.length-c.length<0&&(t=c,c=s,s=t),o=c.length,i=0;o;s[o]%=10)i=(s[--o]=s[o]+c[o]+i)/10|0;for(i&&(s.unshift(i),++a),o=s.length;0===s[--o];)s.pop();return e.c=s,e.e=a,e},ee.pow=function(e){var t=this.constructor,n=new t(this),r=new t(1),o=new t(1),i=e<0;if(e!==~~e||e<-1e6||e>1e6)throw Error(ne+"exponent");for(i&&(e=-e);1&e&&(r=r.times(n)),e>>=1;)n=n.times(n);return i?o.div(r):r},ee.round=function(e,t){var n=this.constructor;if(void 0===e)e=0;else if(e!==~~e||e<-1e6||e>1e6)throw Error(re);return ue(new n(this),e,void 0===t?n.RM:t)},ee.sqrt=function(){var e,t,n,r=this.constructor,o=new r(this),i=o.s,u=o.e,s=new r(.5);if(!o.c[0])return new r(o);if(i<0)throw Error(te+"No square root");0===(i=Math.sqrt(o+""))||i===1/0?((t=o.c.join("")).length+u&1||(t+="0"),u=((u+1)/2|0)-(u<0||1&u),e=new r(((i=Math.sqrt(t))==1/0?"1e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+u)):e=new r(i),u=e.e+(r.DP+=4);do{n=e,e=s.times(n.plus(o.div(n)))}while(n.c.slice(0,u).join("")!==e.c.slice(0,u).join(""));return ue(e,r.DP-=4,r.RM)},ee.times=ee.mul=function(e){var t,n=this.constructor,r=new n(this),o=(e=new n(e),r.c),i=e.c,u=o.length,s=i.length,a=r.e,c=e.e;if(e.s=r.s==e.s?1:-1,!o[0]||!i[0])return new n(0*e.s);for(e.e=a+c,u<s&&(t=o,o=i,i=t,c=u,u=s,s=c),t=new Array(c=u+s);c--;)t[c]=0;for(a=s;a--;){for(s=0,c=u+a;c>a;)s=t[c]+i[a]*o[c-a-1]+s,t[c--]=s%10,s=s/10|0;t[c]=(t[c]+s)%10}for(s?++e.e:t.shift(),a=t.length;!t[--a];)t.pop();return e.c=t,e},ee.toExponential=function(e){return se(this,1,e,e)},ee.toFixed=function(e){return se(this,2,e,this.e+e)},ee.toPrecision=function(e){return se(this,3,e,e-1)},ee.toString=function(){return se(this)},ee.valueOf=ee.toJSON=function(){return se(this,4)};var ae=function e(){function t(n){var r=this;if(!(r instanceof t))return void 0===n?e():new t(n);n instanceof t?(r.s=n.s,r.e=n.e,r.c=n.c.slice(),function(e){if((e=ue(e,28,0)).c.length>1&&!e.c[0]){let t=e.c.findIndex(e=>e);e.c=e.c.slice(t),e.e=e.e-t}}(r)):ie(r,n),r.constructor=t}return t.prototype=ee,t.DP=28,t.RM=1,t.NE=-29,t.PE=29,t.version="5.2.2",t}(),ce=ae,fe=ce;new ce(0),new ce(1),new ce(-1),new ce("79228162514264337593543950335"),new ce("-79228162514264337593543950335");var le;function he(e){return-2147483648===e?e:-e}!function(e){e[e.AllowHexSpecifier=512]="AllowHexSpecifier"}(le||(le={}));var we=null;try{we=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function de(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function ge(e){return!0===(e&&e.__isLong__)}de.prototype.GetHashCode=function(){let e=this.unsigned?1:0;return e=(e<<5)+e^this.high,e=(e<<5)+e^this.low,e},de.prototype.Equals=function(e){return Ue(this,e)},de.prototype.CompareTo=function(e){return qe(this,e)},de.prototype.toString=function(e){return ze(this,e)},de.prototype.toJSON=function(){return ze(this)},de.prototype.__isLong__,Object.defineProperty(de.prototype,"__isLong__",{value:!0});var pe={},me={};function ye(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=me[e])?r:(n=ve(e,(0|e)<0?-1:0,!0),o&&(me[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=pe[e])?r:(n=ve(e,e<0?-1:0,!1),o&&(pe[e]=n),n)}function Se(e,t){if(isNaN(e))return t?Ee:Ge;if(t){if(e<0)return Ee;if(e>=Ce)return Ae}else{if(e<=-Ne)return Oe;if(e+1>=Ne)return Re}return e<0?Je(Se(-e,t)):ve(e%Te|0,e/Te|0,t)}function ve(e,t,n){return new de(e,t,n)}var Me=Math.pow;function Pe(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return Ge;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r=e.indexOf("-");if(r>0)throw Error("interior hyphen");if(0===r)return Je(Pe(e.substring(1),t,n));for(var o=Se(Me(n,8)),i=Ge,u=0;u<e.length;u+=8){var s=Math.min(8,e.length-u),a=parseInt(e.substring(u,u+s),n);if(s<8)i=Xe(Ve(i,Se(Me(n,s))),Se(a));else i=Xe(i=Ve(i,o),Se(a))}return i.unsigned=t,i}function be(e,t){return"number"==typeof e?Se(e,t):"string"==typeof e?Pe(e,t):ve(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}var Te=4294967296,Ce=Te*Te,Ne=Ce/2,Ie=ye(1<<24),Ge=ye(0),Ee=ye(0,!0),ke=ye(1),xe=ye(1,!0),De=ye(-1),Re=ve(-1,2147483647,!1),Ae=ve(-1,-1,!0),Oe=ve(0,-2147483648,!1);function Fe(e){return e.unsigned?e.low>>>0:e.low}function Le(e){return e.unsigned?(e.high>>>0)*Te+(e.low>>>0):e.high*Te+(e.low>>>0)}function ze(e,t){if((t=t||10)<2||36<t)throw RangeError("radix");if(Be(e))return"0";if(He(e)){if(Ue(e,Oe)){var n=Se(t),r=Ze(e,n),o=Ye(Ve(r,n),e);return ze(r,t)+Fe(o).toString(t)}return"-"+ze(Je(e),t)}for(var i=Se(Me(t,6),e.unsigned),u=e,s="";;){var a=Ze(u,i),c=(Fe(Ye(u,Ve(a,i)))>>>0).toString(t);if(Be(u=a))return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}}function Be(e){return 0===e.high&&0===e.low}function He(e){return!e.unsigned&&e.high<0}function We(e){return 1==(1&e.low)}function Ue(e,t){return ge(t)||(t=be(t)),(e.unsigned===t.unsigned||e.high>>>31!=1||t.high>>>31!=1)&&(e.high===t.high&&e.low===t.low)}function je(e,t){return qe(e,t)<0}function _e(e,t){return qe(e,t)>0}function Ke(e,t){return qe(e,t)>=0}function qe(e,t){if(ge(t)||(t=be(t)),Ue(e,t))return 0;var n=He(e),r=He(t);return n&&!r?-1:!n&&r?1:e.unsigned?t.high>>>0>e.high>>>0||t.high===e.high&&t.low>>>0>e.low>>>0?-1:1:He(Ye(e,t))?-1:1}function Je(e){return!e.unsigned&&Ue(e,Oe)?Oe:Xe($e(e),ke)}function Xe(e,t){ge(t)||(t=be(t));var n=e.high>>>16,r=65535&e.high,o=e.low>>>16,i=65535&e.low,u=t.high>>>16,s=65535&t.high,a=t.low>>>16,c=0,f=0,l=0,h=0;return l+=(h+=i+(65535&t.low))>>>16,f+=(l+=o+a)>>>16,c+=(f+=r+s)>>>16,c+=n+u,ve((l&=65535)<<16|(h&=65535),(c&=65535)<<16|(f&=65535),e.unsigned)}function Ye(e,t){return ge(t)||(t=be(t)),Xe(e,Je(t))}function Ve(e,t){if(Be(e))return e.unsigned?Ee:Ge;if(ge(t)||(t=be(t)),we)return ve(we.mul(e.low,e.high,t.low,t.high),we.get_high(),e.unsigned);if(Be(t))return e.unsigned?Ee:Ge;if(Ue(e,Oe))return We(t)?Oe:Ge;if(Ue(t,Oe))return We(e)?Oe:Ge;if(He(e))return He(t)?Ve(Je(e),Je(t)):Je(Ve(Je(e),t));if(He(t))return Je(Ve(e,Je(t)));if(je(e,Ie)&&je(t,Ie))return Se(Le(e)*Le(t),e.unsigned);var n=e.high>>>16,r=65535&e.high,o=e.low>>>16,i=65535&e.low,u=t.high>>>16,s=65535&t.high,a=t.low>>>16,c=65535&t.low,f=0,l=0,h=0,w=0;return h+=(w+=i*c)>>>16,l+=(h+=o*c)>>>16,h&=65535,l+=(h+=i*a)>>>16,f+=(l+=r*c)>>>16,l&=65535,f+=(l+=o*a)>>>16,l&=65535,f+=(l+=i*s)>>>16,f+=n*c+r*a+o*s+i*u,ve((h&=65535)<<16|(w&=65535),(f&=65535)<<16|(l&=65535),e.unsigned)}function Ze(e,t){if(ge(t)||(t=be(t)),Be(t))throw Error("division by zero");var n,r,o;if(we)return e.unsigned||-2147483648!==e.high||-1!==t.low||-1!==t.high?ve((e.unsigned?we.div_u:we.div_s)(e.low,e.high,t.low,t.high),we.get_high(),e.unsigned):e;if(Be(e))return e.unsigned?Ee:Ge;if(e.unsigned){if(t.unsigned||(t=function(e){return e.unsigned?e:ve(e.low,e.high,!0)}(t)),_e(t,e))return Ee;if(_e(t,tt(e,1)))return xe;o=Ee}else{if(Ue(e,Oe))return Ue(t,ke)||Ue(t,De)?Oe:Ue(t,Oe)?ke:Ue(n=Qe(Ze(et(e,1),t),1),Ge)?He(t)?ke:De:o=Xe(n,Ze(r=Ye(e,Ve(t,n)),t));if(Ue(t,Oe))return e.unsigned?Ee:Ge;if(He(e))return He(t)?Ze(Je(e),Je(t)):Je(Ze(Je(e),t));if(He(t))return Je(Ze(e,Je(t)));o=Ge}for(r=e;Ke(r,t);){n=Math.max(1,Math.floor(Le(r)/Le(t)));for(var i=Math.ceil(Math.log(n)/Math.LN2),u=i<=48?1:Me(2,i-48),s=Se(n),a=Ve(s,t);He(a)||_e(a,r);)a=Ve(s=Se(n-=u,e.unsigned),t);Be(s)&&(s=ke),o=Xe(o,s),r=Ye(r,a)}return o}function $e(e){return ve(~e.low,~e.high,e.unsigned)}function Qe(e,t){return ge(t)&&(t=Fe(t)),0==(t&=63)?e:t<32?ve(e.low<<t,e.high<<t|e.low>>>32-t,e.unsigned):ve(0,e.low<<t-32,e.unsigned)}function et(e,t){return ge(t)&&(t=Fe(t)),0==(t&=63)?e:t<32?ve(e.low>>>t|e.high<<32-t,e.high>>t,e.unsigned):ve(e.high>>t-32,e.high>=0?0:-1,e.unsigned)}function tt(e,t){if(ge(t)&&(t=Fe(t)),0===(t&=63))return e;var n=e.high;return t<32?ve(e.low>>>t|n<<32-t,n>>>t,e.unsigned):ve(32===t?n:n>>>t-32,0,e.unsigned)}var nt=de;const rt=Ve,ot=qe,it=function(e,t,n){return n?function(e,t){return new de(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)}(e,t):function(e,t){return new de(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}(e,t)},ut=function(e,t){return t?function(e){var t=e.high,n=e.low;return[255&n,n>>>8&255,n>>>16&255,n>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]}(e):function(e){var t=e.high,n=e.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,n>>>24,n>>>16&255,n>>>8&255,255&n]}(e)},st=ze;class at{constructor(e){this.iter=e}MoveNext(){const e=this.iter.next();return this.current=e.value,!e.done}get Current(){return this.current}Reset(){throw new Error("JS iterators cannot be reset")}Dispose(){}}function ct(e){return new at(e[Symbol.iterator]())}function ft(e){return{next:()=>e.MoveNext()?{done:!1,value:e.Current}:{done:!0,value:null}}}function lt(e){return wt(()=>{const t=e[Symbol.iterator]();let n={value:null};return vt(e=>{let r=!1;for(;!r;)if(null==e){const n=t.next();n.done?r=!0:e=n.value[Symbol.iterator]()}else{const t=e.next();t.done?e=null:(n={value:t.value},r=!0)}return null!=e&&null!=n?[n.value,e]:null},null)})}function ht(e,t){return lt(mt(e,t))}function wt(e){return{[Symbol.iterator]:()=>e()[Symbol.iterator]()}}function dt(e,t,n){if(Array.isArray(n)||ArrayBuffer.isView(n))return n.reduce(e,t);{let r;for(let o=0,i=n[Symbol.iterator]();r=i.next(),!r.done;o++)t=e(t,r.value,o);return t}}function gt(e,t){dt((t,n)=>(e(n),null),null,t)}function pt(e,t){dt((t,n,r)=>(e(null!=r?r:0,n),null),null,t)}function mt(e,t){return wt(()=>vt(t=>{const n=t.next();return n.done?null:[e(n.value),t]},t[Symbol.iterator]()))}function yt(e,t,n){if(0===t)throw new Error("Step cannot be 0");return wt(()=>vt(e=>t>0&&e<=n||t<0&&e>=n?[e,e+t]:null,e))}function St(e,t,n){return dt((t,r)=>n.Add(t,e(r)),n.GetZero(),t)}function vt(e,t){return{[Symbol.iterator]:()=>{let n=t;return{next:()=>{const t=e(n);if(null!=t){const e=$(t);if(null!=e)return n=e[1],{done:!1,value:e[0]}}return{done:!0,value:void 0}}}}}}const Mt=/(^|[^%])%([0+\- ]*)(\d+)?(?:\.(\d+))?(\w)/;function Pt(e){return"number"==typeof e||e instanceof nt||e instanceof fe}function bt(e,t){return e instanceof nt?ot(e,t)<0:e instanceof fe?e.cmp(t)<0:e<t}function Tt(e,t){return e instanceof nt?rt(e,t):e instanceof fe?e.mul(t):e*t}function Ct(e,t){return e instanceof nt?String(e)+(0).toFixed(t).substr(1):e.toFixed(t)}function Nt(e,t){return e instanceof nt?String(e)+(0).toPrecision(t).substr(1):e.toPrecision(t)}function It(e,t){return e instanceof nt?String(e)+(0).toExponential(t).substr(1):e.toExponential(t)}function Gt(e){return e instanceof nt?st(e.unsigned?e:it(ut(e),!0),16):(Number(e)>>>0).toString(16)}function Et(e){return{input:e,cont:(t=e,e=>Mt.test(t)?function e(t,n){return(...r)=>{let o=t;for(const e of r)o=xt(o,e);return Mt.test(o)?e(o,n):n(o.replace(/%%/g,"%"))}}(t,e):e(t))};var t}function kt(e){return e.cont(e=>e)}function xt(e,t){return e.replace(Mt,(e,n,r,o,i,u)=>{let s="";if(Pt(t))switch("x"!==u.toLowerCase()&&(bt(t,0)?(t=Tt(t,-1),s="-"):r.indexOf(" ")>=0?s=" ":r.indexOf("+")>=0&&(s="+")),i=null==i?null:parseInt(i,10),u){case"f":case"F":t=Ct(t,i=null!=i?i:6);break;case"g":case"G":t=null!=i?Nt(t,i):Nt(t);break;case"e":case"E":t=null!=i?It(t,i):It(t);break;case"x":t=Gt(t);break;case"X":t=Gt(t).toUpperCase();break;default:t=String(t)}if(o=parseInt(o,10),isNaN(o))t=s+t;else{const e=r.indexOf("0")>=0,n=r.indexOf("-")>=0,i=n||!e?" ":"0";t="0"===i?s+(t=At(t,o-s.length,i,n)):At(s+t,o,i,n)}return(n+t).replace(/%/g,"%%")})}function Dt(e,t){if(e<0)throw new Error("String length must be non-negative");const n=new Array(e);for(let r=0;r<e;r++)n[r]=t(r);return n.join("")}function Rt(e,t){return Array.isArray(t)?t.join(e):Array.from(t).join(e)}function At(e,t,n,r){n=n||" ",t-=e.length;for(let o=0;o<t;o++)e=r?e+n:n+e;return e}function Ot(e,t,n){if(t+(n||0)>e.length)throw new Error("Invalid startIndex and/or length");return null!=n?e.substr(t,n):e.substr(t)}const Ft=G((function(e,t){const n=new L(null);this.comparer=t,n.contents=this,this.hashMap=new Map([]),this["init@20-1"]=1,gt((function(e){Wt(n.contents,e[0],e[1])}),e)}));function Lt(e,t){const n=0|e.comparer.GetHashCode(t),r=i(e.hashMap,n,null);return r[0]?[!0,n,r[1].findIndex((function(n){return e.comparer.Equals(t,n[0])}))]:[!1,n,-1]}function zt(e,t){const n=Lt(e,t);switch(n[0]&&n[2]>-1?0:1){case 0:return N(e.hashMap,n[1])[n[2]];case 1:return null}}function Bt(e){e.hashMap.clear()}function Ht(e){return 0|St((function(e){return e.length}),e.hashMap.values(),{GetZero:()=>0,Add:(e,t)=>e+t})}function Wt(e,t,n){const r=Lt(e,t);switch(r[0]&&r[2]>-1?0:1){case 0:{let e;throw e=kt(Et("An item with the same key has already been added. Key: %A"))(t),new Error(e)}case 1:if(r[0]){In([t,n],N(e.hashMap,r[1]))}else e.hashMap.set(r[1],[[t,n]])}}function Ut(e,t){const n=Lt(e,t);switch(n[0]&&n[2]>-1?0:1){case 0:return N(e.hashMap,n[1]).splice(n[2],1),!0;case 1:return!1}}Ft.prototype[Symbol.iterator]=function(){const e=this;return ft(ct(wt((function(){return ht((function(e){return mt((function(e){return e}),e)}),e.hashMap.values())}))))},Ft.prototype.Add=function(e){Wt(this,e[0],e[1])},Ft.prototype.Clear=function(){Bt(this)},Ft.prototype.Contains=function(e){const t=zt(this,e[0]);switch(null!=t&&d(t[1],e[1])?0:1){case 0:return!0;case 1:return!1}},Ft.prototype.CopyTo=function(e,t){pt((function(n,r){e[t+n]=r}),this)},Object.defineProperty(Ft.prototype,"Count",{get:function(){return 0|Ht(this)}}),Object.defineProperty(Ft.prototype,"IsReadOnly",{get:function(){return!1}}),Ft.prototype.Remove=function(e){const t=this,n=zt(t,e[0]);if(null!=n){if(d(n[1],e[1])){Ut(t,e[0])}return!0}return!1},Object.defineProperty(Ft.prototype,"size",{get:function(){return 0|Ht(this)}}),Ft.prototype.clear=function(){Bt(this)},Ft.prototype.delete=function(e){return Ut(this,e)},Ft.prototype.entries=function(){return mt((function(e){return e}),this)},Ft.prototype.get=function(e){return function(e,t){const n=zt(e,t);if(null!=n){return n[1]}throw new Error("The item was not found in collection")}(this,e)},Ft.prototype.has=function(e){return function(e,t){const n=Lt(e,t);switch(n[0]&&n[2]>-1?0:1){case 0:return!0;case 1:return!1}}(this,e)},Ft.prototype.keys=function(){return mt((function(e){return e[0]}),this)},Ft.prototype.set=function(e,t){return function(e,t,n){const r=Lt(e,t);switch(r[0]&&r[2]>-1?0:1){case 0:N(e.hashMap,r[1])[r[2]]=[t,n];break;case 1:if(r[0]){In([t,n],N(e.hashMap,r[1]))}else e.hashMap.set(r[1],[[t,n]])}}(this,e,t),this},Ft.prototype.values=function(){return mt((function(e){return e[1]}),this)};const jt=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function _t(e){return function e(t,n){e:for(;;){const r=t,o=n;switch(o.tag){case 1:return r+1|0;case 2:t=e(r+1,o.fields[2]),n=o.fields[3];continue e;default:return 0|r}break}}(0,e)}function Kt(e,t,n){e:for(;;){const r=e,o=t,i=n;switch(i.tag){case 1:if(0===(0|r.Compare(o,i.fields[0])))return i.fields[1];throw new Error("key not found");case 2:{const u=0|r.Compare(o,i.fields[0]);if(u<0){e=r,t=o,n=i.fields[2];continue e}if(0===u)return i.fields[1];e=r,t=o,n=i.fields[3];continue e}default:throw new Error("key not found")}break}}function qt(e,t,n){e:for(;;){const r=e,o=t,i=n;switch(i.tag){case 1:return 0===r.Compare(o,i.fields[0]);case 2:{const u=0|r.Compare(o,i.fields[0]);if(u<0){e=r,t=o,n=i.fields[2];continue e}if(0===u)return!0;e=r,t=o,n=i.fields[3];continue e}default:return!1}break}}const Jt=G((function(e,t){this.stack=e,this.started=t}),F);function Xt(e){for(;;){const t=e;if(null==t.tail)return new x;if(1===t.head.tag)return t;2!==t.head.tag?e=t.tail:e=new x(t.head.fields[2],new x(new jt(1,"MapOne",t.head.fields[0],t.head.fields[1]),new x(t.head.fields[3],t.tail)))}}function Yt(e){return new Jt(Xt(new x(e,new x)),!1)}function Vt(e){if(e.started){const t=e.stack;if(null==t.tail)return function(){throw new Error("enumeration already finished")}();if(1===t.head.tag)return[t.head.fields[0],t.head.fields[1]];throw new Error("Please report error: Map iterator, unexpected stack for current")}return function(){throw new Error("enumeration not started")}()}const Zt=G((function(e){this.s=e,this.i=Yt(this.s)}));function $t(e){return function(e){return this instanceof Zt?Zt.call(this,e):new Zt(e)}(e)}function Qt(e){return vt((function(e){return e.MoveNext()?[e.Current,e]:null}),$t(e))}Object.defineProperty(Zt.prototype,"Current",{get:function(){return Vt(this.i)}}),Zt.prototype.MoveNext=function(){return function(e){if(e.started){const t=e.stack;if(null==t.tail)return!1;if(1===t.head.tag)return e.stack=Xt(t.tail),!(null==e.stack.tail);throw new Error("Please report error: Map iterator, unexpected stack for moveNext")}return e.started=!0,!(null==e.stack.tail)}(this.i)},Zt.prototype.Reset=function(){this.i=Yt(this.s)},Zt.prototype.Dispose=function(){};const en=G((function(e,t){this.comparer=e,this.tree=t}));function tn(e){return e.tree}function nn(e,t){return Kt(e.comparer,t,e.tree)}function rn(e){return _t(e.tree)}function on(e,t){return qt(e.comparer,t,e.tree)}en.prototype.toString=function(){return"map ["+Rt("; ",mt((function(e){return kt(Et("(%A, %A)"))(e[0])(e[1])}),this))+"]"},en.prototype.GetHashCode=function(){const e=function(e,t){return(e<<1)+t+631};let t=0;const n=$t(tn(this));for(;n.MoveNext();){const r=n.Current;t=e(t,l(r[0])),t=e(t,l(r[1]))}return 0|Math.abs(t)},en.prototype.Equals=function(e){return 0===this.CompareTo(e)},en.prototype[Symbol.iterator]=function(){return ft($t(this.tree))},en.prototype.CompareTo=function(e){const t=this;let n=0,r=!1;const i=$t(tn(t));try{const u=$t(tn(e));try{for(;!r&&0===n;){const e=[i.MoveNext(),u.MoveNext()];if(e[0])if(e[1]){const e=i.Current,r=u.Current,o=0|t.comparer.Compare(e[0],r[0]);n=0!==o?o:S(e[1],r[1])}else n=1;else e[1]?n=-1:r=!0}return 0|n}finally{o(u)&&u.Dispose()}}finally{o(i)&&i.Dispose()}},Object.defineProperty(en.prototype,"size",{get:function(){return 0|rn(this)}}),en.prototype.clear=function(){throw new Error("Map cannot be mutated")},en.prototype.delete=function(e){throw new Error("Map cannot be mutated")},en.prototype.entries=function(){return Qt(tn(this))},en.prototype.get=function(e){return nn(this,e)},en.prototype.has=function(e){return on(this,e)},en.prototype.keys=function(){return mt((function(e){return e[0]}),Qt(tn(this)))},en.prototype.set=function(e,t){throw new Error("Map cannot be mutated")},en.prototype.values=function(){return mt((function(e){return e[1]}),Qt(tn(this)))};const un=G((function(e,t){const n=new L(null);this.comparer=t,n.contents=this,this.hashMap=new Map([]),this["init@21-2"]=1,gt((function(e){fn(n.contents,e)}),e)}));function sn(e,t){const n=0|e.comparer.GetHashCode(t),r=i(e.hashMap,n,null);return r[0]?[!0,n,r[1].findIndex((function(n){return e.comparer.Equals(t,n)}))]:[!1,n,-1]}function an(e){e.hashMap.clear()}function cn(e){return 0|St((function(e){return e.length}),e.hashMap.values(),{GetZero:()=>0,Add:(e,t)=>e+t})}function fn(e,t){const n=sn(e,t);switch(n[0]&&n[2]>-1?0:1){case 0:return!1;case 1:if(n[0]){In(t,N(e.hashMap,n[1]));return!0}return e.hashMap.set(n[1],[t]),!0}}function ln(e,t){const n=sn(e,t);switch(n[0]&&n[2]>-1?0:1){case 0:return!0;case 1:return!1}}function hn(e,t){const n=sn(e,t);switch(n[0]&&n[2]>-1?0:1){case 0:return N(e.hashMap,n[1]).splice(n[2],1),!0;case 1:return!1}}un.prototype[Symbol.iterator]=function(){const e=this;return ft(ct(wt((function(){return ht((function(e){return mt((function(e){return e}),e)}),e.hashMap.values())}))))},un.prototype.Add=function(e){fn(this,e)},un.prototype.Clear=function(){an(this)},un.prototype.Contains=function(e){return ln(this,e)},un.prototype.CopyTo=function(e,t){pt((function(n,r){e[t+n]=r}),this)},Object.defineProperty(un.prototype,"Count",{get:function(){return 0|cn(this)}}),Object.defineProperty(un.prototype,"IsReadOnly",{get:function(){return!1}}),un.prototype.Remove=function(e){return hn(this,e)},Object.defineProperty(un.prototype,"size",{get:function(){return 0|cn(this)}}),un.prototype.add=function(e){fn(this,e);return this},un.prototype.add_=function(e){return fn(this,e)},un.prototype.clear=function(){an(this)},un.prototype.delete=function(e){return hn(this,e)},un.prototype.has=function(e){return ln(this,e)},un.prototype.keys=function(){return mt((function(e){return e}),this)},un.prototype.values=function(){return mt((function(e){return e}),this)},un.prototype.entries=function(){return mt((function(e){return[e,e]}),this)};const wn=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function dn(e){return new wn(2,"SetOne",e)}function gn(e,t,n,r){return new wn(1,"SetNode",e,t,n,r)}const pn=G((function(e,t){this.stack=e,this.started=t}),F);function mn(e){for(;;){const t=e;if(null==t.tail)return new x;if(2===t.head.tag)return t;1!==t.head.tag?e=t.tail:e=new x(t.head.fields[1],new x(dn(t.head.fields[0]),new x(t.head.fields[2],t.tail)))}}function yn(e){return new pn(mn(new x(e,new x)),!1)}function Sn(e){if(e.started){const t=e.stack;if(null==t.tail)return function(){throw new Error("Enumeration already started")}();if(2===t.head.tag)return t.head.fields[0];throw new Error("Please report error: Set iterator, unexpected stack for current")}return function(){throw new Error("Enumeration not started")}()}const vn=G((function(e){this.s=e,this.i=yn(this.s)}));function Mn(e){return function(e){return this instanceof vn?vn.call(this,e):new vn(e)}(e)}function Pn(e,t,n){return 0===t.tag?0===n.tag?0:-1:0===n.tag?1:0|function(e,t,n){e:for(;;){const H=e,W=t,U=n;var r,o,i,u,s,a,c,f,l,h,w,d,g,p,m,y,S,v,M,P,b,T,C,N,I,G,E,k,D,R,A,O,F,L,z,B;switch(null!=W.tail?null!=U.tail?2===U.head.tag?2===W.head.tag?(r=4,u=W.head.fields[0],s=U.head.fields[0],a=W.tail,c=U.tail):1===W.head.tag?0===W.head.fields[1].tag?(r=6,g=W.head.fields[1],p=W.head.fields[0],m=W.head.fields[2],y=U.head.fields[0],S=W.tail,v=U.tail):(r=9,E=W.head.fields[0],k=W.head.fields[1],D=W.head.fields[2],R=W.tail):(r=10,A=U.head.fields[0],O=U.tail):1===U.head.tag?0===U.head.fields[1].tag?2===W.head.tag?(r=5,f=W.head.fields[0],l=U.head.fields[0],h=U.head.fields[2],w=W.tail,d=U.tail):1===W.head.tag?0===W.head.fields[1].tag?(r=7,M=W.head.fields[0],P=W.head.fields[2],b=U.head.fields[0],T=U.head.fields[2],C=W.tail,N=U.tail):(r=9,E=W.head.fields[0],k=W.head.fields[1],D=W.head.fields[2],R=W.tail):(r=11,F=U.head.fields[0],L=U.head.fields[1],z=U.head.fields[2],B=U.tail):2===W.head.tag?(r=8,I=W.head.fields[0],G=W.tail):1===W.head.tag?(r=9,E=W.head.fields[0],k=W.head.fields[1],D=W.head.fields[2],R=W.tail):(r=11,F=U.head.fields[0],L=U.head.fields[1],z=U.head.fields[2],B=U.tail):2===W.head.tag?(r=8,I=W.head.fields[0],G=W.tail):1===W.head.tag?(r=9,E=W.head.fields[0],k=W.head.fields[1],D=W.head.fields[2],R=W.tail):(r=3,o=W.tail,i=U.tail):r=2:r=null!=U.tail?1:0,r){case 0:return 0;case 1:return-1;case 2:return 1;case 3:e=H,t=o,n=i;continue e;case 4:{const r=0|H.Compare(u,s);if(0!==r)return 0|r;e=H,t=a,n=c;continue e}case 5:{const r=0|H.Compare(f,l);if(0!==r)return 0|r;e=H,t=new x(new wn(0,"SetEmpty"),w),n=new x(h,d);continue e}case 6:{const r=0|H.Compare(p,y);if(0!==r)return 0|r;e=H,t=new x(m,S),n=new x(g,v);continue e}case 7:{const r=0|H.Compare(M,b);if(0!==r)return 0|r;e=H,t=new x(P,C),n=new x(T,N);continue e}case 8:e=H,t=new x(new wn(0,"SetEmpty"),new x(dn(I),G)),n=U;continue e;case 9:e=H,t=new x(k,new x(gn(E,new wn(0,"SetEmpty"),D,0),R)),n=U;continue e;case 10:e=H,t=W,n=new x(new wn(0,"SetEmpty"),new x(dn(A),O));continue e;case 11:e=H,t=W,n=new x(L,new x(gn(F,new wn(0,"SetEmpty"),z,0),B));continue e}break}}(e,new x(t,new x),new x(n,new x))}Object.defineProperty(vn.prototype,"Current",{get:function(){return Sn(this.i)}}),vn.prototype.MoveNext=function(){return function(e){if(e.started){const t=e.stack;if(null==t.tail)return!1;if(2===t.head.tag)return e.stack=mn(t.tail),!(null==e.stack.tail);throw new Error("Please report error: Set iterator, unexpected stack for moveNext")}return e.started=!0,!(null==e.stack.tail)}(this.i)},vn.prototype.Reset=function(){this.i=yn(this.s)},vn.prototype.Dispose=function(){};const bn=G((function(e,t){this.comparer=e,this.tree=t}));function Tn(e){return e.comparer}function Cn(e){return e.tree}bn.prototype.toString=function(){return"set ["+Rt("; ",mt((function(e){return String(e)}),this))+"]"},bn.prototype.GetHashCode=function(){let e=0;const t=Mn(Cn(this));for(;t.MoveNext();){e=((0|e)<<1)+(0|l(t.Current))+631}return 0|Math.abs(e)},bn.prototype.Equals=function(e){return 0===Pn(Tn(this),Cn(this),Cn(e))},bn.prototype.CompareTo=function(e){return 0|Pn(Tn(this),Cn(this),Cn(e))},bn.prototype[Symbol.iterator]=function(){return ft(Mn(Cn(this)))};function Nn(e,t,n,r){return e.fill(r,t,t+n),e}function In(e,t){t.push(e)}function Gn(e,t){return t.from(e)}function En(e,t,n){return function(e,t,n,r){for(;;){const o=e,i=t,u=n,s=r;if(null==s.tail)return u;e=o,t=i+1,n=o(i,u,s.head),r=s.tail}}(e,0,t,n)}function kn(e,t,n){for(;;){const r=e,o=t,i=n;if(null==i.tail)return o;e=r,t=r(o,i.head),n=i.tail}}function xn(e){return kn((function(e,t){return new x(t,e)}),new x,e)}function Dn(e){return xn(dt((function(e,t){return new x(t,e)}),new x,e))}function Rn(e){return kn((function(e,t){return e+1}),0,e)}function An(e,t){return xn(kn((function(t,n){return new x(e(n),t)}),new x,t))}function On(e,t){return xn(En((function(t,n,r){return new x(e(t,r),n)}),new x,t))}function Fn(e,t){kn((function(t,n){e(n)}),null,t)}function Ln(e,t){En((function(t,n,r){e(t,r)}),null,t)}function zn(e){let t=new x;for(let n=function(e){if(r(e))return e.length;{let t=0;for(const n of e)t++;return t}}(e)-1;n>=0;n--)t=new x(e[n],t);return t}function Bn(e,t){return function(e,t,n){e:for(;;){const r=e,o=t,i=n;if(null!=i.tail){const u=r(o,i.head);if(null==u){e=r,t=o+1,n=i.tail;continue e}return u}return null}}(e,0,t)}function Hn(e,t){return Bn((function(t,n){return e(t,n)?Z(n):null}),t)}function Wn(e,t){return Bn((function(t,n){return e(n)?Z(n):null}),t)}function Un(e,t){const n=Hn(e,t);if(null!=n){return $(n)}throw new Error("List did not contain any matching elements")}function jn(e,t){return Un((function(t,n){return e===t}),t)}function _n(e,t){if(null!=t.tail)return kn(e,t.head,t.tail);throw new Error("List was empty")}function Kn(e,t){return kn((function(t,n){return!!t&&e(n)}),!0,t)}function qn(e,t){for(;;){const n=e,r=t;if(null==r.tail)return!1;if(n(r.head))return!0;e=n,t=r.tail}}function Jn(e,t,n){let r;const o=Gn(t,Array);return o.sort((function(t,r){return-1*n.Compare(e(t),e(r))})),r=o,zn(r)}const Xn=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const Yn=G((function(e,t,n,r){this.ImageFileName=e,this.ImageTransparency=t,this.ImageWidth=n,this.ImageHeight=r}),F);const Vn=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const Zn=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const $n=G((function(e,t){this.ImageMetadata=e,this.HostImageRef=t}),F);const Qn=G((function(e,t){this.FontImageMetadata=e,this.FontCharWidth=0|t}),F);const er=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const tr=G((function(e,t,n,r,o,i,u){this.FontImage=e,this.MagnifyX=0|t,this.MagnifyY=0|n,this.SrcCharWidth=0|r,this.SrcCharHeight=0|o,this.CharWidth=0|i,this.CharHeight=0|u}),F);const nr=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const rr=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const or=G((function(e){this.SoundFileName=e}),F);const ir=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const ur=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const sr=G((function(e,t){this.SoundMetadata=e,this.HostSoundRef=t}),F);const ar=G((function(e,t,...n){D.call(this,e,t,...n)}),D);Math.fround(320),Math.fround(256);const cr=new er(0,"FontID",0),fr=new Vn(0,"ImageID",0),lr=new Vn(0,"ImageID",1),hr=new Vn(0,"ImageID",2),wr=new Vn(0,"ImageID",3),dr=new ir(0,"SoundID",0),gr=new ir(0,"SoundID",1),pr=new ir(0,"SoundID",2),mr=new ir(0,"SoundID",3),yr=new ir(0,"SoundID",4),Sr=new ir(0,"SoundID",5),vr=new ir(0,"SoundID",6),Mr=new ir(0,"SoundID",7),Pr=new ir(0,"SoundID",8),br=G((function(e,t,n){this.RetroScreenTitle=e,this.RetroScreenWidth=t,this.RetroScreenHeight=n}),F);function Tr(e,t,n,r){return new Yn(t,e,n,r)}const Cr=new x((Nr="PacmanFont.png",Ir=296,Gr=8,Er=8,new Qn(Tr(new Xn(1,"MagentaColourKeyImage"),Nr,Ir,Er),Gr)),new x);var Nr,Ir,Gr,Er;const kr=zn([Tr(new Xn(0,"OpaqueImage"),"PacmanBackground.png",320,256),Tr(new Xn(1,"MagentaColourKeyImage"),"PacmanLevel1.png",560,16),Tr(new Xn(0,"OpaqueImage"),"PacmanBackground2.png",320,256),Tr(new Xn(0,"OpaqueImage"),"PacmanBackground3.png",320,256)]),xr=zn([new or("pellet.ogg"),new or("pill.ogg"),new or("321.ogg"),new or("game-over.ogg"),new or("go.ogg"),new or("gulp.ogg"),new or("oww.ogg"),new or("victory.ogg"),new or("life.ogg")]),Dr=G((function(e,t){this.NewPlayerName=e,this.NewPlayerScore=t}),F);const Rr=G((function(e,t,n){this.PlayerName=e,this.PlayerScore=t,this.PlayerScoreString=n}),F);function Ar(e){return e.PlayerScore}function Or(e){let t;var n,r;return n=Ar,r={Compare:p},t=_n((function(e,t){return r.Compare(n(t),n(e))>0?t:e}),e),Ar(t)}function Fr(e,t){if(d(e,new x))return!1;{let o,i;return n=Ar,r={Compare:p},i=_n((function(e,t){return r.Compare(n(t),n(e))>0?e:t}),e),o=Ar(i),t>=o}var n,r}function Lr(e,t){if(Fr(t,e.NewPlayerScore)){let n,r;return r=function(e,t,n){let r;const o=Gn(t,Array);return o.sort((function(t,r){return n.Compare(e(t),e(r))})),r=o,zn(r)}(Ar,new x(new Rr(e.NewPlayerName.trim(),e.NewPlayerScore,e.NewPlayerScore.toString()),t),{Compare:p}),n=function(e){if(null!=e.tail)return e.tail;throw new Error("List was empty")}(r),Jn(Ar,n,{Compare:p})}return t}function zr(e,t){return An((function(t){return function(e,t,n){const r=(0|e.length)+(0|t.length)+2|0;return r>n?"":e+" "+Dt(n-r|0,(function(e){return"."}))+" "+t}(t.PlayerName,t.PlayerScoreString,e)}),t)}const Br=G((function(e,t){this.Score=e,this.HiScore=t}),F);const Hr=G((function(e,t,n,r){this.Name=e,this.SelectorIndex=0|t,this.MaxNameLength=0|n,this.Complete=r}),F);const Wr=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const Ur="ABCDEFGHIJKLMNOPQRSTUVWXYZ .X ";function jr(e,t){const n=Ur.length-1|0,r=n-1|0;switch(e.tag){case 1:{const e=0|(t.SelectorIndex===n?0:t.SelectorIndex+1);return new Hr(t.Name,e,t.MaxNameLength,t.Complete)}case 2:{const e=t.Name.length===t.MaxNameLength,n=e?t.Name:t.SelectorIndex===r?0===t.Name.length?t.Name:Ot(t.Name,0,t.Name.length-1):t.Name+Ur[t.SelectorIndex];return new Hr(n,t.SelectorIndex,t.MaxNameLength,e)}default:{const e=0|(0===t.SelectorIndex?n:t.SelectorIndex-1);return new Hr(t.Name,e,t.MaxNameLength,t.Complete)}}}function _r(e,t){const n=0|e.length,r=t-(0|~~(n/2))|0,o=0|(r<0?r+n:r);return Ot(e,o)+Ot(e,0,o)}function Kr(e){return zn(["ENTER YOUR NAME","","",(t=e.Name,n=e.MaxNameLength,r=".",At(t,n,r,!0)),"",""," V",_r(Ur,e.SelectorIndex)]);var t,n,r}const qr=G((function(e,t){this.ptx=e,this.pty=t}),F);const Jr=G((function(e,t){this.modx=e,this.mody=t}),F);const Xr=G((function(e,t,n,r){this.Left=e,this.Top=t,this.Right=n,this.Bottom=r}),F);G((function(e,t){this.dimx=e,this.dimy=t}),F);function Yr(e,t){return!(S(e.Left,t.Right)>=0||S(e.Right,t.Left)<=0||S(e.Top,t.Bottom)>=0||S(e.Bottom,t.Top)<=0)}const Vr=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const Zr=new Vr(0,"MazeByte",0),$r=new Vr(0,"MazeByte",8),Qr=new Vr(0,"MazeByte",4),eo=new Vr(0,"MazeByte",2),to=new Vr(0,"MazeByte",1),no=new Vr(0,"MazeByte",16);function ro(e,t){if(null!=t.tail){const n=0|Rn(t),r=0|t.head.length;return r>0&&Kn((function(e){return e.length===r}),t)?e(r,n):null}return null}function oo(e,t,n,r,o){if(e>0&&t>0){const i=Nn(new Array(e*t),0,e*t,o);return function(e,t,n,r){var o,i,u,s;if(t>0&&n>0){const a=n-1|0,c=t-1|0,f=function(t,n,r){const o=[t<0?c:t>c?0:t,n<0?a:n>a?0:n];return e(o[0],o[1])?r:Zr};let l;const h=$r.fields[0]|eo.fields[0];let w;l=new Vr(0,"MazeByte",h);const g=Qr.fields[0]|to.fields[0];w=new Vr(0,"MazeByte",g);for(let t=0;t<=a;t++)for(let n=0;n<=c;n++)if(e(n,t)){const h=f(n-1,t,$r),g=f(n,t-1,Qr),p=f(n+1,t,eo),m=f(n,t+1,to);let y;let S;let v;let M;let P,b,T;y=0===n&&d((o=g.fields[0]|m.fields[0],new Vr(0,"MazeByte",o)),w)?Zr:h,S=0===t&&d((i=h.fields[0]|p.fields[0],new Vr(0,"MazeByte",i)),l)?Zr:g,v=n===c&&d((u=g.fields[0]|m.fields[0],new Vr(0,"MazeByte",u)),w)?Zr:p,M=t===a&&d((s=h.fields[0]|p.fields[0],new Vr(0,"MazeByte",s)),l)?Zr:m;const C=M.fields[0]|S.fields[0];T=new Vr(0,"MazeByte",C);const N=y.fields[0]|T.fields[0];b=new Vr(0,"MazeByte",N);const I=v.fields[0]|b.fields[0];P=new Vr(0,"MazeByte",I),r(n,t,d(P,Zr)&&e(n,t)?no:P)}else r(n,t,Zr)}}(n,e,t,(function(t,n,o){i[n*e+t]=r(o)})),i}return null}function io(e,t,n,r){return ro((function(o,i){return oo(o,i,(function(t,n){return e(jn(n,r)[t])}),t,n)}),r)}const uo=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function so(e){switch(e.tag){case 2:return eo;case 1:return Qr;case 3:return to;default:return $r}}function ao(e){switch(e.tag){case 1:return 1;case 2:return 2;case 3:return 3;default:return 0}}function co(e){return 2===e.tag?new Jr(1,0):1===e.tag?new Jr(0,he(1)):3===e.tag?new Jr(0,1):new Jr(he(1),0)}const fo=G((function(e,t,n,r,o,i,u,s,a,c,f,l,h){this.Description=e,this.Turn90=0|t,this.Back90=0|n,this.Onward180=0|r,this.Back180=0|o,this.OnwardT=0|i,this.TurnAwayT=0|u,this.BackT=0|s,this.TurnIntoT=0|a,this.TurnBackT=0|c,this.Onward4=0|f,this.Turn4=0|l,this.Back4=0|h}),F);const lo=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const ho=G((function(e,t,n,r){this.PCLeft=e,this.PCUp=t,this.PCRight=n,this.PCDown=r}),F);const wo=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function go(e,t){const n=0|(1===t.tag||2===t.tag?1:3===t.tag?e.Turn90:4===t.tag?e.Back90:5===t.tag?e.Onward180:6===t.tag?e.Back180:7===t.tag?e.OnwardT:8===t.tag?e.TurnAwayT:9===t.tag?e.BackT:10===t.tag?e.TurnIntoT:11===t.tag?e.TurnBackT:12===t.tag?e.Onward4:13===t.tag?e.Turn4:14===t.tag?e.Back4:0),r=255&n;if(~~r!==n)throw new Error("Out of range probability value -- must fit a byte");return new wo(0,"DirectionProbability",r)}const po=G((function(e,t,n,r){this.ProbLeft=e,this.ProbUp=t,this.ProbRight=n,this.ProbDown=r}),F);const mo=new po(new wo(0,"DirectionProbability",1),new wo(0,"DirectionProbability",0),new wo(0,"DirectionProbability",0),new wo(0,"DirectionProbability",0)),yo=new po(new wo(0,"DirectionProbability",0),new wo(0,"DirectionProbability",1),new wo(0,"DirectionProbability",0),new wo(0,"DirectionProbability",0)),So=new po(new wo(0,"DirectionProbability",0),new wo(0,"DirectionProbability",0),new wo(0,"DirectionProbability",1),new wo(0,"DirectionProbability",0)),vo=new po(new wo(0,"DirectionProbability",0),new wo(0,"DirectionProbability",0),new wo(0,"DirectionProbability",0),new wo(0,"DirectionProbability",1));function Mo(e){return new po(new wo(0,"DirectionProbability",0===e.ProbLeft.fields[0]?0:M(p,~~(e.ProbLeft.fields[0]/4),1)),e.ProbUp,e.ProbRight,e.ProbDown)}function Po(e){const t=new wo(0,"DirectionProbability",0===e.ProbUp.fields[0]?0:M(p,~~(e.ProbUp.fields[0]/4),1));return new po(e.ProbLeft,t,e.ProbRight,e.ProbDown)}function bo(e){const t=new wo(0,"DirectionProbability",0===e.ProbRight.fields[0]?0:M(p,~~(e.ProbRight.fields[0]/4),1));return new po(e.ProbLeft,e.ProbUp,t,e.ProbDown)}function To(e){const t=new wo(0,"DirectionProbability",0===e.ProbDown.fields[0]?0:M(p,~~(e.ProbDown.fields[0]/4),1));return new po(e.ProbLeft,e.ProbUp,e.ProbRight,t)}const Co=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function No(e,t,n,r){return 0==(1&~~(r*e+Math.fround(.5)))?t:n}function Io(e,t){return 0==(1&~~(t*e+Math.fround(.5)))}G((function(e,t,...n){D.call(this,e,t,...n)}),D);const Go=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const Eo=G((function(e,t){this.ScoreAndHiScore=e,this.Lives=t}),F);const ko=Math.fround(12),xo=Math.fround(4),Do=Math.fround(12),Ro=Math.fround(6),Ao=Math.fround(5),Oo=Math.fround(8),Fo=Math.fround(2),Lo=Math.fround(32),zo=(Math.fround(3),Math.fround(3)),Bo=Math.fround(4),Ho=Math.fround(3),Wo=Math.fround(6),Uo=Math.fround(5),jo=Math.fround(8),_o=Math.fround(2);const Ko=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function qo(e,t){return function(e){switch(e){case 0:return new Ko(0,"ZeroAngle");case 1:return new Ko(1,"ClockwiseTurn90");case 2:return new Ko(2,"AboutTurn180");case 3:return new Ko(3,"AntiClockwiseTurn90");default:throw new Error("Invalid integer value for conversion to type Angle")}}(3&(ao(e)-ao(t)|0)|0)}const Jo=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const Xo=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const Yo=G((function(e,t,n,r){this.PacMode=e,this.PacFacingDirection=t,this.LivesLeft=n,this.PacStartPosition=r}),F);const Vo=G((function(e,t){this.PacState2=e,this.PacPosition=t}),F);const Zo=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const $o=G((function(e,t,n,r,o){this.GhostTag=e,this.GhostBasePosition=t,this.GhostFacingDirection=n,this.GhostMode=r,this.GhostAITable=o}),F);const Qo=G((function(e,t){this.GhostState2=e,this.GhostPosition=t}),F);function ei(e,t,n,r,o,i){if(o>0){let u;if(18===o){u=No(Math.fround(10),18,19,i)}else u=o;e(new Go(3,"DrawSubImageStretchedToTarget",16*(u-1),0,16,16,0|n,0|r,16,16,t))}}const ti=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function ni(e,t,n,r,o,i){const u=0|(2===r.tag?20:1===r.tag?22:3===r.tag?23:21);let s;const a=function(e){return 0|No(jo*e,u,u+4|0,i)};switch(o.tag){case 1:s=a(Math.fround(2));break;case 2:s=u;break;default:s=a(Math.fround(1))}ei(e,t,n.ptx,n.pty,s,i)}function ri(e,t,n,r,o,i){let u;const s=r.fields[0]+28|0;switch(o.tag){case 1:u=o.fields[0]-i<xo?No(Do,s,35,i):No(Ro,34,35,i);break;case 2:u=35;break;case 3:u=No(Oo,35,s,i);break;default:u=s}let a;ei(e,t,n.ptx,n.pty,u,i),a=No(_o*(r.fields[0]+1),32,33,i),ei(e,t,n.ptx,n.pty,a,i)}const oi=G((function(e,t){this.pos=e,this.direction=t}),F);const ii=G((function(e,t){this.pos=e,this.number=t}),F);function ui(e,t,n,r){ni(e,t,r.pos,r.direction,new ti(0,"DrawPacNormal"),n)}function si(e,t,n,r){ri(e,t,r.pos,r.number,new Zo(0,"GhostNormal"),n)}function ai(e,t,n){let r,o;r=~~(320*t/100),o=~~(256*n/100);return new oi(new qr(r-8,o-8),e)}function ci(e,t,n){let r,o;r=~~(320*t/100),o=~~(256*n/100);return new ii(new qr(r-8,o-8),e)}const fi=G((function(){}));function li(){return this instanceof fi?fi.call(this):new fi}const hi=G((function(e,t,n,r){li.call(this),this["Model@"]=e,this["DrawFunc@"]=t,this["FrameFunc@"]=n,this["SoundEffectCommands@"]=r}),fi);function wi(e,t,n,r){return this instanceof hi?hi.call(this,e,t,n,r):new hi(e,t,n,r)}function di(e){return e["Model@"]}function gi(e){return T(3,e["DrawFunc@"])}function pi(e){return T(4,e["FrameFunc@"])}function mi(e){return e["SoundEffectCommands@"]}function yi(e){return null==mi(e).tail?e:wi(di(e),b(3,gi(e)),b(4,pi(e)),new x)}function Si(e,t,n,r){return yi(e)}function vi(e,t){return wi(null,(function(e,n,r){t.Draw(e,r)}),(function(e,n,r,o){return t.Frame(n,r,o)}),e)}hi.prototype.Draw=function(e,t){gi(this)(e)(di(this))(t)},hi.prototype.Frame=function(e,t,n){return pi(this)(this)(e)(t)(n)},hi.prototype.Sounds=function(){return mi(this)};const Mi=P([]),Pi=P([]),bi=P([]);function Ti(e,t,n,r){return e(new Go(0,"DrawImageWithTopLeftAtInt",t,n,r))}function Ci(e,t,n,r,o){const i=~~r*o.SrcCharWidth|0;return e(new Go(3,"DrawSubImageStretchedToTarget",i,0,o.SrcCharWidth,o.SrcCharHeight,t,n,o.CharWidth,o.CharHeight,o.FontImage))}function Ni(e,t,n,r,o,i,u){!function(e,t,n,r,o,i,u,s){const a=function(e){return e.length*t};let c=0|(1===u.tag?r-~~(a(i)/2):2===u.tag?r-a(i):r);const f=0|(1===s.tag?o-~~(n/2):2===s.tag?o-n:o);gt((function(n){const r=function(t){e(t,c,f)};n>="0"&&n<="9"?r(n.charCodeAt(0)-48):n>="A"&&n<="Z"?r(n.charCodeAt(0)-55):n>="a"&&n<="z"?r(n.charCodeAt(0)-87):"."===n&&r(36),c+=t}),i.split(""))}((function(n,r,o){Ci(e,r,o,n>>>0,t)}),t.CharWidth,t.CharHeight,o,i,u,n,r)}function Ii(e,t,n,r,o,i,u){Ni(e,Pi()[t.fields[0]],n,r,o,i,u)}function Gi(e,t,n,r,o,i,u,s){!function(e,t,n,r,o,i,u,s){if(null==s.tail);else{let a;a=t.CharHeight;const c=0|M(p,a,u),f=(Rn(s)-1)*c+a|0,l=0|(1===r.tag?i-~~(f/2):2===r.tag?i-f:i);Ln((function(r,i){const u=l+c*r|0;Ni(e,t,n,new rr(0,"TopAlign"),o,u,i)}),s)}}(e,Pi()[t.fields[0]],n,r,o,i,u,s)}const Ei=new J(0,"WebBrowserKeyCode",38),ki=new J(0,"WebBrowserKeyCode",40),xi=new J(0,"WebBrowserKeyCode",37),Di=new J(0,"WebBrowserKeyCode",39),Ri=new J(0,"WebBrowserKeyCode",90),Ai=G((function(e,t,n,r,o,i){this.Scoreboard=e,this.ScoreAndHiScore=t,this.EnterYourNameModel=n,this.MemoizedText=r,this.PacMemo=o,this.WhereToAfterCtor=i}),F);function Oi(e,t,n){let r,o;r=Mi()[fr.fields[0]],Ti(e,0,0,r),o=Mi()[lr.fields[0]],ui(e,o,n,t.PacMemo),Gi(e,cr,new nr(1,"CentreAlign"),new rr(1,"MiddleAlign"),160,100,10,t.MemoizedText)}function Fi(e,t,n,r){const o=di(e),i=function(e,t){const n=t(Ri),r=t(xi),o=t(Di);return n.JustDown?jr(new Wr(2,"SelectLetter"),e):r.JustDown?jr(new Wr(0,"RotateLeft"),e):o.JustDown?jr(new Wr(1,"RotateRight"),e):null}(o.EnterYourNameModel,t);if(null!=i){const t=i;if(t.Complete){let e;u=t,s=o.ScoreAndHiScore.Score,a=o.Scoreboard,e=Lr(new Dr(u.Name,s),a);const r=o.WhereToAfterCtor(e,n);return vi(new x(new ar(0,"PlaySoundEffect",bi()[Mr.fields[0]]),new x),r)}{const n=new Ai(o.Scoreboard,o.ScoreAndHiScore,t,Kr(t),o.PacMemo,o.WhereToAfterCtor),r=new x(new ar(0,"PlaySoundEffect",bi()[dr.fields[0]]),new x),i=pi(e);return wi(n,b(3,gi(e)),b(4,i),r)}}return yi(e);var u,s,a}function Li(e,t,n,r){if(Fr(t,e.Score)){const r=new Hr("",0,10,!1);let o,i;return i=Kr(r),o=new Ai(t,e,r,i,ai(new uo(2,"FacingRight"),50,15),n),wi(o,Oi,Fi,new x)}return n(t,r)}const zi=G((function(e,t,n,r,o){this.BackgroundImage=e,this.Font=t,this.MessageText=n,this.ScreenWidthInt=r,this.ScreenHeightInt=o}),F);function Bi(e,t,n){Ti(e,0,0,t.BackgroundImage),Ni(e,t.Font,new nr(1,"CentreAlign"),new rr(1,"MiddleAlign"),~~(t.ScreenWidthInt/2),~~(t.ScreenHeightInt/2),t.MessageText)}function Hi(e,t,n,r,o){return wi(new zi(e,t,n,r,o),Bi,Si,new x)}const Wi=G((function(e,t,n,r){this.FrozenGameState=e,this.TimeFiddler=t,this.UnfreezeGameTime=n,this.PostFreezeCtor=r}),F);function Ui(e,t,n){const r=t.TimeFiddler(n);t.FrozenGameState.Draw(e,r)}function ji(e,t,n,r){const o=di(e);return n<o.UnfreezeGameTime?yi(e):o.PostFreezeCtor((i=o.FrozenGameState,wi(null,(function(e,t,n){i.Draw(e,n)}),Si,new x)),n);var i}function _i(e){return function(t){return function(t){return e(t)}}}function Ki(e,t,n,r){return wi(new Wi(r,(function(e){return t}),t+e,n),Ui,ji,new x)}function qi(e,t,n,r){return wi(new Wi(r,(function(e){return e}),t+e,n),Ui,ji,new x)}const Ji=G((function(e,t,n,r,o,i,u,s,a){this.ScoreAndHiScore=e,this.ScoreText=t,this.HiScoreText=n,this.PacLeftMemo=r,this.PacRightMemo=o,this.Ghost0Memo=i,this.Ghost1Memo=u,this.Ghost2Memo=s,this.Ghost3Memo=a}),F);function Xi(e,t,n){let r;r=Mi()[wr.fields[0]],Ti(e,0,0,r);const o=function(t,n){Ii(e,cr,new nr(1,"CentreAlign"),new rr(1,"MiddleAlign"),160,~~(256*t/100),n)};let i;i=Mi()[lr.fields[0]];const u=function(t){ui(e,i,n,t)},s=function(t){si(e,i,n,t)};o(20,"PAC MAN"),o(30,"GAME OVER"),o(45,t.ScoreText),o(55,t.HiScoreText),u(t.PacRightMemo),u(t.PacLeftMemo),s(t.Ghost0Memo),s(t.Ghost1Memo),s(t.Ghost2Memo),s(t.Ghost3Memo)}const Yi=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function Vi(e){const t=(e.fields[0]^e.fields[0]<<13>>>0)>>>0,n=(t^t>>>17)>>>0;return new Yi(0,"XorShift32State",(n^n<<5>>>0)>>>0)}const Zi=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function $i(e,t,n,r,o){const i=(n.ptx-t.ptx)/o,u=(n.pty-t.pty)/o;return function(n){const s=n-r;if(s>=Math.fround(0)){if(s<=o){const n=e(s,o),r=t.ptx+i*n,a=t.pty+u*n;return new Zi(1,"MOMVisibleAtPosition",new qr(r,a))}return new Zi(2,"MOMDisappeared")}return new Zi(0,"MOMYetToAppear")}}G((function(e,t,n,r){this.PositionGetter=e,this.StartPosition=t,this.FinalPosition=n,this.EndGameTime=r}),F);function Qi(e,t){return function(n){return t(1===n.tag?new Go(1,"DrawFilledRectangle",n.fields[0]+e.ptx,n.fields[1]+e.pty,n.fields[2],n.fields[3],n.fields[4]):2===n.tag?new Go(2,"DrawStretchedImageWithTopLeftAt",e.ptx+(0|~~(n.fields[0]+Math.fround(.5)))|0,e.pty+(0|~~(n.fields[1]+Math.fround(.5)))|0,n.fields[2],n.fields[3],n.fields[4]):3===n.tag?new Go(3,"DrawSubImageStretchedToTarget",n.fields[0],n.fields[1],n.fields[2],n.fields[3],e.ptx+(0|~~(n.fields[4]+Math.fround(.5)))|0,e.pty+(0|~~(n.fields[5]+Math.fround(.5)))|0,n.fields[6],n.fields[7],n.fields[8]):new Go(0,"DrawImageWithTopLeftAtInt",n.fields[0]+e.ptx,n.fields[1]+e.pty,n.fields[2]))}}const eu=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const tu=G((function(e,t){this.SecondScreenRelativePosition=e,this.PositionFunction=t}),F);const nu=G((function(e,t,n){this.SlideTransitionModel2=e,this.FromScreenState=t,this.ToScreenState=n}),F);function ru(e,t,n){const r=t.SlideTransitionModel2.PositionFunction(n);switch(r.tag){case 1:{let o;const i=function(e){let t;return t=~~(e+Math.fround(.5)),0|t};let u,s,a;o=new qr(i(r.fields[0].ptx),i(r.fields[0].pty)),u=Qi(o,e),t.FromScreenState.Draw(u,n),a=new qr(o.ptx+t.SlideTransitionModel2.SecondScreenRelativePosition.ptx,o.pty+t.SlideTransitionModel2.SecondScreenRelativePosition.pty),s=Qi(a,e),t.ToScreenState.Draw(s,n);break}}}function ou(e,t,n,r){const o=di(e);if(2===o.SlideTransitionModel2.PositionFunction(n).tag)return o.ToScreenState;{let i,u;i=o.FromScreenState.Frame(t,n,r),u=o.ToScreenState.Frame(t,n,r);const s=new nu(o.SlideTransitionModel2,i,u),a=pi(e);return wi(s,b(3,gi(e)),b(4,a),new x)}}function iu(e,t,n,r,o,i,u,s){const a=function(e,t,n){switch(e.tag){case 1:return new qr(0,n);case 2:return new qr(he(t),0);case 3:return new qr(t,0);default:return new qr(0,he(n))}}(n,r,o),c=new qr(Math.fround(0),Math.fround(0));let f,l;l=new qr(he(a.ptx),he(a.pty));f=new qr(l.ptx,l.pty);const h=new tu(a,$i(i,c,f,s,u));return wi(new nu(h,e,t),ru,ou,new x)}function uu(){return wi(null,(function(e,t,n){!function(e,t,n){const r=[160,88];Ii(e,cr,new nr(1,"CentreAlign"),new rr(1,"MiddleAlign"),r[0],r[1],"GET READY")}(e)}),Si,new x)}const su=G((function(e,t,n){this.GameTimeLie=e,this.FrozenGameState=t,this.Overlay=n}),F);function au(e,t,n){t.FrozenGameState.Draw(e,t.GameTimeLie),t.Overlay.Draw(e,n)}function cu(e,t,n,r){const o=di(e);let i;i=o.Overlay.Frame(t,n,r);const u=new su(o.GameTimeLie,o.FrozenGameState,i),s=pi(e);return wi(u,b(3,gi(e)),b(4,s),new x)}function fu(e,t,n,r){let o;return o=Ki(n,r,(function(t,n){const r=e(n);return vi(new x(new ar(0,"PlaySoundEffect",bi()[yr.fields[0]]),new x),r)}),wi(new su(r,e(r),t),au,cu,new x)),vi(new x(new ar(0,"PlaySoundEffect",bi()[pr.fields[0]]),new x),o)}const lu=G((function(e,t,...n){D.call(this,e,t,...n)}),D);const hu=G((function(e,t,n,r,o){this.MazeTilesCountX=0|e,this.MazeTilesCountY=0|t,this.MazeTiles=n,this.MazeGhostRails=r,this.MazePlayersRails=o}),F);const wu=[zn(["####################","#@................@#","#.####.######.####.#","#.####.######.####.#","#..................#","#.##.##.####.##.##.#","#.##.##.:12:.##.##.#","#.......:34:.......#","#.##.##.:  :.##.##.#","#.##.##.####.##.##.#","#..................#","#.##.##########.##.#","#.##.##########.##.#","#@....0...........@#","####################"]),zn(["#####.########.#####","#@................@#","#.###.##.##.##.###.#","#.###.##.##.##.###.#","#.##.....##.....##.#","#....##.####.##....#","#.##.##.:12:.##.##.#","#.##....:34:....##.#","#.##.##.:  :.##.##.#","#....##.####.##....#","#.##.....##.....##.#","#.###.##.##.##.###.#","#.###.##.##.##.###.#","#@......0.........@#","#####.########.#####"]),zn(["#########  #########","#@......####......@#","#.##.##......##.##.#","#.##.##.####.##.##.#","#..................#","###.#.#.####.#.##.##","###.#.#.#12:.#.##.##","........#34:........","###.#.#.#  :.#.##.##","###.#.#.####.#.##.##","#...0..............#","#.##.##.####.##.##.#","#.##.##......##.##.#","##......####......@#","#########  #########"]),zn(["#####.##.#####.#####","....................","#.###.###.#.##.#.#.#","#@###.###.#.##.#@#.#","#.###.#......#...#.#","#.###.#.####...###.#","......#.#12:.#......","#.###.#.#34:.###.###",".......0####...#....","#.###.#......#.#.###","#@###.##.#####.#...#","#..............#.#@#","########.#####.#.#.#","......##.#####......","#####.##.#####.#####"]),zn(["####################","#..@............@..#","#.###.##.##.##.###.#","#.#####......#####.#","#.......####.......#","###.###.#  #.###.###","....###.#12:.###....","###.....#34:.....###","....###0#  #.###....","###.###.#  #.###.###","#.......####.......#","#.#####......#####.#","#.###.##.##.##.###.#","#..@............@..#","####################"]),zn(["####################","#..................#","#.###.########.###.#","#@###..........###@#","#.###.#.####.#.###.#","#...#.#.#12:.#.#...#","#.#...#.#34:.#...#.#","..#.#.#.####.#.#.#..","#.#.#.#.####.#.#.#.#","#.#..............#.#","#.###.########.###.#","#@###...0......###@#","#.###.########.###.#","#..................#","####################"]),zn(["##.# #.##.##########","#..#.#............@#","#.##..#.#.##.#.#.#.#","#.###.#.#.##.......#","#@......#....#.#.#.#","#####.######.......#","#@..#...:12:.#.#.#.#","..#.#.#.:34:........","#..0....##########.#","##.###.#...@.......#","#...#..#.#.#######.#","#.#.#.##.#...#...#.#","#.#.#..#.#.#.#.#.#.#",".....#.#...#...#....","##.# #.##.##########"]),zn(["#####.########.#####","#####.##....##.#####","###......##......###","##.@#.#.####.#.#@.##","##.##..........##.##","......#.####.#......","####.##.#12:.##.####","####.##.#34:.##.####","......#0####.#......","##.##..........##.##","##.@#.#.####.#.#@.##","###......##......###","#####.##....##.#####","......########......","#####.########.#####"]),zn(["#####      #####.# #","##..########.....@.#","#.#..........#####.#","#...########....##.#","###.###......##.##.#","#.......####.##..#.#","#.##.##.#12:.###.#.#","#.##.##.#34:.###.#.#","#.##.##0####.###...#","#.##.##.####.....#.#","#.##.##......###.#.#","#.##....###.####.#.#","#@##.######......@.#","#...........####.#.#","#############  #.# #"]),zn(["####################","#..................#","#.#.############.#.#","#.#@............@#.#","#.###.#.####.#.###.#","#.....#.#12#.#.....#","#####.#.#34#.#.#####","....................","###.#.#.#.##.#.#.###","#.....#.#..#.#.....#","#.###.#.##.#.#.###.#","#..@#.#......#.#@..#","#.#.#.#.####.#.#.#.#","#.......0..........#","####################"]),zn(["  #.#######.####.#  ","  #......@#....#.#  ","#####.##.##.##.#.###","......##.##.##.#....","#####.......##.#####","#...#.#.#####...@..#","#.#.#.#..:12:.##.###","#@#.#.##.#34:.##.###","#.#...##.####.##...#","....#.##.........#..","#####.###.##.#######","    #...#.#......#  ","  ###.#.#.#.#.##.#  ","  #....0..#.#.@..#  ","  #.#######.####.#  "]),zn(["##.#        #.######","##.# ########....###","...# #......####.#..","#### ####.#.#......#","     #12:.#.###.####","     #34:.#.#.....@#","#########.#.##.#####","....................","########.##.########","..@.#.....#.#.......","###.#.#.#.#.#.######","#...#.#.@.#.#.#     ","#.###.#####.#.# ### ","#..##...0...#.# ### ","##.##########.#     "])],du=G((function(e,t,n){this.UnpackedMazeState=e,this.UnpackedPacmanPosition=t,this.UnpackedGhostPositions=n}),F);const gu=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function pu(e,t){let n;if(n=ro((function(n,r){let o=new gu(1,"NotFound");return Ln((function(t,r){for(let i=0;i<=n-1;i++)if(r[i]===e)switch(o.tag){case 2:case 3:o=new gu(3,"NotUnique");break;case 0:throw new Error("unexpected case");default:o=new gu(2,"Found",i,t)}}),t),o}),t),null==n)return new gu(0,"InvalidMaze");return n}const mu=G((function(e,t,n,r){this.MostRecentScore=e,this.MostRecentHiScore=t,this.MostRecentLevelIndex=0|n,this.MostRecentLives=r}),F);const yu=G((function(e,t,n,r,o){this.MostRecentStatusPanel=e,this.MemoizedScoreString=t,this.MemoizedHiScoreString=n,this.MemoizedLevelIndexString=r,this.MemoizedLivesString=o}),F);const Su=G((function(e,t,n,r,o,i,u,s,a){this.Random=e,this.LevelIndex=0|t,this.ScoreAndHiScore=n,this.MazeState=r,this.PacmanState=o,this.GhostsState=i,this.MemoizedStatusPanelStrings=u,this.WhereToOnGameOver=s,this.WhereToOnAllEaten=a}),F);function vu(e,t,n,r){return new mu(e,t,n,r)}function Mu(e){var t;return new yu(e,kt(Et("SCORE %d"))(e.MostRecentScore),kt(Et("HISCORE %d"))(e.MostRecentHiScore),(t=e.MostRecentLevelIndex+1|0,kt(Et("FRAME %d"))(t)),kt(Et("LIVES %d"))(e.MostRecentLives))}function Pu(e){if(function(e){const t=function(e){return e%16==0};return!!t(e.ptx)&&t(e.pty)}(e)){return[0|~~(e.ptx/16),0|~~(e.pty/16)]}return null}function bu(e,t){var n;return!d((n=so(t),new Vr(0,"MazeByte",n.fields[0]&e.fields[0])),Zr)}function Tu(e){return new Xr(e.ptx+5,e.pty+5,e.ptx+16-5,e.pty+16-5)}function Cu(e){return new Xr(e.ptx,e.pty,e.ptx+16,e.pty+16)}function Nu(e,t){return new Vo(new Yo(e,t.PacState2.PacFacingDirection,t.PacState2.LivesLeft,t.PacState2.PacStartPosition),t.PacPosition)}function Iu(e,t){return new Qo(new $o(t.GhostState2.GhostTag,t.GhostState2.GhostBasePosition,t.GhostState2.GhostFacingDirection,e,t.GhostState2.GhostAITable),t.GhostPosition)}function Gu(e,t){const n=16*e.MazeTilesCountX|0,r=16*e.MazeTilesCountY|0,o=0|(t.ptx<he(8)?t.ptx+n:t.ptx>=n-8?t.ptx-n:t.ptx),i=0|(t.pty<he(8)?t.pty+r:t.pty>=r-8?t.pty-r:t.pty);return new qr(o,i)}function Eu(e,t,n,r,o){let i;switch(o.tag){case 2:i=new Jr(1,0);break;case 1:i=new Jr(0,he(1));break;case 3:i=new Jr(0,1);break;default:i=new Jr(he(1),0)}const u=function(e){let t;return t=new qr(16*e.ptx,16*e.pty),Cu(t)};let s;return s=function(e,t){switch(e.tag){case 1:return new Xr(t.Left,t.Top,t.Right,t.Top);case 2:return new Xr(t.Right,t.Top,t.Right,t.Bottom);case 3:return new Xr(t.Left,t.Bottom,t.Right,t.Bottom);default:return new Xr(t.Left,t.Top,t.Left,t.Bottom)}}(o,u(r)),function(r,o,i){var s,a,c;e:for(;;){const f=r,l=o,h=i;let w;if(w=new qr(l.ptx+f.modx,l.pty+f.mody),w.ptx<0||w.pty<0||w.ptx>=e||w.pty>=t||(s=n[w.pty*e+w.ptx]).fields[0]>=1&&s.fields[0]<=16)return h;{const e=u(w);r=f,o=w,i=(c=h,new Xr(v(S,(a=e).Left,c.Left),v(S,a.Top,c.Top),M(S,a.Right,c.Right),M(S,a.Bottom,c.Bottom)));continue e}}}(i,r,s)}function ku(e,t,n,r){return[e-~~(16*n/2)|0,t-~~(16*r/2)|0]}function xu(e,t,n,r,o,i){!function(e,t,n,r,o,i,u,s){const a=ku(n,r,o,i);for(let n=0;n<=i-1;n++){const r=a[1]+16*n|0;for(let i=0;i<=o-1;i++){const c=u[n*o+i];ei(e,t,a[0]+16*i|0,r,~~c.fields[0],s)}}}(e,t,n,r,o.MazeTilesCountX,o.MazeTilesCountY,o.MazeTiles,i)}function Du(e,t,n){let r,o;r=Mi()[fr.fields[0]],Ti(e,0,0,r),o=Mi()[lr.fields[0]];const i=[160,128],u=ku(i[0],i[1],t.MazeState.MazeTilesCountX,t.MazeState.MazeTilesCountY);let s,a,c,f;switch(xu(e,o,i[0],i[1],t.MazeState,n),a=Gu(t.MazeState,t.PacmanState.PacPosition),s=new qr(a.ptx+u[0],a.pty+u[1]),c=t.PacmanState.PacState2.PacFacingDirection,f=t.PacmanState.PacState2.PacMode,f.tag){case 1:Io(Lo,n)&&ni(e,o,s,c,new ti(2,"DrawPacZapped"),n);break;case 2:break;default:{const r=qn((function(e){return 1===e.GhostState2.GhostMode.tag}),t.GhostsState)?new ti(1,"DrawPacPillMode"):new ti(0,"DrawPacNormal");ni(e,o,s,c,r,n)}}Ln((function(r,i){let s,a,c,f;a=Gu(t.MazeState,i.GhostPosition),s=new qr(a.ptx+u[0],a.pty+u[1]),c=i.GhostState2.GhostTag,f=i.GhostState2.GhostMode,ri(e,o,s,c,f,n)}),t.GhostsState),Ii(e,cr,new nr(0,"LeftAlign"),new rr(0,"TopAlign"),20,2,t.MemoizedStatusPanelStrings.MemoizedScoreString),Ii(e,cr,new nr(2,"RightAlign"),new rr(0,"TopAlign"),300,2,t.MemoizedStatusPanelStrings.MemoizedHiScoreString),Ii(e,cr,new nr(0,"LeftAlign"),new rr(2,"BottomAlign"),20,254,t.MemoizedStatusPanelStrings.MemoizedLevelIndexString),Ii(e,cr,new nr(2,"RightAlign"),new rr(2,"BottomAlign"),300,254,t.MemoizedStatusPanelStrings.MemoizedLivesString)}const Ru=G((function(e,t,...n){D.call(this,e,t,...n)}),D);function Au(e,t,n){let r,o;switch(r=n.PacState2.PacFacingDirection,o=n.PacState2.PacMode,o.tag){case 1:case 2:return[new Ru(0,"EatenNothing"),n.PacPosition,r,0,new x];default:{const o=function(e){let t,n,r,o;return t=e(Ei).Held,n=e(ki).Held,r=e(xi).Held,o=e(Di).Held,[t,n,r,o]}(e),f=(i=o[0],u=o[1],s=o[2],a=o[3],c=r,!0===i&&!1===u&&!1===s&&!1===a?new uo(1,"FacingUp"):!1===i&&!0===u&&!1===s&&!1===a?new uo(3,"FacingDown"):!1===i&&!1===u&&!0===s&&!1===a?new uo(0,"FacingLeft"):!1===i&&!1===u&&!1===s&&!0===a?new uo(2,"FacingRight"):c),l=qo(f,r),h=Pu(n.PacPosition);let w,d,g,p,m;switch(l.tag){case 2:w=f;break;case 3:case 1:if(null!=h){const e=0|h[1],n=0|h[0],o=e*t.MazeTilesCountX+n|0;w=bu(t.MazePlayersRails[o],f)?f:r}else w=r;break;default:w=f}if(null!=h){const e=0|h[1],n=0|h[0],r=e*t.MazeTilesCountX+n|0,o=t.MazeTiles[r];d=17===o.fields[0]?[new Ru(1,"EatenDot",r),10,new x(new ar(0,"PlaySoundEffect",bi()[dr.fields[0]]),new x)]:18===o.fields[0]?[new Ru(2,"EatenPowerPill",r),250,new x(new ar(0,"PlaySoundEffect",bi()[gr.fields[0]]),new x)]:[new Ru(0,"EatenNothing"),0,new x]}else d=[new Ru(0,"EatenNothing"),0,new x];const y=co(w);if(m=new qr(n.PacPosition.ptx+y.modx,n.PacPosition.pty+y.mody),p=Gu(t,m),null!=h){const e=0|h[1],r=0|h[0],o=e*t.MazeTilesCountX+r|0;g=bu(t.MazePlayersRails[o],w)?p:n.PacPosition}else g=p;return[d[0],g,w,d[1],d[2]]}}var i,u,s,a,c}function Ou(e,t,n,r,o,i){let u;u=Cu(r.PacPosition);const s=function(r,i,s,a){if(function(e){const t=function(e){return e.fields[0]>0?1:0};return(0|t(e.ProbLeft))+(0|t(e.ProbUp))+(0|t(e.ProbRight))+(0|t(e.ProbDown))>1}(a)&&!d(function(e,t){switch(e.tag){case 1:return t.ProbUp;case 2:return t.ProbRight;case 3:return t.ProbDown;default:return t.ProbLeft}}(r,a),new wo(0,"DirectionProbability",0))){let l;return l=Eu(t.MazeTilesCountX,t.MazeTilesCountY,t.MazeTiles,n,r),Yr(l,u)?i:(c=e,f=l,qn((function(e){if(d(e.GhostState2.GhostTag,c.GhostState2.GhostTag))return!1;{let t;return t=Cu(e.GhostPosition),Yr(f,t)}}),o)?s(a):a)}return a;var c,f};return s(new uo(3,"FacingDown"),vo,To,s(new uo(2,"FacingRight"),So,bo,s(new uo(1,"FacingUp"),yo,Po,s(new uo(0,"FacingLeft"),mo,Mo,i))))}function Fu(e,t,n,r,o,i){let u;u=e.GhostState2.GhostFacingDirection;const s=Pu(e.GhostPosition);let a;if(null!=s){const i=0|s[1],f=0|s[0],l=i*t.MazeTilesCountX+f|0,h=t.MazeGhostRails[l];if(d(h,no))a=u;else{let s,l;s=function(e,t,n){let r;r=ao(e);const o=r|~~(t.fields[0]-1)<<2|0;return n.fields[0][o]}(u,h,e.GhostState2.GhostAITable);const w=new qr(f,i);let g,p;switch(p=e.GhostState2.GhostMode,p.tag){case 0:g=Ou(e,t,w,r,n,s);break;case 1:g=function(e,t,n,r){let o;o=Cu(n.PacPosition);const i=function(n,r){if(d(n,new wo(0,"DirectionProbability",0)))return n;{const i=Eu(e.MazeTilesCountX,e.MazeTilesCountY,e.MazeTiles,t,r);return Yr(o,i)?new wo(0,"DirectionProbability",0):n}};return new po(i(r.ProbLeft,new uo(0,"FacingLeft")),i(r.ProbUp,new uo(1,"FacingUp")),i(r.ProbRight,new uo(2,"FacingRight")),i(r.ProbDown,new uo(3,"FacingDown")))}(t,w,r,s);break;default:throw new Error("Should not be deciding direction for ghost in this state")}l=0==((c=g).ProbLeft.fields[0]|c.ProbUp.fields[0]|c.ProbDown.fields[0]|c.ProbRight.fields[0])?s:g;const m=function(e,t){const n=e.ProbLeft.fields[0],r=e.ProbUp.fields[0],o=e.ProbRight.fields[0],i=e.ProbDown.fields[0],u=n+r+o+i,s=t.fields[0]%u;if(0!==n&&s<n)return new uo(0,"FacingLeft");if(0!==r&&s<n+r)return new uo(1,"FacingUp");if(0!==i&&s<n+r+i)return new uo(3,"FacingDown");if(0!==o&&s<n+r+i+o)return new uo(2,"FacingRight");throw new Error("It should never be the case there are *no* exits from a decision point!")}(l,o);let y;y=so(m),a=m}}else a=u;var c;let f,l;if(null!=s){const e=0|s[1],n=0|s[0],r=e*t.MazeTilesCountX+n|0;l=d(t.MazeGhostRails[r],no)}else l=!1;if(l)f=e.GhostPosition;else{let n;const r=co(a);n=new qr(e.GhostPosition.ptx+r.modx,e.GhostPosition.pty+r.mody),f=Gu(t,n)}return[f,a]}function Lu(e){let t,n;var r,o,i,u;let s;return n=e.GhostState2.GhostBasePosition,r=n,o=e.GhostPosition,t=new Jr((i=r.ptx-o.ptx|0)>=1?1:i<=-1?-1:0,(u=r.pty-o.pty|0)>=1?1:u<=-1?-1:0),s=new qr(e.GhostPosition.ptx+t.modx,e.GhostPosition.pty+t.mody),[s,e.GhostState2.GhostFacingDirection]}function zu(e,t,n,r,o){let i=n;return An((function(n){return i=Vi(i),function(e,t,n,r,o,i){var u,s,a;const c=[r.GhostPosition,r.GhostState2.GhostFacingDirection];let f,l;switch(l=r.GhostState2.GhostMode,l.tag){case 1:f=Io(Math.fround(20),i)?Fu(r,e,t,n,o):[c[0],c[1]];break;case 2:f=Lu(r);break;case 3:f=[c[0],c[1]];break;default:f=Fu(r,e,t,n,o)}return new Qo((u=r.GhostState2.GhostTag,s=r.GhostState2.GhostBasePosition,a=r.GhostState2.GhostMode,new $o(u,s,f[1],a,r.GhostState2.GhostAITable)),f[0])}(e,o,t,n,i,r)}),o)}function Bu(e){var t,n;let r;return r=e.GhostState2.GhostBasePosition,new Qo((t=new Zo(0,"GhostNormal"),n=new uo(1,"FacingUp"),new $o(e.GhostState2.GhostTag,e.GhostState2.GhostBasePosition,n,t,e.GhostState2.GhostAITable)),r)}function Hu(e){const t=vu(e.ScoreAndHiScore.Score,e.ScoreAndHiScore.HiScore,e.LevelIndex,e.PacmanState.PacState2.LivesLeft);return new Su(e.Random,e.LevelIndex,e.ScoreAndHiScore,e.MazeState,function(e){var t;let n;return n=e.PacState2.PacStartPosition,new Vo((t=new uo(2,"FacingRight"),new Yo(new Xo(0,"PacAlive"),t,e.PacState2.LivesLeft-1,e.PacState2.PacStartPosition)),n)}(e.PacmanState),An(Bu,e.GhostsState),Mu(t),e.WhereToOnGameOver,e.WhereToOnAllEaten)}function Wu(e,t,n){var r,o,i;let u;switch(u=n.PacState2.PacMode,u.tag){case 1:{const e=new x;return[(r=t>=u.fields[0],i=new Xo(2,"PacDead"),o=function(e){return Nu(i,e)},r?o(n):n),e]}case 2:return[n,new x];default:{let r,o,i,u;r=Tu(n.PacPosition),s=r,i=qn((function(e){let t;switch(t=e.GhostState2.GhostMode,t.tag){case 1:case 3:case 2:return!1;default:{let t;return t=Tu(e.GhostPosition),Yr(s,t)}}}),e);const a=new Xo(1,"PacDyingUntil",t+Fo);return u=function(e){return Nu(a,e)},o=i?u(n):n,[o,1===o.PacState2.PacMode.tag?new x(new ar(0,"PlaySoundEffect",bi()[vr.fields[0]]),new x):new x]}}var s}function Uu(e,t){let n;n=Tu(e.PacPosition);const r=function(e,t){let n;switch(n=t.GhostState2.GhostMode,n.tag){case 2:case 3:return!1;case 1:{let n;return n=Tu(t.GhostPosition),Yr(e,n)}default:return!1}};let o;var i,u,s;i=function(e){return r(n,e)?500:0},u=t,o=kn((function(e,t){return s.Add(e,i(t))}),(s={GetZero:()=>0,Add:(e,t)=>e+t}).GetZero(),u);const a=o>0?new x(new ar(0,"PlaySoundEffect",bi()[Sr.fields[0]]),new x):new x;let c;const f=o>0;let l,h;const w=C(1,r,[n]);let d;const g=new Zo(2,"GhostReturningToBase");return d=function(e){return Iu(g,e)},h=function(e){return w(e)?d(e):e},l=function(e){return An(h,e)},c=f?l(t):t,[c,o,a]}function ju(e,t,n,r){const o=di(e),i=Au(t,o.MazeState,o.PacmanState);let u;var s,a,c;let f,l,h,w;var g;let m,y;s=i[1],a=i[2],c=o.PacmanState,u=d(a,c.PacState2.PacFacingDirection)?new Vo(c.PacState2,s):new Vo(new Yo(c.PacState2.PacMode,a,c.PacState2.LivesLeft,c.PacState2.PacStartPosition),s),f=function(e,t){var n,r;switch(e.tag){case 1:case 2:n=1,r=e.fields[0];break;default:n=0}switch(n){case 0:return t;case 1:return t.MazeTiles[r]=new lu(0,"MazeTile",0),t}}(i[0],o.MazeState),g=n,w=An((function(e){let t;var n,r;switch(t=e.GhostState2.GhostMode,t.tag){case 1:case 3:n=1,r=t.fields[0];break;case 2:n=2;break;default:n=0}switch(n){case 0:return e;case 1:{const t=g>=r;let n;const o=new Zo(0,"GhostNormal");return n=function(e){return Iu(o,e)},t?n(e):e}case 2:{let t;const n=new Zo(3,"GhostRegeneratingUntil",g+Ao);return t=function(e){return Iu(n,e)},d(e.GhostPosition,e.GhostState2.GhostBasePosition)?t(e):e}}}),o.GhostsState),h=function(e,t,n){switch(e.tag){case 1:return n;case 2:return An((function(e){let n;switch(n=e.GhostState2.GhostMode,n.tag){case 1:return Iu(new Zo(1,"GhostEdibleUntil",t+ko),e);case 2:case 3:return e;default:return Iu(new Zo(1,"GhostEdibleUntil",t+ko),e)}}),n);default:return n}}(i[0],n,w),l=zu(f,u,o.Random,n,h),m=Wu(l,n,u),y=Uu(m[0],l);const S=i[3]+y[1];let v,P,T;v=function(e,t){if(0!==e){const n=t.Score+e;return new Br(n,M(p,n,t.HiScore))}return t}(S,o.ScoreAndHiScore),P=function(e,t,n){var r;if(t>0){const o=0|~~((e.Score-t)/1e4);if((0|~~(e.Score/1e4))>o){return[new Vo((r=n.PacState2.LivesLeft+1,new Yo(n.PacState2.PacMode,n.PacState2.PacFacingDirection,r,n.PacState2.PacStartPosition)),n.PacPosition),new x(new ar(0,"PlaySoundEffect",bi()[Pr.fields[0]]),new x)]}return[n,new x]}return[n,new x]}(v,S,m[0]);const C=vu(v.Score,v.HiScore,o.LevelIndex,P[0].PacState2.LivesLeft);T=d(C,o.MemoizedStatusPanelStrings.MostRecentStatusPanel)?o.MemoizedStatusPanelStrings:Mu(C);const N=new Su(Vi(o.Random),o.LevelIndex,v,f,P[0],y[0],T,o.WhereToOnGameOver,o.WhereToOnAllEaten);if(2===P[0].PacState2.PacMode.tag)return P[0].PacState2.LivesLeft<=1?N.WhereToOnGameOver(v,n):function(e,t){const n=Hi(Mi()[fr.fields[0]],Pi()[cr.fields[0]],"LIFE OVER",320,256);let r;return r=_i(e),Ki(Bo,t,b(2,r),n)}((function(t){return fu((function(t){let n;n=Hu(N);const r=pi(e);return wi(n,b(3,gi(e)),b(4,r),new x)}),uu(),zo,t)}),n);if(f.MazeTiles.some((function(e){return 18===(t=e).fields[0]||17===t.fields[0];var t}))){const t=(I=[i[4],m[1],y[2],P[1]],xn(dt((function(e,t){return kn((function(e,t){return new x(t,e)}),e,t)}),new x,I))),n=pi(e),r=gi(e);return wi(N,b(3,r),b(4,n),t)}{const t=new Eo(N.ScoreAndHiScore,N.PacmanState.PacState2.LivesLeft);let r;return r=qi(Ho,n,(function(e,n){return N.WhereToOnAllEaten(N.LevelIndex,t,n)}),e),vi(new x(new ar(0,"PlaySoundEffect",bi()[Mr.fields[0]]),new x),r)}var I}function _u(e,t,n,r){var o;let i;i=function(e){const t=function(e,t){if(null==t)throw new Error(e);return $(t)},n=t("Failed to unpack walls from maze definition, please check text format input.",io((function(e){return"#"===e||":"===e}),(function(e){return new lu(0,"MazeTile",e.fields[0])}),new lu(0,"MazeTile",0),e)),r=t("Failed to unpack rails from maze definition, please check text format input.",io((function(e){return"#"!==e}),(function(e){return e}),Zr,e)),o=t("Failed to unpack rails from maze definition, please check text format input.",io((function(e){return"#"!==e&&":"!==e}),(function(e){return e}),Zr,e)),i=t("Failed to obtains the dots and pills from maze definition, please check text format input.",ro((function(t,r){if(t*r===n.length){const r=Nn(new Array(n.length),0,n.length,new lu(0,"MazeTile",0));return Ln((function(e,o){for(let i=0;i<=t-1;i++){const u=e*t+i|0,s=n[u];let a;if(0!==s.fields[0])a=s.fields[0]+0;else{const e=o[i];a="."===e?17:"@"===e?18:0}r[u]=new lu(0,"MazeTile",a)}}),e),r}return null}),e)),u=function(e,t){switch(t.tag){case 1:throw new Error(kt(Et("Could not find char '%s' in the maze definition."))(e));case 3:throw new Error(kt(Et("Char '%s' is not unique in the maze definition."))(e));case 2:return new qr(16*t.fields[0],16*t.fields[1]);default:throw new Error("Invalid maze definition")}};let s;s=An((function(t){const n=String.fromCharCode(48+t);return u(n,pu(n,e))}),Dn(yt(1,1,4)));const a=u("0",("0",pu("0",e)));return new du(new hu(jn(0,e).length,Rn(e),i,r,o),a,s)}(wu[e%(0|wu.length)]);const u=[new fo("Charger",100,1,100,0,80,20,1,50,1,80,10,1),new fo("Standard",95,5,99,0,70,20,10,45,10,30,30,10),new fo("Ditherer",60,40,95,0,30,30,30,30,30,20,20,20)],s=[u[1],u[2],u[1],u[0]];let a;const c=new Yi(0,"XorShift32State",208947);return a=new Su(c,e,r.ScoreAndHiScore,i.UnpackedMazeState,new Vo((o=new uo(2,"FacingRight"),new Yo(new Xo(0,"PacAlive"),o,r.Lives,i.UnpackedPacmanPosition)),i.UnpackedPacmanPosition),On((function(e,t){var n,r;const o=s[e%s.length];return new Qo((n=new Jo(0,"GhostNumber",e),r=new Zo(0,"GhostNormal"),new $o(n,t,new uo(1,"FacingUp"),r,function(e){let t,n;return n=An((function(t){return new po(go(e,t.PCLeft),go(e,t.PCUp),go(e,t.PCRight),go(e,t.PCDown))}),zn([new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(0,"Never"),new lo(2,"OnlyWay")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(0,"Never"),new lo(2,"OnlyWay")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(0,"Never"),new lo(2,"OnlyWay")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(0,"Never"),new lo(2,"OnlyWay")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(2,"OnlyWay"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(2,"OnlyWay"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(2,"OnlyWay"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(2,"OnlyWay"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(4,"Back90"),new lo(3,"Turn90")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(3,"Turn90"),new lo(4,"Back90")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(1,"Correct"),new lo(1,"Correct")),new ho(new lo(0,"Never"),new lo(0,"Never"),new lo(1,"Correct"),new lo(1,"Correct")),new ho(new lo(0,"Never"),new lo(2,"OnlyWay"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(2,"OnlyWay"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(2,"OnlyWay"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(2,"OnlyWay"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(1,"Correct"),new lo(0,"Never"),new lo(1,"Correct")),new ho(new lo(0,"Never"),new lo(5,"Onward180"),new lo(0,"Never"),new lo(6,"Back180")),new ho(new lo(0,"Never"),new lo(1,"Correct"),new lo(0,"Never"),new lo(1,"Correct")),new ho(new lo(0,"Never"),new lo(6,"Back180"),new lo(0,"Never"),new lo(5,"Onward180")),new ho(new lo(0,"Never"),new lo(3,"Turn90"),new lo(4,"Back90"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(1,"Correct"),new lo(1,"Correct"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(1,"Correct"),new lo(1,"Correct"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(4,"Back90"),new lo(3,"Turn90"),new lo(0,"Never")),new ho(new lo(0,"Never"),new lo(10,"TurnIntoT"),new lo(11,"TurnBackT"),new lo(10,"TurnIntoT")),new ho(new lo(0,"Never"),new lo(7,"OnwardT"),new lo(8,"TurnAwayT"),new lo(9,"BackT")),new ho(new lo(0,"Never"),new lo(1,"Correct"),new lo(1,"Correct"),new lo(1,"Correct")),new ho(new lo(0,"Never"),new lo(9,"BackT"),new lo(8,"TurnAwayT"),new lo(7,"OnwardT")),new ho(new lo(2,"OnlyWay"),new lo(0,"Never"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(2,"OnlyWay"),new lo(0,"Never"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(2,"OnlyWay"),new lo(0,"Never"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(2,"OnlyWay"),new lo(0,"Never"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(1,"Correct"),new lo(0,"Never"),new lo(0,"Never"),new lo(1,"Correct")),new ho(new lo(3,"Turn90"),new lo(0,"Never"),new lo(0,"Never"),new lo(4,"Back90")),new ho(new lo(4,"Back90"),new lo(0,"Never"),new lo(0,"Never"),new lo(3,"Turn90")),new ho(new lo(1,"Correct"),new lo(0,"Never"),new lo(0,"Never"),new lo(1,"Correct")),new ho(new lo(5,"Onward180"),new lo(0,"Never"),new lo(6,"Back180"),new lo(0,"Never")),new ho(new lo(1,"Correct"),new lo(0,"Never"),new lo(1,"Correct"),new lo(0,"Never")),new ho(new lo(6,"Back180"),new lo(0,"Never"),new lo(5,"Onward180"),new lo(0,"Never")),new ho(new lo(1,"Correct"),new lo(0,"Never"),new lo(1,"Correct"),new lo(0,"Never")),new ho(new lo(7,"OnwardT"),new lo(0,"Never"),new lo(9,"BackT"),new lo(8,"TurnAwayT")),new ho(new lo(10,"TurnIntoT"),new lo(0,"Never"),new lo(10,"TurnIntoT"),new lo(11,"TurnBackT")),new ho(new lo(9,"BackT"),new lo(0,"Never"),new lo(7,"OnwardT"),new lo(8,"TurnAwayT")),new ho(new lo(1,"Correct"),new lo(0,"Never"),new lo(1,"Correct"),new lo(1,"Correct")),new ho(new lo(1,"Correct"),new lo(1,"Correct"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(1,"Correct"),new lo(1,"Correct"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(4,"Back90"),new lo(3,"Turn90"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(3,"Turn90"),new lo(4,"Back90"),new lo(0,"Never"),new lo(0,"Never")),new ho(new lo(1,"Correct"),new lo(1,"Correct"),new lo(0,"Never"),new lo(1,"Correct")),new ho(new lo(8,"TurnAwayT"),new lo(7,"OnwardT"),new lo(0,"Never"),new lo(9,"BackT")),new ho(new lo(11,"TurnBackT"),new lo(10,"TurnIntoT"),new lo(0,"Never"),new lo(10,"TurnIntoT")),new ho(new lo(8,"TurnAwayT"),new lo(9,"BackT"),new lo(0,"Never"),new lo(7,"OnwardT")),new ho(new lo(7,"OnwardT"),new lo(8,"TurnAwayT"),new lo(9,"BackT"),new lo(0,"Never")),new ho(new lo(1,"Correct"),new lo(1,"Correct"),new lo(1,"Correct"),new lo(0,"Never")),new ho(new lo(9,"BackT"),new lo(8,"TurnAwayT"),new lo(7,"OnwardT"),new lo(0,"Never")),new ho(new lo(10,"TurnIntoT"),new lo(11,"TurnBackT"),new lo(10,"TurnIntoT"),new lo(0,"Never")),new ho(new lo(12,"Onward4"),new lo(13,"Turn4"),new lo(13,"Turn4"),new lo(14,"Back4")),new ho(new lo(13,"Turn4"),new lo(12,"Onward4"),new lo(13,"Turn4"),new lo(14,"Back4")),new ho(new lo(14,"Back4"),new lo(13,"Turn4"),new lo(12,"Onward4"),new lo(13,"Turn4")),new ho(new lo(13,"Turn4"),new lo(14,"Back4"),new lo(13,"Turn4"),new lo(12,"Onward4"))])),t=Gn(n,Array),new Co(0,"GhostAI",t)}(o))),t)}),i.UnpackedGhostPositions),Mu(vu(r.ScoreAndHiScore.Score,r.ScoreAndHiScore.HiScore,e,r.Lives)),n,t),wi(a,Du,ju,new x)}const Ku=G((function(e,t,n,r,o,i,u,s){this.Scoreboard=e,this.ScoreboardMemo=t,this.PacLeftMemo=n,this.PacRightMemo=r,this.Ghost0Memo=o,this.Ghost1Memo=i,this.Ghost2Memo=u,this.Ghost3Memo=s}),F);function qu(e,t,n){let r,o,i,u,s,a;r=Mi()[hr.fields[0]],Ti(e,0,0,r),o=Mi()[lr.fields[0]],i=160,u=51,s=128,a=192;const c=function(t){ui(e,o,n,t)},f=function(t){si(e,o,n,t)};c(t.PacRightMemo),c(t.PacLeftMemo),f(t.Ghost0Memo),f(t.Ghost1Memo),f(t.Ghost2Memo),f(t.Ghost3Memo),Ii(e,cr,new nr(1,"CentreAlign"),new rr(1,"MiddleAlign"),160,51,"PAC MAN"),Gi(e,cr,new nr(1,"CentreAlign"),new rr(1,"MiddleAlign"),160,128,16,t.ScoreboardMemo),Ii(e,cr,new nr(1,"CentreAlign"),new rr(1,"MiddleAlign"),160,192,"USE CURSOR KEYS ... Z TO START")}const Ju=G((function(e,t){this.GuestState=e,this.StateSwitchChooser=t}),F);function Xu(e,t,n){t.GuestState.Draw(e,n)}function Yu(e,t,n,r){const o=di(e),i=o.StateSwitchChooser(n,t);if(null==i){const i=new Ju(o.GuestState.Frame(t,n,r),o.StateSwitchChooser),u=pi(e);return wi(i,b(3,gi(e)),b(4,u),new x)}return i}function Vu(e,t){return wi(new Ju(t,e),Xu,Yu,t.Sounds())}let Zu=new x;function $u(e,t,n){var r;return function(e,t,n){const r=Hi(Mi()[fr.fields[0]],Pi()[cr.fields[0]],kt(Et("SCREEN COMPLETE  SCORE %d"))(e.ScoreAndHiScore.Score),320,256);let o;return o=_i(t),Ki(Wo,n,b(2,o),r)}(t,(r=e+1|0,function(e){return es(r,t,e)}),n)}function Qu(e,t){let n;const r=wi(new Ji(o=e,"SCORE   "+o.Score.toString(),"HI SCORE   "+o.HiScore.toString(),ai(new uo(2,"FacingRight"),20,50),ai(new uo(0,"FacingLeft"),80,50),ci(new Jo(0,"GhostNumber",0),20,75),ci(new Jo(0,"GhostNumber",1),40,75),ci(new Jo(0,"GhostNumber",2),60,75),ci(new Jo(0,"GhostNumber",3),80,75)),Xi,Si,new x);var o;return n=qi(Uo,t,(function(t,n){return iu(t,function(e,t){return Li(e,Zu,(function(e,t){return Zu=e,ts(t)}),t)}(e,n),new eu(2,"ComingFromLeft"),320,256,(function(e,t){let n;let r,o,i;var u;return n=e/t,i=(u=n)*u,o=t*i,r=o,r}),Math.fround(1),n)}),r),vi(new x(new ar(0,"PlaySoundEffect",bi()[mr.fields[0]]),new x),n)}function es(e,t,n){return fu((function(n){return _u(e,$u,Qu,t)}),uu(),zo,n)}function ts(e){const t=new Eo(new Br(0,Or(Zu)),3),n=wi(new Ku(r=Zu,zr(24,r),ai(new uo(2,"FacingRight"),20,20),ai(new uo(0,"FacingLeft"),80,20),ci(new Jo(0,"GhostNumber",0),20,90),ci(new Jo(0,"GhostNumber",1),40,90),ci(new Jo(0,"GhostNumber",2),60,90),ci(new Jo(0,"GhostNumber",3),80,90)),qu,Si,new x);var r;return function(e,t,n){return Vu((function(n,r){return r(t).JustDown?e(n):null}),n)}((function(e){return es(0,t,e)}),Ri,n)}function ns(e,t){return Zu=function(e,t,n){let r;return r=On((function(e,r){const o=t+(e>>>0)*n;return new Rr(r,o,o.toString())}),e),Jn(Ar,r,{Compare:p})}(zn(["VINNY","HELEN","JARVIS","JULIA"]),2500,2500),ts()}const rs=new J(0,"WebBrowserKeyCode",80),os=G((function(e,t,n,r,o){this.WebBrowserKeyCode=e,this.ThisKeyScanCode=t,this.MutHeld=n,this.MutJustPressed=r,this.MutWaitingRelease=o}),F);function is(e,t){return new os(e,t,!1,!1,!1)}function us(e){return new X(e.MutJustPressed,e.MutHeld)}const ss=G((function(e,t,n){this.MutableKeyStatesList=e,this.PauseKey=t,this.GameIsPaused=n}),F);function as(e,t){let n;if(n=Wn((function(e){return d(e.ThisKeyScanCode,t)}),e.MutableKeyStatesList),null==n)return d(t,e.PauseKey.ThisKeyScanCode)?e.PauseKey:null;return n}function cs(e,t){const n=as(e,t);if(null!=n){const t=n;return t.MutWaitingRelease||(d(t.ThisKeyScanCode,e.PauseKey.ThisKeyScanCode)&&((r=e).GameIsPaused=!r.GameIsPaused),t.MutHeld=!0,t.MutJustPressed=!0,t.MutWaitingRelease=!0),!0}return!1;var r}function fs(e,t){const n=as(e,t);if(null!=n){const e=n;return e.MutHeld=!1,e.MutWaitingRelease=!1,!0}return!1}G((function(e,t){this.Fonts=e,this.Images=t}),F);function ls(e,t,n,r,o,i){const u=[];!function i(s){if(null!=s.tail){const o=e(s.head),a=0|t(s.head),c=0|r(s.head),f=0|n(s.head);loadImageThenDo(o,!0,(function(e){In(function(e,t){const n=0|e.ImageMetadata.ImageHeight;return new tr(e,1,1,t,n,t,n)}(new $n(new Yn(o,new Xn(1,"MagentaColourKeyImage"),a,c),new Zn(0,"HostImageRef",IFsharpImageToTexture(e))),f),u),i(s.tail)}))}else o(u.slice())}(i)}function hs(e,t,n,r,o){InitialiseWebGl2Interface(e.RetroScreenWidth,e.RetroScreenHeight,e.RetroScreenTitle),ls((function(e){return e.FontImageMetadata.ImageFileName}),(function(e){return e.FontImageMetadata.ImageWidth}),(function(e){return e.FontCharWidth}),(function(e){return e.FontImageMetadata.ImageHeight}),(function(e){!function(e,t,n,r,o,i){const u=[];!function i(s){if(null!=s.tail){const o=e(s.head),a=t(s.head),c=0|n(s.head),f=0|r(s.head);loadImageThenDo(o,a,(function(e){In(new $n(new Yn(o,a?new Xn(1,"MagentaColourKeyImage"):new Xn(0,"OpaqueImage"),c,f),new Zn(0,"HostImageRef",IFsharpImageToTexture(e))),u),i(s.tail)}))}else o(u.slice())}(i)}((function(e){return e.ImageFileName}),(function(e){return 1===e.ImageTransparency.tag}),(function(e){return e.ImageWidth}),(function(e){return e.ImageHeight}),(function(t){!function(e,t,n){const r=[];!function n(o){if(null!=o.tail){const t=e(o.head);loadSoundThenDo(t,(function(e){In(new sr(new or(t),new ur(0,"HostSoundRef",e)),r),n(o.tail)}))}else t(r.slice())}(n)}((function(e){return e.SoundFileName}),(function(n){o(t,e,n)}),r)}),t)}),n)}function ws(e){switch(e.tag){case 2:{let t,n,r,o,i,u,s,a;t=e.fields[2].ImageMetadata.ImageWidth,n=e.fields[2].ImageMetadata.ImageHeight,r=e.fields[2].ImageMetadata.ImageWidth,o=e.fields[2].ImageMetadata.ImageHeight,i=~~(e.fields[0]+Math.fround(.5)),u=~~(e.fields[1]+Math.fround(.5)),s=e.fields[3],a=e.fields[4],r>0&&o>0&&s>0&&a>0&&IFsharpDrawImagePortion(e.fields[2].HostImageRef.fields[0],t,n,0,0,r,o,i,u,s,a);break}case 3:{let t,n,r,o,i,u;t=e.fields[8].ImageMetadata.ImageWidth,n=e.fields[8].ImageMetadata.ImageHeight,r=~~(e.fields[4]+Math.fround(.5)),o=~~(e.fields[5]+Math.fround(.5)),i=e.fields[6],u=e.fields[7],e.fields[2]>0&&e.fields[3]>0&&i>0&&u>0&&IFsharpDrawImagePortion(e.fields[8].HostImageRef.fields[0],t,n,e.fields[0],e.fields[1],e.fields[2],e.fields[3],r,o,i,u);break}case 1:{let u,s,a,c;u=e.fields[2],s=e.fields[3],a=e.fields[0],c=e.fields[1],t=a,n=c,r=u,o=s,i=e.fields[4].fields[0],IFsharpDrawRectangle(t,n,r,o,((16711680&i)>>>0>>>16)/256,((65280&i)>>>0>>>8)/256,((255&i)>>>0)/256);break}default:{let t,n,r,o;t=e.fields[2].ImageMetadata.ImageWidth,n=e.fields[2].ImageMetadata.ImageHeight,r=e.fields[0],o=e.fields[1],IFsharpDrawImageOneToOne(e.fields[2].HostImageRef.fields[0],t,n,r,o)}}var t,n,r,o,i}function ds(e,t,n,r,o,i){var u,s;let a;u=o,s=i,Mi(r),Pi(u),bi(s);const c=t();if(0!==c.tag)throw new Error(c.fields[0]);a=c.fields[0];const f=Math.fround(0),l=Math.fround(.019999999552965164);let h=n(a,f);const w=(g=80,p=An((function(e){return[e.fields[0],new J(0,"WebBrowserKeyCode",e.fields[0])]}),e),new ss(An((function(e){return is(e[1],e[0])}),p),is(rs,g),!1));var g,p;const m=function(e,t){document.addEventListener(e,(function(e){t(w,~~e.keyCode)&&e.preventDefault()}))};m("keydown",cs),m("keyup",fs),document.getElementById("loaderScreen").classList.add("hidden"),document.getElementById("gameScreen").classList.remove("hidden");let y=0;window.setInterval((function(){let e;let t;var n;y+=1,e=y/Math.fround(50),h.Draw(ws,e),t=h.Frame((function(e){return function(e,t){let n;return n=Wn((function(e){return d(e.WebBrowserKeyCode,t)}),e.MutableKeyStatesList),null==n?d(t,e.PauseKey.WebBrowserKeyCode)?us(e.PauseKey):Y:us(n)}(w,e)}),e,l),Fn((function(e){var t;t=e.fields[0].HostSoundRef,playSound(t.fields[0])}),t.Sounds()),qn((function(e){return e.MutJustPressed}),(n=w).MutableKeyStatesList)&&Fn((function(e){e.MutJustPressed=!1}),n.MutableKeyStatesList),h=t}),20,null)}function gs(){const e=zn([new J(0,"WebBrowserKeyCode",37),new J(0,"WebBrowserKeyCode",39),new J(0,"WebBrowserKeyCode",38),new J(0,"WebBrowserKeyCode",40),new J(0,"WebBrowserKeyCode",90)]);hs(new br("Pac Man",320,256),kr,Cr,xr,(function(t,n,r){ds(e,(function(){return new Q(0,"Ok",1)}),ns,t,n,r)}))}gs(),n.d(t,"WebMain",(function(){return gs}))}]);