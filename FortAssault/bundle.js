!function(n){var e={};function t(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return n[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var i in n)t.d(r,i,function(e){return n[e]}.bind(null,i));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=0)}([function(n,e,t){"use strict";function r(n){return null!=n&&(Array.isArray(n)||ArrayBuffer.isView(n))}function i(n){return null!=n&&"function"==typeof n.Dispose}t.r(e);function o(n,e,t){return n.has(e)?[!0,n.get(e)]:[!1,t]}function a(n,e){return!e.has(n)&&(e.add(n),!0)}function u(n,e){let t=n.toString(10);for(;t.length<e;)t="0"+t;return t}function s(n){const e=n;return"number"==typeof e.offset?e.offset:1===n.kind?0:-6e4*n.getTimezoneOffset()}class l{static id(n){return l.idMap.has(n)||l.idMap.set(n,++l.count),l.idMap.get(n)}}function c(n){let e=0,t=5381;const r=n.length;for(;e<r;)t=33*t^n.charCodeAt(e++);return t}function f(n){return 2654435761*n|0}function h(n){return 0===n.length?0:n.reduce((n,e)=>(n<<5)+n^e)}function d(n){if(null==n)return 0;switch(typeof n){case"boolean":return n?1:0;case"number":return f(n);case"string":return c(n);default:if(function(n){return null!=n&&"function"==typeof n.GetHashCode}(n))return n.GetHashCode();if(r(n)){const e=n.length,t=new Array(e);for(let r=0;r<e;r++)t[r]=d(n[r]);return h(t)}return c(String(n))}}function g(n,e,t){if(null==n)return null==e;if(null==e)return!1;if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function w(n,e){return g(n,e,p)}function p(n,e){return n===e||(null==n?null==e:null!=e&&("object"==typeof n&&(function(n){return null!=n&&"function"==typeof n.Equals}(n)?n.Equals(e):r(n)?r(e)&&w(n,e):n instanceof Date&&(e instanceof Date&&0===S(n,e)))))}function S(n,e){let t,r;return"offset"in n&&"offset"in e?(t=n.getTime(),r=e.getTime()):(t=n.getTime()+s(n),r=e.getTime()+s(e)),t===r?0:t<r?-1:1}function m(n,e){return n===e?0:n<e?-1:1}function M(n,e,t){if(null==n)return null==e?0:1;if(null==e)return-1;if(n.length!==e.length)return n.length<e.length?-1:1;for(let r=0,i=0;r<n.length;r++)if(i=t(n[r],e[r]),0!==i)return i;return 0}function y(n,e){return M(n,e,T)}function T(n,e){return n===e?0:null==n?null==e?0:-1:null==e?1:"object"!=typeof n?n<e?-1:1:function(n){return null!=n&&"function"==typeof n.CompareTo}(n)?n.CompareTo(e):r(n)&&r(e)?y(n,e):n instanceof Date&&e instanceof Date?S(n,e):1}function I(n,e,t){return n(e,t)<0?e:t}function C(n,e,t){return n(e,t)>0?e:t}function A(n){let e=n;return n=>void 0===n?e:void(e=n)}l.idMap=new WeakMap,l.count=0;function k(n,e,t){if(null==e)return null;if("__CURRIED__"in e){e=e.__CURRIED__;for(let n=0;n<t.length;n++)e=e(t[n]);return e}switch(n){case 1:return n=>e.apply(null,t.concat([n]));case 2:return n=>r=>e.apply(null,t.concat([n,r]));case 3:return n=>r=>i=>e.apply(null,t.concat([n,r,i]));case 4:return n=>r=>i=>o=>e.apply(null,t.concat([n,r,i,o]));case 5:return n=>r=>i=>o=>a=>e.apply(null,t.concat([n,r,i,o,a]));case 6:return n=>r=>i=>o=>a=>u=>e.apply(null,t.concat([n,r,i,o,a,u]));case 7:return n=>r=>i=>o=>a=>u=>s=>e.apply(null,t.concat([n,r,i,o,a,u,s]));case 8:return n=>r=>i=>o=>a=>u=>s=>l=>e.apply(null,t.concat([n,r,i,o,a,u,s,l]));default:throw new Error("Partially applying to more than 8-arity is not supported: "+n)}}function E(n,e){if(n.has(e))return n.get(e);throw new Error(`The given key '${e}' was not present in the dictionary.`)}function W(n,e){return null!=e&&Object.getPrototypeOf(n).constructor===Object.getPrototypeOf(e).constructor}function v(n,e){return function(n,e){n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}(n,e||b),n}function b(){}function D(n,e){if(n===e)return 0;if(null==e)return-1;for(;null!=n.tail;){if(null==e.tail)return 1;const t=T(n.head,e.head);if(0!==t)return t;n=n.tail,e=e.tail}return null==e.tail?0:-1}function P(n,e){this.head=n,this.tail=e}function B(n,e,...t){this.tag=0|n,this.name=e,this.fields=t}function H(n,e){const t={},r=null==e?Object.keys(n):e(n);for(let e=0;e<r.length;e++)t[r[e]]=n[r[e]];return t}function x(n,e,t){if(n===e)return!0;if(W(n,e)){const r=null==t?Object.keys(n):t(n);for(let t=0;t<r.length;t++)if(!p(n[r[t]],e[r[t]]))return!1;return!0}return!1}function X(n,e,t){if(n===e)return 0;if(W(n,e)){const r=null==t?Object.keys(n):t(n);for(let t=0;t<r.length;t++){const i=T(n[r[t]],e[r[t]]);if(0!==i)return i}return 0}return-1}function F(){}b.prototype.toString=function(){return"{"+Object.keys(this).map(n=>n+" = "+String(this[n])).join(";\n ")+"}"},b.prototype.GetHashCode=function(){return function(n){if(null==n)return 0;switch(typeof n){case"boolean":return n?1:0;case"number":return f(n);case"string":return c(n);default:return f(l.id(n))}}(this)},b.prototype.Equals=function(n){return this===n},P.prototype.toString=function(){return"["+Array.from(this).map(n=>String(n)).join("; ")+"]"},P.prototype.toJSON=function(){return Array.from(this)},P.prototype[Symbol.iterator]=function(){let n=this;return{next:()=>{const e=n;return n=n.tail,{done:null==e.tail,value:e.head}}}},P.prototype.GetHashCode=function(){return h(Array.from(this).map(d))},P.prototype.Equals=function(n){return 0===D(this,n)},P.prototype.CompareTo=function(n){return D(this,n)},B.prototype.toString=function(){const n=this.fields.length;return 0===n?this.name:1===n?this.name+" "+String(this.fields[0]):this.name+" ("+this.fields.map(n=>String(n)).join(",")+")"},B.prototype.toJSON=function(){return 0===this.fields.length?this.name:[this.name].concat(this.fields)},B.prototype.GetHashCode=function(){const n=this.fields.map(n=>d(n));return n.splice(0,0,f(this.tag)),h(n)},B.prototype.Equals=function(n){return this===n||W(this,n)&&this.tag===n.tag&&w(this.fields,n.fields)},B.prototype.CompareTo=function(n){return this===n?0:W(this,n)?this.tag===n.tag?y(this.fields,n.fields):this.tag<n.tag?-1:1:-1},F.prototype.toString=function(){return"{"+Object.keys(this).map(n=>n+" = "+String(this[n])).join(";\n ")+"}"},F.prototype.toJSON=function(){return H(this)},F.prototype.GetHashCode=function(){return h(Object.keys(this).map(n=>d(this[n])))},F.prototype.Equals=function(n){return x(this,n)},F.prototype.CompareTo=function(n){return X(this,n)};const G=v((function(n){this.contents=n}),F),O=v((function(n){this.stack=Error().stack,this.message=n}),b);function L(n){return Object.keys(n).filter(n=>"message"!==n&&"stack"!==n)}const R=v((function(){O.call(this)}),O);R.prototype.toString=function(){const n=L(this),e=n.length;return 0===e?this.message:1===e?this.message+" "+String(this[n[0]]):this.message+" ("+n.map(n=>String(this[n])).join(",")+")"},R.prototype.toJSON=function(){return H(this,L)},R.prototype.GetHashCode=function(){return h(L(this).map(n=>d(this[n])))},R.prototype.Equals=function(n){return x(this,n,L)},R.prototype.CompareTo=function(n){return X(this,n,L)};v((function(n,e,t){this.arg1=n,this.arg2=0|e,this.arg3=0|t,this.message="The match cases were incomplete"}),R),v((function(){}),b);class K{constructor(n,e,t,r){this.declaringType=n,this.tag=e,this.name=t,this.fields=r}}class N{constructor(n,e,t,r,i,o){this.fullname=n,this.generics=e,this.constructor=t,this.fields=r,this.cases=i,this.enumCases=o}toString(){return function n(e){const t=null==e.generics||$(e)?[]:e.generics;return t.length>0?e.fullname+"["+t.map(e=>n(e)).join(",")+"]":e.fullname}(this)}Equals(n){return U(this,n)}CompareTo(n){return V(this,n)}}function j(n){return null!=n.generics?n.generics:[]}function U(n,e){return""===n.fullname?""===e.fullname&&g(Q(n),Q(e),([n,e],[t,r])=>n===t&&U(e,r)):n.fullname===e.fullname&&g(j(n),j(e),U)}function V(n,e){return n.fullname!==e.fullname?n.fullname<e.fullname?-1:1:M(j(n),j(e),V)}function z(n,e,t,r){return new N(n,e,t,r)}function J(n,e,t,r){const i=new N(n,e,t,void 0,()=>r().map((n,e)=>"string"==typeof n?new K(i,e,n):new K(i,e,n[0],n[1])));return i}function _(n){return new N(n.fullname+"[]",[n])}const Y=new N("System.Object"),q=(new N("Microsoft.FSharp.Core.Unit"),new N("System.Char"),new N("System.String")),Z=(new N("System.Boolean"),new N("System.SByte"),new N("System.Byte"),new N("System.Int16"),new N("System.UInt16"),new N("System.Int32"));new N("System.UInt32"),new N("System.Single"),new N("System.Double"),new N("System.Decimal");function $(n){return n.fullname.endsWith("[]")}function Q(n){if(null!=n.fields)return n.fields();throw new Error(`${n.fullname} is not an F# record type`)}const nn=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const en=v((function(n,e,t,r){this.ImageFileName=n,this.ImageColourKey=e,this.ImageWidth=t,this.ImageHeight=r}),F);const tn=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const rn=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const on=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const an=v((function(n,e){this.EngineImageMetadata=n,this.HostImageObject=e}),F);function un(){return z("ResourceFileMetadata.ImageWithHostObject",[],an,()=>[["EngineImageMetadata",z("ResourceFileMetadata.EngineImageMetadata",[],en,()=>[["ImageFileName",q],["ImageColourKey",J("ResourceFileMetadata.ImageColourKey",[],nn,()=>["NoColourKey","MagentaColourKey"])],["ImageWidth",Z],["ImageHeight",Z]])],["HostImageObject",J("ResourceFileMetadata.HostImageObject",[],on,()=>[["HostImageObject",[Y]]])]])}const sn=v((function(n,e,t){this.FontImageWithHostObject=n,this.CharWidth=0|e,this.CharHeight=0|t}),F);class ln{constructor(n){this.value=n}toString(){return String(this.value)}toJSON(){return this.value}GetHashCode(){return d(this.value)}Equals(n){return null!=n&&p(this.value,n instanceof ln?n.value:n)}CompareTo(n){return null==n?1:T(this.value,n instanceof ln?n.value:n)}}function cn(n){return null==(n=void 0===n?null:n)||n instanceof ln?new ln(n):n}function fn(n,e){if(null==n){if(!e)throw new Error("Option has no value");return null}return n instanceof ln?n.value:n}function hn(n,e,t){return null!=n?null!=t?t(fn(n)):fn(n):e}v((function(n,e,t){B.call(this,n,e,t)}),B);const dn=v((function(n,e,t){B.call(this,n,e,t)}),B);function gn(n,e){return 1===e.tag?(t=n(e.fields[0]),new dn(1,"Error",t)):e;var t}var wn={GetHashCode(){return h([this.s,this.e].concat(this.c))},Equals(n){return!this.cmp(n)},CompareTo(n){return this.cmp(n)}},pn="[big.js] ",Sn=pn+"Invalid ",mn=Sn+"decimal places",Mn=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function yn(n,e){var t,r,i;if(0===e&&1/e<0)e="-0";else if(!Mn.test(e+=""))throw Error(Sn+"number");for(n.s="-"==e.charAt(0)?(e=e.slice(1),-1):1,(t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),i=e.length,r=0;r<t&&r<i&&"0"==e.charAt(r);)++r;if(r==i)n.c=[n.e=0];else for(n.e=t-r-1,n.c=[],t=0;r<i;)n.c[t++]=+e.charAt(r++);return n=Tn(n,Cn.DP,Cn.RM)}function Tn(n,e,t,r){var i=n.c,o=n.e+e+1;if(o<i.length){if(1===t)r=i[o]>=5;else if(2===t)r=i[o]>5||5==i[o]&&(r||o<0||void 0!==i[o+1]||1&i[o-1]);else if(3===t)r=r||!!i[0];else if(r=!1,0!==t)throw Error("[big.js] Invalid rounding mode");if(o<1)i.length=1,r?(n.e=-e,i[0]=1):i[0]=n.e=0;else{if(i.length=o--,r)for(;++i[o]>9;)i[o]=0,o--||(++n.e,i.unshift(1));for(o=i.length;!i[--o];)i.pop()}}else if(t<0||t>3||t!==~~t)throw Error("[big.js] Invalid rounding mode");return n}function In(n,e,t,r){var i,o,a=n.constructor,u=!n.c[0];if(void 0!==t){if(t!==~~t||t<(3==e)||t>1e6)throw Error(3==e?Sn+"precision":mn);for(t=r-(n=new a(n)).e,n.c.length>++r&&Tn(n,t,a.RM),2==e&&(r=n.e+t+1);n.c.length<r;)n.c.push(0)}if(i=n.e,t=(o=n.c.join("")).length,2!=e&&(1==e||3==e&&r<=i||i<=a.NE||i>=a.PE))o=o.charAt(0)+(t>1?"."+o.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)o="0"+o;o="0."+o}else if(i>0)if(++i>t)for(i-=t;i--;)o+="0";else i<t&&(o=o.slice(0,i)+"."+o.slice(i));else t>1&&(o=o.charAt(0)+"."+o.slice(1));return n.s<0&&(!u||4==e)?"-"+o:o}wn.abs=function(){var n=new this.constructor(this);return n.s=1,n},wn.cmp=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.c),o=n.c,a=r.s,u=n.s,s=r.e,l=n.e;if(!i[0]||!o[0])return i[0]?a:o[0]?-u:0;if(a!=u)return a;if(e=a<0,s!=l)return s>l^e?1:-1;for(u=Math.max(i.length,o.length),a=0;a<u;a++)if((s=a<i.length?i[a]:0)!=(l=a<o.length?o[a]:0))return s>l^e?1:-1;return 0},wn.div=function(n){var e=this.constructor,t=new e(this),r=(n=new e(n),t.c),i=n.c,o=t.s==n.s?1:-1,a=e.DP;if(a!==~~a||a<0||a>1e6)throw Error(mn);if(!i[0])throw Error("[big.js] Division by zero");if(!r[0])return new e(0*o);var u,s,l,c,f,h=i.slice(),d=u=i.length,g=r.length,w=r.slice(0,u),p=w.length,S=n,m=S.c=[],M=0,y=a+(S.e=t.e-n.e)+1;for(S.s=o,o=y<0?0:y,h.unshift(0);p++<u;)w.push(0);do{for(l=0;l<10;l++){if(u!=(p=w.length))c=u>p?1:-1;else for(f=-1,c=0;++f<u;)if(i[f]!=w[f]){c=i[f]>w[f]?1:-1;break}if(!(c<0))break;for(s=p==u?i:h;p;){if(w[--p]<s[p]){for(f=p;f&&!w[--f];)w[f]=9;--w[f],w[p]+=10}w[p]-=s[p]}for(;!w[0];)w.shift()}m[M++]=c?l:++l,w[0]&&c?w[p]=r[d]||0:w=[r[d]]}while((d++<g||void 0!==w[0])&&o--);return m[0]||1==M||(m.shift(),S.e--),M>y&&Tn(S,a,e.RM,void 0!==w[0]),S},wn.eq=function(n){return!this.cmp(n)},wn.gt=function(n){return this.cmp(n)>0},wn.gte=function(n){return this.cmp(n)>-1},wn.lt=function(n){return this.cmp(n)<0},wn.lte=function(n){return this.cmp(n)<1},wn.minus=wn.sub=function(n){var e,t,r,i,o=this.constructor,a=new o(this),u=(n=new o(n),a.s),s=n.s;if(u!=s)return n.s=-s,a.plus(n);var l=a.c.slice(),c=a.e,f=n.c,h=n.e;if(!l[0]||!f[0])return f[0]?(n.s=-s,n):new o(l[0]?a:0);if(u=c-h){for((i=u<0)?(u=-u,r=l):(h=c,r=f),r.reverse(),s=u;s--;)r.push(0);r.reverse()}else for(t=((i=l.length<f.length)?l:f).length,u=s=0;s<t;s++)if(l[s]!=f[s]){i=l[s]<f[s];break}if(i&&(r=l,l=f,f=r,n.s=-n.s),(s=(t=f.length)-(e=l.length))>0)for(;s--;)l[e++]=0;for(s=e;t>u;){if(l[--t]<f[t]){for(e=t;e&&!l[--e];)l[e]=9;--l[e],l[t]+=10}l[t]-=f[t]}for(;0===l[--s];)l.pop();for(;0===l[0];)l.shift(),--h;return l[0]||(n.s=1,l=[h=0]),n.c=l,n.e=h,n},wn.mod=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.s),o=n.s;if(!n.c[0])throw Error("[big.js] Division by zero");return r.s=n.s=1,e=1==n.cmp(r),r.s=i,n.s=o,e?new t(r):(i=t.DP,o=t.RM,t.DP=t.RM=0,r=r.div(n),t.DP=i,t.RM=o,this.minus(r.times(n)))},wn.plus=wn.add=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.s),o=n.s;if(i!=o)return n.s=-o,r.minus(n);var a=r.e,u=r.c,s=n.e,l=n.c;if(!u[0]||!l[0])return l[0]?n:new t(u[0]?r:0*i);if(u=u.slice(),i=a-s){for(i>0?(s=a,e=l):(i=-i,e=u),e.reverse();i--;)e.push(0);e.reverse()}for(u.length-l.length<0&&(e=l,l=u,u=e),i=l.length,o=0;i;u[i]%=10)o=(u[--i]=u[i]+l[i]+o)/10|0;for(o&&(u.unshift(o),++s),i=u.length;0===u[--i];)u.pop();return n.c=u,n.e=s,n},wn.pow=function(n){var e=this.constructor,t=new e(this),r=new e(1),i=new e(1),o=n<0;if(n!==~~n||n<-1e6||n>1e6)throw Error(Sn+"exponent");for(o&&(n=-n);1&n&&(r=r.times(t)),n>>=1;)t=t.times(t);return o?i.div(r):r},wn.round=function(n,e){var t=this.constructor;if(void 0===n)n=0;else if(n!==~~n||n<-1e6||n>1e6)throw Error(mn);return Tn(new t(this),n,void 0===e?t.RM:e)},wn.sqrt=function(){var n,e,t,r=this.constructor,i=new r(this),o=i.s,a=i.e,u=new r(.5);if(!i.c[0])return new r(i);if(o<0)throw Error(pn+"No square root");0===(o=Math.sqrt(i+""))||o===1/0?((e=i.c.join("")).length+a&1||(e+="0"),a=((a+1)/2|0)-(a<0||1&a),n=new r(((o=Math.sqrt(e))==1/0?"1e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):n=new r(o),a=n.e+(r.DP+=4);do{t=n,n=u.times(t.plus(i.div(t)))}while(t.c.slice(0,a).join("")!==n.c.slice(0,a).join(""));return Tn(n,r.DP-=4,r.RM)},wn.times=wn.mul=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.c),o=n.c,a=i.length,u=o.length,s=r.e,l=n.e;if(n.s=r.s==n.s?1:-1,!i[0]||!o[0])return new t(0*n.s);for(n.e=s+l,a<u&&(e=i,i=o,o=e,l=a,a=u,u=l),e=new Array(l=a+u);l--;)e[l]=0;for(s=u;s--;){for(u=0,l=a+s;l>s;)u=e[l]+o[s]*i[l-s-1]+u,e[l--]=u%10,u=u/10|0;e[l]=(e[l]+u)%10}for(u?++n.e:e.shift(),s=e.length;!e[--s];)e.pop();return n.c=e,n},wn.toExponential=function(n){return In(this,1,n,n)},wn.toFixed=function(n){return In(this,2,n,this.e+n)},wn.toPrecision=function(n){return In(this,3,n,n-1)},wn.toString=function(){return In(this)},wn.valueOf=wn.toJSON=function(){return In(this,4)};var Cn=function n(){function e(t){var r=this;if(!(r instanceof e))return void 0===t?n():new e(t);t instanceof e?(r.s=t.s,r.e=t.e,r.c=t.c.slice(),function(n){if((n=Tn(n,28,0)).c.length>1&&!n.c[0]){let e=n.c.findIndex(n=>n);n.c=n.c.slice(e),n.e=n.e-e}}(r)):yn(r,t),r.constructor=e}return e.prototype=wn,e.DP=28,e.RM=1,e.NE=-29,e.PE=29,e.version="5.2.2",e}(),An=Cn,kn=An;new An(0),new An(1),new An(-1),new An("79228162514264337593543950335"),new An("-79228162514264337593543950335");var En;function Wn(n){return-2147483648===n?n:-n}!function(n){n[n.AllowHexSpecifier=512]="AllowHexSpecifier"}(En||(En={}));var vn=null;try{vn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(n){}function bn(n,e,t){this.low=0|n,this.high=0|e,this.unsigned=!!t}function Dn(n){return!0===(n&&n.__isLong__)}bn.prototype.GetHashCode=function(){let n=this.unsigned?1:0;return n=(n<<5)+n^this.high,n=(n<<5)+n^this.low,n},bn.prototype.Equals=function(n){return re(this,n)},bn.prototype.CompareTo=function(n){return ue(this,n)},bn.prototype.toString=function(n){return Qn(this,n)},bn.prototype.toJSON=function(){return Qn(this)},bn.prototype.__isLong__,Object.defineProperty(bn.prototype,"__isLong__",{value:!0});var Pn={},Bn={};function Hn(n,e){var t,r,i;return e?(i=0<=(n>>>=0)&&n<256)&&(r=Bn[n])?r:(t=Xn(n,(0|n)<0?-1:0,!0),i&&(Bn[n]=t),t):(i=-128<=(n|=0)&&n<128)&&(r=Pn[n])?r:(t=Xn(n,n<0?-1:0,!1),i&&(Pn[n]=t),t)}function xn(n,e){if(isNaN(n))return e?Un:jn;if(e){if(n<0)return Un;if(n>=Rn)return Yn}else{if(n<=-Kn)return qn;if(n+1>=Kn)return _n}return n<0?se(xn(-n,e)):Xn(n%Ln|0,n/Ln|0,e)}function Xn(n,e,t){return new bn(n,e,t)}var Fn=Math.pow;function Gn(n,e,t){if(0===n.length)throw Error("empty string");if("NaN"===n||"Infinity"===n||"+Infinity"===n||"-Infinity"===n)return jn;if("number"==typeof e?(t=e,e=!1):e=!!e,(t=t||10)<2||36<t)throw RangeError("radix");var r=n.indexOf("-");if(r>0)throw Error("interior hyphen");if(0===r)return se(Gn(n.substring(1),e,t));for(var i=xn(Fn(t,8)),o=jn,a=0;a<n.length;a+=8){var u=Math.min(8,n.length-a),s=parseInt(n.substring(a,a+u),t);if(u<8)o=le(fe(o,xn(Fn(t,u))),xn(s));else o=le(o=fe(o,i),xn(s))}return o.unsigned=e,o}function On(n,e){return"number"==typeof n?xn(n,e):"string"==typeof n?Gn(n,e):Xn(n.low,n.high,"boolean"==typeof e?e:n.unsigned)}var Ln=4294967296,Rn=Ln*Ln,Kn=Rn/2,Nn=Hn(1<<24),jn=Hn(0),Un=Hn(0,!0),Vn=Hn(1),zn=Hn(1,!0),Jn=Hn(-1),_n=Xn(-1,2147483647,!1),Yn=Xn(-1,-1,!0),qn=Xn(0,-2147483648,!1);function Zn(n){return n.unsigned?n.low>>>0:n.low}function $n(n){return n.unsigned?(n.high>>>0)*Ln+(n.low>>>0):n.high*Ln+(n.low>>>0)}function Qn(n,e){if((e=e||10)<2||36<e)throw RangeError("radix");if(ne(n))return"0";if(ee(n)){if(re(n,qn)){var t=xn(e),r=he(n,t),i=ce(fe(r,t),n);return Qn(r,e)+Zn(i).toString(e)}return"-"+Qn(se(n),e)}for(var o=xn(Fn(e,6),n.unsigned),a=n,u="";;){var s=he(a,o),l=(Zn(ce(a,fe(s,o)))>>>0).toString(e);if(ne(a=s))return l+u;for(;l.length<6;)l="0"+l;u=""+l+u}}function ne(n){return 0===n.high&&0===n.low}function ee(n){return!n.unsigned&&n.high<0}function te(n){return 1==(1&n.low)}function re(n,e){return Dn(e)||(e=On(e)),(n.unsigned===e.unsigned||n.high>>>31!=1||e.high>>>31!=1)&&(n.high===e.high&&n.low===e.low)}function ie(n,e){return ue(n,e)<0}function oe(n,e){return ue(n,e)>0}function ae(n,e){return ue(n,e)>=0}function ue(n,e){if(Dn(e)||(e=On(e)),re(n,e))return 0;var t=ee(n),r=ee(e);return t&&!r?-1:!t&&r?1:n.unsigned?e.high>>>0>n.high>>>0||e.high===n.high&&e.low>>>0>n.low>>>0?-1:1:ee(ce(n,e))?-1:1}function se(n){return!n.unsigned&&re(n,qn)?qn:le(de(n),Vn)}function le(n,e){Dn(e)||(e=On(e));var t=n.high>>>16,r=65535&n.high,i=n.low>>>16,o=65535&n.low,a=e.high>>>16,u=65535&e.high,s=e.low>>>16,l=0,c=0,f=0,h=0;return f+=(h+=o+(65535&e.low))>>>16,c+=(f+=i+s)>>>16,l+=(c+=r+u)>>>16,l+=t+a,Xn((f&=65535)<<16|(h&=65535),(l&=65535)<<16|(c&=65535),n.unsigned)}function ce(n,e){return Dn(e)||(e=On(e)),le(n,se(e))}function fe(n,e){if(ne(n))return n.unsigned?Un:jn;if(Dn(e)||(e=On(e)),vn)return Xn(vn.mul(n.low,n.high,e.low,e.high),vn.get_high(),n.unsigned);if(ne(e))return n.unsigned?Un:jn;if(re(n,qn))return te(e)?qn:jn;if(re(e,qn))return te(n)?qn:jn;if(ee(n))return ee(e)?fe(se(n),se(e)):se(fe(se(n),e));if(ee(e))return se(fe(n,se(e)));if(ie(n,Nn)&&ie(e,Nn))return xn($n(n)*$n(e),n.unsigned);var t=n.high>>>16,r=65535&n.high,i=n.low>>>16,o=65535&n.low,a=e.high>>>16,u=65535&e.high,s=e.low>>>16,l=65535&e.low,c=0,f=0,h=0,d=0;return h+=(d+=o*l)>>>16,f+=(h+=i*l)>>>16,h&=65535,f+=(h+=o*s)>>>16,c+=(f+=r*l)>>>16,f&=65535,c+=(f+=i*s)>>>16,f&=65535,c+=(f+=o*u)>>>16,c+=t*l+r*s+i*u+o*a,Xn((h&=65535)<<16|(d&=65535),(c&=65535)<<16|(f&=65535),n.unsigned)}function he(n,e){if(Dn(e)||(e=On(e)),ne(e))throw Error("division by zero");var t,r,i;if(vn)return n.unsigned||-2147483648!==n.high||-1!==e.low||-1!==e.high?Xn((n.unsigned?vn.div_u:vn.div_s)(n.low,n.high,e.low,e.high),vn.get_high(),n.unsigned):n;if(ne(n))return n.unsigned?Un:jn;if(n.unsigned){if(e.unsigned||(e=function(n){return n.unsigned?n:Xn(n.low,n.high,!0)}(e)),oe(e,n))return Un;if(oe(e,pe(n,1)))return zn;i=Un}else{if(re(n,qn))return re(e,Vn)||re(e,Jn)?qn:re(e,qn)?Vn:re(t=ge(he(we(n,1),e),1),jn)?ee(e)?Vn:Jn:i=le(t,he(r=ce(n,fe(e,t)),e));if(re(e,qn))return n.unsigned?Un:jn;if(ee(n))return ee(e)?he(se(n),se(e)):se(he(se(n),e));if(ee(e))return se(he(n,se(e)));i=jn}for(r=n;ae(r,e);){t=Math.max(1,Math.floor($n(r)/$n(e)));for(var o=Math.ceil(Math.log(t)/Math.LN2),a=o<=48?1:Fn(2,o-48),u=xn(t),s=fe(u,e);ee(s)||oe(s,r);)s=fe(u=xn(t-=a,n.unsigned),e);ne(u)&&(u=Vn),i=le(i,u),r=ce(r,s)}return i}function de(n){return Xn(~n.low,~n.high,n.unsigned)}function ge(n,e){return Dn(e)&&(e=Zn(e)),0==(e&=63)?n:e<32?Xn(n.low<<e,n.high<<e|n.low>>>32-e,n.unsigned):Xn(0,n.low<<e-32,n.unsigned)}function we(n,e){return Dn(e)&&(e=Zn(e)),0==(e&=63)?n:e<32?Xn(n.low>>>e|n.high<<32-e,n.high>>e,n.unsigned):Xn(n.high>>e-32,n.high>=0?0:-1,n.unsigned)}function pe(n,e){if(Dn(e)&&(e=Zn(e)),0===(e&=63))return n;var t=n.high;return e<32?Xn(n.low>>>e|t<<32-e,t>>>e,n.unsigned):Xn(32===e?t:t>>>e-32,0,n.unsigned)}var Se=bn;const me=fe,Me=ue,ye=function(n,e,t){return t?function(n,e){return new bn(n[0]|n[1]<<8|n[2]<<16|n[3]<<24,n[4]|n[5]<<8|n[6]<<16|n[7]<<24,e)}(n,e):function(n,e){return new bn(n[4]<<24|n[5]<<16|n[6]<<8|n[7],n[0]<<24|n[1]<<16|n[2]<<8|n[3],e)}(n,e)},Te=function(n,e){return e?function(n){var e=n.high,t=n.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]}(n):function(n){var e=n.high,t=n.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]}(n)},Ie=Qn;class Ce{constructor(n){this.iter=n}MoveNext(){const n=this.iter.next();return this.current=n.value,!n.done}get Current(){return this.current}Reset(){throw new Error("JS iterators cannot be reset")}Dispose(){}}function Ae(n){return new Ce(n[Symbol.iterator]())}function ke(n){return{next:()=>n.MoveNext()?{done:!1,value:n.Current}:{done:!0,value:null}}}function Ee(n){return ve(()=>{const e=n[Symbol.iterator]();let t={value:null};return Oe(n=>{let r=!1;for(;!r;)if(null==n){const t=e.next();t.done?r=!0:n=t.value[Symbol.iterator]()}else{const e=n.next();e.done?n=null:(t={value:e.value},r=!0)}return null!=n&&null!=t?[t.value,n]:null},null)})}function We(n,e){return Ee(xe(n,e))}function ve(n){return{[Symbol.iterator]:()=>n()[Symbol.iterator]()}}function be(){return Oe(()=>null,void 0)}function De(n,e){let t;for(const r=e[Symbol.iterator]();t=r.next(),!t.done;)if(n(t.value))return!0;return!1}function Pe(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))return t.reduce(n,e);{let r;for(let i=0,o=t[Symbol.iterator]();r=o.next(),!r.done;i++)e=n(e,r.value,i);return e}}function Be(n,e){Pe((e,t)=>(n(t),null),null,e)}function He(n,e){Pe((e,t,r)=>(n(null!=r?r:0,t),null),null,e)}function xe(n,e){return ve(()=>Oe(e=>{const t=e.next();return t.done?null:[n(t.value),e]},e[Symbol.iterator]()))}function Xe(n,e,t){if(0===e)throw new Error("Step cannot be 0");return ve(()=>Oe(n=>e>0&&n<=t||e<0&&n>=t?[n,n+e]:null,n))}function Fe(n){return[n]}function Ge(n,e,t){return Pe((e,r)=>t.Add(e,n(r)),t.GetZero(),e)}function Oe(n,e){return{[Symbol.iterator]:()=>{let t=e;return{next:()=>{const e=n(t);if(null!=e){const n=fn(e);if(null!=n)return t=n[1],{done:!1,value:n[0]}}return{done:!0,value:void 0}}}}}}function Le(n){const e=n<0,t=(n=Math.abs(n))%36e5/6e4;return(e?"-":"+")+u(~~(n/36e5),2)+":"+u(t,2)}function Re(n,e){const t=n.toISOString();return"first"===e?t.substring(0,t.indexOf("T")):t.substring(t.indexOf("T")+1,t.length-1)}function Ke(n,e,t){return e.replace(/(\w)\1*/g,e=>{let r=Number.NaN;switch(e.substring(0,1)){case"y":const i=t?n.getUTCFullYear():n.getFullYear();r=e.length<4?i%100:i;break;case"M":r=(t?n.getUTCMonth():n.getMonth())+1;break;case"d":r=t?n.getUTCDate():n.getDate();break;case"H":r=t?n.getUTCHours():n.getHours();break;case"h":const o=t?n.getUTCHours():n.getHours();r=o>12?o%12:o;break;case"m":r=t?n.getUTCMinutes():n.getMinutes();break;case"s":r=t?n.getUTCSeconds():n.getSeconds();break;case"f":r=t?n.getUTCMilliseconds():n.getMilliseconds()}return Number.isNaN(r)?e:r<10&&e.length>1?"0"+r:""+r})}function Ne(n,e){var t,r,i;const o=new Date(n.getTime()+(null!=(t=n.offset)?t:0));if("string"!=typeof e)return o.toISOString().replace(/\.\d+/,"").replace(/[A-Z]|\.\d+/g," ")+Le(null!=(r=n.offset)?r:0);if(1!==e.length)return Ke(o,e,!0);switch(e){case"D":case"d":return Re(o,"first");case"T":case"t":return Re(o,"second");case"O":case"o":return function(n,e){const t=n.toISOString();return t.substring(0,t.length-1)+Le(e)}(o,null!=(i=n.offset)?i:0);default:throw new Error("Unrecognized Date print format")}}function je(n,e){const t=1===n.kind;if("string"!=typeof e)return t?n.toUTCString():n.toLocaleString();if(1!==e.length)return Ke(n,e,t);switch(e){case"D":case"d":return t?Re(n,"first"):n.toLocaleDateString();case"T":case"t":return t?Re(n,"second"):n.toLocaleTimeString();case"O":case"o":return function(n,e){if(e)return n.toISOString();{const e=null==n.kind||2===n.kind;return u(n.getFullYear(),4)+"-"+u(n.getMonth()+1,2)+"-"+u(n.getDate(),2)+"T"+u(n.getHours(),2)+":"+u(n.getMinutes(),2)+":"+u(n.getSeconds(),2)+"."+u(n.getMilliseconds(),3)+(e?Le(-6e4*n.getTimezoneOffset()):"")}}(n,t);default:throw new Error("Unrecognized Date print format")}}const Ue=/(^|[^%])%([0+\- ]*)(\d+)?(?:\.(\d+))?(\w)/,Ve=/\{(\d+)(,-?\d+)?(?:\:([a-zA-Z])(\d{0,2})|\:(.+?))?\}/g;function ze(n){return"number"==typeof n||n instanceof Se||n instanceof kn}function Je(n,e){return n instanceof Se?Me(n,e)<0:n instanceof kn?n.cmp(e)<0:n<e}function _e(n,e){return n instanceof Se?me(n,e):n instanceof kn?n.mul(e):n*e}function Ye(n,e){return n instanceof Se?String(n)+(0).toFixed(e).substr(1):n.toFixed(e)}function qe(n,e){return n instanceof Se?String(n)+(0).toPrecision(e).substr(1):n.toPrecision(e)}function Ze(n,e){return n instanceof Se?String(n)+(0).toExponential(e).substr(1):n.toExponential(e)}function $e(n){return n instanceof Se?Ie(n.unsigned?n:ye(Te(n),!0),16):(Number(n)>>>0).toString(16)}function Qe(n){return{input:n,cont:(e=n,n=>Ue.test(e)?function n(e,t){return(...r)=>{let i=e;for(const n of r)i=et(i,n);return Ue.test(i)?n(i,t):t(i.replace(/%%/g,"%"))}}(e,n):n(e))};var e}function nt(n){return n.cont(n=>n)}function et(n,e){return n.replace(Ue,(n,t,r,i,o,a)=>{let u="";if(ze(e))switch("x"!==a.toLowerCase()&&(Je(e,0)?(e=_e(e,-1),u="-"):r.indexOf(" ")>=0?u=" ":r.indexOf("+")>=0&&(u="+")),o=null==o?null:parseInt(o,10),a){case"f":case"F":e=Ye(e,o=null!=o?o:6);break;case"g":case"G":e=null!=o?qe(e,o):qe(e);break;case"e":case"E":e=null!=o?Ze(e,o):Ze(e);break;case"x":e=$e(e);break;case"X":e=$e(e).toUpperCase();break;default:e=String(e)}if(i=parseInt(i,10),isNaN(i))e=u+e;else{const n=r.indexOf("0")>=0,t=r.indexOf("-")>=0,o=t||!n?" ":"0";e="0"===o?u+(e=ot(e,i-u.length,o,t)):ot(u+e,i,o,t)}return(t+e).replace(/%/g,"%%")})}function tt(n,...e){return"object"==typeof n&&e.length>0&&(n=e[0],e.shift()),n.replace(Ve,(n,t,r,i,o,a)=>{let u=e[t];if(ze(u))switch(o=null==o?null:parseInt(o,10),i){case"f":case"F":u=Ye(u,o=null!=o?o:2);break;case"g":case"G":u=null!=o?qe(u,o):qe(u);break;case"e":case"E":u=null!=o?Ze(u,o):Ze(u);break;case"p":case"P":o=null!=o?o:2,u=Ye(_e(u,100),o)+" %";break;case"d":case"D":u=null!=o?ot(String(u),o,"0"):String(u);break;case"x":case"X":u=null!=o?ot($e(u),o,"0"):$e(u),"X"===i&&(u=u.toUpperCase());break;default:if(a){let n="";u=a.replace(/(0+)(\.0+)?/,(e,t,r)=>(Je(u,0)&&(u=_e(u,-1),n="-"),u=Ye(u,null!=r?r.length-1:0),ot(u,(t||"").length-n.length+(null!=r?r.length:0),"0"))),u=n+u}}else u instanceof Date&&(u=function(n,e){return null!=n.offset?Ne(n,e):je(n,e)}(u,a||i));return r=parseInt((r||" ").substring(1),10),isNaN(r)||(u=ot(String(u),Math.abs(r)," ",r<0)),u})}function rt(n,e){if(n<0)throw new Error("String length must be non-negative");const t=new Array(n);for(let r=0;r<n;r++)t[r]=e(r);return t.join("")}function it(n,e){return Array.isArray(e)?e.join(n):Array.from(e).join(n)}function ot(n,e,t,r){t=t||" ",e-=n.length;for(let i=0;i<e;i++)n=r?n+t:t+n;return n}function at(n,e,t){if(e+(t||0)>n.length)throw new Error("Invalid startIndex and/or length");return null!=t?n.substr(e,t):n.substr(e)}const ut=v((function(n,e){const t=new G(null);this.comparer=e,t.contents=this,this.hashMap=new Map([]),this["init@20-1"]=1,Be((function(n){ht(t.contents,n[0],n[1])}),n)}));function st(n,e){const t=0|n.comparer.GetHashCode(e),r=o(n.hashMap,t,null);return r[0]?[!0,t,r[1].findIndex((function(t){return n.comparer.Equals(e,t[0])}))]:[!1,t,-1]}function lt(n,e){const t=st(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return E(n.hashMap,t[1])[t[2]];case 1:return null}}function ct(n){n.hashMap.clear()}function ft(n){return 0|Ge((function(n){return n.length}),n.hashMap.values(),{GetZero:()=>0,Add:(n,e)=>n+e})}function ht(n,e,t){const r=st(n,e);switch(r[0]&&r[2]>-1?0:1){case 0:{let n;throw n=nt(Qe("An item with the same key has already been added. Key: %A"))(e),new Error(n)}case 1:if(r[0]){nr([e,t],E(n.hashMap,r[1]))}else n.hashMap.set(r[1],[[e,t]])}}function dt(n,e){const t=st(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return E(n.hashMap,t[1]).splice(t[2],1),!0;case 1:return!1}}ut.prototype[Symbol.iterator]=function(){const n=this;return ke(Ae(ve((function(){return We((function(n){return xe((function(n){return n}),n)}),n.hashMap.values())}))))},ut.prototype.Add=function(n){ht(this,n[0],n[1])},ut.prototype.Clear=function(){ct(this)},ut.prototype.Contains=function(n){const e=lt(this,n[0]);switch(null!=e&&p(e[1],n[1])?0:1){case 0:return!0;case 1:return!1}},ut.prototype.CopyTo=function(n,e){He((function(t,r){n[e+t]=r}),this)},Object.defineProperty(ut.prototype,"Count",{get:function(){return 0|ft(this)}}),Object.defineProperty(ut.prototype,"IsReadOnly",{get:function(){return!1}}),ut.prototype.Remove=function(n){const e=this,t=lt(e,n[0]);if(null!=t){if(p(t[1],n[1])){dt(e,n[0])}return!0}return!1},Object.defineProperty(ut.prototype,"size",{get:function(){return 0|ft(this)}}),ut.prototype.clear=function(){ct(this)},ut.prototype.delete=function(n){return dt(this,n)},ut.prototype.entries=function(){return xe((function(n){return n}),this)},ut.prototype.get=function(n){return function(n,e){const t=lt(n,e);if(null!=t){return t[1]}throw new Error("The item was not found in collection")}(this,n)},ut.prototype.has=function(n){return function(n,e){const t=st(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return!0;case 1:return!1}}(this,n)},ut.prototype.keys=function(){return xe((function(n){return n[0]}),this)},ut.prototype.set=function(n,e){return function(n,e,t){const r=st(n,e);switch(r[0]&&r[2]>-1?0:1){case 0:E(n.hashMap,r[1])[r[2]]=[e,t];break;case 1:if(r[0]){nr([e,t],E(n.hashMap,r[1]))}else n.hashMap.set(r[1],[[e,t]])}}(this,n,e),this},ut.prototype.values=function(){return xe((function(n){return n[1]}),this)};const gt=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function wt(n){return function n(e,t){n:for(;;){const r=e,i=t;switch(i.tag){case 1:return r+1|0;case 2:e=n(r+1,i.fields[2]),t=i.fields[3];continue n;default:return 0|r}break}}(0,n)}function pt(n,e,t){n:for(;;){const r=n,i=e,o=t;switch(o.tag){case 1:if(0===(0|r.Compare(i,o.fields[0])))return o.fields[1];throw new Error("key not found");case 2:{const a=0|r.Compare(i,o.fields[0]);if(a<0){n=r,e=i,t=o.fields[2];continue n}if(0===a)return o.fields[1];n=r,e=i,t=o.fields[3];continue n}default:throw new Error("key not found")}break}}function St(n,e,t){n:for(;;){const r=n,i=e,o=t;switch(o.tag){case 1:return 0===r.Compare(i,o.fields[0]);case 2:{const a=0|r.Compare(i,o.fields[0]);if(a<0){n=r,e=i,t=o.fields[2];continue n}if(0===a)return!0;n=r,e=i,t=o.fields[3];continue n}default:return!1}break}}const mt=v((function(n,e){this.stack=n,this.started=e}),F);function Mt(n){for(;;){const e=n;if(null==e.tail)return new P;if(1===e.head.tag)return e;2!==e.head.tag?n=e.tail:n=new P(e.head.fields[2],new P(new gt(1,"MapOne",e.head.fields[0],e.head.fields[1]),new P(e.head.fields[3],e.tail)))}}function yt(n){return new mt(Mt(new P(n,new P)),!1)}function Tt(n){if(n.started){const e=n.stack;if(null==e.tail)return function(){throw new Error("enumeration already finished")}();if(1===e.head.tag)return[e.head.fields[0],e.head.fields[1]];throw new Error("Please report error: Map iterator, unexpected stack for current")}return function(){throw new Error("enumeration not started")}()}const It=v((function(n){this.s=n,this.i=yt(this.s)}));function Ct(n){return function(n){return this instanceof It?It.call(this,n):new It(n)}(n)}function At(n){return Oe((function(n){return n.MoveNext()?[n.Current,n]:null}),Ct(n))}Object.defineProperty(It.prototype,"Current",{get:function(){return Tt(this.i)}}),It.prototype.MoveNext=function(){return function(n){if(n.started){const e=n.stack;if(null==e.tail)return!1;if(1===e.head.tag)return n.stack=Mt(e.tail),!(null==n.stack.tail);throw new Error("Please report error: Map iterator, unexpected stack for moveNext")}return n.started=!0,!(null==n.stack.tail)}(this.i)},It.prototype.Reset=function(){this.i=yt(this.s)},It.prototype.Dispose=function(){};const kt=v((function(n,e){this.comparer=n,this.tree=e}));function Et(n){return n.tree}function Wt(n,e){return pt(n.comparer,e,n.tree)}function vt(n){return wt(n.tree)}function bt(n,e){return St(n.comparer,e,n.tree)}kt.prototype.toString=function(){return"map ["+it("; ",xe((function(n){return nt(Qe("(%A, %A)"))(n[0])(n[1])}),this))+"]"},kt.prototype.GetHashCode=function(){const n=function(n,e){return(n<<1)+e+631};let e=0;const t=Ct(Et(this));for(;t.MoveNext();){const r=t.Current;e=n(e,d(r[0])),e=n(e,d(r[1]))}return 0|Math.abs(e)},kt.prototype.Equals=function(n){return 0===this.CompareTo(n)},kt.prototype[Symbol.iterator]=function(){return ke(Ct(this.tree))},kt.prototype.CompareTo=function(n){const e=this;let t=0,r=!1;const o=Ct(Et(e));try{const a=Ct(Et(n));try{for(;!r&&0===t;){const n=[o.MoveNext(),a.MoveNext()];if(n[0])if(n[1]){const n=o.Current,r=a.Current,i=0|e.comparer.Compare(n[0],r[0]);t=0!==i?i:T(n[1],r[1])}else t=1;else n[1]?t=-1:r=!0}return 0|t}finally{i(a)&&a.Dispose()}}finally{i(o)&&o.Dispose()}},Object.defineProperty(kt.prototype,"size",{get:function(){return 0|vt(this)}}),kt.prototype.clear=function(){throw new Error("Map cannot be mutated")},kt.prototype.delete=function(n){throw new Error("Map cannot be mutated")},kt.prototype.entries=function(){return At(Et(this))},kt.prototype.get=function(n){return Wt(this,n)},kt.prototype.has=function(n){return bt(this,n)},kt.prototype.keys=function(){return xe((function(n){return n[0]}),At(Et(this)))},kt.prototype.set=function(n,e){throw new Error("Map cannot be mutated")},kt.prototype.values=function(){return xe((function(n){return n[1]}),At(Et(this)))};const Dt=v((function(n,e){const t=new G(null);this.comparer=e,t.contents=this,this.hashMap=new Map([]),this["init@21-2"]=1,Be((function(n){Xt(t.contents,n)}),n)}));function Pt(n,e){return this instanceof Dt?Dt.call(this,n,e):new Dt(n,e)}function Bt(n,e){const t=0|n.comparer.GetHashCode(e),r=o(n.hashMap,t,null);return r[0]?[!0,t,r[1].findIndex((function(t){return n.comparer.Equals(e,t)}))]:[!1,t,-1]}function Ht(n){n.hashMap.clear()}function xt(n){return 0|Ge((function(n){return n.length}),n.hashMap.values(),{GetZero:()=>0,Add:(n,e)=>n+e})}function Xt(n,e){const t=Bt(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return!1;case 1:if(t[0]){nr(e,E(n.hashMap,t[1]));return!0}return n.hashMap.set(t[1],[e]),!0}}function Ft(n,e){const t=Bt(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return!0;case 1:return!1}}function Gt(n,e){const t=Bt(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return E(n.hashMap,t[1]).splice(t[2],1),!0;case 1:return!1}}Dt.prototype[Symbol.iterator]=function(){const n=this;return ke(Ae(ve((function(){return We((function(n){return xe((function(n){return n}),n)}),n.hashMap.values())}))))},Dt.prototype.Add=function(n){Xt(this,n)},Dt.prototype.Clear=function(){Ht(this)},Dt.prototype.Contains=function(n){return Ft(this,n)},Dt.prototype.CopyTo=function(n,e){He((function(t,r){n[e+t]=r}),this)},Object.defineProperty(Dt.prototype,"Count",{get:function(){return 0|xt(this)}}),Object.defineProperty(Dt.prototype,"IsReadOnly",{get:function(){return!1}}),Dt.prototype.Remove=function(n){return Gt(this,n)},Object.defineProperty(Dt.prototype,"size",{get:function(){return 0|xt(this)}}),Dt.prototype.add=function(n){Xt(this,n);return this},Dt.prototype.add_=function(n){return Xt(this,n)},Dt.prototype.clear=function(){Ht(this)},Dt.prototype.delete=function(n){return Gt(this,n)},Dt.prototype.has=function(n){return Ft(this,n)},Dt.prototype.keys=function(){return xe((function(n){return n}),this)},Dt.prototype.values=function(){return xe((function(n){return n}),this)},Dt.prototype.entries=function(){return xe((function(n){return[n,n]}),this)};const Ot=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function Lt(n){return new Ot(2,"SetOne",n)}function Rt(n,e,t,r){return new Ot(1,"SetNode",n,e,t,r)}const Kt=v((function(n,e){this.stack=n,this.started=e}),F);function Nt(n){for(;;){const e=n;if(null==e.tail)return new P;if(2===e.head.tag)return e;1!==e.head.tag?n=e.tail:n=new P(e.head.fields[1],new P(Lt(e.head.fields[0]),new P(e.head.fields[2],e.tail)))}}function jt(n){return new Kt(Nt(new P(n,new P)),!1)}function Ut(n){if(n.started){const e=n.stack;if(null==e.tail)return function(){throw new Error("Enumeration already started")}();if(2===e.head.tag)return e.head.fields[0];throw new Error("Please report error: Set iterator, unexpected stack for current")}return function(){throw new Error("Enumeration not started")}()}const Vt=v((function(n){this.s=n,this.i=jt(this.s)}));function zt(n){return function(n){return this instanceof Vt?Vt.call(this,n):new Vt(n)}(n)}function Jt(n,e,t){return 0===e.tag?0===t.tag?0:-1:0===t.tag?1:0|function(n,e,t){n:for(;;){const R=n,K=e,N=t;var r,i,o,a,u,s,l,c,f,h,d,g,w,p,S,m,M,y,T,I,C,A,k,E,W,v,b,D,B,H,x,X,F,G,O,L;switch(null!=K.tail?null!=N.tail?2===N.head.tag?2===K.head.tag?(r=4,a=K.head.fields[0],u=N.head.fields[0],s=K.tail,l=N.tail):1===K.head.tag?0===K.head.fields[1].tag?(r=6,w=K.head.fields[1],p=K.head.fields[0],S=K.head.fields[2],m=N.head.fields[0],M=K.tail,y=N.tail):(r=9,b=K.head.fields[0],D=K.head.fields[1],B=K.head.fields[2],H=K.tail):(r=10,x=N.head.fields[0],X=N.tail):1===N.head.tag?0===N.head.fields[1].tag?2===K.head.tag?(r=5,c=K.head.fields[0],f=N.head.fields[0],h=N.head.fields[2],d=K.tail,g=N.tail):1===K.head.tag?0===K.head.fields[1].tag?(r=7,T=K.head.fields[0],I=K.head.fields[2],C=N.head.fields[0],A=N.head.fields[2],k=K.tail,E=N.tail):(r=9,b=K.head.fields[0],D=K.head.fields[1],B=K.head.fields[2],H=K.tail):(r=11,F=N.head.fields[0],G=N.head.fields[1],O=N.head.fields[2],L=N.tail):2===K.head.tag?(r=8,W=K.head.fields[0],v=K.tail):1===K.head.tag?(r=9,b=K.head.fields[0],D=K.head.fields[1],B=K.head.fields[2],H=K.tail):(r=11,F=N.head.fields[0],G=N.head.fields[1],O=N.head.fields[2],L=N.tail):2===K.head.tag?(r=8,W=K.head.fields[0],v=K.tail):1===K.head.tag?(r=9,b=K.head.fields[0],D=K.head.fields[1],B=K.head.fields[2],H=K.tail):(r=3,i=K.tail,o=N.tail):r=2:r=null!=N.tail?1:0,r){case 0:return 0;case 1:return-1;case 2:return 1;case 3:n=R,e=i,t=o;continue n;case 4:{const r=0|R.Compare(a,u);if(0!==r)return 0|r;n=R,e=s,t=l;continue n}case 5:{const r=0|R.Compare(c,f);if(0!==r)return 0|r;n=R,e=new P(new Ot(0,"SetEmpty"),d),t=new P(h,g);continue n}case 6:{const r=0|R.Compare(p,m);if(0!==r)return 0|r;n=R,e=new P(S,M),t=new P(w,y);continue n}case 7:{const r=0|R.Compare(T,C);if(0!==r)return 0|r;n=R,e=new P(I,k),t=new P(A,E);continue n}case 8:n=R,e=new P(new Ot(0,"SetEmpty"),new P(Lt(W),v)),t=N;continue n;case 9:n=R,e=new P(D,new P(Rt(b,new Ot(0,"SetEmpty"),B,0),H)),t=N;continue n;case 10:n=R,e=K,t=new P(new Ot(0,"SetEmpty"),new P(Lt(x),X));continue n;case 11:n=R,e=K,t=new P(G,new P(Rt(F,new Ot(0,"SetEmpty"),O,0),L));continue n}break}}(n,new P(e,new P),new P(t,new P))}Object.defineProperty(Vt.prototype,"Current",{get:function(){return Ut(this.i)}}),Vt.prototype.MoveNext=function(){return function(n){if(n.started){const e=n.stack;if(null==e.tail)return!1;if(2===e.head.tag)return n.stack=Nt(e.tail),!(null==n.stack.tail);throw new Error("Please report error: Set iterator, unexpected stack for moveNext")}return n.started=!0,!(null==n.stack.tail)}(this.i)},Vt.prototype.Reset=function(){this.i=jt(this.s)},Vt.prototype.Dispose=function(){};const _t=v((function(n,e){this.comparer=n,this.tree=e}));function Yt(n){return n.comparer}function qt(n){return n.tree}function Zt(n,e){return Pt(n,e)}_t.prototype.toString=function(){return"set ["+it("; ",xe((function(n){return String(n)}),this))+"]"},_t.prototype.GetHashCode=function(){let n=0;const e=zt(qt(this));for(;e.MoveNext();){n=((0|n)<<1)+(0|d(e.Current))+631}return 0|Math.abs(n)},_t.prototype.Equals=function(n){return 0===Jt(Yt(this),qt(this),qt(n))},_t.prototype.CompareTo=function(n){return 0|Jt(Yt(this),qt(this),qt(n))},_t.prototype[Symbol.iterator]=function(){return ke(zt(qt(this)))};function $t(n,e,t){if(ArrayBuffer.isView(e)){const r=0|e.length,i=new t(r);for(let t=0;t<=r-1;t++)i[t]=n(e[t]);return i}return e.map((function(e){return n(e)}))}function Qt(n,e){var t;const r=Array.isArray(n)?n:Array.from(n);switch(0|r.length){case 0:return new e(0);case 1:return r[0];default:if(t=r[0],ArrayBuffer.isView(t)){let n=0,t=0;for(let n=0;n<=r.length-1;n++){t+=r[n].length}const i=new e(t);for(let e=0;e<=r.length-1;e++){const t=r[e];for(let e=0;e<=t.length-1;e++)i[n]=t[e],n+=1}return i}return r[0].concat(...r.slice(1))}}function nr(n,e){e.push(n)}function er(n,e){return e.from(n)}function tr(n,e,t){return function(n,e,t,r){for(;;){const i=n,o=e,a=t,u=r;if(null==u.tail)return a;n=i,e=o+1,t=i(o,a,u.head),r=u.tail}}(n,0,e,t)}function rr(n,e,t){for(;;){const r=n,i=e,o=t;if(null==o.tail)return i;n=r,e=r(i,o.head),t=o.tail}}function ir(n){return rr((function(n,e){return new P(e,n)}),new P,n)}function or(n,e,t){return rr((function(e,t){return n(t,e)}),t,ir(e))}function ar(n){return ir(Pe((function(n,e){return new P(e,n)}),new P,n))}function ur(n){return rr((function(n,e){return n+1}),0,n)}function sr(n,e){return rr((function(n,e){return new P(e,n)}),e,ir(n))}function lr(n,e){return ir(rr((function(e,t){return new P(n(t),e)}),new P,e))}function cr(n,e){return ir(tr((function(e,t,r){return new P(n(e,r),t)}),new P,e))}function fr(n,e){rr((function(e,t){n(t)}),null,e)}function hr(n){let e=new P;for(let t=function(n){if(r(n))return n.length;{let e=0;for(const t of n)e++;return e}}(n)-1;t>=0;t--)e=new P(n[t],e);return e}function dr(n,e){return function(n,e,t){n:for(;;){const r=n,i=e,o=t;if(null!=o.tail){const a=r(i,o.head);if(null==a){n=r,e=i+1,t=o.tail;continue n}return a}return null}}(n,0,e)}function gr(n,e){return dr((function(e,t){return n(t)}),e)}function wr(n,e){return dr((function(e,t){return n(e,t)?cn(t):null}),e)}function pr(n,e){return dr((function(e,t){return n(t)?cn(t):null}),e)}function Sr(n,e){const t=wr(n,e);if(null!=t){return fn(t)}throw new Error("List did not contain any matching elements")}function mr(n,e){return Sr((function(e,t){return n===e}),e)}function Mr(n,e){return ir(rr((function(e,t){return n(t)?new P(t,e):e}),new P,e))}function yr(n,e){if(null!=e.tail)return rr(n,e.head,e.tail);throw new Error("List was empty")}function Tr(n,e){return rr((function(e,t){return!!e&&n(t)}),!0,e)}function Ir(n,e){for(;;){const t=n,r=e;if(null==r.tail)return!1;if(t(r.head))return!0;n=t,e=r.tail}}function Cr(n,e,t){let r;const i=er(e,Array);return i.sort((function(e,r){return-1*t.Compare(n(e),n(r))})),r=i,hr(r)}function Ar(n,e,t){const r=Zt([],t);return Mr((function(e){return a(n(e),r)}),e)}function kr(n,e,t,r){return new en(e,n,t,r)}const Er=hr([kr(new nn(1,"MagentaColourKey"),"MilitaryFontRed.png",296,8),kr(new nn(1,"MagentaColourKey"),"MilitaryFontYellow.png",296,8),kr(new nn(1,"MagentaColourKey"),"MilitaryFontBlue.png",296,8),kr(new nn(1,"MagentaColourKey"),"MilitaryFontBlack.png",296,8),kr(new nn(1,"MagentaColourKey"),"MilitaryFontSymbols.png",296,8)]),Wr=hr([kr(new nn(0,"NoColourKey"),"CliffsTile.png",89,200),kr(new nn(1,"MagentaColourKey"),"Title.png",297,20),kr(new nn(0,"NoColourKey"),"Map.png",320,160),kr(new nn(1,"MagentaColourKey"),"AlliedFleetSymbol.png",21,21),kr(new nn(1,"MagentaColourKey"),"EnemyFleetSymbol.png",20,20),kr(new nn(0,"NoColourKey"),"SecretPassage.png",320,160),kr(new nn(1,"MagentaColourKey"),"Mine.png",6,8),kr(new nn(1,"MagentaColourKey"),"Ship0.png",40,13),kr(new nn(1,"MagentaColourKey"),"Ship1.png",34,18),kr(new nn(1,"MagentaColourKey"),"Ship2.png",31,21),kr(new nn(1,"MagentaColourKey"),"Ship3.png",26,26),kr(new nn(1,"MagentaColourKey"),"Ship4.png",12,36),kr(new nn(1,"MagentaColourKey"),"Torpedo0.png",8,2),kr(new nn(1,"MagentaColourKey"),"Torpedo22degrees.png",8,5),kr(new nn(1,"MagentaColourKey"),"ShipExplode0.png",25,25),kr(new nn(1,"MagentaColourKey"),"ShipExplode1.png",50,37),kr(new nn(1,"MagentaColourKey"),"ShipExplode2.png",50,49),kr(new nn(1,"MagentaColourKey"),"ShipExplode3.png",50,49),kr(new nn(1,"MagentaColourKey"),"Plane0.png",6,2),kr(new nn(1,"MagentaColourKey"),"Plane1.png",18,6),kr(new nn(1,"MagentaColourKey"),"Plane2.png",31,10),kr(new nn(1,"MagentaColourKey"),"Plane3.png",49,19),kr(new nn(1,"MagentaColourKey"),"Plane4.png",72,26),kr(new nn(1,"MagentaColourKey"),"Plane4BankingLeft.png",62,21),kr(new nn(1,"MagentaColourKey"),"Plane4BankingRight.png",62,21),kr(new nn(1,"MagentaColourKey"),"Plane5.png",73,22),kr(new nn(1,"MagentaColourKey"),"Plane5BankingLeft.png",66,20),kr(new nn(1,"MagentaColourKey"),"Plane5BankingRight.png",66,20),kr(new nn(1,"MagentaColourKey"),"Plane6.png",71,27),kr(new nn(1,"MagentaColourKey"),"Plane6BankingLeft.png",69,26),kr(new nn(1,"MagentaColourKey"),"Plane6BankingRight.png",69,26),kr(new nn(1,"MagentaColourKey"),"PlaneExplode0.png",45,23),kr(new nn(1,"MagentaColourKey"),"PlaneExplode1.png",51,26),kr(new nn(1,"MagentaColourKey"),"PlaneExplode2.png",35,19),kr(new nn(1,"MagentaColourKey"),"Splash0.png",12,9),kr(new nn(1,"MagentaColourKey"),"PlaneBomb0.png",2,2),kr(new nn(1,"MagentaColourKey"),"PlaneBomb1.png",4,4),kr(new nn(1,"MagentaColourKey"),"PlaneBomb2.png",6,6),kr(new nn(1,"MagentaColourKey"),"PlaneBomb3.png",10,10),kr(new nn(1,"MagentaColourKey"),"PlaneBomb4.png",12,12),kr(new nn(1,"MagentaColourKey"),"SeaBattleBackground0.png",320,160),kr(new nn(1,"MagentaColourKey"),"SeaBattleBackground1.png",320,160),kr(new nn(1,"MagentaColourKey"),"SeaBattleBackground2.png",320,160),kr(new nn(1,"MagentaColourKey"),"SeaBattleBackground3.png",320,160),kr(new nn(1,"MagentaColourKey"),"EnemyShip0.png",12,15),kr(new nn(1,"MagentaColourKey"),"EnemyShip1.png",32,16),kr(new nn(1,"MagentaColourKey"),"EnemyShip2.png",67,16),kr(new nn(1,"MagentaColourKey"),"EnemyShip3.png",12,15),kr(new nn(1,"MagentaColourKey"),"EnemyShip4.png",34,16),kr(new nn(0,"NoColourKey"),"TankBattleMissile.png",12,1),kr(new nn(0,"NoColourKey"),"TileBarricade.png",16,16),kr(new nn(0,"NoColourKey"),"TileBridge.png",16,16),kr(new nn(0,"NoColourKey"),"TileMine.png",16,16),kr(new nn(0,"NoColourKey"),"TileSand.png",16,16),kr(new nn(0,"NoColourKey"),"TileTower.png",16,16),kr(new nn(0,"NoColourKey"),"TileWater.png",16,16),kr(new nn(1,"MagentaColourKey"),"EnemyTankGun1.png",24,12),kr(new nn(1,"MagentaColourKey"),"TankFacingLeft0.png",24,12),kr(new nn(1,"MagentaColourKey"),"TankFacingUpLeft0.png",24,14),kr(new nn(1,"MagentaColourKey"),"TankFacingDownLeft0.png",24,14),kr(new nn(1,"MagentaColourKey"),"TankFacingLeft1.png",24,12),kr(new nn(1,"MagentaColourKey"),"TankFacingUpLeft1.png",24,14),kr(new nn(1,"MagentaColourKey"),"TankFacingDownLeft1.png",24,14),kr(new nn(0,"NoColourKey"),"FinalBossBackground.png",320,160),kr(new nn(1,"MagentaColourKey"),"FinalBoss0.png",207,43),kr(new nn(1,"MagentaColourKey"),"FinalBoss1.png",152,42),kr(new nn(1,"MagentaColourKey"),"FinalBoss2.png",94,42),kr(new nn(1,"MagentaColourKey"),"FinalBoss3.png",94,42),kr(new nn(1,"MagentaColourKey"),"FinalBoss4.png",94,42),kr(new nn(1,"MagentaColourKey"),"FinalBoss5.png",94,42),kr(new nn(1,"MagentaColourKey"),"FinalBossSurrender0.png",16,35),kr(new nn(1,"MagentaColourKey"),"FinalBossSurrender1.png",16,35),kr(new nn(1,"MagentaColourKey"),"FinalBossActiveTarget.png",4,4),kr(new nn(1,"MagentaColourKey"),"FinalBossTarget.png",4,4),kr(new nn(1,"MagentaColourKey"),"ShipGunNozzle.png",16,8),kr(new nn(0,"NoColourKey"),"ShipGunStem.png",12,1),kr(new nn(1,"MagentaColourKey"),"ShipGunBullet.png",16,8),kr(new nn(0,"NoColourKey"),"IntermissionBackground.png",320,200),kr(new nn(0,"NoColourKey"),"VictoryScreen.png",320,200),kr(new nn(1,"MagentaColourKey"),"ColonelReceivingMedal.png",70,130),kr(new nn(1,"MagentaColourKey"),"ColonelSaluting.png",72,130),kr(new nn(1,"MagentaColourKey"),"ColonelStanding.png",50,130),kr(new nn(1,"MagentaColourKey"),"SoldierSaluting.png",54,120),kr(new nn(1,"MagentaColourKey"),"SoldierStanding.png",54,120),kr(new nn(1,"MagentaColourKey"),"Medal.png",7,16),kr(new nn(1,"MagentaColourKey"),"PresidentPresentingMedal.png",66,130),kr(new nn(1,"MagentaColourKey"),"PresidentSaluting.png",62,130),kr(new nn(1,"MagentaColourKey"),"PresidentStanding.png",39,130)]),vr=A([]),br=A([]);const Dr=Math.fround(320),Pr=(Math.fround(200),new rn(0,"FontID",0)),Br=new rn(0,"FontID",1),Hr=new rn(0,"FontID",2),xr=new rn(0,"FontID",3),Xr=new rn(0,"FontID",4),Fr=new tn(0,"ImageID",0),Gr=new tn(0,"ImageID",1),Or=new tn(0,"ImageID",2),Lr=new tn(0,"ImageID",3),Rr=new tn(0,"ImageID",4),Kr=new tn(0,"ImageID",5),Nr=new tn(0,"ImageID",6),jr=new tn(0,"ImageID",7),Ur=new tn(0,"ImageID",8),Vr=new tn(0,"ImageID",9),zr=new tn(0,"ImageID",10),Jr=new tn(0,"ImageID",11),_r=new tn(0,"ImageID",12),Yr=new tn(0,"ImageID",13),qr=new tn(0,"ImageID",14),Zr=new tn(0,"ImageID",15),$r=new tn(0,"ImageID",16),Qr=new tn(0,"ImageID",17),ni=new tn(0,"ImageID",18),ei=new tn(0,"ImageID",19),ti=new tn(0,"ImageID",20),ri=new tn(0,"ImageID",21),ii=new tn(0,"ImageID",22),oi=new tn(0,"ImageID",23),ai=new tn(0,"ImageID",24),ui=new tn(0,"ImageID",25),si=new tn(0,"ImageID",26),li=new tn(0,"ImageID",27),ci=new tn(0,"ImageID",28),fi=new tn(0,"ImageID",29),hi=new tn(0,"ImageID",30),di=new tn(0,"ImageID",31),gi=new tn(0,"ImageID",32),wi=new tn(0,"ImageID",33),pi=new tn(0,"ImageID",34),Si=new tn(0,"ImageID",35),mi=new tn(0,"ImageID",36),Mi=new tn(0,"ImageID",37),yi=new tn(0,"ImageID",38),Ti=new tn(0,"ImageID",39),Ii=new tn(0,"ImageID",40),Ci=new tn(0,"ImageID",41),Ai=new tn(0,"ImageID",42),ki=new tn(0,"ImageID",43),Ei=new tn(0,"ImageID",44),Wi=new tn(0,"ImageID",45),vi=new tn(0,"ImageID",46),bi=new tn(0,"ImageID",47),Di=new tn(0,"ImageID",48),Pi=(new tn(0,"ImageID",49),new tn(0,"ImageID",50)),Bi=new tn(0,"ImageID",51),Hi=new tn(0,"ImageID",52),xi=new tn(0,"ImageID",53),Xi=new tn(0,"ImageID",54),Fi=new tn(0,"ImageID",55),Gi=new tn(0,"ImageID",56),Oi=new tn(0,"ImageID",57),Li=new tn(0,"ImageID",58),Ri=new tn(0,"ImageID",59),Ki=new tn(0,"ImageID",60),Ni=new tn(0,"ImageID",61),ji=new tn(0,"ImageID",62),Ui=new tn(0,"ImageID",63),Vi=new tn(0,"ImageID",64),zi=new tn(0,"ImageID",65),Ji=new tn(0,"ImageID",66),_i=new tn(0,"ImageID",67),Yi=new tn(0,"ImageID",68),qi=new tn(0,"ImageID",69),Zi=new tn(0,"ImageID",70),$i=new tn(0,"ImageID",71),Qi=new tn(0,"ImageID",72),no=new tn(0,"ImageID",73),eo=new tn(0,"ImageID",74),to=new tn(0,"ImageID",75),ro=new tn(0,"ImageID",76),io=new tn(0,"ImageID",77),oo=new tn(0,"ImageID",78),ao=new tn(0,"ImageID",79),uo=new tn(0,"ImageID",80),so=new tn(0,"ImageID",81),lo=new tn(0,"ImageID",82),co=new tn(0,"ImageID",83),fo=new tn(0,"ImageID",84),ho=new tn(0,"ImageID",85),go=new tn(0,"ImageID",86),wo=new tn(0,"ImageID",87),po=Math.fround(16),So=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function mo(n,e){let t;return t=function(n,e){let t=new P,r=new P,i=e;for(;null!=i.tail;)if(null!=i.tail){const e=i.tail,o=n(i.head);switch(o.tag){case 1:r=new P(o.fields[0],r);break;case 2:break;default:t=new P(o.fields[0],t)}i=e}return[t,r]}(n,e),[ir(t[0]),ir(t[1])]}const Mo=[["T----------X-------------WWWW------WW-WW---","X-T--------X-T-T----------WW-----WWW-WWWW--","X----------X------W-------W->------WWW--WW-","X----------X------WW-T->--W----------------","X------X---X---T--WWW----------------------","->-WWW-X---X-----WWWW--------\x3e-----WW------","----\x3e--X--------WWWW--------------WWW------","--T-T--X------\x3e--------T--XX-----WWW---WWWW","T------X-----------------XXXX-----------WWW"],["WW-------X-----WWWWW-*---X---WWWWWWWWW-X","W--XXXXXXXXXX---W-W-W*->-X----W-WWW-W--X","W----------\x3e-------=======----------T--X","WW---XXXXXXXX----X--**>--X--X----X->X---","==--X--=====---\x3e-X--*-------X-------X--X","WW-X-----X->-----X-----**X>-X----X-----X","==------X>----------***--X-------X--T--X","W-T------X---\x3e----WW*--\x3e-X------XXX----X","W-XXXX---X------XXXX*----X-------X-----X"],["XXX--XX--XXXXXXXXXXXXX----X-WW---T-------WWWW","--X-X--XX--WWW--WWWW------X-W--T---*----WWWW-","---X--------WWWWW---------X-------***----W>W-","-----\x3e--------WWWWW-------X---XXX*****---WWWW","->-----------WWWWWW---X>--XT-----\x3e-------====","-----\x3e------\x3e-W====---X-------XXX*****---WWWW","---X------\x3e-=====WWW--X>----------***---\x3e====","--X-X--XX------WW-----X--------T---*-----WWW-","XXX--XX--XXXXXXXXXXXXXX---WWW----T-----WWWWW-"],["-WWWWW-X--X***--T-----X----WWWWWWWWWWWW--WW","W-WWW--X>-X***---WWT--X----WWWW-WWWWWW-WW--","----T--X--X***>-------X---===-----W--W-----","-X->X-----=-------X---X>----WWW==----------","----X--X--X>--\x3e---X>--X----=========-------","-X-----X-----------X>-------WWW==----------","-X--T--X--X***--T--X------WW>---------W----","XXX----X>-X***-T-T-X-------WWWWWWWWWWWWW---","-X-----X--X***-----X---*---WW****WWW*WW*WWW"]],yo=v((function(n,e){this.etx=0|n,this.ety=0|e}),F);const To=v((function(n,e,t){this.TilesHorizontally=0|n,this.TilesArray=e,this.EnemyTanks=t}),F);function Io(n){switch(n){case"*":return Hi;case"-":return xi;case"=":return Bi;case">":return xi;case"T":return Xi;case"W":return Fi;case"X":return Pi;default:return null}}function Co(n){return e=function(n){let e;return e=Io(n),null!=e},!De(n=>!e(n),n.split(""));var e}function Ao(n){if(n.length<9)return new dn(1,"Error","Map matrix file has insufficient rows.");if(function(n){if(n.length>=9){return Tr((function(e){return n[e].length===n[0].length}),ar(Xe(0,1,8)))}return!1}(n)){if(function(n){if(n.length>=9){return n.slice(0,9).every(Co)}return!1}(n)){let t;return t=$t((function(n){return"-----"+n+"-----"}),n.slice(0,9),Array),new dn(0,"Ok",new To(t[0].length,(e=t,Qt(ve((function(){return xe((function(n){let t;return t=xe((function(n){let e;return e=Io(n),hn(e,xi)}),e[n].split("")),r=t,Array.from(r);var r}),Xe(0,1,8))})),Array)),function(n){if(n.length>0){const e=0|n[0].length;return ar(ve((function(){return We((function(t){const r=n[t];return We((function(n){return">"===r[n]?Fe(new yo(n,t)):be()}),Xe(0,1,e-1))}),Xe(0,1,8))})))}return new P}(t)))}return new dn(1,"Error","The map matrix contains illegal characters.")}return new dn(1,"Error","The map matrix rows must all be the same length.");var e}function ko(n){let e;return e=Ao(Mo[n]),gn((function(e){return nt(Qe("TankMapDefinitions.[%d]: Error: %s"))(n)(e)}),e)}const Eo=v((function(n,e){this.NewPlayerName=n,this.NewPlayerScore=e}),F);const Wo=v((function(n,e,t){this.PlayerName=n,this.PlayerScore=e,this.PlayerScoreString=t}),F);function vo(n){return n.PlayerScore}function bo(n){let e;var t,r;return t=vo,r={Compare:m},e=yr((function(n,e){return r.Compare(t(e),t(n))>0?e:n}),n),vo(e)}function Do(n,e){if(p(n,new P))return!1;{let i,o;return t=vo,r={Compare:m},o=yr((function(n,e){return r.Compare(t(e),t(n))>0?n:e}),n),i=vo(o),e>=i}var t,r}function Po(n,e){if(Do(e,n.NewPlayerScore)){let t,r;return r=function(n,e,t){let r;const i=er(e,Array);return i.sort((function(e,r){return t.Compare(n(e),n(r))})),r=i,hr(r)}(vo,new P(new Wo(n.NewPlayerName.trim(),n.NewPlayerScore,n.NewPlayerScore.toString()),e),{Compare:m}),t=function(n){if(null!=n.tail)return n.tail;throw new Error("List was empty")}(r),Cr(vo,t,{Compare:m})}return e}function Bo(n,e){return lr((function(e){return function(n,e,t){const r=(0|n.length)+(0|e.length)+2|0;return r>t?"":n+" "+rt(t-r|0,(function(n){return"."}))+" "+e}(e.PlayerName,e.PlayerScoreString,n)}),e)}const Ho=v((function(n){this.GameScoreBoard=n}),F);function xo(){return new dn(0,"Ok",new Ho(function(n,e,t){let r;return r=cr((function(n,r){const i=e+(n>>>0)*t;return new Wo(r,i,i.toString())}),n),Cr(vo,r,{Compare:m})}(hr(["Bob","Scott","Lara","J"]),1e4,5e3)))}const Xo=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Fo=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function Go(n,e,t,r){return n(new Fo(0,"DrawImageWithTopLeftAtInt",e,t,r))}function Oo(n,e,t,r,i,o){return n(new Fo(2,"DrawStretchedImageWithTopLeftAt",e,t,r,i,o))}function Lo(n,e,t,r){let i;i=[r.EngineImageMetadata.ImageWidth,r.EngineImageMetadata.ImageHeight];const o=e-(0|~~(i[0]/2)),a=t-(0|~~(i[1]/2));return n(new Fo(2,"DrawStretchedImageWithTopLeftAt",o,a,r,i[0],i[1]))}function Ro(n,e,t,r,i,o){const a=0|r.length,u=i/a,s=Math.abs(~~(o/u))%a|0;s<a&&Lo(n,e,t,r[s])}function Ko(n,e,t,r,i,o){return n(new Fo(1,"DrawFilledRectangle",e,t,r,i,o))}function No(n,e,t,r,i){const o=~~r*i.CharWidth|0;return n(new Fo(3,"DrawSubImageStretchedToTarget",o,0,i.CharWidth,i.CharHeight,e,t,i.CharWidth,i.CharHeight,i.FontImageWithHostObject))}function jo(n,e,t,r,i,o,a){const u=br()[e.fields[0]];!function(n,e,t,r,i,o,a,u){const s=function(n){return n.length*e};let l=0|(1===a.tag?r-~~(s(o)/2):2===a.tag?r-s(o):r);const c=0|(1===u.tag?i-~~(t/2):2===u.tag?i-t:i);Be((function(t){const r=function(e){n(e,l,c)};t>="0"&&t<="9"?r(t.charCodeAt(0)-48):t>="A"&&t<="Z"?r(t.charCodeAt(0)-55):t>="a"&&t<="z"?r(t.charCodeAt(0)-87):"."===t&&r(36),l+=e}),o.split(""))}((function(e,t,r){No(n,t,r,e>>>0,u)}),u.CharWidth,u.CharHeight,i,o,a,t,r)}function Uo(n,e,t,r,i,o,a,u){const s=br()[e.fields[0]];let l=0|o,c=0|a,f=u;for(;f>0;)No(n,l,c,i,s),f-=1,l+=t,c+=r;return[l,c]}function Vo(n,e,t,r,i,o,a,u){var s;s=function(u,s){jo(n,e,t,r,i,o+a*u|0,s)},tr((function(n,e,t){s(n,t)}),null,u)}function zo(n,e){let t;let r;t=~~(e*Math.fround(5))%89-89|0,r=vr()[Fr.fields[0]];for(let e=1;e<=5;e++)Go(n,t,0,r),t+=89}const Jo=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const _o=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Yo=Math.fround(2),qo=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Zo=v((function(n,e,t,r){this.ScreenStartTime=n,this.GameGlobalState=e,this.HiScore=t,this.State=r}),F);function $o(n,e,t){const r=new qo(0,"GameTitleAwaitingFireButton");return new Zo(t,e,n,r)}const Qo=v((function(n,e){this.ptx=n,this.pty=e}),F);const na=v((function(n,e){this.modx=n,this.mody=e}),F);const ea=v((function(n,e,t,r){this.Left=n,this.Top=e,this.Right=t,this.Bottom=r}),F);function ta(n,e){return n.ptx<e.ptx}function ra(n,e){return n.ptx>e.ptx}function ia(n,e,t){return Math.abs(n.ptx-t.ptx)<e&&Math.abs(n.pty-t.pty)<e}function oa(n,e){return e.ptx>=n.Left&&e.ptx<=n.Right&&e.pty>=n.Top&&e.pty<=n.Bottom}function aa(n,e){return new Qo(e.ptx+n.modx,e.pty+n.mody)}const ua=Math.fround(20),sa=Math.fround(.30000001192092896),la=Math.fround(.30000001192092896),ca=new Qo(Math.fround(97),Math.fround(129)),fa=Math.fround(2),ha=new ea(Math.fround(134),Math.fround(35),Math.fround(147),Math.fround(47)),da=new ea(Math.fround(86),Math.fround(75),Math.fround(238),Math.fround(139)),ga=new ea(Math.fround(68),Math.fround(130),Math.fround(91),Math.fround(141));function wa(n,e,t){let r;return r=aa(function(n,e){const t=function(e,t){return e.Held&&t.Held?Math.fround(0):e.Held?-n:t.Held?n:Math.fround(0)};return new na(t(e.Left,e.Right),t(e.Up,e.Down))}(sa,e),n),i=r,Ir((function(n){return oa(n,i)}),t)?r:n;var i}function pa(n,e){const t=oa(da,r=e)?r:ca;var r;if(ia(t,Math.fround(1),n))return n;{let e;return e=function(n,e,t){var r,i;return new na((r=n.ptx-t.ptx)>e?e:r<Math.fround(0)?-e:Math.fround(0),(i=n.pty-t.pty)>e?e:i<Math.fround(0)?-e:Math.fround(0))}(t,la,n),aa(e,n)}}const Sa=v((function(n,e){this.Score=n,this.HiScore=e}),F);function ma(n,e){const t=e.Score+n;return new Sa(t,C(m,t,e.HiScore))}function Ma(n,e){return Ko(n,0,e,320,200-e,new Xo(0,"SolidColour",0))}function ya(n){return 2*n}const Ta=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Ia=v((function(n,e,t,r,i,o){this.BackgroundFont=n,this.BackgroundCharIndex=e,this.ForegroundFont=t,this.ForegroundCharIndex=r,this.SpacingX=i,this.SpacingY=o}),F);const Ca=v((function(n,e){this.BarTotal=n,this.BarValue=e}),F);function Aa(n,e,t,r,i){const o=I(m,i.BarTotal,i.BarValue),a=Uo(n,r.BackgroundFont,r.SpacingX,r.SpacingY,r.BackgroundCharIndex,e,t,o);Uo(n,r.ForegroundFont,r.SpacingX,r.SpacingY,r.ForegroundCharIndex,a[0],a[1],i.BarTotal-o)}const ka=new Ia(Xr,4,Xr,2,8,0),Ea=new Ia(Xr,3,Xr,1,8,0),Wa=new Ia(Xr,5,Xr,6,8,0),va=new Ia(Xr,7,Xr,7,8,0),ba=v((function(n,e,t,r,i,o,a,u){this.ScoreAndHiScore=n,this.ShipsPending=e,this.ShipsThrough=t,this.Tanks=r,this.Damage=i,this.MaxDamage=o,this.PlaneIntel=a,this.Elevation=u}),F);function Da(n,e,t){const r=e+4|0;var i,o,a,u,s,l,c;jo(n,Br,new Jo(0,"LeftAlign"),new _o(0,"TopAlign"),4,r,"SCORE"),i=n,o=Pr,a=new Jo(0,"LeftAlign"),u=new _o(0,"TopAlign"),s=68,l=r,c=t.ScoreAndHiScore.Score,jo(i,o,a,u,s,l,c.toString());const f=r+12|0;var h,d,g;if(jo(n,Br,new Jo(0,"LeftAlign"),new _o(0,"TopAlign"),4,f,"SHIPS"),Aa(n,68,f,ka,new Ca((h=t).ShipsThrough+h.ShipsPending,h.ShipsThrough)),t.MaxDamage>0){const e=r+24|0;jo(n,Br,new Jo(0,"LeftAlign"),new _o(0,"TopAlign"),4,e,"DAMAGE"),Aa(n,68,e,Wa,new Ca((d=t).MaxDamage,d.Damage))}if(null==t.PlaneIntel);else{const e=t.PlaneIntel;jo(n,Br,new Jo(0,"LeftAlign"),new _o(0,"TopAlign"),160,r,"INTEL"),Aa(n,208,r,va,new Ca(g=e,g))}const w=r+12|0;var p;jo(n,Br,new Jo(0,"LeftAlign"),new _o(0,"TopAlign"),160,w,"TANKS"),Aa(n,208,w,Ea,new Ca((p=t).Tanks,p.Tanks));const S=r+24|0;var m,M,y,T,I,C,A;jo(n,Br,new Jo(0,"LeftAlign"),new _o(0,"TopAlign"),160,S,"ELEVATION"),m=n,M=Hr,y=new Jo(0,"LeftAlign"),T=new _o(0,"TopAlign"),I=256,C=S,A=t.Elevation,jo(m,M,y,T,I,C,nt(Qe("%.1f"))(A))}const Pa=new Qo(Math.fround(290),Math.fround(15)),Ba=hr([new ea(Math.fround(38),Math.fround(7),Math.fround(310),Math.fround(19)),new ea(Math.fround(125),Math.fround(19),Math.fround(310),Math.fround(35)),new ea(Math.fround(133),Math.fround(35),Math.fround(310),Math.fround(41)),new ea(Math.fround(168),Math.fround(41),Math.fround(310),Math.fround(50)),new ea(Math.fround(200),Math.fround(49),Math.fround(310),Math.fround(139)),new ea(Math.fround(86),Math.fround(75),Math.fround(276),Math.fround(139)),ha,ga]),Ha=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const xa=v((function(n,e,t,r){this.ScoreAndHiScore=n,this.EnemyFleetCentre=e,this.AlliedState=t,this.NumShips=r}),F);function Xa(n,e){const t=new Ha(0,"MapInPlay",Pa);return new xa(e,ca,t,n)}function Fa(n,e,t){var r,i,o;switch(1===n.AlliedState.tag?1:3===n.AlliedState.tag||2===n.AlliedState.tag?2:0){case 0:{const a=wa(n.AlliedState.fields[0],e,Ba),u=pa(n.EnemyFleetCentre,a),s=(i=u,o=t,oa(ha,r=a)?new Ha(1,"FleetEngagedOnMap",r,o,new Ha(2,"ScreenOverEngagedSecretPassage")):ia(i,ua,r)?new Ha(1,"FleetEngagedOnMap",r,o,new Ha(3,"ScreenOverEngagedEnemyAtSea")):new Ha(0,"MapInPlay",r));return new xa(n.ScoreAndHiScore,u,s,n.NumShips)}case 1:return t-n.AlliedState.fields[1]>fa?new xa(n.ScoreAndHiScore,n.EnemyFleetCentre,n.AlliedState.fields[2],n.NumShips):n;case 2:return n}}const Ga=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function Oa(n,e,t){const r=e(t);let i;return i=pr((function(n){const t=e(n);return p(r,t)}),n),null==i}function La(n,e){return Tr(n,e)?e:Mr(n,e)}const Ra=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function Ka(n,e,t,r,i){const o=(t.ptx-e.ptx)/i,a=(t.pty-e.pty)/i;return function(t){const u=t-r;if(u>=Math.fround(0)){if(u<=i){const t=n(u,i),r=e.ptx+o*t,s=e.pty+a*t;return new Ra(1,"MOMVisibleAtPosition",new Qo(r,s))}return new Ra(2,"MOMDisappeared")}return new Ra(0,"MOMYetToAppear")}}const Na=v((function(n,e,t,r){this.PositionGetter=n,this.StartPosition=e,this.FinalPosition=t,this.EndGameTime=r}),F);function ja(n,e,t){return new Na(function(n,e,t){const r=e+t;return function(t){return t>=e?t<=r?new Ra(1,"MOMVisibleAtPosition",n):new Ra(2,"MOMDisappeared"):new Ra(0,"MOMYetToAppear")}}(n,e,t),n,n,e+t)}function Ua(n,e,t,r,i){return new Na(Ka(n,e,t,r,i),e,t,r+i)}function Va(n,e){const t=e.PositionGetter(n);switch(t.tag){case 0:return e.StartPosition;case 2:return e.FinalPosition;default:return t.fields[0]}}function za(n,e){return n<=e.EndGameTime}const Ja=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const _a=v((function(n,e,t,r){this.FlickBookDuration=n,this.FlickBookImages=e,this.VisibilityBeforeStart=t,this.VisibilityAfterEnd=r}),F);const Ya=v((function(n,e,t){this.FlickBookType=n,this.FlickBookStartTime=e,this.FlickBookMechanicsObject=t}),F);function qa(n){return n.FlickBookStartTime}function Za(n,e){return Va(n,e.FlickBookMechanicsObject)}function $a(n,e,t){return La((function(t){return r=n,i=e(t),za(r,i.FlickBookMechanicsObject);var r,i}),t)}function Qa(n,e){return $a(n,(function(n){return n}),e)}function nu(n,e,t){const r=t-e.FlickBookStartTime,i=0|e.FlickBookType.FlickBookImages.length,o=e.FlickBookMechanicsObject.PositionGetter(t);switch(o.tag){case 1:{const t=e.FlickBookType.FlickBookDuration/i,a=0|Math.abs(~~(r/t));a<i&&Lo(n,o.fields[0].ptx,o.fields[0].pty,e.FlickBookType.FlickBookImages[a]);break}case 2:p(e.FlickBookType.VisibilityAfterEnd,new Ja(0,"Visible"))&&i>0&&Lo(n,e.FlickBookMechanicsObject.FinalPosition.ptx,e.FlickBookMechanicsObject.FinalPosition.pty,e.FlickBookType.FlickBookImages[e.FlickBookType.FlickBookImages.length-1]);break;default:p(e.FlickBookType.VisibilityBeforeStart,new Ja(0,"Visible"))&&i>0&&Lo(n,e.FlickBookMechanicsObject.StartPosition.ptx,e.FlickBookMechanicsObject.StartPosition.pty,e.FlickBookType.FlickBookImages[0])}}function eu(n,e,t,r){fr((function(t){nu(n,e(t),r)}),t)}function tu(n,e,t){eu(n,(function(n){return n}),e,t)}const ru=Math.fround(4),iu=Math.fround(4),ou=Math.fround(10),au=Math.fround(3),uu=Math.fround(.75);function su(){return new _a(uu,$t((function(n){return vr()[n.fields[0]]}),[qr,Zr,$r,Qr],Array),new Ja(1,"Hidden"),new Ja(1,"Hidden"))}const lu=v((function(n,e,t){this.ShipsStillToNavigate=n,this.ShipsSuccess=e,this.Score=t}),F);const cu=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const fu=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const hu=v((function(n,e,t){this.ShipRotation=n,this.ShipSpeed=e,this.ShipCentre=t}),F);const du=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const gu=v((function(n){this.MineLocation=n}),F);const wu=v((function(n,e,t){this.TorpedoLaunchDetail=n,this.TorpedoPositionGetter=e,this.TorpedoIsHorizontal=t}),F);const pu=v((function(n,e,t,r,i){this.FleetStats=n,this.LiveTorpedos=e,this.Mines=t,this.Animations=r,this.Ship=i}),F);function Su(n,e){return e.Left.JustDown?function(n){switch(n.tag){case 1:return new cu(0,"FacingLeft");case 2:return new cu(1,"Facing1");case 3:return new cu(2,"Facing2");case 4:return new cu(3,"Facing3");default:return new cu(0,"FacingLeft")}}(n):e.Right.JustDown?function(n){switch(n.tag){case 1:return new cu(2,"Facing2");case 2:return new cu(3,"Facing3");case 3:case 4:return new cu(4,"FacingUp");default:return new cu(1,"Facing1")}}(n):n}function mu(n,e){return e.Up.JustDown?function(n){switch(n.tag){case 1:return new fu(2,"ShipMedium");case 2:case 3:return new fu(3,"ShipFast");default:return new fu(1,"ShipSlow")}}(n):e.Down.JustDown?function(n){switch(n.tag){case 1:return new fu(0,"ShipStationary");case 2:return new fu(1,"ShipSlow");case 3:return new fu(2,"ShipMedium");default:return new fu(0,"ShipStationary")}}(n):n}function Mu(n){switch(n.tag){case 1:return Math.fround(.9229999780654907);case 2:return Math.fround(.7070000171661377);case 3:return Math.fround(.382999986410141);case 4:return Math.fround(0);default:return Math.fround(1)}}function yu(n){switch(n.tag){case 1:return Math.fround(.382999986410141);case 2:return Math.fround(.7070000171661377);case 3:return Math.fround(.9229999780654907);case 4:return Math.fround(1);default:return Math.fround(0)}}function Tu(n,e,t){let r;return r=function(n){switch(n.tag){case 1:return Math.fround(.20000000298023224);case 2:return Math.fround(.4000000059604645);case 3:return Math.fround(.6000000238418579);default:return Math.fround(0)}}(t),new Qo(n.ptx+Mu(e)*-r,n.pty-yu(e)*r)}const Iu=hr([[.2,.352],[.404,.338],[.556,.196],[.294,.606],[.7,.336],[.264,.808],[.564,.688],[.812,.512],[.908,.662],[.87,.832]]);function Cu(){return lr((function(n){return function(n,e){let t,r;return r=vr()[Kr.fields[0]],t=[r.EngineImageMetadata.ImageWidth,r.EngineImageMetadata.ImageHeight],new gu(new Qo(n*t[0],e*t[1]))}(n[0],n[1])}),Iu)}const Au=hr([[[.086,.214],[.318,.082],Math.fround(5),Math.fround(1)],[[.086,.214],[.616,.214],Math.fround(4.099999904632568),Math.fround(2.5)],[[.132,.39],[.454,.126],Math.fround(6.199999809265137),Math.fround(2)],[[.132,.39],[.826,.39],Math.fround(5.300000190734863),Math.fround(3)],[[.17,.592],[.776,.312],Math.fround(7),Math.fround(3.5)],[[.17,.592],[.958,.592],Math.fround(7.099999904632568),Math.fround(2)],[[.206,.79],[.846,.41],Math.fround(7.199999809265137),Math.fround(3.5)],[[.206,.79],[.984,.79],Math.fround(8.300000190734863),Math.fround(1)],[[.382,.102],[.138,.336],Math.fround(6),Math.fround(1)],[[.698,.204],[.078,.204],Math.fround(6.400000095367432),Math.fround(2.5)],[[.698,.204],[.152,.49],Math.fround(6.5),Math.fround(2.5)],[[.884,.454],[.13,.454],Math.fround(7.599999904632568),Math.fround(1.5)],[[.962,.608],[.26,.914],Math.fround(7.699999809265137),Math.fround(3)],[[.962,.608],[.178,.608],Math.fround(7.800000190734863),Math.fround(1)]]);function ku(n,e,t,r,i){let o,a;a=vr()[Kr.fields[0]],o=[a.EngineImageMetadata.ImageWidth,a.EngineImageMetadata.ImageHeight];const u=n[0]*o[0],s=e[0]*o[0],l=n[1]*o[1],c=e[1]*o[1],f=i+r;return new wu([n,e,t,r],Ka((function(n,e){return n}),new Qo(u,l),new Qo(s,c),f,t),l===c)}function Eu(n,e){return ku(n.TorpedoLaunchDetail[0],n.TorpedoLaunchDetail[1],n.TorpedoLaunchDetail[2],n.TorpedoLaunchDetail[3],e)}function Wu(){let n,e;return e=vr()[Kr.fields[0]],n=[e.EngineImageMetadata.ImageWidth,e.EngineImageMetadata.ImageHeight],new hu(new cu(0,"FacingLeft"),new fu(0,"ShipStationary"),new Qo(Math.fround(.8859999775886536)*n[0],Math.fround(.9380000233650208)*n[1]))}function vu(n,e,t,r){const i=Math.fround(10),o=Mu(e),a=yu(e),u=function(n,e){return new Qo(n.ptx+o*e,n.pty+a*e)},s=t(r,u(n,i*Math.fround(1))),l=t(s,n);return t(l,u(n,i*Math.fround(-1)))}function bu(n,e,t){return vu(n.ShipCentre,n.ShipRotation,(function(n,r){return!!n||ia(e,t,r)}),!1)}function Du(n,e){return new Ya(su(),e,ja(n,e,uu))}function Pu(n,e,t,r){switch(t.tag){case 1:case 3:return[e,t];case 0:{let i;return i=rr((function(n,e){return i=bu(t.fields[0],e.MineLocation,iu)?e.MineLocation:null,o=n[1],a=n[0],u=r,null==i?[a,o]:[new P(Du(i,u),a),new du(2,"ShipExploding",u)];var i,o,a,u}),[e,t],n),[i[0],i[1]]}default:return[e,t]}}const Bu=[Math.fround(0),hr([[Math.fround(.02199999988079071),Math.fround(0)],[Math.fround(.13199999928474426),Math.fround(.3799999952316284)],[Math.fround(.22200000286102295),Math.fround(.8899999856948853)],[Math.fround(.3199999928474426),Math.fround(1)]])],Hu=[Math.fround(1),hr([[Math.fround(.23999999463558197),Math.fround(0)],[Math.fround(.335999995470047),Math.fround(.11599999666213989)],[Math.fround(.6959999799728394),Math.fround(.20000000298023224)],[Math.fround(1),Math.fround(.7260000109672546)],[Math.fround(1),Math.fround(1)]])];function xu(n,e,t){let r,i;i=vr()[Kr.fields[0]],r=[i.EngineImageMetadata.ImageWidth,i.EngineImageMetadata.ImageHeight];const o=t/r[1];let a,u;return u=gr((function(n){return o<n[0][1]||o>n[1][1]?null:(e=n[0][1],t=n[0][0],r=n[1][1],i=n[1][0],t+(i-t)/(r-e)*(o-e));var e,t,r,i}),function(n){const e=function(n,e,t){for(;;){const r=n,i=e,o=t;if(null==r.tail)return hr(i);{let a=i;nr([o,r.head],a),n=r.tail,e=i,t=r.head}}};var t,r,i,o;switch(null!=n.tail&&null!=n.tail.tail?(t=1,r=n.head,i=n.tail.head,o=n.tail.tail):t=0,t){case 0:return new P;case 1:{const n=[];return nr([r,i],n),k(2,e,[o])(n)(i)}}}(e)),a=hn(u,n),new Qo(a*r[0],t)}function Xu(n,e,t,r){return vu(n.ShipCentre,n.ShipRotation,(function(n,i){if(null==n){const n=xu(t,r,i.pty);return e(i,n)?i:null}return n}),null)}function Fu(n,e){switch(n.tag){case 1:case 3:return n;case 0:return n.fields[0].ShipCentre.pty<ou?new du(1,"ShipGotThrough",e,n.fields[0]):n;default:return n}}function Gu(n,e,t){let r,i,o,a;var u,s;switch(r=vr()[Nr.fields[0]],i=vr()[_r.fields[0]],o=vr()[Yr.fields[0]],a=vr()[Kr.fields[0]],Go(n,0,0,a),Ma(n,a.EngineImageMetadata.ImageHeight),fr((function(e){Lo(n,e.MineLocation.ptx,e.MineLocation.pty,r)}),t.Mines),fr((function(t){const r=t.TorpedoPositionGetter(e);switch(r.tag){case 2:break;case 1:{const e=t.TorpedoIsHorizontal?i:o;Lo(n,r.fields[0].ptx,r.fields[0].pty,e);break}}}),t.LiveTorpedos),2===t.Ship.tag?u=0:1===t.Ship.tag?(u=1,s=t.Ship.fields[1]):0===t.Ship.tag?(u=1,s=t.Ship.fields[0]):u=0,u){case 1:Lo(n,s.ShipCentre.ptx,s.ShipCentre.pty,function(n){const e=1===n.tag?Ur:2===n.tag?Vr:3===n.tag?zr:4===n.tag?Jr:jr;return vr()[e.fields[0]]}(s.ShipRotation))}tu(n,t.Animations,e);const l=new ba(t.FleetStats.Score,t.FleetStats.ShipsStillToNavigate,t.FleetStats.ShipsSuccess,ya(t.FleetStats.ShipsSuccess),0,0,null,Math.fround(0));Da(n,a.EngineImageMetadata.ImageHeight,l)}function Ou(n,e,t){const r=new lu(e,0,n),i=(o=t,cr((function(n,e){return ku(e[0],e[1],e[2],e[3],o)}),Au));var o;const a=new du(0,"ShipInPlay",Wu()),u=new P;return new pu(r,i,Cu(),u,a)}function Lu(n,e,t){const r=function(n,e,t){const r=new lu(n.ShipsStillToNavigate-1,e,t);return[r,0===r.ShipsStillToNavigate?new du(3,"SecretPassageScreenOver"):new du(0,"ShipInPlay",Wu())]};if(!function(n,e){var t,r;switch(n.tag){case 0:t=0;break;case 2:case 1:t=1,r=n.fields[0];break;default:t=0}switch(t){case 0:return!1;case 1:return e>r+au}}(e,t))return[n,e];switch(e.tag){case 3:throw new Error("should not happen");case 2:return r(n,n.ShipsSuccess,n.Score);case 1:return r(n,n.ShipsSuccess+1,ma(3e3,n.Score));default:throw new Error("should not happen")}}function Ru(n,e,t){if(3===n.Ship.tag)return n;{const i=function(n,e){var t,r,i;switch(n.tag){case 2:return n;case 1:return new du(1,"ShipGotThrough",n.fields[0],(t=Tu(n.fields[1].ShipCentre,n.fields[1].ShipRotation,n.fields[1].ShipSpeed),new hu(n.fields[1].ShipRotation,n.fields[1].ShipSpeed,t)));case 3:return n;default:return new du(0,"ShipInPlay",(r=Tu(n.fields[0].ShipCentre,n.fields[0].ShipRotation,n.fields[0].ShipSpeed),i=mu(n.fields[0].ShipSpeed,e),new hu(Su(n.fields[0].ShipRotation,e),i,r)))}}(n.Ship,e);let o,a;r=t,o=lr((function(n){return 2===n.TorpedoPositionGetter(r).tag?Eu(n,r):n}),n.LiveTorpedos),a=Qa(t,n.Animations);const u=function(n,e,t,r){switch(t.tag){case 1:case 3:return[n,e,t];case 0:{let i;return i=rr((function(n,e){let i;const o=e.TorpedoPositionGetter(r);switch(o.tag){case 2:i=null;break;case 1:i=bu(t.fields[0],o.fields[0],ru)?o.fields[0]:null;break;default:i=null}if(null==i)return[new P(e,n[0]),n[1],n[2]];{const t=i;return[new P(Eu(e,r),n[0]),new P(Du(t,r),n[1]),new du(2,"ShipExploding",r)]}}),[new P,e,t],n),[i[0],i[1],i[2]]}default:return[n,e,t]}}(o,a,i,t),s=Pu(n.Mines,u[1],u[2],t),l=function(n,e,t){switch(e.tag){case 1:case 3:return[n,e];case 0:{let r;if(r=hn(Xu(e.fields[0],ta,Bu[0],Bu[1]),Xu(e.fields[0],ra,Hu[0],Hu[1])),null!=r){return[new P(Du(r,t),n),new du(2,"ShipExploding",t)]}return[n,e]}default:return[n,e]}}(s[0],s[1],t),c=Fu(l[1],t),f=Lu(n.FleetStats,c,t);return new pu(f[0],u[0],n.Mines,l[0],f[1])}var r}const Ku=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Nu=new Qo(Math.fround(124),Math.fround(75)),ju=new P(new ea(Math.fround(86),Math.fround(75),Math.fround(276),Math.fround(139)),new P),Uu=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Vu=v((function(n,e,t,r){this.ScoreAndHiScore=n,this.ShipsThrough=e,this.AlliedState=t,this.EnemyFleetCentre=r}),F);function zu(n,e){return new Vu(n,e,new Uu(0,"AlliedFleetInPlay",Nu),ca)}function Ju(n,e,t){if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[1]>fa){const e=new Uu(2,"PostPassageScreenOver");return new Vu(n.ScoreAndHiScore,n.ShipsThrough,e,n.EnemyFleetCentre)}return n}if(2===n.AlliedState.tag)return n;{const o=wa(n.AlliedState.fields[0],e,ju),a=pa(n.EnemyFleetCentre,o),u=(i=t,ia(a,ua,r=o)?new Uu(1,"Paused",r,i):new Uu(0,"AlliedFleetInPlay",r));return new Vu(n.ScoreAndHiScore,n.ShipsThrough,u,a)}var r,i}const _u=v((function(n,e){this.ShellMechanicsObject=n,this.ShellStartTime=e}),F);const Yu=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const qu=v((function(n,e,t,r,i,o,a,u,s,l){this.GunType=n,this.GunLeftExtent=e,this.GunRightExtent=t,this.GunStepRatePerSecond=r,this.HighestShellY=i,this.GunRepeatTime=o,this.GunShellDuration=a,this.GunLowestElevation=u,this.GunHighestElevation=s,this.GunElevationStepRate=l}),F);const Zu=v((function(n,e,t,r,i){this.GunTraits=n,this.GunCentreX=e,this.GunElevation=t,this.Shells=r,this.LastFireTime=i}),F);function $u(n,e,t,r,i){const o=(a=r,new qu(n,Math.fround(20),Math.fround(300),Math.fround(80),Math.fround(0),Math.fround(.5),Math.fround(.699999988079071),Math.fround(5),Math.fround(80),a));var a;return new Zu(o,e,t,new P,i-o.GunRepeatTime)}function Qu(n){const e=po*Math.fround(.6000000238418579);return[n-e,n+e]}function ns(n,e){const t=e.GunElevation/Math.fround(10),r=~~(Math.fround(9.5)+Math.fround(.15199999511241913)*t),i=~~(Math.fround(15.5)+Math.fround(.10400000214576721)*t);return[i,r,n-i,n-(i+r)]}function es(n,e,t,r){const i=function(r){const i=ns(e,t),o=r-(6,6),a=r-(8,8);Oo(n,o,i[2],vr()[to.fields[0]],12,0|~~(i[0]+Math.fround(.5))),Oo(n,a,i[3],vr()[eo.fields[0]],16,0|~~(i[1]+Math.fround(.5)))};if(1===t.GunTraits.GunType.tag){const n=Qu(t.GunCentreX);i(n[0]),i(n[1])}else i(t.GunCentreX);fr((function(e){const i=e.ShellMechanicsObject.PositionGetter(r);if(1===i.tag){const a=Math.fround(1)-(o=t.GunTraits,(r-e.ShellStartTime)/o.GunShellDuration),u=a*Math.fround(12)+Math.fround(4),s=a*Math.fround(5)+Math.fround(1),l=i.fields[0].ptx-u/Math.fround(2),c=i.fields[0].pty-s/Math.fround(2);Oo(n,l,c,vr()[ro.fields[0]],0|~~(u+Math.fround(.5)),0|~~(s+Math.fround(.5)))}var o}),t.Shells)}function ts(n,e,t,r,i){const o=n.Up.Held&&n.Down.Held?i.GunElevation:n.Up.Held?C(m,i.GunTraits.GunLowestElevation,i.GunElevation-i.GunTraits.GunElevationStepRate*t):n.Down.Held?I(m,i.GunTraits.GunHighestElevation,i.GunElevation+i.GunTraits.GunElevationStepRate*t):i.GunElevation,a=n.Left.Held&&n.Right.Held?i.GunCentreX:n.Left.Held?C(m,i.GunTraits.GunLeftExtent,i.GunCentreX-i.GunTraits.GunStepRatePerSecond*t):n.Right.Held?I(m,i.GunTraits.GunRightExtent,i.GunCentreX+i.GunTraits.GunStepRatePerSecond*t):i.GunCentreX;let u;const s=e-i.LastFireTime;if(n.Fire.JustDown&&s>i.GunTraits.GunRepeatTime){const n=function(n){return function(n,e,t,r){const i=ns(e,t),o=new Qo(n,i[3]),a=new Qo(n,function(n,e,t){const r=n.GunHighestElevation-t,i=(e-n.HighestShellY)/n.GunHighestElevation;return n.HighestShellY+r*i}(t.GunTraits,i[3],t.GunElevation));return new _u(Ua((function(n,e){let t;let r,i,o;return t=n/e,o=function(n){let e,t;return t=Math.fround(1)-n,e=t*t,Math.fround(1)-e}(t),i=e*o,r=i,r}),o,a,r,t.GunTraits.GunShellDuration),r)}(n,r,i,e)};if(1===i.GunTraits.GunType.tag){const t=Qu(i.GunCentreX);u=[new P(n(t[0]),new P(n(t[1]),i.Shells)),e]}else{u=[new P(n(i.GunCentreX),i.Shells),e]}}else u=[i.Shells,i.LastFireTime];return new Zu(i.GunTraits,a,o,u[0],u[1])}function rs(n,e){let t;var r,i;return r=function(n){return n.ShellMechanicsObject},i=n,t=La((function(n){const e=r(n);return za(i,e)}),e.Shells),new Zu(e.GunTraits,e.GunCentreX,e.GunElevation,t,e.LastFireTime)}const is=Math.fround(3),os=Math.fround(6),as=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function us(n){return n<=Math.fround(45)?n:Math.fround(90)-n}function ss(n){let e,t;e=us(n);const r=Math.fround(0),i=Math.fround(45),o=Math.fround(1);let a,u;t=e*((Math.fround(0)-o)/(i-r))+o,a=t*t;const s=Math.fround(0),l=Math.fround(1),c=Math.fround(100);return u=a*((Math.fround(148)-c)/(l-s))+c,u+Math.fround(.5)}const ls=v((function(n,e,t,r,i){this.CentreX=n,this.BaseY=e,this.ShipImage=t,this.SinkStartTime=r,this.ElevationToHit=i}),F);function cs(n,e,t){return new ls(n,ss(t),e,null,t)}function fs(){return hr([cs(Math.fround(29),vr()[Ei.fields[0]],Math.fround(44)),cs(Math.fround(143),vr()[Wi.fields[0]],Math.fround(39.5)),cs(Math.fround(198),vr()[vi.fields[0]],Math.fround(36.5)),cs(Math.fround(248),vr()[bi.fields[0]],Math.fround(41)),cs(Math.fround(288),vr()[Di.fields[0]],Math.fround(32.5))])}function hs(n,e){return La((function(e){return function(n,e){if(null!=e.SinkStartTime){return n-e.SinkStartTime<=os}return!0}(n,e)}),e)}function ds(n,e,t){fr((function(e){let r,i;if(null!=e.SinkStartTime){const n=e.SinkStartTime;r=I(m,t-n,os)/os*e.ShipImage.EngineImageMetadata.ImageHeight}else r=Math.fround(0);i=e.ShipImage.EngineImageMetadata.ImageWidth;const o=e.ShipImage.EngineImageMetadata.ImageHeight-~~(r+Math.fround(.5))|0,a=e.CentreX-e.ShipImage.EngineImageMetadata.ImageWidth/Math.fround(2),u=e.BaseY-(e.ShipImage.EngineImageMetadata.ImageHeight-r);let s;s=o;const l=new Fo(3,"DrawSubImageStretchedToTarget",0,0,i,o,a,u,e.ShipImage.EngineImageMetadata.ImageWidth,s,e.ShipImage);n(l)}),e)}function gs(n){let e,t,r;e=vr()[Ii.fields[0]],t=e.EngineImageMetadata.ImageWidth,r=e.EngineImageMetadata.ImageHeight;const i=new _a(is,[vr()[Ci.fields[0]],vr()[Ai.fields[0]],vr()[Ai.fields[0]],vr()[ki.fields[0]],vr()[ki.fields[0]]],new Ja(1,"Hidden"),new Ja(1,"Hidden")),o=ja(new Qo(t/Math.fround(2),r/Math.fround(2)),n,is);return new Ya(i,n,o)}function ws(n){jo(n,xr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,75,"STAGE COMPLETE")}function ps(n){jo(n,xr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,75,"SHIP DESTROYED")}const Ss=v((function(n,e){this.ExplosionsList=n,this.TotalScore=e}),F);function ms(n,e,t,r,i,o,a,u){let s;if(s=Mr((function(n){return t(n[0],n[1])}),ar(function(n,e){let t=!0;const r=[];return We(n=>t?(t=!1,xe(e=>(r.push(e),[n,e]),e)):r.map(e=>[n,e]),n)}(n,e))),null==s.tail)return[n,e,o,a];{let t,l,c,f,h,g;let w;return t=or((function(n,e){return[new P(n[0],e[0]),new P(n[1],e[1])]}),s,[new P,new P]),l=Ar(r,t[0],{Equals:p,GetHashCode:d}),c=Ar(i,t[1],{Equals:p,GetHashCode:d}),f=Mr((function(n){return Oa(l,r,n)}),n),h=Mr((function(n){return Oa(c,i,n)}),e),w=rr((function(n,e){const t=u(e);return new Ss(new P(t[0],n.ExplosionsList),n.TotalScore+t[1])}),new Ss(o,0),l),g=[w.ExplosionsList,w.TotalScore],[f,h,g[0],ma(g[1],a)]}}const Ms=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const ys=Math.fround(30),Ts=Math.fround(160),Is=Math.fround(6),Cs=Math.fround(4),As=Math.fround(.75),ks=Math.fround(6),Es=Math.fround(3),Ws=Math.fround(5),vs=Math.fround(1),bs=Math.fround(150),Ds=Math.fround(30);function Ps(n){return $t((function(n){return vr()[n.fields[0]]}),n,Array)}const Bs=v((function(n,e){this.PlaneFlickBookInstance=n,this.PlaneHasReleasedBombs=e}),F);const Hs=v((function(n,e,t,r,i,o,a,u,s,l,c,f){this.ScoreAndHiScore=n,this.ShipsRemaining=e,this.Planes=t,this.PlaneBombs=r,this.PlanesRemaining=i,this.GunAim=o,this.AlliedState=a,this.SkyExplosion=u,this.Explosions=s,this.EnemyShips=l,this.Damage=c,this.LastSortieAt=f}),F);function xs(n){return n.PlaneFlickBookInstance}function Xs(n,e){const t=new _a(As,Ps([di,gi,wi]),new Ja(1,"Hidden"),new Ja(0,"Visible")),r=ja(n,e,As);return new Ya(t,e,r)}function Fs(n,e,t,r,i){return ms(n,e,(function(n,e){return function(n,e,t){if(za(n,e.ShellMechanicsObject))return!1;{let r,i;return i=xs(t),r=Za(n,i),ia(r,Is,e.ShellMechanicsObject.FinalPosition)}}(i,n,e)}),(function(n){return n.ShellStartTime}),(function(n){return n.PlaneFlickBookInstance.FlickBookStartTime}),t,r,(function(n){let e;return e=Va(i,n.ShellMechanicsObject),[Xs(e,i),2e3]}))}function Gs(n){const e=~~n%4|0;return 0===e?[function(){return new _a(ks,Ps([ni,ei,ti,ri,oi,si,fi]),new Ja(1,"Hidden"),new Ja(0,"Visible"))},Math.fround(-50)]:1===e?[function(){return new _a(ks,Ps([ni,ei,ti,ri,ai,li,hi]),new Ja(1,"Hidden"),new Ja(0,"Visible"))},Math.fround(50)]:[function(){return new _a(ks,Ps([ni,ei,ti,ri,ii,ui,ci]),new Ja(1,"Hidden"),new Ja(0,"Visible"))},Math.fround(0)]}function Os(n){const e=Gs(n),t=~~n%24*10+40,r=t+e[1];return new Bs(new Ya(e[0](),n,Ua((function(n,e){let t;let r,i,o;var a;return t=n/e,o=(a=t)*a,i=e*o,r=i,r}),new Qo(t,Math.fround(90)),new Qo(r,Math.fround(-14)),n,ks)),!1)}function Ls(n,e){let t;t=Za(e,n.PlaneFlickBookInstance);const r=new Qo(t.ptx,bs);return new Ya(new _a(vs,Ps([Si,mi,Mi,yi,Ti]),new Ja(1,"Hidden"),new Ja(0,"Visible")),e,Ua((function(n,e){let t;let r,i,o;var a;return t=n/e,o=(a=t)*a,i=e*o,r=i,r}),t,r,e,vs))}function Rs(n,e,t){return rr((function(e,t){if(t.PlaneHasReleasedBombs)return[e[0],new P(t,e[1])];if(n-t.PlaneFlickBookInstance.FlickBookStartTime>=Es){return[new P(Ls(t,n),e[0]),new P(new Bs(t.PlaneFlickBookInstance,!0),e[1])]}return[e[0],new P(t,e[1])]}),[e,new P],t)}function Ks(n,e,t,r){let i;i=1===n.tag?20:40;const o=$u(new Yu(1,"DoubleBarrelGun"),Ts,ys,Ds,r),a=new as(0,"AlliedShipInPlay"),u=new P,s=new P,l=fs();return new Hs(e,t,new P,new P,i,o,a,s,u,l,0,Math.fround(0))}function Ns(n,e,t,r){if(2===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>Cs){const e=new as(3,"AirOrSeaBattleScreenOver");return new Hs(n.ScoreAndHiScore,n.ShipsRemaining,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,n.SkyExplosion,n.Explosions,n.EnemyShips,n.Damage,n.LastSortieAt)}return n}if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>Cs){if(n.ShipsRemaining>1){const e=new as(0,"AlliedShipInPlay"),t=n.ShipsRemaining-1,r=new P;return new Hs(n.ScoreAndHiScore,t,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,r,n.Explosions,n.EnemyShips,0,n.LastSortieAt)}{const e=new as(3,"AirOrSeaBattleScreenOver"),t=new P;return new Hs(n.ScoreAndHiScore,0,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,t,n.Explosions,n.EnemyShips,n.Damage,n.LastSortieAt)}}return n}if(3===n.AlliedState.tag)return n;if(0===n.PlanesRemaining&&null==n.Planes.tail){const e=new as(2,"WonScreen",t);return new Hs(n.ScoreAndHiScore,n.ShipsRemaining,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,n.SkyExplosion,n.Explosions,n.EnemyShips,n.Damage,n.LastSortieAt)}{let s;let l,c,f;s=0|vr()[Ii.fields[0]].EngineImageMetadata.ImageHeight,l=Qa(t,n.Explosions),c=Qa(t,n.SkyExplosion),f=$a(t,xs,n.Planes);const h=0|ur(n.PlaneBombs);let d;d=Qa(t,n.PlaneBombs);const g=0|ur(d),w=n.Damage+(h-g>>>0),p=ts(e,t,r,s,n.GunAim),S=Rs(t,d,f),m=(i=t,o=n.PlanesRemaining,a=n.LastSortieAt,u=S[1],o>0&&i>a+Ws&&ur(u)<3?[o-1,i,new P(Os(i),u)]:[o,a,u]),M=w>=5?[new as(1,"ShipSinking",t),new P(gs(t),new P)]:[n.AlliedState,c],y=Fs(p.Shells,m[2],l,n.ScoreAndHiScore,t);let T;return T=rs(t,new Zu(p.GunTraits,p.GunCentreX,p.GunElevation,y[0],p.LastFireTime)),new Hs(y[3],n.ShipsRemaining,y[1],S[0],m[0],T,M[0],M[1],y[2],n.EnemyShips,w,m[1])}var i,o,a,u}const js=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Us=v((function(n,e){this.ToDoTime=n,this.ToDoData=e}),F);function Vs(n,e){return new Us(n,e)}const zs=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function Js(n,e,t){const r=function(n,e){return n>=e.ToDoTime};if(Ir(k(1,r,[n]),t[1])){let o,a;return a=ir(t[1]),o=rr((function(t,i){if(r(n,i)){const r=e(t[0],i.ToDoData,n);return 1===r.tag?[r.fields[0],sr(r.fields[1],t[1])]:[r.fields[0],t[1]]}return[t[0],new P(i,t[1])]}),[t[0],new P],a),[(i=o)[0],ir(i[1])]}return[t[0],t[1]];var i}const _s=Math.fround(30),Ys=Math.fround(160),qs=Math.fround(4),Zs=(Math.fround(.75),Math.fround(6),Math.fround(.20000000298023224)),$s=Math.fround(3.5),Qs=Math.fround(.30000001192092896),nl=Math.fround(155),el=Math.fround(140),tl=Math.fround(4),rl=Math.fround(10),il=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const ol=v((function(n){this.HitShipX=n}),F);const al=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const ul=v((function(n,e,t,r,i,o,a,u,s,l,c,f,h,d){this.ScoreAndHiScore=n,this.ShipsRemaining=e,this.GunAim=t,this.AlliedState=r,this.AlliedCountToSink=0|i,this.EnemyShips=o,this.Decoratives=a,this.SkyExplosion=u,this.PendingIncoming=s,this.PendingDamage=l,this.PendingHits=c,this.PendingMessageTexts=f,this.PendingScoreChanges=h,this.MessageText=d}),F);function sl(n){return $t((function(n){return vr()[n.fields[0]]}),n,Array)}function ll(n,e,t){const r=new _a(Zs,sl([pi]),new Ja(1,"Hidden"),new Ja(1,"Hidden")),i=ja(new Qo(e,t),n,Zs);return new Ya(r,n,i)}function cl(n,e){return pr((function(n){const t=n.ShipImage.EngineImageMetadata.ImageWidth/Math.fround(2);return null==n.SinkStartTime&&(r=n.CentreX,i=t,o=e,Math.abs(r-o)<i);var r,i,o}),n)}function fl(n,e,t,r){const i=n.BaseY-n.ShipImage.EngineImageMetadata.ImageHeight,o=t?nl:el,a=new _a(Math.fround(.699999988079071),sl([Si,mi]),new Ja(1,"Hidden"),new Ja(1,"Hidden")),u=new _a(Math.fround(.699999988079071),sl([yi,Ti]),new Ja(1,"Hidden"),new Ja(1,"Hidden")),s=r+a.FlickBookDuration+Qs,l=s+u.FlickBookDuration,c=l+$s,f=new Ya(a,r,Ua((function(n,e){let t;let r,i,o;var a;return t=n/e,o=(a=t)*a,i=e*o,r=i,r}),new Qo(n.CentreX,i),new Qo(n.CentreX,Math.fround(-10)),r,a.FlickBookDuration)),h=new Ya(u,s,Ua((function(n,e){let t;let r,i,o;var a;return t=n/e,o=(a=t)*a,i=e*o,r=i,r}),new Qo(n.CentreX,Math.fround(-100)),new Qo(n.CentreX,o),s,u.FlickBookDuration)),d=t?e:new P(ll(l,n.CentreX,o),e);return[new P(f,new P(h,d)),l,c]}function hl(n,e){let t;t=0|vr()[pi.fields[0]].EngineImageMetadata.ImageHeight;const r=ss(n.GunElevation)-t/Math.fround(2);return ll(e,n.GunCentreX,r)}const dl=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function gl(n,e,t,r){var i,o,a,u,s,l,c;if(n.Fire.JustDown){const n=r+e.GunTraits.GunShellDuration*Math.fround(2);let f;if(f=cl(t,e.GunCentreX),null!=f){const t=f,r=function(n,e){const t=~~us(n.GunElevation)-~~e.ElevationToHit|0;return 0===t?new dl(0,"DirectHit"):t<0?new dl(2,"TooNearBy",Wn(t)):new dl(1,"TooFarBy",t)}(e,t),h=2===r.tag?[null,(o=100*Math.abs(r.fields[0])|0,a=nt(Qe("%dM SHORT")),i=a(o),Vs(n,i)),null]:1===r.tag?[null,(s=100*Math.abs(r.fields[0])|0,l=nt(Qe("%dM LONG")),u=l(s),Vs(n,u)),null]:[(c=new ol(t.CentreX),Vs(n,c)),Vs(n,"DIRECT HIT"),Vs(n,2e3)],d=2===r.tag?hl(e,n):(r.tag,null);return[h[0],h[1],h[2],d]}return[null,null,null,hl(e,n)]}return[null,null,null,null]}function wl(n,e,t){return new ul(n,e,$u(new Yu(1,"DoubleBarrelGun"),Ys,_s,rl,t),new as(0,"AlliedShipInPlay"),5,fs(),new P,new P,new P(Vs(t,new al(0,"IncomingChange",null)),new P),new P,new P,new P,new P,"")}function pl(n,e,t,r){if(2===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>qs){const e=new as(3,"AirOrSeaBattleScreenOver");return new ul(n.ScoreAndHiScore,n.ShipsRemaining,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText)}return n}if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>qs){if(n.ShipsRemaining>1){const e=new as(0,"AlliedShipInPlay"),t=n.ShipsRemaining-1;return new ul(n.ScoreAndHiScore,t,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText)}{const e=new as(3,"AirOrSeaBattleScreenOver");return new ul(n.ScoreAndHiScore,0,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText)}}return n}if(3===n.AlliedState.tag)return n;if(null==n.EnemyShips.tail){const e=new as(2,"WonScreen",t);return new ul(n.ScoreAndHiScore,n.ShipsRemaining,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText)}{let i,o,a,u;i=Qa(t,n.SkyExplosion),o=Qa(t,n.Decoratives),a=hs(t,n.EnemyShips),u=0|vr()[Ii.fields[0]].EngineImageMetadata.ImageHeight;const s=ts(e,t,r,u,n.GunAim);let l,c,f,h,d,g;l=Js(t,(function(n,e,t){return function(n,e,t,r,i,o){var a,u,s;if(null!=n.tail){if(null!=n.head.SinkStartTime)return new zs(1,"PendingDoneWithAdditionalToDos",[n,e,t,r],new P((a=new al(0,"IncomingChange",null),Vs(o+tl,a)),new P));{const t=1===r,i=fl(n.head,e,t,o),a=t?new P((u=new il(0,"DamageChange",null),Vs(i[1],u)),new P):new P,l=r-1|0;return new zs(1,"PendingDoneWithAdditionalToDos",[n,i[0],a,l],new P((s=new al(0,"IncomingChange",null),Vs(i[2],s)),new P))}}return new zs(0,"PendingDone",[n,e,t,r])}(n[0],n[1],n[2],n[3],0,t)}),[[a,o,n.PendingDamage,n.AlliedCountToSink],n.PendingIncoming]),c=Js(t,(function(n,e,t){return new zs(0,"PendingDone",[new as(1,"ShipSinking",t),new P(gs(t),new P),5])}),[[n.AlliedState,i,l[0][3]],l[0][2]]),f=Js(t,(function(n,e,t){return new zs(0,"PendingDone",(r=t,i=e.HitShipX,lr((function(n){if(n.CentreX===i){const e=r;return new ls(n.CentreX,n.BaseY,n.ShipImage,e,n.ElevationToHit)}return n}),n)));var r,i}),[l[0][0],n.PendingHits]),h=Js(t,(function(n,e,t){return new zs(0,"PendingDone",e)}),[n.MessageText,n.PendingMessageTexts]),d=Js(t,(function(n,e,t){return new zs(0,"PendingDone",ma(e,n))}),[n.ScoreAndHiScore,n.PendingScoreChanges]),g=rs(t,s);const w=gl(e,g,f[0],t),p=function(n,e){if(null!=n){return new P(fn(n),e)}return e},S=p(w[0],f[1]),m=p(w[1],h[1]),M=p(w[2],d[1]),y=p(w[3],l[0][1]);return new ul(d[0],n.ShipsRemaining,g,c[0][0],c[0][2],f[0],y,c[0][1],l[1],c[1],S,m,M,h[0])}}const Sl=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const ml=new Qo(Math.fround(120),Math.fround(97)),Ml=hr([new ea(Math.fround(86),Math.fround(75),Math.fround(156),Math.fround(139)),ga]),yl=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Tl=v((function(n,e,t){this.ScoreAndHiScore=n,this.ShipsThrough=e,this.AlliedState=t}),F);function Il(n,e){return new Tl(n,e,new yl(0,"FleetBeforeBeachLandingInPlay",ml))}function Cl(n,e,t){if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[1]>fa){const e=new yl(2,"ScreenOver");return new Tl(n.ScoreAndHiScore,n.ShipsThrough,e)}return n}if(2===n.AlliedState.tag)return n;{const o=wa(n.AlliedState.fields[0],e,Ml),a=(i=t,oa(ga,r=o)?new yl(1,"EngagedBeachLanding",r,i):new yl(0,"FleetBeforeBeachLandingInPlay",r));return new Tl(n.ScoreAndHiScore,n.ShipsThrough,a)}var r,i}const Al=v((function(n,e,t,r){this.TilesHorizontally=0|n,this.TilesVertically=0|e,this.TileWidthPixels=t,this.TileHeightPixels=r}),F);const kl=v((function(n,e,t,r){this.WindowLeft=n,this.WindowTop=e,this.WindowWidth=t,this.WindowHeight=r}),F);const El=v((function(n,e){this.OffsetX=n,this.OffsetY=e}),F);function Wl(n,e,t,r){const i=function(n,e){if(e<=0){const t=0|~~(Wn(e)/n);return[e+n*t|0,t]}return[e,0]},o=i(n.TileWidthPixels,t.OffsetX),a=i(n.TileHeightPixels,t.OffsetY);if(e.WindowWidth>0&&e.WindowHeight>0){const t=e.WindowLeft+e.WindowWidth|0,i=e.WindowTop+e.WindowHeight|0;let u=e.WindowTop+a[0]|0,s=0|a[1];for(;u<i&&s<n.TilesVertically;){let i=e.WindowLeft+o[0]|0,a=0|o[1];for(;i<t&&a<n.TilesHorizontally;)r(i,u,a,s),i+=n.TileWidthPixels,a+=1;u+=n.TileHeightPixels,s+=1}}}const vl=v((function(n){this.TargetLocation=n}),F);const bl=v((function(n,e){this.TargetsOnFinalBoss=n,this.TankBattleMapNumber=0|e}),F);const Dl=hr([[Math.fround(169),Math.fround(50)],[Math.fround(134),Math.fround(71)],[Math.fround(194),Math.fround(90)],[Math.fround(123),Math.fround(111)],[Math.fround(221),Math.fround(68)],[Math.fround(74),Math.fround(108)],[Math.fround(249),Math.fround(116)],[Math.fround(163),Math.fround(83)],[Math.fround(104),Math.fround(70)],[Math.fround(231),Math.fround(96)]]);function Pl(){return new bl(lr((function(n){return new vl(new Qo(n[0],n[1]))}),Dl),0)}const Bl=Math.fround(60),Hl=Math.fround(188),xl=(Bl+Hl)/Math.fround(2),Xl=Dr-Math.fround(16),Fl=Math.fround(12),Gl=Math.fround(3),Ol=Math.fround(12),Ll=Math.fround(1),Rl=Math.fround(3),Kl=Math.fround(4),Nl=(Math.fround(120),Math.fround(15)),jl=Math.fround(2.5),Ul=Math.fround(.20000000298023224),Vl=Math.fround(.75),zl=Math.fround(7);function Jl(n){return $t((function(n){return vr()[n.fields[0]]}),n,Array)}function _l(n,e){return new Ya(new _a(Vl,Jl([qr,Zr,$r,Qr]),new Ja(1,"Hidden"),new Ja(1,"Hidden")),e,ja(n,e,Vl))}const Yl=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const ql=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Zl=v((function(n,e){this.etmx=n,this.etmy=e}),F);const $l=v((function(n,e,t,r){this.ScreenStartTime=n,this.TileMatrixTraits=e,this.LevelMap=t,this.FinalBossAndTankBattleData=r}),F);const Ql=v((function(n,e,t,r,i,o,a,u){this.Constants=n,this.ScoreAndHiScore=e,this.TanksRemaining=t,this.AlliedState=r,this.Decoratives=i,this.AlliedMissiles=o,this.EnemyMissiles=a,this.EnemyTankLocations=u}),F);function nc(){return new _a(Math.fround(3),[vr()[_r.fields[0]]],new Ja(1,"Hidden"),new Ja(1,"Hidden"))}function ec(n,e,t){switch(t.tag){case 2:case 0:return new ea(n-Math.fround(8),e-Math.fround(6),n+Math.fround(8),e+Math.fround(6));default:return new ea(n-Math.fround(8),e-Math.fround(4),n+Math.fround(8),e+Math.fround(4))}}function tc(n,e){let t;return t=0|~~(e*Math.fround(5)),16*Wn(n)+320+t|0}function rc(n,e,t){return(0|Wn(tc(n,e)))+(0|~~(t+Math.fround(.5)))|0}function ic(n,e,t){let r;let i;return r=0|tc(n,t),i=52,new Qo(r+e.etmx,52+e.etmy)}function oc(n,e,t,r){const i=ec(Xl,n,e),o=new kl(0|~~(i.Left+Math.fround(.5)),0|~~(i.Top+Math.fround(.5)),0|~~((u=i).Right-u.Left+Math.fround(.5)),0|~~((a=i).Bottom-a.Top+Math.fround(.5)));var a,u;const s=new El(tc(r.LevelMap.TilesHorizontally,t)-o.WindowLeft,0|~~(-(i.Top-52)+Math.fround(.5)));let l=!0;return Wl(r.TileMatrixTraits,o,s,(function(n,e,t,i){const o=r.LevelMap.TilesArray[i*r.LevelMap.TilesHorizontally+t];var a;l=!!l&&(!!p(a=o,xi)||p(a,Bi))})),!l}function ac(n){switch(n.tag){case 0:return Jl([Li,Ni]);case 2:return Jl([Ri,ji]);default:return Jl([Oi,Ki])}}function uc(n,e,t,r){let i;const o=0|tc(n,e);let a;i=o,a=52,fr((function(n){t(n.etmx+i,n.etmy+52)}),r)}function sc(n,e,t){var r;const i=t-e.Constants.ScreenStartTime;let o;o=vr()[Gi.fields[0]];const a=function(){zo(n,i),function(n,e,t){const r=new kl(0,52,320,144),i=new El(tc(e.LevelMap.TilesHorizontally,t),0);Wl(e.TileMatrixTraits,r,i,(function(t,r,i,o){let a;const u=e.LevelMap.TilesArray[o*e.LevelMap.TilesHorizontally+i];a=vr()[u.fields[0]],Go(n,t,r,a)}))}(n,e.Constants,i),tu(n,e.AlliedMissiles,i),tu(n,e.EnemyMissiles,i),uc(e.Constants.LevelMap.TilesHorizontally,i,(function(e,t){Lo(n,e,t,o)}),e.EnemyTankLocations)},u=function(){tu(n,e.Decoratives,i)},s=Math.fround(0);switch(1===e.AlliedState.tag?1:2===e.AlliedState.tag||3===e.AlliedState.tag?2:0){case 0:{a();const t=i-e.Constants.ScreenStartTime;Ro(n,Xl,e.AlliedState.fields[0],ac(e.AlliedState.fields[1]),Ul,t),u();break}case 1:a(),u()}!function(n,e,t,r){const i=e+2|0;let o;o=nt(Qe("SCORE  %d     TANKS  %d"))(t)(r),jo(n,xr,new Jo(1,"CentreAlign"),new _o(0,"TopAlign"),160,i,o)}(n,(r=0|~~(s+Math.fround(.5)),r),e.ScoreAndHiScore.Score,e.TanksRemaining)}function lc(n,e,t,r,i){const o=function(n,e){const t=0|ur(n);if(t<1)throw new Error("List of tank battle maps should never be empty");return mr(e%t,n)}(r,t.TankBattleMapNumber),a=new Al(o.TilesHorizontally,9,16,16),u=new $l(i,a,o,t);return new Ql(u,n,e,new ql(0,"AlliedTankInPlay",xl,new Yl(1,"TankFacingLeft")),new P,new P,new P,lr((function(n){return new Zl(16*n.etx+8|0,16*n.ety+8|0)}),o.EnemyTanks))}function cc(n,e,t,r){if(e.Fire.JustDown&&function(n,e,t){let r;var i;if(r=null!=(i=n).tail?i.head.FlickBookStartTime:null,null!=r){return t-r>=e}return!0}(t,jl,r)){return new P((i=Xl-Fl,o=n-Gl,a=r,new Ya(nc(),a,Ua((function(n,e){return n}),new Qo(i,o),new Qo(i-Dr,o),a,jl))),t)}return t;var i,o,a}function fc(n,e){let t;return t=Va(e,n.FlickBookMechanicsObject),_l(t,e)}function hc(n,e,t){return function(n,e){const t=n.ptx+Ol,r=n.pty-Ll;return new Ya(nc(),e,Ua((function(n,e){return n}),new Qo(t,r),new Qo(t+Dr,r),e,jl))}(ic(e,n,t),t)}function dc(n,e,t,r,i,o){switch(n.tag){case 2:case 1:return[n,e];case 0:{const u=function(n,e,t){const r=t*Nl;switch(e.tag){case 2:return I(m,n+r,Hl);case 1:return n;default:return C(m,n-r,Bl)}}(n.fields[0],n.fields[1],t),s=(a=r).Up.Held&&a.Down.Held?new Yl(1,"TankFacingLeft"):a.Up.Held?new Yl(0,"TankFacingUpLeft"):a.Down.Held?new Yl(2,"TankFacingDownLeft"):new Yl(1,"TankFacingLeft");if(oc(u,s,o,i)){const n=new P(_l(new Qo(Xl,u),o),e);return[new ql(1,"AlliedTankExploding",o),n]}return[new ql(0,"AlliedTankInPlay",u,s),e]}default:return[n,e]}var a}function gc(n,e,t,r,i){switch(n.tag){case 3:case 1:return[e,n,t,r];case 0:{const o=function(n,e,t,r,i,o,a){const u=ms(n,new P(e,new P),t,r,(function(n){return 1}),i,o,a),s=null==u[1].tail?new Ms(0,"PlayerDestroyed"):new Ms(1,"PlayerSurvives");return[u[0],s,u[2],u[3]]}(e,n.fields[0],(function(n,e){return function(n,e,t){const r=new Qo(Xl,t);let i;return i=Za(n,e),ia(r,zl,i)}(i,n,e)}),qa,t,r,(function(n){return[fc(n,i),0]}));return 0===o[1].tag?[o[0],new ql(1,"AlliedTankExploding",i),o[2],o[3]]:[o[0],n,o[2],o[3]]}default:return[e,n,t,r]}}function wc(n,e,t,r,i){switch(n.tag){case 2:case 1:return[n,e];case 0:if(function(n,e,t,r,i){const o=ec(Xl,r,i),a=vr()[Gi.fields[0]].EngineImageMetadata;let u=!1;return uc(n,e,(function(n,e){if(u)u=!0;else{let t;const r=n-a.ImageWidth/Math.fround(2),i=e-a.ImageHeight/Math.fround(2);t=new ea(r,i,r+a.ImageWidth,i+a.ImageHeight),u=function(n,e){return!(n.Left>e.Right||n.Right<e.Left||n.Top>e.Bottom||n.Bottom<e.Top)}(t,o)}}),t),u}(r,i,t,n.fields[0],n.fields[1])){return[new ql(1,"AlliedTankExploding",i),new P(_l(new Qo(Xl,n.fields[0]),i),e)]}return[n,e];default:return[n,e]}}v((function(n,e,...t){B.call(this,n,e,...t)}),B);function pc(n,e,t,r){let i;var o,a,u;switch(2===n.AlliedState.tag||3===n.AlliedState.tag?0:1){case 0:i=n;break;case 1:{const o=t-n.Constants.ScreenStartTime,a=0|rc(n.Constants.LevelMap.TilesHorizontally,o,Xl);let u,s,l;u=Qa(o,n.Decoratives),s=Qa(o,n.AlliedMissiles),l=Qa(o,n.EnemyMissiles);const c=function(n,e,t){switch(n.tag){case 2:case 0:return[n,e];case 1:return t-n.fields[0]>Kl?[new ql(3,"AlliedTankDestroyed"),e-1]:[n,e];default:return[n,e]}}(function(n,e){switch(n.tag){case 2:case 1:return n;case 0:return e<64?new ql(2,"AlliedTankReachedFort"):n;default:return n}}(n.AlliedState,a),n.TanksRemaining,o),f=dc(c[0],u,r,e,n.Constants,o),h=ms(function(n,e,t,r){switch(n.tag){case 2:case 1:return t;case 0:return cc(n.fields[0],e,t,r);default:return t}}(f[0],e,s,o),n.EnemyTankLocations,(function(e,t){return function(n,e,t,r){const i=ic(n,r,e);let o;return o=Za(e,t),ia(i,zl,o)}(n.Constants.LevelMap.TilesHorizontally,o,e,t)}),qa,(function(n){return n}),f[1],n.ScoreAndHiScore,(function(n){return[fc(n,o),1e3]})),d=gc(f[0],l,h[2],h[3],o),g=wc(d[1],d[2],h[1],n.Constants.LevelMap.TilesHorizontally,o),w=function(n,e,t,r){var i;let o,a,u,s;if(a=rc(n,r,Math.fround(0)),o=a,s=rc(n,r,Dr),u=s,i=r-Rl,r-(null!=t.tail?t.head.FlickBookStartTime:i)>=Rl){let i,a;a=La((function(n){return n.etmx>=o&&n.etmx<=u}),e);const s=0|ur(a);if(s>0){i=mr(~~r%s|0,a)}else i=null;if(null!=i){return new P(hc(i,n,r),t)}return t}return t}(n.Constants.LevelMap.TilesHorizontally,h[1],d[0],o);i=new Ql(n.Constants,d[3],c[1],g[0],g[1],h[0],w,h[1]);break}}switch(3===i.AlliedState.tag||0===i.AlliedState.tag||1===i.AlliedState.tag?1:0){case 0:return new Ql((u=(o=i).Constants.FinalBossAndTankBattleData.TankBattleMapNumber+1|0,a=new bl(o.Constants.FinalBossAndTankBattleData.TargetsOnFinalBoss,u),new $l(o.Constants.ScreenStartTime,o.Constants.TileMatrixTraits,o.Constants.LevelMap,a)),o.ScoreAndHiScore,o.TanksRemaining,o.AlliedState,o.Decoratives,o.AlliedMissiles,o.EnemyMissiles,o.EnemyTankLocations);case 1:return i}}const Sc=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const mc=Math.fround(3),Mc=Math.fround(160),yc=new Qo(Math.fround(160),Math.fround(20)),Tc=Math.fround(4),Ic=Math.fround(20),Cc=Math.fround(.75),Ac=Math.fround(.5),kc=Math.fround(30),Ec=Math.fround(30);function Wc(n){return $t((function(n){return vr()[n.fields[0]]}),n,Array)}const vc=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const bc=v((function(n,e,t,r,i,o,a,u){this.FinalBossAndTankBattleData=n,this.ScoreAndHiScore=e,this.TanksRemaining=t,this.ScreenStartTime=r,this.GunAim=i,this.AlliedState=o,this.Explosions=a,this.BossGunFlickBook=u}),F);function Dc(n,e){const t=new _a(Cc,Wc([qr,Zr,$r,Qr]),new Ja(0,"Visible"),new Ja(0,"Visible")),r=ja(n,e,Cc);return new Ya(t,e,r)}function Pc(n,e,t,r,i){return ms(n,e,(function(n,t){return!!p(t.TargetLocation,function(n){if(null!=n.tail)return n.head;throw new Error("List was empty")}(e).TargetLocation)&&(!za(i,n.ShellMechanicsObject)&&ia(t.TargetLocation,mc,n.ShellMechanicsObject.FinalPosition))}),(function(n){return n.ShellStartTime}),(function(n){return n.TargetLocation.ptx}),t,r,(function(n){let e;return e=Va(i,n.ShellMechanicsObject),[Dc(e,i),2e3]}))}function Bc(n,e,t){let r;r=vr()[Ui.fields[0]];const i=function(){Go(n,0,0,r)},o=function(t){es(n,r.EngineImageMetadata.ImageHeight,e.GunAim,t)};if(1===e.AlliedState.tag){i();const r=t-e.ScreenStartTime;Ro(n,yc.ptx,yc.pty,Wc([Zi,$i]),Ac,r),tu(n,e.Explosions,t),o(t)}else if(2===e.AlliedState.tag)Ko(n,0,0,320,200,new Xo(0,"SolidColour",0)),jo(n,Pr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,100,"TANK DESTROYED");else if(3===e.AlliedState.tag);else{i(),function(e,t){for(;;){const r=e,i=t;if(null==i.tail)break;{const o=r?Qi:no;Lo(n,i.head.TargetLocation.ptx,i.head.TargetLocation.pty,vr()[o.fields[0]]),e=!1,t=i.tail}}}(!0,e.FinalBossAndTankBattleData.TargetsOnFinalBoss),nu(n,e.BossGunFlickBook,t),tu(n,e.Explosions,t),o(t)}const a=new ba(e.ScoreAndHiScore,0,0,e.TanksRemaining,0,0,null,e.GunAim.GunElevation);Ma(n,r.EngineImageMetadata.ImageHeight),Da(n,r.EngineImageMetadata.ImageHeight,a)}function Hc(n,e,t,r){return new bc(t,n,e,r,$u(new Yu(0,"SingleBarrelGun"),Mc,Ec,kc,r),new vc(0,"AlliedTankInPlay"),new P,new Ya(new _a(Ic,Wc([Vi,zi,Ji,_i,Yi,qi]),new Ja(0,"Visible"),new Ja(0,"Visible")),r,ja(yc,r,Ic)))}const xc=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const Xc=v((function(n,e,t){this.ScoreAndHiScore=n,this.HiScoreText=e,this.RestartNow=t}),F);function Fc(n){return new Xc(n,"HI SCORE   "+n.HiScore.toString(),!1)}const Gc=Math.fround(4),Oc=v((function(n,e,t){this.EndNow=n,this.EndTime=e,this.NextChapterConstructor=t}),F);function Lc(n,e){return new Oc(!1,n+Gc,e)}const Rc=v((function(n,e,t,r,i,o){this.ScoreAndHiScore=n,this.ScoreText=e,this.HiScoreText=t,this.NextAnimStageTime=r,this.AnimationStage=i,this.RestartNow=o}),F);const Kc=Math.fround(1),Nc=hr(["----|--x","----|--x","----|P-x","----|PCx","----|-Cx","----|---","----|---"]),jc=hr(["---P|---","123P|---","123P|---","123P|---","123-|---"]),Uc=hr(["---P|---","-23P|---","-23P|---","-23P|---","-23-|---","1---|---","1--P|---","123P|---","123P|---","123P|---","123-|---"]),Vc=hr(["----|---","----|---","----|---","----|---"]),zc=sr(Nc,sr(jc,Vc)),Jc=sr(Nc,sr(Uc,Vc));function _c(n,e,t){Go(n,0,0,vr()[oo.fields[0]]),null!=e.AnimationStage.tail?function(n,e){const t=function(n,e,t,r){return Lo(n,e,t,vr()[r.fields[0]])},r="x"===e[7],i="C"===e[6],o="P"===e[5],a="P"===e[3],u="3"===e[2],s="2"===e[1],l="1"===e[0],c=Math.fround(100),f=Math.fround(80);t(n,Math.fround(256),c,a?go:o?ho:wo),t(n,Math.fround(192),c,u?uo:i?ao:so),t(n,r?o||i?Math.fround(224):Math.fround(256):Math.fround(192),f,fo),t(n,Math.fround(128),c,s?lo:co),t(n,Math.fround(64),c,l?lo:co)}(n,e.AnimationStage.head):(jo(n,xr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,75,"CONGRATULATIONS"),jo(n,Pr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,100,"MISSION COMPLETE"),jo(n,Hr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,125,e.ScoreText),jo(n,Hr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,150,e.HiScoreText))}function Yc(n,e){return new Rc(n,"FINAL SCORE   "+n.Score.toString(),"HI SCORE   "+n.HiScore.toString(),e+Kc,e%Math.fround(4)<Math.fround(1)?Jc:zc,!1)}const qc=v((function(n,e,t,r){this.Name=n,this.SelectorIndex=0|e,this.MaxNameLength=0|t,this.Complete=r}),F);const Zc=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const $c="ABCDEFGHIJKLMNOPQRSTUVWXYZ .X ";function Qc(n,e){const t=$c.length-1|0,r=t-1|0;switch(n.tag){case 1:{const n=0|(e.SelectorIndex===t?0:e.SelectorIndex+1);return new qc(e.Name,n,e.MaxNameLength,e.Complete)}case 2:{const n=e.Name.length===e.MaxNameLength,t=n?e.Name:e.SelectorIndex===r?0===e.Name.length?e.Name:at(e.Name,0,e.Name.length-1):e.Name+$c[e.SelectorIndex];return new qc(t,e.SelectorIndex,e.MaxNameLength,n)}default:{const n=0|(0===e.SelectorIndex?t:e.SelectorIndex-1);return new qc(e.Name,n,e.MaxNameLength,e.Complete)}}}function nf(n,e){const t=0|n.length,r=e-(0|~~(t/2))|0,i=0|(r<0?r+t:r);return at(n,i)+at(n,0,i)}function ef(n){return hr(["ENTER YOUR NAME","","",(e=n.Name,t=n.MaxNameLength,r=".",ot(e,t,r,!0)),"",""," .",nf($c,n.SelectorIndex)]);var e,t,r}function tf(n){return n.Complete}const rf=v((function(n,e,t,r,i){this.Scoreboard=n,this.ScoreAndHiScore=e,this.DataModel=t,this.MemoizedText=r,this.CanEnterBoard=i}),F);function of(n,e){const t=new qc("",0,12,!1);return new rf(e,n,t,ef(t),Do(e,n.Score))}function af(n,e,t){if(n.CanEnterBoard){let t;const s=(a=n.DataModel,(u=e).Fire.JustDown?Qc(new Zc(2,"SelectLetter"),a):u.Left.JustDown?Qc(new Zc(0,"RotateLeft"),a):u.Right.JustDown?Qc(new Zc(1,"RotateRight"),a):null);if(null!=s){const e=s;let r;r=ef(e),t=new rf(n.Scoreboard,n.ScoreAndHiScore,e,r,n.CanEnterBoard)}else t=n;if(tf(t.DataModel)){let e;return r=t.DataModel,i=t.ScoreAndHiScore.Score,o=n.Scoreboard,e=Po(new Eo(r.Name,i),o),new rf(e,t.ScoreAndHiScore,t.DataModel,t.MemoizedText,!1)}return t}return n;var r,i,o,a,u}const uf=Math.fround(3),sf=Math.fround(5),lf=v((function(n,e){this.Functions=n,this.RepeatAtTime=e}),F);function cf(n){const e=function(e){return function(t){return Ka(e,new Qo(t,Math.fround(150)),new Qo(t,Math.fround(50)),n,uf)}},t=n+sf;return new lf(hr([e((function(n,e){return n}))(Math.fround(50)),e((function(n,e){let t;let r,i,o;var a;return t=n/e,o=(a=t)*a,i=e*o,r=i,r}))(Math.fround(100)),e((function(n,e){let t;let r,i,o;return t=n/e,o=function(n){let e,t;return t=Math.fround(1)-n,e=t*t,Math.fround(1)-e}(t),i=e*o,r=i,r}))(Math.fround(150)),e((function(n,e){let t;let r,i,o;return t=n/e,o=function(n){if(n<Math.fround(.5)){let e;let t,r;return e=Math.fround(2)*n,r=Math.fround(1)-e,t=r*r,Math.fround(1)-t}{let e,t,r;return r=Math.fround(.5)-n,t=Math.fround(2)*r,e=t*t,Math.fround(1)-e}}(t),i=e*o,r=i,r}))(Math.fround(200))]),t)}const ff=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const hf=v((function(n){this.TankMapsList=n}),F);function df(n,e,t){1===e[0].tag?function(n,e){let t;var r,i;switch(t=vr()[Or.fields[0]],Go(n,0,0,t),1===e.AlliedState.tag?(r=0,i=e.AlliedState.fields[0]):3===e.AlliedState.tag||2===e.AlliedState.tag?r=1:(r=0,i=e.AlliedState.fields[0]),r){case 0:Lo(n,i.ptx,i.pty,vr()[Lr.fields[0]]),Lo(n,e.EnemyFleetCentre.ptx,e.EnemyFleetCentre.pty,vr()[Rr.fields[0]])}Ma(n,t.EngineImageMetadata.ImageHeight);const o=new ba(e.ScoreAndHiScore,0,e.NumShips,ya(e.NumShips),0,0,null,Math.fround(0));Da(n,t.EngineImageMetadata.ImageHeight,o)}(n,e[0].fields[0]):2===e[0].tag?Gu(n,t,e[0].fields[0]):3===e[0].tag?function(n,e){let t;var r,i;switch(t=vr()[Or.fields[0]],Go(n,0,0,t),1===e.AlliedState.tag?(r=0,i=e.AlliedState.fields[0]):2===e.AlliedState.tag?r=1:(r=0,i=e.AlliedState.fields[0]),r){case 0:Lo(n,i.ptx,i.pty,vr()[Lr.fields[0]]),Lo(n,e.EnemyFleetCentre.ptx,e.EnemyFleetCentre.pty,vr()[Rr.fields[0]])}Ma(n,t.EngineImageMetadata.ImageHeight);const o=new ba(e.ScoreAndHiScore,0,e.ShipsThrough,ya(e.ShipsThrough),0,0,null,Math.fround(0));Da(n,t.EngineImageMetadata.ImageHeight,o)}(n,e[0].fields[0]):4===e[0].tag?function(n,e,t){const r=0|vr()[Ii.fields[0]].EngineImageMetadata.ImageHeight,i=function(t){es(n,r,e.GunAim,t)},o=function(){Go(n,0,0,vr()[Ii.fields[0]]),tu(n,e.SkyExplosion,t),ds(n,e.EnemyShips,t),eu(n,xs,e.Planes,t),tu(n,e.PlaneBombs,t),tu(n,e.Explosions,t)};2===e.AlliedState.tag?(o(),i(t),ws(n)):1===e.AlliedState.tag?(o(),ps(n)):3===e.AlliedState.tag||(o(),i(t));const a=new ba(e.ScoreAndHiScore,e.ShipsRemaining,0,ya(e.ShipsRemaining),e.Damage,5,~~((e.PlanesRemaining+3)/4),e.GunAim.GunElevation);Ma(n,r),Da(n,r,a)}(n,e[0].fields[0],t):5===e[0].tag?function(n,e,t){let r;r=vr()[Ii.fields[0]];const i=function(t){es(n,r.EngineImageMetadata.ImageHeight,e.GunAim,t)},o=function(){Go(n,0,0,r),tu(n,e.SkyExplosion,t),ds(n,e.EnemyShips,t),tu(n,e.Decoratives,t)};2===e.AlliedState.tag?(o(),i(t),ws(n)):1===e.AlliedState.tag?(o(),ps(n)):3===e.AlliedState.tag||(o(),i(t));const a=new ba(e.ScoreAndHiScore,0,e.ShipsRemaining,ya(e.ShipsRemaining),5-(e.AlliedCountToSink>>>0),5,null,e.GunAim.GunElevation);jo(n,xr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,15,e.MessageText),Ma(n,r.EngineImageMetadata.ImageHeight),Da(n,r.EngineImageMetadata.ImageHeight,a)}(n,e[0].fields[0],t):6===e[0].tag?function(n,e){let t;var r,i;switch(t=vr()[Or.fields[0]],Go(n,0,0,t),1===e.AlliedState.tag?(r=0,i=e.AlliedState.fields[0]):2===e.AlliedState.tag?r=1:(r=0,i=e.AlliedState.fields[0]),r){case 0:Lo(n,i.ptx,i.pty,vr()[Lr.fields[0]])}Ma(n,t.EngineImageMetadata.ImageHeight);const o=new ba(e.ScoreAndHiScore,0,e.ShipsThrough,ya(e.ShipsThrough),0,0,null,Math.fround(0));Da(n,t.EngineImageMetadata.ImageHeight,o)}(n,e[0].fields[0]):7===e[0].tag?sc(n,e[0].fields[0],t):8===e[0].tag?Bc(n,e[0].fields[0],t):9===e[0].tag?function(n,e,t){Ko(n,0,0,320,200,new Xo(0,"SolidColour",0)),jo(n,Br,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,100,"GAME OVER"),jo(n,Hr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,125,e.HiScoreText)}(n,e[0].fields[0]):10===e[0].tag?function(n,e,t){Go(n,0,0,vr()[io.fields[0]]),jo(n,Br,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,100,"GET READY")}(n,e[0].fields[0]):11===e[0].tag?_c(n,e[0].fields[0]):12===e[0].tag?function(n,e,t){zo(n,t),Vo(n,xr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,75,10,e.MemoizedText)}(n,e[0].fields[0],t):13===e[0].tag?function(n,e,t){Ko(n,0,0,320,200,new Xo(0,"SolidColour",0)),jo(n,Br,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,15,"MECHANICS TEST SCREEN"),Ko(n,25,25,270,150,new Xo(0,"SolidColour",80)),Ko(n,25,50,270,1,new Xo(0,"SolidColour",16744448)),Ko(n,25,150,270,1,new Xo(0,"SolidColour",16744448)),fr((function(e){const r=e(t);1===r.tag&&Lo(n,r.fields[0].ptx,r.fields[0].pty,vr()[Lr.fields[0]])}),e.Functions)}(n,e[0].fields[0],t):function(n,e,t){zo(n,t/Math.fround(4)),Lo(n,Math.fround(160),Math.fround(68),vr()[Gr.fields[0]]);const r=Bo(30,e.GameGlobalState.GameScoreBoard);Vo(n,xr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,94,20,r),jo(n,xr,new Jo(1,"CentreAlign"),new _o(1,"MiddleAlign"),160,180,"USE CURSOR KEYS ... Z TO FIRE")}(n,e[0].fields[0],t)}const gf=v((function(n,e,...t){B.call(this,n,e,...t)}),B);function wf(n,e){return function(n,e,t){switch(t.tag){case 1:{const n=Xa(10,new Sa(0,12345));return new ff(1,"InitialMapChapter",n)}case 2:return new ff(10,"IntermissionChapter",Lc(e,(function(n){return new ff(2,"SecretPassageChapter",Ou(new Sa(0,1e4),7,n))})));case 3:{const n=Ou(new Sa(0,1e4),7,e);return new ff(2,"SecretPassageChapter",n)}case 4:{const n=zu(new Sa(0,1e4),5);return new ff(3,"MapPostPassageChapter",n)}case 5:{const n=Ks(new Ta(0,"StrongEnemy"),new Sa(100,1e3),4,e);return new ff(4,"AirBattleChapter",n)}case 6:{const n=wl(new Sa(100,1e3),4,e);return new ff(5,"SeaBattleChapter",n)}case 7:{const n=Il(new Sa(100,1e3),4);return new ff(6,"MapBeforeBeachLandingChapter",n)}case 8:{const t=Pl(),r=lc(new Sa(100,1e3),8,t,n.TankMapsList,e);return new ff(7,"TankBattleChapter",r)}case 9:{const n=Pl(),t=Hc(new Sa(100,1e3),3,n,e);return new ff(8,"FinalBossChapter",t)}case 10:{const n=Yc(new Sa(25e3,37e3),e);return new ff(11,"VictoryChapter",n)}case 11:{const n=xo();if(0===n.tag){const e=of(new Sa(25e3,25e3),n.fields[0].GameScoreBoard);return new ff(12,"PotentialEnterYourNameChapter",e)}throw new Error(n.fields[0])}case 12:{const n=Fc(new Sa(25e3,25e3));return new ff(9,"GameOverChapter",n)}case 13:{const n=cf(e);return new ff(13,"MechanicsTestPageChapter",n)}default:{const n=xo();if(0===n.tag){const t=bo(n.fields[0].GameScoreBoard);return new ff(0,"GameTitleChapter",$o(t,n.fields[0],e))}throw new Error(n.fields[0])}}}(n,e,new gf(0,"RunGameNormally"))}function pf(n,e,t,r,i){const o=function(n){return new ff(10,"IntermissionChapter",Lc(r,n))};if(1===e[0].tag){let n;const i=Fa(e[0].fields[0],t,r);let a;switch(a=function(n){switch(1===n.AlliedState.tag?0:2===n.AlliedState.tag?1:3===n.AlliedState.tag?2:0){case 0:return new Ga(0,"StayOnInitialMapScreen");case 1:return new Ga(1,"FromInitialMapGoToSecretPassage");case 2:return new Ga(2,"FromInitialMapGoToSeaBattle")}}(i),a.tag){case 1:n=o((function(n){return new ff(2,"SecretPassageChapter",Ou(i.ScoreAndHiScore,i.NumShips,n))}));break;case 2:n=o((function(n){return new ff(4,"AirBattleChapter",Ks(new Ta(0,"StrongEnemy"),i.ScoreAndHiScore,i.NumShips,n))}));break;default:n=new ff(1,"InitialMapChapter",i)}return[n,e[1]]}if(2===e[0].tag){let n;const i=Ru(e[0].fields[0],t,r);let a;switch(a=function(n){switch(1===n.Ship.tag||2===n.Ship.tag?0:3===n.Ship.tag?1:0){case 0:return new Ku(0,"StayOnSecretPassageScreen");case 1:return n.FleetStats.ShipsSuccess>0?new Ku(1,"FromSecretPassageGoToNextScreen"):new Ku(2,"SecretPassageGameOver")}}(i),a.tag){case 1:n=o((function(n){return new ff(3,"MapPostPassageChapter",zu(i.FleetStats.Score,i.FleetStats.ShipsSuccess))}));break;case 2:n=new ff(9,"GameOverChapter",Fc(i.FleetStats.Score));break;default:n=new ff(2,"SecretPassageChapter",i)}return[n,e[1]]}if(3===e[0].tag){let n;const i=Ju(e[0].fields[0],t,r);return n=function(n){switch(1===n.AlliedState.tag?0:2===n.AlliedState.tag?1:0){case 0:return!0;case 1:return!1}}(i)?new ff(3,"MapPostPassageChapter",i):new ff(4,"AirBattleChapter",Ks(new Ta(1,"WeakerEnemy"),i.ScoreAndHiScore,i.ShipsThrough,r)),[n,e[1]]}if(4===e[0].tag){let n;const o=Ns(e[0].fields[0],t,r,i);let a;switch(a=function(n){switch(1===n.AlliedState.tag||2===n.AlliedState.tag?0:3===n.AlliedState.tag?1:0){case 0:return new js(0,"StayOnAirBattleScreen");case 1:return n.ShipsRemaining>0?new js(1,"GoToScreenAfterAirBattle"):new js(2,"AirBattleGameOver")}}(o),a.tag){case 1:n=new ff(5,"SeaBattleChapter",wl(o.ScoreAndHiScore,o.ShipsRemaining,r));break;case 2:n=new ff(9,"GameOverChapter",Fc(o.ScoreAndHiScore));break;default:n=new ff(4,"AirBattleChapter",o)}return[n,e[1]]}if(5===e[0].tag){let n;const o=pl(e[0].fields[0],t,r,i);let a;switch(a=function(n){switch(1===n.AlliedState.tag||2===n.AlliedState.tag?0:3===n.AlliedState.tag?1:0){case 0:return new Sl(0,"StayOnSeaBattleScreen");case 1:return n.ShipsRemaining>0?new Sl(1,"GoToScreenAfterSeaBattle"):new Sl(2,"SeaBattleGameOver")}}(o),a.tag){case 1:n=new ff(6,"MapBeforeBeachLandingChapter",Il(o.ScoreAndHiScore,o.ShipsRemaining));break;case 2:n=new ff(9,"GameOverChapter",Fc(o.ScoreAndHiScore));break;default:n=new ff(5,"SeaBattleChapter",o)}return[n,e[1]]}if(6===e[0].tag){let i;const a=Cl(e[0].fields[0],t,r);return i=function(n){switch(1===n.AlliedState.tag||2===n.AlliedState.tag?1:0){case 0:return!0;case 1:return!1}}(a)?new ff(6,"MapBeforeBeachLandingChapter",a):o((function(e){return new ff(7,"TankBattleChapter",lc(a.ScoreAndHiScore,ya(a.ShipsThrough),Pl(),n.TankMapsList,e))})),[i,e[1]]}if(7===e[0].tag){let a;const u=pc(e[0].fields[0],t,r,i);let s;switch(s=function(n){switch(3===n.AlliedState.tag?1:0===n.AlliedState.tag||1===n.AlliedState.tag?2:0){case 0:return new Sc(1,"TankCompletedCourseSuccessfully");case 1:return n.TanksRemaining>0?new Sc(3,"RestartTankBattle"):new Sc(2,"TankBattleGameOver");case 2:return new Sc(0,"StayOnTankBattleScreen")}}(u),s.tag){case 1:a=o((function(n){return new ff(8,"FinalBossChapter",Hc(u.ScoreAndHiScore,u.TanksRemaining,u.Constants.FinalBossAndTankBattleData,n))}));break;case 2:a=new ff(9,"GameOverChapter",Fc(u.ScoreAndHiScore));break;case 3:a=o((function(e){return new ff(7,"TankBattleChapter",lc(u.ScoreAndHiScore,u.TanksRemaining,u.Constants.FinalBossAndTankBattleData,n.TankMapsList,e))}));break;default:a=new ff(7,"TankBattleChapter",u)}return[a,e[1]]}if(8===e[0].tag){let o;const a=function(n,e,t,r){var i,o;switch(1===n.AlliedState.tag||2===n.AlliedState.tag?(i=1,o=n.AlliedState.fields[0]):i=3===n.AlliedState.tag?2:0,i){case 0:{const i=t-n.ScreenStartTime;if(null==n.FinalBossAndTankBattleData.TargetsOnFinalBoss.tail){const e=new vc(1,"WonScreen",t);return new bc(n.FinalBossAndTankBattleData,n.ScoreAndHiScore,n.TanksRemaining,n.ScreenStartTime,n.GunAim,e,n.Explosions,n.BossGunFlickBook)}if(i>Ic){const e=new vc(2,"TankIsShot",t);return new bc(n.FinalBossAndTankBattleData,n.ScoreAndHiScore,n.TanksRemaining,n.ScreenStartTime,n.GunAim,e,n.Explosions,n.BossGunFlickBook)}{let i,o;i=Qa(t,n.Explosions),o=0|vr()[Ui.fields[0]].EngineImageMetadata.ImageHeight;const a=ts(e,t,r,o,n.GunAim),u=Pc(a.Shells,n.FinalBossAndTankBattleData.TargetsOnFinalBoss,i,n.ScoreAndHiScore,t);let s;return s=rs(t,new Zu(a.GunTraits,a.GunCentreX,a.GunElevation,u[0],a.LastFireTime)),new bc(new bl(u[1],n.FinalBossAndTankBattleData.TankBattleMapNumber),u[3],n.TanksRemaining,n.ScreenStartTime,s,n.AlliedState,u[2],n.BossGunFlickBook)}}case 1:if(t-o>Tc){const e=new vc(3,"FinalBossScreenOver"),t=n.TanksRemaining-1;return new bc(n.FinalBossAndTankBattleData,n.ScoreAndHiScore,t,n.ScreenStartTime,n.GunAim,e,n.Explosions,n.BossGunFlickBook)}return n;case 2:return n}}(e[0].fields[0],t,r,i);let u;switch(u=function(n){switch(1===n.AlliedState.tag||2===n.AlliedState.tag?0:3===n.AlliedState.tag?1:0){case 0:return new xc(0,"StayOnFinalBossScreen");case 1:return null==n.FinalBossAndTankBattleData.TargetsOnFinalBoss.tail?new xc(1,"VictoryOverFinalBoss"):n.TanksRemaining>0?new xc(2,"FinalBossDestroyedTheTank"):new xc(3,"FinalBossGameOver")}}(a),u.tag){case 1:o=new ff(11,"VictoryChapter",Yc(a.ScoreAndHiScore,r));break;case 2:o=new ff(7,"TankBattleChapter",lc(a.ScoreAndHiScore,a.TanksRemaining,a.FinalBossAndTankBattleData,n.TankMapsList,r));break;case 3:o=new ff(9,"GameOverChapter",Fc(a.ScoreAndHiScore));break;default:o=new ff(8,"FinalBossChapter",a)}return[o,e[1]]}if(10===e[0].tag){let n;const t=(a=e[0].fields[0],r>=a.EndTime?new Oc(!0,a.EndTime,a.NextChapterConstructor):a);return n=t.EndNow?t.NextChapterConstructor(r):new ff(10,"IntermissionChapter",t),[n,e[1]]}if(9===e[0].tag){let n;const r=function(n,e,t){return e.Fire.JustDown?new Xc(n.ScoreAndHiScore,n.HiScoreText,!0):n}(e[0].fields[0],t);return n=function(n){return!n.RestartNow}(r)?new ff(9,"GameOverChapter",r):new ff(12,"PotentialEnterYourNameChapter",of(r.ScoreAndHiScore,e[1].GameScoreBoard)),[n,e[1]]}if(11===e[0].tag){let n;const i=function(n,e,t){if(e.Fire.JustDown)return new Rc(n.ScoreAndHiScore,n.ScoreText,n.HiScoreText,n.NextAnimStageTime,n.AnimationStage,!0);{const e=null!=n.AnimationStage.tail&&t>n.NextAnimStageTime?[t+Kc,n.AnimationStage.tail]:[n.NextAnimStageTime,n.AnimationStage];return new Rc(n.ScoreAndHiScore,n.ScoreText,n.HiScoreText,e[0],e[1],n.RestartNow)}}(e[0].fields[0],t,r);return n=function(n){return!n.RestartNow}(i)?new ff(11,"VictoryChapter",i):new ff(12,"PotentialEnterYourNameChapter",of(i.ScoreAndHiScore,e[1].GameScoreBoard)),[n,e[1]]}if(12===e[0].tag){let n;const i=af(e[0].fields[0],t);if(function(n){return!!n.CanEnterBoard&&!tf(n.DataModel)}(i)){n=[new Ho(i.Scoreboard),new ff(12,"PotentialEnterYourNameChapter",i)]}else{const e=new Ho(i.Scoreboard);n=[e,new ff(0,"GameTitleChapter",$o(i.ScoreAndHiScore.HiScore,e,r))]}return[n[1],n[0]]}if(13===e[0].tag){return[new ff(13,"MechanicsTestPageChapter",function(n,e,t){return t>n.RepeatAtTime?cf(t):n}(e[0].fields[0],0,r)),e[1]]}{let n;const i=function(n,e,t){if(e.Fire.JustDown){if(t>n.ScreenStartTime+Yo){const e=new qo(1,"GameTitleScreenOver");return new Zo(n.ScreenStartTime,n.GameGlobalState,n.HiScore,e)}return n}return n}(e[0].fields[0],t,r);return n=function(n){return 1!==n.State.tag}(i)?new ff(0,"GameTitleChapter",i):new ff(1,"InitialMapChapter",Xa(10,new Sa(0,i.HiScore))),[n,e[1]]}var a}const Sf=v((function(n,e,...t){B.call(this,n,e,...t)}),B);const mf=v((function(n,e){this.JustDown=n,this.Held=e}),F);const Mf=new mf(!1,!1),yf=new Sf(0,"WebBrowserKeyCode",80),Tf=v((function(n,e,t,r,i){this.WebBrowserKeyCode=n,this.ThisKeyScanCode=e,this.MutHeld=t,this.MutJustPressed=r,this.MutWaitingRelease=i}),F);function If(n,e){return new Tf(n,e,!1,!1,!1)}function Cf(n){return new mf(n.MutJustPressed,n.MutHeld)}const Af=v((function(n,e,t){this.MutableKeyStatesList=n,this.PauseKey=e,this.GameIsPaused=t}),F);function kf(n,e){let t;if(t=pr((function(n){return p(n.ThisKeyScanCode,e)}),n.MutableKeyStatesList),null==t)return p(e,n.PauseKey.ThisKeyScanCode)?n.PauseKey:null;return t}function Ef(n,e){const t=kf(n,e);if(null!=t){const e=t;return e.MutWaitingRelease||(p(e.ThisKeyScanCode,n.PauseKey.ThisKeyScanCode)&&((r=n).GameIsPaused=!r.GameIsPaused),e.MutHeld=!0,e.MutJustPressed=!0,e.MutWaitingRelease=!0),!0}return!1;var r}function Wf(n,e){const t=kf(n,e);if(null!=t){const n=t;return n.MutHeld=!1,n.MutWaitingRelease=!1,!0}return!1}const vf=v((function(n,e,t,r,i){this.Left=n,this.Right=e,this.Up=t,this.Down=r,this.Fire=i}),F);new vf(Mf,Mf,Mf,Mf,Mf);const bf=v((function(n,e){this.Fonts=n,this.Images=e}),F);function Df(){return z("FortAssaultWeb.JavascriptGraphicResources",[],bf,()=>[["Fonts",_(z("ResourceFileMetadata.FontWithHostObject",[],sn,()=>[["FontImageWithHostObject",un()],["CharWidth",Z],["CharHeight",Z]]))],["Images",_(un())]])}function Pf(n,e,t,r,i,o){const a=[];!function n(e,o,u){if(null!=e.tail){const i=o(e.head),s=u(e.head),l=0|t(e.head),c=0|r(e.head);loadImageThenDo(i,s,(function(t){nr(new an(new en(i,s?new nn(1,"MagentaColourKey"):new nn(0,"NoColourKey"),l,c),new on(0,"HostImageObject",t)),a),n(e.tail,o,u)}))}else i(a.slice())}(o,n,e)}function Bf(n){const e=function(n){return n.ImageFileName},t=function(n){return 1===n.ImageColourKey.tag},r=function(n){return n.ImageWidth},i=function(n){return n.ImageHeight};Pf(e,t,r,i,(function(o){let a;a=$t((function(n){return new sn(n,n.EngineImageMetadata.ImageHeight,n.EngineImageMetadata.ImageHeight)}),o,Array),Pf(e,t,r,i,(function(e){n(a,e)}),Wr)}),Er)}function Hf(n,e){switch(e.tag){case 2:{let t,r,i,o,a,u;t=e.fields[2].EngineImageMetadata.ImageWidth,r=e.fields[2].EngineImageMetadata.ImageHeight,i=~~(e.fields[0]+Math.fround(.5)),o=~~(e.fields[1]+Math.fround(.5)),a=e.fields[3],u=e.fields[4],t>0&&r>0&&a>0&&u>0&&n.drawImage(e.fields[2].HostImageObject.fields[0],0,0,t,r,i,o,a,u);break}case 3:{let t,r,i,o;t=~~(e.fields[4]+Math.fround(.5)),r=~~(e.fields[5]+Math.fround(.5)),i=e.fields[6],o=e.fields[7],e.fields[2]>0&&e.fields[3]>0&&i>0&&o>0&&n.drawImage(e.fields[8].HostImageObject.fields[0],e.fields[0],e.fields[1],e.fields[2],e.fields[3],t,r,i,o);break}case 1:{let t,r,i,o;t=e.fields[2],r=e.fields[3],i=e.fields[0],o=e.fields[1];const a="#"+tt("{0:x6}",e.fields[4].fields[0]);n.fillStyle=a,n.fillRect(i,o,t,r);break}default:{let t,r;t=e.fields[0],r=e.fields[1],n.drawImage(e.fields[2].HostImageObject.fields[0],t,r)}}}function xf(n,e){new bf(n,e);var t;t=n,vr(e),br(t);const r=document.getElementById("gameScreen").getContext("2d"),i=function(){let n,e;return e=lr(ko,ar(Xe(0,1,3))),n=mo((function(n){return 1===n.tag?new So(1,"SecondList",n.fields[0]):new So(0,"FirstList",n.fields[0])}),e),null==n[1].tail?new dn(0,"Ok",n[0]):new dn(1,"Error",it("\n",n[1]))}();if(1===i.tag)console.log(i.fields[0]);else{const n=Math.fround(0),e=new hf(i.fields[0]),t=wf(e,n),u=Math.fround(.019999999552965164),s=xo(),l=(o=80,a=hr([[37,new Sf(0,"WebBrowserKeyCode",37)],[39,new Sf(0,"WebBrowserKeyCode",39)],[38,new Sf(0,"WebBrowserKeyCode",38)],[40,new Sf(0,"WebBrowserKeyCode",40)],[90,new Sf(0,"WebBrowserKeyCode",90)]]),new Af(lr((function(n){return If(n[1],n[0])}),a),If(yf,o),!1)),c=function(n,e){document.addEventListener(n,(function(n){e(l,~~n.keyCode)&&n.preventDefault()}))};c("keydown",Ef),c("keyup",Wf),document.getElementById("loaderScreen").classList.add("hidden"),document.getElementById("gameScreen").classList.remove("hidden");const f=function n(t,i,o){const a=i+1;let s;s=a/Math.fround(50),df((function(n){Hf(r,n)}),t,s);const c=function(n,e,t,r,i){const o=t(new Sf(0,"WebBrowserKeyCode",38)),a=t(new Sf(0,"WebBrowserKeyCode",40)),u=t(new Sf(0,"WebBrowserKeyCode",37)),s=t(new Sf(0,"WebBrowserKeyCode",39)),l=t(new Sf(0,"WebBrowserKeyCode",90));return pf(n,e,new vf(u,s,o,a,l),r,i)}(e,t,(function(n){return function(n,e){let t;return t=pr((function(n){return p(n.WebBrowserKeyCode,e)}),n.MutableKeyStatesList),null==t?p(e,n.PauseKey.WebBrowserKeyCode)?Cf(n.PauseKey):Mf:Cf(t)}(l,n)}),s,u);var f;Ir((function(n){return n.MutJustPressed}),(f=l).MutableKeyStatesList)&&fr((function(n){n.MutJustPressed=!1}),f.MutableKeyStatesList);window.setTimeout(k(1,n,[c,a]),20)};let h;if(0!==s.tag)throw new Error(s.fields[0]);h=s.fields[0],f([t,h],0,null)}var o,a}Bf(xf),t.d(e,"JavascriptGraphicResources",(function(){return bf})),t.d(e,"JavascriptGraphicResources$reflection",(function(){return Df})),t.d(e,"LoadFileListThenDo",(function(){return Pf})),t.d(e,"LoadResourceFilesThenDo",(function(){return Bf})),t.d(e,"RenderToWebCanvas",(function(){return Hf})),t.d(e,"StartGame",(function(){return xf}))}]);