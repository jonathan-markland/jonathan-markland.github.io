!function(e){var n={};function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(n){return e[n]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";function r(e){return null!=e&&(Array.isArray(e)||ArrayBuffer.isView(e))}function i(e){return null!=e&&"function"==typeof e.Dispose}t.r(n);function o(e,n,t){return e.has(n)?[!0,e.get(n)]:[!1,t]}function a(e,n){return!n.has(e)&&(n.add(e),!0)}function u(e,n){let t=e.toString(10);for(;t.length<n;)t="0"+t;return t}function s(e){const n=e;return"number"==typeof n.offset?n.offset:1===e.kind?0:-6e4*e.getTimezoneOffset()}class l{static id(e){return l.idMap.has(e)||l.idMap.set(e,++l.count),l.idMap.get(e)}}function c(e){let n=0,t=5381;const r=e.length;for(;n<r;)t=33*t^e.charCodeAt(n++);return t}function f(e){return 2654435761*e|0}function h(e){return 0===e.length?0:e.reduce((e,n)=>(e<<5)+e^n)}function d(e){if(null==e)return 0;switch(typeof e){case"boolean":return e?1:0;case"number":return f(e);case"string":return c(e);default:if(function(e){return null!=e&&"function"==typeof e.GetHashCode}(e))return e.GetHashCode();if(r(e)){const n=e.length,t=new Array(n);for(let r=0;r<n;r++)t[r]=d(e[r]);return h(t)}return c(String(e))}}function g(e,n,t){if(null==e)return null==n;if(null==n)return!1;if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(!t(e[r],n[r]))return!1;return!0}function w(e,n){return g(e,n,p)}function p(e,n){return e===n||(null==e?null==n:null!=n&&("object"==typeof e&&(function(e){return null!=e&&"function"==typeof e.Equals}(e)?e.Equals(n):r(e)?r(n)&&w(e,n):e instanceof Date&&(n instanceof Date&&0===S(e,n)))))}function S(e,n){let t,r;return"offset"in e&&"offset"in n?(t=e.getTime(),r=n.getTime()):(t=e.getTime()+s(e),r=n.getTime()+s(n)),t===r?0:t<r?-1:1}function M(e,n){return e===n?0:e<n?-1:1}function m(e,n,t){if(null==e)return null==n?0:1;if(null==n)return-1;if(e.length!==n.length)return e.length<n.length?-1:1;for(let r=0,i=0;r<e.length;r++)if(i=t(e[r],n[r]),0!==i)return i;return 0}function y(e,n){return m(e,n,T)}function T(e,n){return e===n?0:null==e?null==n?0:-1:null==n?1:"object"!=typeof e?e<n?-1:1:function(e){return null!=e&&"function"==typeof e.CompareTo}(e)?e.CompareTo(n):r(e)&&r(n)?y(e,n):e instanceof Date&&n instanceof Date?S(e,n):1}function I(e,n,t){return e(n,t)<0?n:t}function C(e,n,t){return e(n,t)>0?n:t}l.idMap=new WeakMap,l.count=0;function A(e,n,t){if(null==n)return null;if("__CURRIED__"in n){n=n.__CURRIED__;for(let e=0;e<t.length;e++)n=n(t[e]);return n}switch(e){case 1:return e=>n.apply(null,t.concat([e]));case 2:return e=>r=>n.apply(null,t.concat([e,r]));case 3:return e=>r=>i=>n.apply(null,t.concat([e,r,i]));case 4:return e=>r=>i=>o=>n.apply(null,t.concat([e,r,i,o]));case 5:return e=>r=>i=>o=>a=>n.apply(null,t.concat([e,r,i,o,a]));case 6:return e=>r=>i=>o=>a=>u=>n.apply(null,t.concat([e,r,i,o,a,u]));case 7:return e=>r=>i=>o=>a=>u=>s=>n.apply(null,t.concat([e,r,i,o,a,u,s]));case 8:return e=>r=>i=>o=>a=>u=>s=>l=>n.apply(null,t.concat([e,r,i,o,a,u,s,l]));default:throw new Error("Partially applying to more than 8-arity is not supported: "+e)}}function k(e,n){if(e.has(n))return e.get(n);throw new Error(`The given key '${n}' was not present in the dictionary.`)}function E(e,n){return null!=n&&Object.getPrototypeOf(e).constructor===Object.getPrototypeOf(n).constructor}function v(e,n){return function(e,n){e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}(e,n||b),e}function b(){}function W(e,n){if(e===n)return 0;if(null==n)return-1;for(;null!=e.tail;){if(null==n.tail)return 1;const t=T(e.head,n.head);if(0!==t)return t;e=e.tail,n=n.tail}return null==n.tail?0:-1}function x(e,n){this.head=e,this.tail=n}function D(e,n,...t){this.tag=0|e,this.name=n,this.fields=t}function P(e,n){const t={},r=null==n?Object.keys(e):n(e);for(let n=0;n<r.length;n++)t[r[n]]=e[r[n]];return t}function H(e,n,t){if(e===n)return!0;if(E(e,n)){const r=null==t?Object.keys(e):t(e);for(let t=0;t<r.length;t++)if(!p(e[r[t]],n[r[t]]))return!1;return!0}return!1}function B(e,n,t){if(e===n)return 0;if(E(e,n)){const r=null==t?Object.keys(e):t(e);for(let t=0;t<r.length;t++){const i=T(e[r[t]],n[r[t]]);if(0!==i)return i}return 0}return-1}function X(){}b.prototype.toString=function(){return"{"+Object.keys(this).map(e=>e+" = "+String(this[e])).join(";\n ")+"}"},b.prototype.GetHashCode=function(){return function(e){if(null==e)return 0;switch(typeof e){case"boolean":return e?1:0;case"number":return f(e);case"string":return c(e);default:return f(l.id(e))}}(this)},b.prototype.Equals=function(e){return this===e},x.prototype.toString=function(){return"["+Array.from(this).map(e=>String(e)).join("; ")+"]"},x.prototype.toJSON=function(){return Array.from(this)},x.prototype[Symbol.iterator]=function(){let e=this;return{next:()=>{const n=e;return e=e.tail,{done:null==n.tail,value:n.head}}}},x.prototype.GetHashCode=function(){return h(Array.from(this).map(d))},x.prototype.Equals=function(e){return 0===W(this,e)},x.prototype.CompareTo=function(e){return W(this,e)},D.prototype.toString=function(){const e=this.fields.length;return 0===e?this.name:1===e?this.name+" "+String(this.fields[0]):this.name+" ("+this.fields.map(e=>String(e)).join(",")+")"},D.prototype.toJSON=function(){return 0===this.fields.length?this.name:[this.name].concat(this.fields)},D.prototype.GetHashCode=function(){const e=this.fields.map(e=>d(e));return e.splice(0,0,f(this.tag)),h(e)},D.prototype.Equals=function(e){return this===e||E(this,e)&&this.tag===e.tag&&w(this.fields,e.fields)},D.prototype.CompareTo=function(e){return this===e?0:E(this,e)?this.tag===e.tag?y(this.fields,e.fields):this.tag<e.tag?-1:1:-1},X.prototype.toString=function(){return"{"+Object.keys(this).map(e=>e+" = "+String(this[e])).join(";\n ")+"}"},X.prototype.toJSON=function(){return P(this)},X.prototype.GetHashCode=function(){return h(Object.keys(this).map(e=>d(this[e])))},X.prototype.Equals=function(e){return H(this,e)},X.prototype.CompareTo=function(e){return B(this,e)};const F=v((function(e){this.contents=e}),X),G=v((function(e){this.stack=Error().stack,this.message=e}),b);function O(e){return Object.keys(e).filter(e=>"message"!==e&&"stack"!==e)}const L=v((function(){G.call(this)}),G);L.prototype.toString=function(){const e=O(this),n=e.length;return 0===n?this.message:1===n?this.message+" "+String(this[e[0]]):this.message+" ("+e.map(e=>String(this[e])).join(",")+")"},L.prototype.toJSON=function(){return P(this,O)},L.prototype.GetHashCode=function(){return h(O(this).map(e=>d(this[e])))},L.prototype.Equals=function(e){return H(this,e,O)},L.prototype.CompareTo=function(e){return B(this,e,O)};v((function(e,n,t){this.arg1=e,this.arg2=0|n,this.arg3=0|t,this.message="The match cases were incomplete"}),L),v((function(){}),b);class N{constructor(e,n,t,r){this.declaringType=e,this.tag=n,this.name=t,this.fields=r}}class K{constructor(e,n,t,r,i,o){this.fullname=e,this.generics=n,this.constructor=t,this.fields=r,this.cases=i,this.enumCases=o}toString(){return function e(n){const t=null==n.generics||Z(n)?[]:n.generics;return t.length>0?n.fullname+"["+t.map(n=>e(n)).join(",")+"]":n.fullname}(this)}Equals(e){return j(this,e)}CompareTo(e){return U(this,e)}}function R(e){return null!=e.generics?e.generics:[]}function j(e,n){return""===e.fullname?""===n.fullname&&g($(e),$(n),([e,n],[t,r])=>e===t&&j(n,r)):e.fullname===n.fullname&&g(R(e),R(n),j)}function U(e,n){return e.fullname!==n.fullname?e.fullname<n.fullname?-1:1:m(R(e),R(n),U)}function J(e,n,t,r){return new K(e,n,t,r)}function z(e,n,t,r){const i=new K(e,n,t,void 0,()=>r().map((e,n)=>"string"==typeof e?new N(i,n,e):new N(i,n,e[0],e[1])));return i}function V(e){return new K(e.fullname+"[]",[e])}const _=new K("System.Object"),Y=(new K("Microsoft.FSharp.Core.Unit"),new K("System.Char"),new K("System.String")),q=(new K("System.Boolean"),new K("System.SByte"),new K("System.Byte"),new K("System.Int16"),new K("System.UInt16"),new K("System.Int32"));new K("System.UInt32"),new K("System.Single"),new K("System.Double"),new K("System.Decimal");function Z(e){return e.fullname.endsWith("[]")}function $(e){if(null!=e.fields)return e.fields();throw new Error(`${e.fullname} is not an F# record type`)}const Q=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const ee=v((function(e,n,t,r){this.ImageFileName=e,this.ImageColourKey=n,this.ImageWidth=t,this.ImageHeight=r}),X);const ne=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const te=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const re=v((function(e,n){this.EngineImageMetadata=e,this.HostImageObject=n}),X);function ie(){return J("ResourceFileMetadata.ImageWithHostObject",[],re,()=>[["EngineImageMetadata",J("ResourceFileMetadata.EngineImageMetadata",[],ee,()=>[["ImageFileName",Y],["ImageColourKey",z("ResourceFileMetadata.ImageColourKey",[],Q,()=>["NoColourKey","MagentaColourKey"])],["ImageWidth",q],["ImageHeight",q]])],["HostImageObject",z("ResourceFileMetadata.HostImageObject",[],te,()=>[["HostImageObject",[_]]])]])}function oe(e){return[e.EngineImageMetadata.ImageWidth,e.EngineImageMetadata.ImageHeight]}class ae{constructor(e){this.value=e}toString(){return String(this.value)}toJSON(){return this.value}GetHashCode(){return d(this.value)}Equals(e){return null!=e&&p(this.value,e instanceof ae?e.value:e)}CompareTo(e){return null==e?1:T(this.value,e instanceof ae?e.value:e)}}function ue(e){return null==(e=void 0===e?null:e)||e instanceof ae?new ae(e):e}function se(e,n){if(null==e){if(!n)throw new Error("Option has no value");return null}return e instanceof ae?e.value:e}function le(e,n,t){return null!=e?null!=t?t(se(e)):se(e):n}v((function(e,n,t){D.call(this,e,n,t)}),D);const ce=v((function(e,n,t){D.call(this,e,n,t)}),D);function fe(e,n){return 1===n.tag?(t=e(n.fields[0]),new ce(1,"Error",t)):n;var t}var he={GetHashCode(){return h([this.s,this.e].concat(this.c))},Equals(e){return!this.cmp(e)},CompareTo(e){return this.cmp(e)}},de="[big.js] ",ge=de+"Invalid ",we=ge+"decimal places",pe=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Se(e,n){var t,r,i;if(0===n&&1/n<0)n="-0";else if(!pe.test(n+=""))throw Error(ge+"number");for(e.s="-"==n.charAt(0)?(n=n.slice(1),-1):1,(t=n.indexOf("."))>-1&&(n=n.replace(".","")),(r=n.search(/e/i))>0?(t<0&&(t=r),t+=+n.slice(r+1),n=n.substring(0,r)):t<0&&(t=n.length),i=n.length,r=0;r<t&&r<i&&"0"==n.charAt(r);)++r;if(r==i)e.c=[e.e=0];else for(e.e=t-r-1,e.c=[],t=0;r<i;)e.c[t++]=+n.charAt(r++);return e=Me(e,ye.DP,ye.RM)}function Me(e,n,t,r){var i=e.c,o=e.e+n+1;if(o<i.length){if(1===t)r=i[o]>=5;else if(2===t)r=i[o]>5||5==i[o]&&(r||o<0||void 0!==i[o+1]||1&i[o-1]);else if(3===t)r=r||!!i[0];else if(r=!1,0!==t)throw Error("[big.js] Invalid rounding mode");if(o<1)i.length=1,r?(e.e=-n,i[0]=1):i[0]=e.e=0;else{if(i.length=o--,r)for(;++i[o]>9;)i[o]=0,o--||(++e.e,i.unshift(1));for(o=i.length;!i[--o];)i.pop()}}else if(t<0||t>3||t!==~~t)throw Error("[big.js] Invalid rounding mode");return e}function me(e,n,t,r){var i,o,a=e.constructor,u=!e.c[0];if(void 0!==t){if(t!==~~t||t<(3==n)||t>1e6)throw Error(3==n?ge+"precision":we);for(t=r-(e=new a(e)).e,e.c.length>++r&&Me(e,t,a.RM),2==n&&(r=e.e+t+1);e.c.length<r;)e.c.push(0)}if(i=e.e,t=(o=e.c.join("")).length,2!=n&&(1==n||3==n&&r<=i||i<=a.NE||i>=a.PE))o=o.charAt(0)+(t>1?"."+o.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)o="0"+o;o="0."+o}else if(i>0)if(++i>t)for(i-=t;i--;)o+="0";else i<t&&(o=o.slice(0,i)+"."+o.slice(i));else t>1&&(o=o.charAt(0)+"."+o.slice(1));return e.s<0&&(!u||4==n)?"-"+o:o}he.abs=function(){var e=new this.constructor(this);return e.s=1,e},he.cmp=function(e){var n,t=this.constructor,r=new t(this),i=(e=new t(e),r.c),o=e.c,a=r.s,u=e.s,s=r.e,l=e.e;if(!i[0]||!o[0])return i[0]?a:o[0]?-u:0;if(a!=u)return a;if(n=a<0,s!=l)return s>l^n?1:-1;for(u=Math.max(i.length,o.length),a=0;a<u;a++)if((s=a<i.length?i[a]:0)!=(l=a<o.length?o[a]:0))return s>l^n?1:-1;return 0},he.div=function(e){var n=this.constructor,t=new n(this),r=(e=new n(e),t.c),i=e.c,o=t.s==e.s?1:-1,a=n.DP;if(a!==~~a||a<0||a>1e6)throw Error(we);if(!i[0])throw Error("[big.js] Division by zero");if(!r[0])return new n(0*o);var u,s,l,c,f,h=i.slice(),d=u=i.length,g=r.length,w=r.slice(0,u),p=w.length,S=e,M=S.c=[],m=0,y=a+(S.e=t.e-e.e)+1;for(S.s=o,o=y<0?0:y,h.unshift(0);p++<u;)w.push(0);do{for(l=0;l<10;l++){if(u!=(p=w.length))c=u>p?1:-1;else for(f=-1,c=0;++f<u;)if(i[f]!=w[f]){c=i[f]>w[f]?1:-1;break}if(!(c<0))break;for(s=p==u?i:h;p;){if(w[--p]<s[p]){for(f=p;f&&!w[--f];)w[f]=9;--w[f],w[p]+=10}w[p]-=s[p]}for(;!w[0];)w.shift()}M[m++]=c?l:++l,w[0]&&c?w[p]=r[d]||0:w=[r[d]]}while((d++<g||void 0!==w[0])&&o--);return M[0]||1==m||(M.shift(),S.e--),m>y&&Me(S,a,n.RM,void 0!==w[0]),S},he.eq=function(e){return!this.cmp(e)},he.gt=function(e){return this.cmp(e)>0},he.gte=function(e){return this.cmp(e)>-1},he.lt=function(e){return this.cmp(e)<0},he.lte=function(e){return this.cmp(e)<1},he.minus=he.sub=function(e){var n,t,r,i,o=this.constructor,a=new o(this),u=(e=new o(e),a.s),s=e.s;if(u!=s)return e.s=-s,a.plus(e);var l=a.c.slice(),c=a.e,f=e.c,h=e.e;if(!l[0]||!f[0])return f[0]?(e.s=-s,e):new o(l[0]?a:0);if(u=c-h){for((i=u<0)?(u=-u,r=l):(h=c,r=f),r.reverse(),s=u;s--;)r.push(0);r.reverse()}else for(t=((i=l.length<f.length)?l:f).length,u=s=0;s<t;s++)if(l[s]!=f[s]){i=l[s]<f[s];break}if(i&&(r=l,l=f,f=r,e.s=-e.s),(s=(t=f.length)-(n=l.length))>0)for(;s--;)l[n++]=0;for(s=n;t>u;){if(l[--t]<f[t]){for(n=t;n&&!l[--n];)l[n]=9;--l[n],l[t]+=10}l[t]-=f[t]}for(;0===l[--s];)l.pop();for(;0===l[0];)l.shift(),--h;return l[0]||(e.s=1,l=[h=0]),e.c=l,e.e=h,e},he.mod=function(e){var n,t=this.constructor,r=new t(this),i=(e=new t(e),r.s),o=e.s;if(!e.c[0])throw Error("[big.js] Division by zero");return r.s=e.s=1,n=1==e.cmp(r),r.s=i,e.s=o,n?new t(r):(i=t.DP,o=t.RM,t.DP=t.RM=0,r=r.div(e),t.DP=i,t.RM=o,this.minus(r.times(e)))},he.plus=he.add=function(e){var n,t=this.constructor,r=new t(this),i=(e=new t(e),r.s),o=e.s;if(i!=o)return e.s=-o,r.minus(e);var a=r.e,u=r.c,s=e.e,l=e.c;if(!u[0]||!l[0])return l[0]?e:new t(u[0]?r:0*i);if(u=u.slice(),i=a-s){for(i>0?(s=a,n=l):(i=-i,n=u),n.reverse();i--;)n.push(0);n.reverse()}for(u.length-l.length<0&&(n=l,l=u,u=n),i=l.length,o=0;i;u[i]%=10)o=(u[--i]=u[i]+l[i]+o)/10|0;for(o&&(u.unshift(o),++s),i=u.length;0===u[--i];)u.pop();return e.c=u,e.e=s,e},he.pow=function(e){var n=this.constructor,t=new n(this),r=new n(1),i=new n(1),o=e<0;if(e!==~~e||e<-1e6||e>1e6)throw Error(ge+"exponent");for(o&&(e=-e);1&e&&(r=r.times(t)),e>>=1;)t=t.times(t);return o?i.div(r):r},he.round=function(e,n){var t=this.constructor;if(void 0===e)e=0;else if(e!==~~e||e<-1e6||e>1e6)throw Error(we);return Me(new t(this),e,void 0===n?t.RM:n)},he.sqrt=function(){var e,n,t,r=this.constructor,i=new r(this),o=i.s,a=i.e,u=new r(.5);if(!i.c[0])return new r(i);if(o<0)throw Error(de+"No square root");0===(o=Math.sqrt(i+""))||o===1/0?((n=i.c.join("")).length+a&1||(n+="0"),a=((a+1)/2|0)-(a<0||1&a),e=new r(((o=Math.sqrt(n))==1/0?"1e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):e=new r(o),a=e.e+(r.DP+=4);do{t=e,e=u.times(t.plus(i.div(t)))}while(t.c.slice(0,a).join("")!==e.c.slice(0,a).join(""));return Me(e,r.DP-=4,r.RM)},he.times=he.mul=function(e){var n,t=this.constructor,r=new t(this),i=(e=new t(e),r.c),o=e.c,a=i.length,u=o.length,s=r.e,l=e.e;if(e.s=r.s==e.s?1:-1,!i[0]||!o[0])return new t(0*e.s);for(e.e=s+l,a<u&&(n=i,i=o,o=n,l=a,a=u,u=l),n=new Array(l=a+u);l--;)n[l]=0;for(s=u;s--;){for(u=0,l=a+s;l>s;)u=n[l]+o[s]*i[l-s-1]+u,n[l--]=u%10,u=u/10|0;n[l]=(n[l]+u)%10}for(u?++e.e:n.shift(),s=n.length;!n[--s];)n.pop();return e.c=n,e},he.toExponential=function(e){return me(this,1,e,e)},he.toFixed=function(e){return me(this,2,e,this.e+e)},he.toPrecision=function(e){return me(this,3,e,e-1)},he.toString=function(){return me(this)},he.valueOf=he.toJSON=function(){return me(this,4)};var ye=function e(){function n(t){var r=this;if(!(r instanceof n))return void 0===t?e():new n(t);t instanceof n?(r.s=t.s,r.e=t.e,r.c=t.c.slice(),function(e){if((e=Me(e,28,0)).c.length>1&&!e.c[0]){let n=e.c.findIndex(e=>e);e.c=e.c.slice(n),e.e=e.e-n}}(r)):Se(r,t),r.constructor=n}return n.prototype=he,n.DP=28,n.RM=1,n.NE=-29,n.PE=29,n.version="5.2.2",n}(),Te=ye,Ie=Te;new Te(0),new Te(1),new Te(-1),new Te("79228162514264337593543950335"),new Te("-79228162514264337593543950335");var Ce;function Ae(e){return-2147483648===e?e:-e}!function(e){e[e.AllowHexSpecifier=512]="AllowHexSpecifier"}(Ce||(Ce={}));var ke=null;try{ke=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Ee(e,n,t){this.low=0|e,this.high=0|n,this.unsigned=!!t}function ve(e){return!0===(e&&e.__isLong__)}Ee.prototype.GetHashCode=function(){let e=this.unsigned?1:0;return e=(e<<5)+e^this.high,e=(e<<5)+e^this.low,e},Ee.prototype.Equals=function(e){return en(this,e)},Ee.prototype.CompareTo=function(e){return on(this,e)},Ee.prototype.toString=function(e){return qe(this,e)},Ee.prototype.toJSON=function(){return qe(this)},Ee.prototype.__isLong__,Object.defineProperty(Ee.prototype,"__isLong__",{value:!0});var be={},We={};function xe(e,n){var t,r,i;return n?(i=0<=(e>>>=0)&&e<256)&&(r=We[e])?r:(t=Pe(e,(0|e)<0?-1:0,!0),i&&(We[e]=t),t):(i=-128<=(e|=0)&&e<128)&&(r=be[e])?r:(t=Pe(e,e<0?-1:0,!1),i&&(be[e]=t),t)}function De(e,n){if(isNaN(e))return n?Ke:Ne;if(n){if(e<0)return Ke;if(e>=Ge)return ze}else{if(e<=-Oe)return Ve;if(e+1>=Oe)return Je}return e<0?an(De(-e,n)):Pe(e%Fe|0,e/Fe|0,n)}function Pe(e,n,t){return new Ee(e,n,t)}var He=Math.pow;function Be(e,n,t){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return Ne;if("number"==typeof n?(t=n,n=!1):n=!!n,(t=t||10)<2||36<t)throw RangeError("radix");var r=e.indexOf("-");if(r>0)throw Error("interior hyphen");if(0===r)return an(Be(e.substring(1),n,t));for(var i=De(He(t,8)),o=Ne,a=0;a<e.length;a+=8){var u=Math.min(8,e.length-a),s=parseInt(e.substring(a,a+u),t);if(u<8)o=un(ln(o,De(He(t,u))),De(s));else o=un(o=ln(o,i),De(s))}return o.unsigned=n,o}function Xe(e,n){return"number"==typeof e?De(e,n):"string"==typeof e?Be(e,n):Pe(e.low,e.high,"boolean"==typeof n?n:e.unsigned)}var Fe=4294967296,Ge=Fe*Fe,Oe=Ge/2,Le=xe(1<<24),Ne=xe(0),Ke=xe(0,!0),Re=xe(1),je=xe(1,!0),Ue=xe(-1),Je=Pe(-1,2147483647,!1),ze=Pe(-1,-1,!0),Ve=Pe(0,-2147483648,!1);function _e(e){return e.unsigned?e.low>>>0:e.low}function Ye(e){return e.unsigned?(e.high>>>0)*Fe+(e.low>>>0):e.high*Fe+(e.low>>>0)}function qe(e,n){if((n=n||10)<2||36<n)throw RangeError("radix");if(Ze(e))return"0";if($e(e)){if(en(e,Ve)){var t=De(n),r=cn(e,t),i=sn(ln(r,t),e);return qe(r,n)+_e(i).toString(n)}return"-"+qe(an(e),n)}for(var o=De(He(n,6),e.unsigned),a=e,u="";;){var s=cn(a,o),l=(_e(sn(a,ln(s,o)))>>>0).toString(n);if(Ze(a=s))return l+u;for(;l.length<6;)l="0"+l;u=""+l+u}}function Ze(e){return 0===e.high&&0===e.low}function $e(e){return!e.unsigned&&e.high<0}function Qe(e){return 1==(1&e.low)}function en(e,n){return ve(n)||(n=Xe(n)),(e.unsigned===n.unsigned||e.high>>>31!=1||n.high>>>31!=1)&&(e.high===n.high&&e.low===n.low)}function nn(e,n){return on(e,n)<0}function tn(e,n){return on(e,n)>0}function rn(e,n){return on(e,n)>=0}function on(e,n){if(ve(n)||(n=Xe(n)),en(e,n))return 0;var t=$e(e),r=$e(n);return t&&!r?-1:!t&&r?1:e.unsigned?n.high>>>0>e.high>>>0||n.high===e.high&&n.low>>>0>e.low>>>0?-1:1:$e(sn(e,n))?-1:1}function an(e){return!e.unsigned&&en(e,Ve)?Ve:un(fn(e),Re)}function un(e,n){ve(n)||(n=Xe(n));var t=e.high>>>16,r=65535&e.high,i=e.low>>>16,o=65535&e.low,a=n.high>>>16,u=65535&n.high,s=n.low>>>16,l=0,c=0,f=0,h=0;return f+=(h+=o+(65535&n.low))>>>16,c+=(f+=i+s)>>>16,l+=(c+=r+u)>>>16,l+=t+a,Pe((f&=65535)<<16|(h&=65535),(l&=65535)<<16|(c&=65535),e.unsigned)}function sn(e,n){return ve(n)||(n=Xe(n)),un(e,an(n))}function ln(e,n){if(Ze(e))return e.unsigned?Ke:Ne;if(ve(n)||(n=Xe(n)),ke)return Pe(ke.mul(e.low,e.high,n.low,n.high),ke.get_high(),e.unsigned);if(Ze(n))return e.unsigned?Ke:Ne;if(en(e,Ve))return Qe(n)?Ve:Ne;if(en(n,Ve))return Qe(e)?Ve:Ne;if($e(e))return $e(n)?ln(an(e),an(n)):an(ln(an(e),n));if($e(n))return an(ln(e,an(n)));if(nn(e,Le)&&nn(n,Le))return De(Ye(e)*Ye(n),e.unsigned);var t=e.high>>>16,r=65535&e.high,i=e.low>>>16,o=65535&e.low,a=n.high>>>16,u=65535&n.high,s=n.low>>>16,l=65535&n.low,c=0,f=0,h=0,d=0;return h+=(d+=o*l)>>>16,f+=(h+=i*l)>>>16,h&=65535,f+=(h+=o*s)>>>16,c+=(f+=r*l)>>>16,f&=65535,c+=(f+=i*s)>>>16,f&=65535,c+=(f+=o*u)>>>16,c+=t*l+r*s+i*u+o*a,Pe((h&=65535)<<16|(d&=65535),(c&=65535)<<16|(f&=65535),e.unsigned)}function cn(e,n){if(ve(n)||(n=Xe(n)),Ze(n))throw Error("division by zero");var t,r,i;if(ke)return e.unsigned||-2147483648!==e.high||-1!==n.low||-1!==n.high?Pe((e.unsigned?ke.div_u:ke.div_s)(e.low,e.high,n.low,n.high),ke.get_high(),e.unsigned):e;if(Ze(e))return e.unsigned?Ke:Ne;if(e.unsigned){if(n.unsigned||(n=function(e){return e.unsigned?e:Pe(e.low,e.high,!0)}(n)),tn(n,e))return Ke;if(tn(n,gn(e,1)))return je;i=Ke}else{if(en(e,Ve))return en(n,Re)||en(n,Ue)?Ve:en(n,Ve)?Re:en(t=hn(cn(dn(e,1),n),1),Ne)?$e(n)?Re:Ue:i=un(t,cn(r=sn(e,ln(n,t)),n));if(en(n,Ve))return e.unsigned?Ke:Ne;if($e(e))return $e(n)?cn(an(e),an(n)):an(cn(an(e),n));if($e(n))return an(cn(e,an(n)));i=Ne}for(r=e;rn(r,n);){t=Math.max(1,Math.floor(Ye(r)/Ye(n)));for(var o=Math.ceil(Math.log(t)/Math.LN2),a=o<=48?1:He(2,o-48),u=De(t),s=ln(u,n);$e(s)||tn(s,r);)s=ln(u=De(t-=a,e.unsigned),n);Ze(u)&&(u=Re),i=un(i,u),r=sn(r,s)}return i}function fn(e){return Pe(~e.low,~e.high,e.unsigned)}function hn(e,n){return ve(n)&&(n=_e(n)),0==(n&=63)?e:n<32?Pe(e.low<<n,e.high<<n|e.low>>>32-n,e.unsigned):Pe(0,e.low<<n-32,e.unsigned)}function dn(e,n){return ve(n)&&(n=_e(n)),0==(n&=63)?e:n<32?Pe(e.low>>>n|e.high<<32-n,e.high>>n,e.unsigned):Pe(e.high>>n-32,e.high>=0?0:-1,e.unsigned)}function gn(e,n){if(ve(n)&&(n=_e(n)),0===(n&=63))return e;var t=e.high;return n<32?Pe(e.low>>>n|t<<32-n,t>>>n,e.unsigned):Pe(32===n?t:t>>>n-32,0,e.unsigned)}var wn=Ee;const pn=ln,Sn=on,Mn=function(e,n,t){return t?function(e,n){return new Ee(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)}(e,n):function(e,n){return new Ee(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)}(e,n)},mn=function(e,n){return n?function(e){var n=e.high,t=e.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&n,n>>>8&255,n>>>16&255,n>>>24]}(e):function(e){var n=e.high,t=e.low;return[n>>>24,n>>>16&255,n>>>8&255,255&n,t>>>24,t>>>16&255,t>>>8&255,255&t]}(e)},yn=qe;class Tn{constructor(e){this.iter=e}MoveNext(){const e=this.iter.next();return this.current=e.value,!e.done}get Current(){return this.current}Reset(){throw new Error("JS iterators cannot be reset")}Dispose(){}}function In(e){return new Tn(e[Symbol.iterator]())}function Cn(e){return{next:()=>e.MoveNext()?{done:!1,value:e.Current}:{done:!0,value:null}}}function An(e){return En(()=>{const n=e[Symbol.iterator]();let t={value:null};return Fn(e=>{let r=!1;for(;!r;)if(null==e){const t=n.next();t.done?r=!0:e=t.value[Symbol.iterator]()}else{const n=e.next();n.done?e=null:(t={value:n.value},r=!0)}return null!=e&&null!=t?[t.value,e]:null},null)})}function kn(e,n){return An(Pn(e,n))}function En(e){return{[Symbol.iterator]:()=>e()[Symbol.iterator]()}}function vn(){return Fn(()=>null,void 0)}function bn(e,n){let t;for(const r=n[Symbol.iterator]();t=r.next(),!t.done;)if(e(t.value))return!0;return!1}function Wn(e,n,t){if(Array.isArray(t)||ArrayBuffer.isView(t))return t.reduce(e,n);{let r;for(let i=0,o=t[Symbol.iterator]();r=o.next(),!r.done;i++)n=e(n,r.value,i);return n}}function xn(e,n){Wn((n,t)=>(e(t),null),null,n)}function Dn(e,n){Wn((n,t,r)=>(e(null!=r?r:0,t),null),null,n)}function Pn(e,n){return En(()=>Fn(n=>{const t=n.next();return t.done?null:[e(t.value),n]},n[Symbol.iterator]()))}function Hn(e,n,t){if(0===n)throw new Error("Step cannot be 0");return En(()=>Fn(e=>n>0&&e<=t||n<0&&e>=t?[e,e+n]:null,e))}function Bn(e){return[e]}function Xn(e,n,t){return Wn((n,r)=>t.Add(n,e(r)),t.GetZero(),n)}function Fn(e,n){return{[Symbol.iterator]:()=>{let t=n;return{next:()=>{const n=e(t);if(null!=n){const e=se(n);if(null!=e)return t=e[1],{done:!1,value:e[0]}}return{done:!0,value:void 0}}}}}}function Gn(e){const n=e<0,t=(e=Math.abs(e))%36e5/6e4;return(n?"-":"+")+u(~~(e/36e5),2)+":"+u(t,2)}function On(e,n){const t=e.toISOString();return"first"===n?t.substring(0,t.indexOf("T")):t.substring(t.indexOf("T")+1,t.length-1)}function Ln(e,n,t){return n.replace(/(\w)\1*/g,n=>{let r=Number.NaN;switch(n.substring(0,1)){case"y":const i=t?e.getUTCFullYear():e.getFullYear();r=n.length<4?i%100:i;break;case"M":r=(t?e.getUTCMonth():e.getMonth())+1;break;case"d":r=t?e.getUTCDate():e.getDate();break;case"H":r=t?e.getUTCHours():e.getHours();break;case"h":const o=t?e.getUTCHours():e.getHours();r=o>12?o%12:o;break;case"m":r=t?e.getUTCMinutes():e.getMinutes();break;case"s":r=t?e.getUTCSeconds():e.getSeconds();break;case"f":r=t?e.getUTCMilliseconds():e.getMilliseconds()}return Number.isNaN(r)?n:r<10&&n.length>1?"0"+r:""+r})}function Nn(e,n){var t,r,i;const o=new Date(e.getTime()+(null!=(t=e.offset)?t:0));if("string"!=typeof n)return o.toISOString().replace(/\.\d+/,"").replace(/[A-Z]|\.\d+/g," ")+Gn(null!=(r=e.offset)?r:0);if(1!==n.length)return Ln(o,n,!0);switch(n){case"D":case"d":return On(o,"first");case"T":case"t":return On(o,"second");case"O":case"o":return function(e,n){const t=e.toISOString();return t.substring(0,t.length-1)+Gn(n)}(o,null!=(i=e.offset)?i:0);default:throw new Error("Unrecognized Date print format")}}function Kn(e,n){const t=1===e.kind;if("string"!=typeof n)return t?e.toUTCString():e.toLocaleString();if(1!==n.length)return Ln(e,n,t);switch(n){case"D":case"d":return t?On(e,"first"):e.toLocaleDateString();case"T":case"t":return t?On(e,"second"):e.toLocaleTimeString();case"O":case"o":return function(e,n){if(n)return e.toISOString();{const n=null==e.kind||2===e.kind;return u(e.getFullYear(),4)+"-"+u(e.getMonth()+1,2)+"-"+u(e.getDate(),2)+"T"+u(e.getHours(),2)+":"+u(e.getMinutes(),2)+":"+u(e.getSeconds(),2)+"."+u(e.getMilliseconds(),3)+(n?Gn(-6e4*e.getTimezoneOffset()):"")}}(e,t);default:throw new Error("Unrecognized Date print format")}}const Rn=/(^|[^%])%([0+\- ]*)(\d+)?(?:\.(\d+))?(\w)/,jn=/\{(\d+)(,-?\d+)?(?:\:([a-zA-Z])(\d{0,2})|\:(.+?))?\}/g;function Un(e){return"number"==typeof e||e instanceof wn||e instanceof Ie}function Jn(e,n){return e instanceof wn?Sn(e,n)<0:e instanceof Ie?e.cmp(n)<0:e<n}function zn(e,n){return e instanceof wn?pn(e,n):e instanceof Ie?e.mul(n):e*n}function Vn(e,n){return e instanceof wn?String(e)+(0).toFixed(n).substr(1):e.toFixed(n)}function _n(e,n){return e instanceof wn?String(e)+(0).toPrecision(n).substr(1):e.toPrecision(n)}function Yn(e,n){return e instanceof wn?String(e)+(0).toExponential(n).substr(1):e.toExponential(n)}function qn(e){return e instanceof wn?yn(e.unsigned?e:Mn(mn(e),!0),16):(Number(e)>>>0).toString(16)}function Zn(e){return{input:e,cont:(n=e,e=>Rn.test(n)?function e(n,t){return(...r)=>{let i=n;for(const e of r)i=Qn(i,e);return Rn.test(i)?e(i,t):t(i.replace(/%%/g,"%"))}}(n,e):e(n))};var n}function $n(e){return e.cont(e=>e)}function Qn(e,n){return e.replace(Rn,(e,t,r,i,o,a)=>{let u="";if(Un(n))switch("x"!==a.toLowerCase()&&(Jn(n,0)?(n=zn(n,-1),u="-"):r.indexOf(" ")>=0?u=" ":r.indexOf("+")>=0&&(u="+")),o=null==o?null:parseInt(o,10),a){case"f":case"F":n=Vn(n,o=null!=o?o:6);break;case"g":case"G":n=null!=o?_n(n,o):_n(n);break;case"e":case"E":n=null!=o?Yn(n,o):Yn(n);break;case"x":n=qn(n);break;case"X":n=qn(n).toUpperCase();break;default:n=String(n)}if(i=parseInt(i,10),isNaN(i))n=u+n;else{const e=r.indexOf("0")>=0,t=r.indexOf("-")>=0,o=t||!e?" ":"0";n="0"===o?u+(n=rt(n,i-u.length,o,t)):rt(u+n,i,o,t)}return(t+n).replace(/%/g,"%%")})}function et(e,...n){return"object"==typeof e&&n.length>0&&(e=n[0],n.shift()),e.replace(jn,(e,t,r,i,o,a)=>{let u=n[t];if(Un(u))switch(o=null==o?null:parseInt(o,10),i){case"f":case"F":u=Vn(u,o=null!=o?o:2);break;case"g":case"G":u=null!=o?_n(u,o):_n(u);break;case"e":case"E":u=null!=o?Yn(u,o):Yn(u);break;case"p":case"P":o=null!=o?o:2,u=Vn(zn(u,100),o)+" %";break;case"d":case"D":u=null!=o?rt(String(u),o,"0"):String(u);break;case"x":case"X":u=null!=o?rt(qn(u),o,"0"):qn(u),"X"===i&&(u=u.toUpperCase());break;default:if(a){let e="";u=a.replace(/(0+)(\.0+)?/,(n,t,r)=>(Jn(u,0)&&(u=zn(u,-1),e="-"),u=Vn(u,null!=r?r.length-1:0),rt(u,(t||"").length-e.length+(null!=r?r.length:0),"0"))),u=e+u}}else u instanceof Date&&(u=function(e,n){return null!=e.offset?Nn(e,n):Kn(e,n)}(u,a||i));return r=parseInt((r||" ").substring(1),10),isNaN(r)||(u=rt(String(u),Math.abs(r)," ",r<0)),u})}function nt(e,n){if(e<0)throw new Error("String length must be non-negative");const t=new Array(e);for(let r=0;r<e;r++)t[r]=n(r);return t.join("")}function tt(e,n){return Array.isArray(n)?n.join(e):Array.from(n).join(e)}function rt(e,n,t,r){t=t||" ",n-=e.length;for(let i=0;i<n;i++)e=r?e+t:t+e;return e}function it(e,n,t){if(n+(t||0)>e.length)throw new Error("Invalid startIndex and/or length");return null!=t?e.substr(n,t):e.substr(n)}const ot=v((function(e,n){const t=new F(null);this.comparer=n,t.contents=this,this.hashMap=new Map([]),this["init@20-1"]=1,xn((function(e){ct(t.contents,e[0],e[1])}),e)}));function at(e,n){const t=0|e.comparer.GetHashCode(n),r=o(e.hashMap,t,null);return r[0]?[!0,t,r[1].findIndex((function(t){return e.comparer.Equals(n,t[0])}))]:[!1,t,-1]}function ut(e,n){const t=at(e,n);switch(t[0]&&t[2]>-1?0:1){case 0:return k(e.hashMap,t[1])[t[2]];case 1:return null}}function st(e){e.hashMap.clear()}function lt(e){return 0|Xn((function(e){return e.length}),e.hashMap.values(),{GetZero:()=>0,Add:(e,n)=>e+n})}function ct(e,n,t){const r=at(e,n);switch(r[0]&&r[2]>-1?0:1){case 0:{let e;throw e=$n(Zn("An item with the same key has already been added. Key: %A"))(n),new Error(e)}case 1:if(r[0]){$t([n,t],k(e.hashMap,r[1]))}else e.hashMap.set(r[1],[[n,t]])}}function ft(e,n){const t=at(e,n);switch(t[0]&&t[2]>-1?0:1){case 0:return k(e.hashMap,t[1]).splice(t[2],1),!0;case 1:return!1}}ot.prototype[Symbol.iterator]=function(){const e=this;return Cn(In(En((function(){return kn((function(e){return Pn((function(e){return e}),e)}),e.hashMap.values())}))))},ot.prototype.Add=function(e){ct(this,e[0],e[1])},ot.prototype.Clear=function(){st(this)},ot.prototype.Contains=function(e){const n=ut(this,e[0]);switch(null!=n&&p(n[1],e[1])?0:1){case 0:return!0;case 1:return!1}},ot.prototype.CopyTo=function(e,n){Dn((function(t,r){e[n+t]=r}),this)},Object.defineProperty(ot.prototype,"Count",{get:function(){return 0|lt(this)}}),Object.defineProperty(ot.prototype,"IsReadOnly",{get:function(){return!1}}),ot.prototype.Remove=function(e){const n=this,t=ut(n,e[0]);if(null!=t){if(p(t[1],e[1])){ft(n,e[0])}return!0}return!1},Object.defineProperty(ot.prototype,"size",{get:function(){return 0|lt(this)}}),ot.prototype.clear=function(){st(this)},ot.prototype.delete=function(e){return ft(this,e)},ot.prototype.entries=function(){return Pn((function(e){return e}),this)},ot.prototype.get=function(e){return function(e,n){const t=ut(e,n);if(null!=t){return t[1]}throw new Error("The item was not found in collection")}(this,e)},ot.prototype.has=function(e){return function(e,n){const t=at(e,n);switch(t[0]&&t[2]>-1?0:1){case 0:return!0;case 1:return!1}}(this,e)},ot.prototype.keys=function(){return Pn((function(e){return e[0]}),this)},ot.prototype.set=function(e,n){return function(e,n,t){const r=at(e,n);switch(r[0]&&r[2]>-1?0:1){case 0:k(e.hashMap,r[1])[r[2]]=[n,t];break;case 1:if(r[0]){$t([n,t],k(e.hashMap,r[1]))}else e.hashMap.set(r[1],[[n,t]])}}(this,e,n),this},ot.prototype.values=function(){return Pn((function(e){return e[1]}),this)};const ht=v((function(e,n,...t){D.call(this,e,n,...t)}),D);function dt(e){return function e(n,t){e:for(;;){const r=n,i=t;switch(i.tag){case 1:return r+1|0;case 2:n=e(r+1,i.fields[2]),t=i.fields[3];continue e;default:return 0|r}break}}(0,e)}function gt(e,n,t){e:for(;;){const r=e,i=n,o=t;switch(o.tag){case 1:if(0===(0|r.Compare(i,o.fields[0])))return o.fields[1];throw new Error("key not found");case 2:{const a=0|r.Compare(i,o.fields[0]);if(a<0){e=r,n=i,t=o.fields[2];continue e}if(0===a)return o.fields[1];e=r,n=i,t=o.fields[3];continue e}default:throw new Error("key not found")}break}}function wt(e,n,t){e:for(;;){const r=e,i=n,o=t;switch(o.tag){case 1:return 0===r.Compare(i,o.fields[0]);case 2:{const a=0|r.Compare(i,o.fields[0]);if(a<0){e=r,n=i,t=o.fields[2];continue e}if(0===a)return!0;e=r,n=i,t=o.fields[3];continue e}default:return!1}break}}const pt=v((function(e,n){this.stack=e,this.started=n}),X);function St(e){for(;;){const n=e;if(null==n.tail)return new x;if(1===n.head.tag)return n;2!==n.head.tag?e=n.tail:e=new x(n.head.fields[2],new x(new ht(1,"MapOne",n.head.fields[0],n.head.fields[1]),new x(n.head.fields[3],n.tail)))}}function Mt(e){return new pt(St(new x(e,new x)),!1)}function mt(e){if(e.started){const n=e.stack;if(null==n.tail)return function(){throw new Error("enumeration already finished")}();if(1===n.head.tag)return[n.head.fields[0],n.head.fields[1]];throw new Error("Please report error: Map iterator, unexpected stack for current")}return function(){throw new Error("enumeration not started")}()}const yt=v((function(e){this.s=e,this.i=Mt(this.s)}));function Tt(e){return function(e){return this instanceof yt?yt.call(this,e):new yt(e)}(e)}function It(e){return Fn((function(e){return e.MoveNext()?[e.Current,e]:null}),Tt(e))}Object.defineProperty(yt.prototype,"Current",{get:function(){return mt(this.i)}}),yt.prototype.MoveNext=function(){return function(e){if(e.started){const n=e.stack;if(null==n.tail)return!1;if(1===n.head.tag)return e.stack=St(n.tail),!(null==e.stack.tail);throw new Error("Please report error: Map iterator, unexpected stack for moveNext")}return e.started=!0,!(null==e.stack.tail)}(this.i)},yt.prototype.Reset=function(){this.i=Mt(this.s)},yt.prototype.Dispose=function(){};const Ct=v((function(e,n){this.comparer=e,this.tree=n}));function At(e){return e.tree}function kt(e,n){return gt(e.comparer,n,e.tree)}function Et(e){return dt(e.tree)}function vt(e,n){return wt(e.comparer,n,e.tree)}Ct.prototype.toString=function(){return"map ["+tt("; ",Pn((function(e){return $n(Zn("(%A, %A)"))(e[0])(e[1])}),this))+"]"},Ct.prototype.GetHashCode=function(){const e=function(e,n){return(e<<1)+n+631};let n=0;const t=Tt(At(this));for(;t.MoveNext();){const r=t.Current;n=e(n,d(r[0])),n=e(n,d(r[1]))}return 0|Math.abs(n)},Ct.prototype.Equals=function(e){return 0===this.CompareTo(e)},Ct.prototype[Symbol.iterator]=function(){return Cn(Tt(this.tree))},Ct.prototype.CompareTo=function(e){const n=this;let t=0,r=!1;const o=Tt(At(n));try{const a=Tt(At(e));try{for(;!r&&0===t;){const e=[o.MoveNext(),a.MoveNext()];if(e[0])if(e[1]){const e=o.Current,r=a.Current,i=0|n.comparer.Compare(e[0],r[0]);t=0!==i?i:T(e[1],r[1])}else t=1;else e[1]?t=-1:r=!0}return 0|t}finally{i(a)&&a.Dispose()}}finally{i(o)&&o.Dispose()}},Object.defineProperty(Ct.prototype,"size",{get:function(){return 0|Et(this)}}),Ct.prototype.clear=function(){throw new Error("Map cannot be mutated")},Ct.prototype.delete=function(e){throw new Error("Map cannot be mutated")},Ct.prototype.entries=function(){return It(At(this))},Ct.prototype.get=function(e){return kt(this,e)},Ct.prototype.has=function(e){return vt(this,e)},Ct.prototype.keys=function(){return Pn((function(e){return e[0]}),It(At(this)))},Ct.prototype.set=function(e,n){throw new Error("Map cannot be mutated")},Ct.prototype.values=function(){return Pn((function(e){return e[1]}),It(At(this)))};const bt=v((function(e,n){const t=new F(null);this.comparer=n,t.contents=this,this.hashMap=new Map([]),this["init@21-2"]=1,xn((function(e){Ht(t.contents,e)}),e)}));function Wt(e,n){return this instanceof bt?bt.call(this,e,n):new bt(e,n)}function xt(e,n){const t=0|e.comparer.GetHashCode(n),r=o(e.hashMap,t,null);return r[0]?[!0,t,r[1].findIndex((function(t){return e.comparer.Equals(n,t)}))]:[!1,t,-1]}function Dt(e){e.hashMap.clear()}function Pt(e){return 0|Xn((function(e){return e.length}),e.hashMap.values(),{GetZero:()=>0,Add:(e,n)=>e+n})}function Ht(e,n){const t=xt(e,n);switch(t[0]&&t[2]>-1?0:1){case 0:return!1;case 1:if(t[0]){$t(n,k(e.hashMap,t[1]));return!0}return e.hashMap.set(t[1],[n]),!0}}function Bt(e,n){const t=xt(e,n);switch(t[0]&&t[2]>-1?0:1){case 0:return!0;case 1:return!1}}function Xt(e,n){const t=xt(e,n);switch(t[0]&&t[2]>-1?0:1){case 0:return k(e.hashMap,t[1]).splice(t[2],1),!0;case 1:return!1}}bt.prototype[Symbol.iterator]=function(){const e=this;return Cn(In(En((function(){return kn((function(e){return Pn((function(e){return e}),e)}),e.hashMap.values())}))))},bt.prototype.Add=function(e){Ht(this,e)},bt.prototype.Clear=function(){Dt(this)},bt.prototype.Contains=function(e){return Bt(this,e)},bt.prototype.CopyTo=function(e,n){Dn((function(t,r){e[n+t]=r}),this)},Object.defineProperty(bt.prototype,"Count",{get:function(){return 0|Pt(this)}}),Object.defineProperty(bt.prototype,"IsReadOnly",{get:function(){return!1}}),bt.prototype.Remove=function(e){return Xt(this,e)},Object.defineProperty(bt.prototype,"size",{get:function(){return 0|Pt(this)}}),bt.prototype.add=function(e){Ht(this,e);return this},bt.prototype.add_=function(e){return Ht(this,e)},bt.prototype.clear=function(){Dt(this)},bt.prototype.delete=function(e){return Xt(this,e)},bt.prototype.has=function(e){return Bt(this,e)},bt.prototype.keys=function(){return Pn((function(e){return e}),this)},bt.prototype.values=function(){return Pn((function(e){return e}),this)},bt.prototype.entries=function(){return Pn((function(e){return[e,e]}),this)};const Ft=v((function(e,n,...t){D.call(this,e,n,...t)}),D);function Gt(e){return new Ft(2,"SetOne",e)}function Ot(e,n,t,r){return new Ft(1,"SetNode",e,n,t,r)}const Lt=v((function(e,n){this.stack=e,this.started=n}),X);function Nt(e){for(;;){const n=e;if(null==n.tail)return new x;if(2===n.head.tag)return n;1!==n.head.tag?e=n.tail:e=new x(n.head.fields[1],new x(Gt(n.head.fields[0]),new x(n.head.fields[2],n.tail)))}}function Kt(e){return new Lt(Nt(new x(e,new x)),!1)}function Rt(e){if(e.started){const n=e.stack;if(null==n.tail)return function(){throw new Error("Enumeration already started")}();if(2===n.head.tag)return n.head.fields[0];throw new Error("Please report error: Set iterator, unexpected stack for current")}return function(){throw new Error("Enumeration not started")}()}const jt=v((function(e){this.s=e,this.i=Kt(this.s)}));function Ut(e){return function(e){return this instanceof jt?jt.call(this,e):new jt(e)}(e)}function Jt(e,n,t){return 0===n.tag?0===t.tag?0:-1:0===t.tag?1:0|function(e,n,t){e:for(;;){const N=e,K=n,R=t;var r,i,o,a,u,s,l,c,f,h,d,g,w,p,S,M,m,y,T,I,C,A,k,E,v,b,W,D,P,H,B,X,F,G,O,L;switch(null!=K.tail?null!=R.tail?2===R.head.tag?2===K.head.tag?(r=4,a=K.head.fields[0],u=R.head.fields[0],s=K.tail,l=R.tail):1===K.head.tag?0===K.head.fields[1].tag?(r=6,w=K.head.fields[1],p=K.head.fields[0],S=K.head.fields[2],M=R.head.fields[0],m=K.tail,y=R.tail):(r=9,W=K.head.fields[0],D=K.head.fields[1],P=K.head.fields[2],H=K.tail):(r=10,B=R.head.fields[0],X=R.tail):1===R.head.tag?0===R.head.fields[1].tag?2===K.head.tag?(r=5,c=K.head.fields[0],f=R.head.fields[0],h=R.head.fields[2],d=K.tail,g=R.tail):1===K.head.tag?0===K.head.fields[1].tag?(r=7,T=K.head.fields[0],I=K.head.fields[2],C=R.head.fields[0],A=R.head.fields[2],k=K.tail,E=R.tail):(r=9,W=K.head.fields[0],D=K.head.fields[1],P=K.head.fields[2],H=K.tail):(r=11,F=R.head.fields[0],G=R.head.fields[1],O=R.head.fields[2],L=R.tail):2===K.head.tag?(r=8,v=K.head.fields[0],b=K.tail):1===K.head.tag?(r=9,W=K.head.fields[0],D=K.head.fields[1],P=K.head.fields[2],H=K.tail):(r=11,F=R.head.fields[0],G=R.head.fields[1],O=R.head.fields[2],L=R.tail):2===K.head.tag?(r=8,v=K.head.fields[0],b=K.tail):1===K.head.tag?(r=9,W=K.head.fields[0],D=K.head.fields[1],P=K.head.fields[2],H=K.tail):(r=3,i=K.tail,o=R.tail):r=2:r=null!=R.tail?1:0,r){case 0:return 0;case 1:return-1;case 2:return 1;case 3:e=N,n=i,t=o;continue e;case 4:{const r=0|N.Compare(a,u);if(0!==r)return 0|r;e=N,n=s,t=l;continue e}case 5:{const r=0|N.Compare(c,f);if(0!==r)return 0|r;e=N,n=new x(new Ft(0,"SetEmpty"),d),t=new x(h,g);continue e}case 6:{const r=0|N.Compare(p,M);if(0!==r)return 0|r;e=N,n=new x(S,m),t=new x(w,y);continue e}case 7:{const r=0|N.Compare(T,C);if(0!==r)return 0|r;e=N,n=new x(I,k),t=new x(A,E);continue e}case 8:e=N,n=new x(new Ft(0,"SetEmpty"),new x(Gt(v),b)),t=R;continue e;case 9:e=N,n=new x(D,new x(Ot(W,new Ft(0,"SetEmpty"),P,0),H)),t=R;continue e;case 10:e=N,n=K,t=new x(new Ft(0,"SetEmpty"),new x(Gt(B),X));continue e;case 11:e=N,n=K,t=new x(G,new x(Ot(F,new Ft(0,"SetEmpty"),O,0),L));continue e}break}}(e,new x(n,new x),new x(t,new x))}Object.defineProperty(jt.prototype,"Current",{get:function(){return Rt(this.i)}}),jt.prototype.MoveNext=function(){return function(e){if(e.started){const n=e.stack;if(null==n.tail)return!1;if(2===n.head.tag)return e.stack=Nt(n.tail),!(null==e.stack.tail);throw new Error("Please report error: Set iterator, unexpected stack for moveNext")}return e.started=!0,!(null==e.stack.tail)}(this.i)},jt.prototype.Reset=function(){this.i=Kt(this.s)},jt.prototype.Dispose=function(){};const zt=v((function(e,n){this.comparer=e,this.tree=n}));function Vt(e){return e.comparer}function _t(e){return e.tree}function Yt(e,n){return Wt(e,n)}zt.prototype.toString=function(){return"set ["+tt("; ",Pn((function(e){return String(e)}),this))+"]"},zt.prototype.GetHashCode=function(){let e=0;const n=Ut(_t(this));for(;n.MoveNext();){e=((0|e)<<1)+(0|d(n.Current))+631}return 0|Math.abs(e)},zt.prototype.Equals=function(e){return 0===Jt(Vt(this),_t(this),_t(e))},zt.prototype.CompareTo=function(e){return 0|Jt(Vt(this),_t(this),_t(e))},zt.prototype[Symbol.iterator]=function(){return Cn(Ut(_t(this)))};function qt(e,n,t){if(ArrayBuffer.isView(n)){const r=0|n.length,i=new t(r);for(let t=0;t<=r-1;t++)i[t]=e(n[t]);return i}return n.map((function(n){return e(n)}))}function Zt(e,n){var t;const r=Array.isArray(e)?e:Array.from(e);switch(0|r.length){case 0:return new n(0);case 1:return r[0];default:if(t=r[0],ArrayBuffer.isView(t)){let e=0,t=0;for(let e=0;e<=r.length-1;e++){t+=r[e].length}const i=new n(t);for(let n=0;n<=r.length-1;n++){const t=r[n];for(let n=0;n<=t.length-1;n++)i[e]=t[n],e+=1}return i}return r[0].concat(...r.slice(1))}}function $t(e,n){n.push(e)}function Qt(e,n){return n.from(e)}function er(e,n,t){return function(e,n,t,r){for(;;){const i=e,o=n,a=t,u=r;if(null==u.tail)return a;e=i,n=o+1,t=i(o,a,u.head),r=u.tail}}(e,0,n,t)}function nr(e,n,t){for(;;){const r=e,i=n,o=t;if(null==o.tail)return i;e=r,n=r(i,o.head),t=o.tail}}function tr(e){return nr((function(e,n){return new x(n,e)}),new x,e)}function rr(e,n,t){return nr((function(n,t){return e(t,n)}),t,tr(n))}function ir(e){return tr(Wn((function(e,n){return new x(n,e)}),new x,e))}function or(e){return nr((function(e,n){return e+1}),0,e)}function ar(e,n){return nr((function(e,n){return new x(n,e)}),n,tr(e))}function ur(e,n){return tr(nr((function(n,t){return new x(e(t),n)}),new x,n))}function sr(e,n){return tr(er((function(n,t,r){return new x(e(n,r),t)}),new x,n))}function lr(e,n){nr((function(n,t){e(t)}),null,n)}function cr(e){let n=new x;for(let t=function(e){if(r(e))return e.length;{let n=0;for(const t of e)n++;return n}}(e)-1;t>=0;t--)n=new x(e[t],n);return n}function fr(e,n){return function(e,n,t){e:for(;;){const r=e,i=n,o=t;if(null!=o.tail){const a=r(i,o.head);if(null==a){e=r,n=i+1,t=o.tail;continue e}return a}return null}}(e,0,n)}function hr(e,n){return fr((function(n,t){return e(t)}),n)}function dr(e,n){return fr((function(n,t){return e(n,t)?ue(t):null}),n)}function gr(e,n){return fr((function(n,t){return e(t)?ue(t):null}),n)}function wr(e,n){const t=dr(e,n);if(null!=t){return se(t)}throw new Error("List did not contain any matching elements")}function pr(e,n){return wr((function(n,t){return e===n}),n)}function Sr(e,n){return tr(nr((function(n,t){return e(t)?new x(t,n):n}),new x,n))}function Mr(e,n){if(null!=n.tail)return nr(e,n.head,n.tail);throw new Error("List was empty")}function mr(e,n){return nr((function(n,t){return!!n&&e(t)}),!0,n)}function yr(e,n){for(;;){const t=e,r=n;if(null==r.tail)return!1;if(t(r.head))return!0;e=t,n=r.tail}}function Tr(e,n,t){let r;const i=Qt(n,Array);return i.sort((function(n,r){return-1*t.Compare(e(n),e(r))})),r=i,cr(r)}function Ir(e,n,t){const r=Yt([],t);return Sr((function(n){return a(e(n),r)}),n)}function Cr(e,n,t,r){return new ee(n,e,t,r)}const Ar=cr([Cr(new Q(1,"MagentaColourKey"),"MilitaryFontRed.png",296,8),Cr(new Q(1,"MagentaColourKey"),"MilitaryFontYellow.png",296,8),Cr(new Q(1,"MagentaColourKey"),"MilitaryFontBlue.png",296,8),Cr(new Q(1,"MagentaColourKey"),"MilitaryFontBlack.png",296,8),Cr(new Q(1,"MagentaColourKey"),"MilitaryFontSymbols.png",296,8)]),kr=cr([Cr(new Q(0,"NoColourKey"),"CliffsTile.png",89,200),Cr(new Q(1,"MagentaColourKey"),"Title.png",297,20),Cr(new Q(0,"NoColourKey"),"Map.png",320,160),Cr(new Q(1,"MagentaColourKey"),"AlliedFleetSymbol.png",21,21),Cr(new Q(1,"MagentaColourKey"),"EnemyFleetSymbol.png",20,20),Cr(new Q(0,"NoColourKey"),"SecretPassage.png",320,160),Cr(new Q(1,"MagentaColourKey"),"Mine.png",6,8),Cr(new Q(1,"MagentaColourKey"),"Ship0.png",40,13),Cr(new Q(1,"MagentaColourKey"),"Ship1.png",34,18),Cr(new Q(1,"MagentaColourKey"),"Ship2.png",31,21),Cr(new Q(1,"MagentaColourKey"),"Ship3.png",26,26),Cr(new Q(1,"MagentaColourKey"),"Ship4.png",12,36),Cr(new Q(1,"MagentaColourKey"),"Torpedo0.png",8,2),Cr(new Q(1,"MagentaColourKey"),"Torpedo22degrees.png",8,5),Cr(new Q(1,"MagentaColourKey"),"ShipExplode0.png",25,25),Cr(new Q(1,"MagentaColourKey"),"ShipExplode1.png",50,37),Cr(new Q(1,"MagentaColourKey"),"ShipExplode2.png",50,49),Cr(new Q(1,"MagentaColourKey"),"ShipExplode3.png",50,49),Cr(new Q(1,"MagentaColourKey"),"Plane0.png",6,2),Cr(new Q(1,"MagentaColourKey"),"Plane1.png",18,6),Cr(new Q(1,"MagentaColourKey"),"Plane2.png",31,10),Cr(new Q(1,"MagentaColourKey"),"Plane3.png",49,19),Cr(new Q(1,"MagentaColourKey"),"Plane4.png",72,26),Cr(new Q(1,"MagentaColourKey"),"Plane4BankingLeft.png",62,21),Cr(new Q(1,"MagentaColourKey"),"Plane4BankingRight.png",62,21),Cr(new Q(1,"MagentaColourKey"),"Plane5.png",73,22),Cr(new Q(1,"MagentaColourKey"),"Plane5BankingLeft.png",66,20),Cr(new Q(1,"MagentaColourKey"),"Plane5BankingRight.png",66,20),Cr(new Q(1,"MagentaColourKey"),"Plane6.png",71,27),Cr(new Q(1,"MagentaColourKey"),"Plane6BankingLeft.png",69,26),Cr(new Q(1,"MagentaColourKey"),"Plane6BankingRight.png",69,26),Cr(new Q(1,"MagentaColourKey"),"PlaneExplode0.png",45,23),Cr(new Q(1,"MagentaColourKey"),"PlaneExplode1.png",51,26),Cr(new Q(1,"MagentaColourKey"),"PlaneExplode2.png",35,19),Cr(new Q(1,"MagentaColourKey"),"Splash0.png",12,9),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb0.png",2,2),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb1.png",4,4),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb2.png",6,6),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb3.png",10,10),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb4.png",12,12),Cr(new Q(1,"MagentaColourKey"),"SeaBattleBackground0.png",320,160),Cr(new Q(1,"MagentaColourKey"),"SeaBattleBackground1.png",320,160),Cr(new Q(1,"MagentaColourKey"),"SeaBattleBackground2.png",320,160),Cr(new Q(1,"MagentaColourKey"),"SeaBattleBackground3.png",320,160),Cr(new Q(1,"MagentaColourKey"),"EnemyShip0.png",12,15),Cr(new Q(1,"MagentaColourKey"),"EnemyShip1.png",32,16),Cr(new Q(1,"MagentaColourKey"),"EnemyShip2.png",67,16),Cr(new Q(1,"MagentaColourKey"),"EnemyShip3.png",12,15),Cr(new Q(1,"MagentaColourKey"),"EnemyShip4.png",34,16),Cr(new Q(0,"NoColourKey"),"TankBattleMissile.png",12,1),Cr(new Q(0,"NoColourKey"),"TileBarricade.png",16,16),Cr(new Q(0,"NoColourKey"),"TileBridge.png",16,16),Cr(new Q(0,"NoColourKey"),"TileMine.png",16,16),Cr(new Q(0,"NoColourKey"),"TileSand.png",16,16),Cr(new Q(0,"NoColourKey"),"TileTower.png",16,16),Cr(new Q(0,"NoColourKey"),"TileWater.png",16,16),Cr(new Q(1,"MagentaColourKey"),"EnemyTankGun1.png",24,12),Cr(new Q(1,"MagentaColourKey"),"TankFacingLeft0.png",24,12),Cr(new Q(1,"MagentaColourKey"),"TankFacingUpLeft0.png",24,14),Cr(new Q(1,"MagentaColourKey"),"TankFacingDownLeft0.png",24,14),Cr(new Q(1,"MagentaColourKey"),"TankFacingLeft1.png",24,12),Cr(new Q(1,"MagentaColourKey"),"TankFacingUpLeft1.png",24,14),Cr(new Q(1,"MagentaColourKey"),"TankFacingDownLeft1.png",24,14),Cr(new Q(0,"NoColourKey"),"FinalBossBackground.png",320,160),Cr(new Q(1,"MagentaColourKey"),"FinalBoss0.png",207,43),Cr(new Q(1,"MagentaColourKey"),"FinalBoss1.png",152,42),Cr(new Q(1,"MagentaColourKey"),"FinalBoss2.png",94,42),Cr(new Q(1,"MagentaColourKey"),"FinalBoss3.png",94,42),Cr(new Q(1,"MagentaColourKey"),"FinalBoss4.png",94,42),Cr(new Q(1,"MagentaColourKey"),"FinalBoss5.png",94,42),Cr(new Q(1,"MagentaColourKey"),"FinalBossSurrender0.png",16,35),Cr(new Q(1,"MagentaColourKey"),"FinalBossSurrender1.png",16,35),Cr(new Q(1,"MagentaColourKey"),"FinalBossActiveTarget.png",4,4),Cr(new Q(1,"MagentaColourKey"),"FinalBossTarget.png",4,4),Cr(new Q(1,"MagentaColourKey"),"ShipGunNozzle.png",16,8),Cr(new Q(0,"NoColourKey"),"ShipGunStem.png",12,1),Cr(new Q(1,"MagentaColourKey"),"ShipGunBullet.png",16,8),Cr(new Q(0,"NoColourKey"),"IntermissionBackground.png",320,200),Cr(new Q(0,"NoColourKey"),"VictoryScreen.png",320,200),Cr(new Q(1,"MagentaColourKey"),"ColonelReceivingMedal.png",70,130),Cr(new Q(1,"MagentaColourKey"),"ColonelSaluting.png",72,130),Cr(new Q(1,"MagentaColourKey"),"ColonelStanding.png",50,130),Cr(new Q(1,"MagentaColourKey"),"SoldierSaluting.png",54,120),Cr(new Q(1,"MagentaColourKey"),"SoldierStanding.png",54,120),Cr(new Q(1,"MagentaColourKey"),"Medal.png",7,16),Cr(new Q(1,"MagentaColourKey"),"PresidentPresentingMedal.png",66,130),Cr(new Q(1,"MagentaColourKey"),"PresidentSaluting.png",62,130),Cr(new Q(1,"MagentaColourKey"),"PresidentStanding.png",39,130)]),Er=function(e){let n=e;return e=>void 0===e?n:void(n=e)}([]);const vr=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const br=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const Wr=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const xr=Math.fround(320),Dr=(Math.fround(200),new vr(0,"FontID",0)),Pr=new vr(0,"FontID",1),Hr=new vr(0,"FontID",2),Br=new vr(0,"FontID",3),Xr=new vr(0,"FontID",4),Fr=new ne(0,"ImageID",0),Gr=new ne(0,"ImageID",1),Or=new ne(0,"ImageID",2),Lr=new ne(0,"ImageID",3),Nr=new ne(0,"ImageID",4),Kr=new ne(0,"ImageID",5),Rr=new ne(0,"ImageID",6),jr=new ne(0,"ImageID",7),Ur=new ne(0,"ImageID",8),Jr=new ne(0,"ImageID",9),zr=new ne(0,"ImageID",10),Vr=new ne(0,"ImageID",11),_r=new ne(0,"ImageID",12),Yr=new ne(0,"ImageID",13),qr=new ne(0,"ImageID",14),Zr=new ne(0,"ImageID",15),$r=new ne(0,"ImageID",16),Qr=new ne(0,"ImageID",17),ei=new ne(0,"ImageID",18),ni=new ne(0,"ImageID",19),ti=new ne(0,"ImageID",20),ri=new ne(0,"ImageID",21),ii=new ne(0,"ImageID",22),oi=new ne(0,"ImageID",23),ai=new ne(0,"ImageID",24),ui=new ne(0,"ImageID",25),si=new ne(0,"ImageID",26),li=new ne(0,"ImageID",27),ci=new ne(0,"ImageID",28),fi=new ne(0,"ImageID",29),hi=new ne(0,"ImageID",30),di=new ne(0,"ImageID",31),gi=new ne(0,"ImageID",32),wi=new ne(0,"ImageID",33),pi=new ne(0,"ImageID",34),Si=new ne(0,"ImageID",35),Mi=new ne(0,"ImageID",36),mi=new ne(0,"ImageID",37),yi=new ne(0,"ImageID",38),Ti=new ne(0,"ImageID",39),Ii=new ne(0,"ImageID",40),Ci=new ne(0,"ImageID",41),Ai=new ne(0,"ImageID",42),ki=new ne(0,"ImageID",43),Ei=new ne(0,"ImageID",44),vi=new ne(0,"ImageID",45),bi=new ne(0,"ImageID",46),Wi=new ne(0,"ImageID",47),xi=new ne(0,"ImageID",48),Di=(new ne(0,"ImageID",49),new ne(0,"ImageID",50)),Pi=new ne(0,"ImageID",51),Hi=new ne(0,"ImageID",52),Bi=new ne(0,"ImageID",53),Xi=new ne(0,"ImageID",54),Fi=new ne(0,"ImageID",55),Gi=new ne(0,"ImageID",56),Oi=new ne(0,"ImageID",57),Li=new ne(0,"ImageID",58),Ni=new ne(0,"ImageID",59),Ki=new ne(0,"ImageID",60),Ri=new ne(0,"ImageID",61),ji=new ne(0,"ImageID",62),Ui=new ne(0,"ImageID",63),Ji=new ne(0,"ImageID",64),zi=new ne(0,"ImageID",65),Vi=new ne(0,"ImageID",66),_i=new ne(0,"ImageID",67),Yi=new ne(0,"ImageID",68),qi=new ne(0,"ImageID",69),Zi=new ne(0,"ImageID",70),$i=new ne(0,"ImageID",71),Qi=new ne(0,"ImageID",72),eo=new ne(0,"ImageID",73),no=new ne(0,"ImageID",74),to=new ne(0,"ImageID",75),ro=new ne(0,"ImageID",76),io=new ne(0,"ImageID",77),oo=new ne(0,"ImageID",78),ao=new ne(0,"ImageID",79),uo=new ne(0,"ImageID",80),so=new ne(0,"ImageID",81),lo=new ne(0,"ImageID",82),co=new ne(0,"ImageID",83),fo=new ne(0,"ImageID",84),ho=new ne(0,"ImageID",85),go=new ne(0,"ImageID",86),wo=new ne(0,"ImageID",87),po=Math.fround(12),So=(Math.fround(1),Math.fround(16)),Mo=(Math.fround(8),Math.fround(16),v((function(e,n,...t){D.call(this,e,n,...t)}),D));function mo(e,n){let t;return t=function(e,n){let t=new x,r=new x,i=n;for(;null!=i.tail;)if(null!=i.tail){const n=i.tail,o=e(i.head);switch(o.tag){case 1:r=new x(o.fields[0],r);break;case 2:break;default:t=new x(o.fields[0],t)}i=n}return[t,r]}(e,n),[tr(t[0]),tr(t[1])]}const yo=[["T----------X-------------WWWW------WW-WW---","X-T--------X-T-T----------WW-----WWW-WWWW--","X----------X------W-------W->------WWW--WW-","X----------X------WW-T->--W----------------","X------X---X---T--WWW----------------------","->-WWW-X---X-----WWWW--------\x3e-----WW------","----\x3e--X--------WWWW--------------WWW------","--T-T--X------\x3e--------T--XX-----WWW---WWWW","T------X-----------------XXXX-----------WWW"],["WW-------X-----WWWWW-M---X---WWWWWWWWW-X","W--XXXXXXXXXX---W-W-WM->-X----W-WWW-W--X","W----------\x3e-------=======----------T--X","WW---XXXXXXXX----X--MM>--X--X----X->X---","==--X--=====---\x3e-X--M-------X-------X--X","WW-X-----X->-----X-----MMX>-X----X-----X","==------X>----------MMM--X-------X--T--X","W-T------X---\x3e----WWM--\x3e-X------XXX----X","W-XXXX---X------XXXXM----X-------X-----X"],["XXX--XX--XXXXXXXXXXXXX----X-WW---T-------WWWW","--X-X--XX--WWW--WWWW------X-W--T---M----WWWW-","---X--------WWWWW---------X-------MMM----W>W-","-----\x3e--------WWWWW-------X---XXXMMMMM---WWWW","->-----------WWWWWW---X>--XT-----\x3e-------====","-----\x3e------\x3e-W====---X-------XXXMMMMM---WWWW","---X------\x3e-=====WWW--X>----------MMM---\x3e====","--X-X--XX------WW-----X--------T---M-----WWW-","XXX--XX--XXXXXXXXXXXXXX---WWW----T-----WWWWW-"],["-WWWWW-X--XMMM--T-----X----WWWWWWWWWWWW--WW","W-WWW--X>-XMMM---WWT--X----WWWW-WWWWWW-WW--","----T--X--XMMM>-------X---===-----W--W-----","-X->X-----=-------X---X>----WWW==----------","----X--X--X>--\x3e---X>--X----=========-------","-X-----X-----------X>-------WWW==----------","-X--T--X--XMMM--T--X------WW>---------W----","XXX----X>-XMMM-T-T-X-------WWWWWWWWWWWWW---","-X-----X--XMMM-----X---M---WWMMMMWWWMWWMWWW"]],To=v((function(e,n){this.etx=0|e,this.ety=0|n}),X);const Io=v((function(e,n,t){this.TilesHorizontally=0|e,this.TilesArray=n,this.EnemyTanks=t}),X);function Co(e){switch(e){case"-":return Bi;case"=":return Pi;case">":return Bi;case"M":return Hi;case"T":return Xi;case"W":return Fi;case"X":return Di;default:return null}}function Ao(e){return n=function(e){let n;return n=Co(e),null!=n},!bn(e=>!n(e),e.split(""));var n}function ko(e){if(e.length<9)return new ce(1,"Error","Map matrix file has insufficient rows.");if(function(e){if(e.length>=9){return mr((function(n){return e[n].length===e[0].length}),ir(Hn(0,1,8)))}return!1}(e)){if(function(e){if(e.length>=9){return e.slice(0,9).every(Ao)}return!1}(e)){let t;return t=qt((function(e){return"-----"+e+"-----"}),e.slice(0,9),Array),new ce(0,"Ok",new Io(t[0].length,(n=t,Zt(En((function(){return Pn((function(e){let t;return t=Pn((function(e){let n;return n=Co(e),le(n,Bi)}),n[e].split("")),r=t,Array.from(r);var r}),Hn(0,1,8))})),Array)),function(e){if(e.length>0){const n=0|e[0].length;return ir(En((function(){return kn((function(t){const r=e[t];return kn((function(e){return">"===r[e]?Bn(new To(e,t)):vn()}),Hn(0,1,n-1))}),Hn(0,1,8))})))}return new x}(t)))}return new ce(1,"Error","The map matrix contains illegal characters.")}return new ce(1,"Error","The map matrix rows must all be the same length.");var n}function Eo(e){let n;return n=ko(yo[e]),fe((function(n){return $n(Zn("TankMapDefinitions.[%d]: Error: %s"))(e)(n)}),n)}const vo=v((function(e,n){this.NewPlayerName=e,this.NewPlayerScore=n}),X);const bo=v((function(e,n,t){this.PlayerName=e,this.PlayerScore=n,this.PlayerScoreString=t}),X);function Wo(e){return e.PlayerScore}function xo(e,n){if(p(e,new x))return!1;{let i,o;return t=Wo,r={Compare:M},o=Mr((function(e,n){return r.Compare(t(n),t(e))>0?e:n}),e),i=Wo(o),n>=i}var t,r}function Do(e,n){if(xo(n,e.NewPlayerScore)){let t,r;return r=function(e,n,t){let r;const i=Qt(n,Array);return i.sort((function(n,r){return t.Compare(e(n),e(r))})),r=i,cr(r)}(Wo,new x(new bo(e.NewPlayerName.trim(),e.NewPlayerScore,e.NewPlayerScore.toString()),n),{Compare:M}),t=function(e){if(null!=e.tail)return e.tail;throw new Error("List was empty")}(r),Tr(Wo,t,{Compare:M})}return n}function Po(e,n){return ur((function(n){return function(e,n,t){const r=(0|e.length)+(0|n.length)+2|0;return r>t?"":e+" "+nt(t-r|0,(function(e){return"."}))+" "+n}(n.PlayerName,n.PlayerScoreString,e)}),n)}const Ho=v((function(e){this.GameScoreBoard=e}),X);function Bo(){return new Ho(function(e,n,t){let r;return r=sr((function(e,r){const i=n+(e>>>0)*t;return new bo(r,i,i.toString())}),e),Tr(Wo,r,{Compare:M})}(cr(["Bob","Scott","Lara","J"]),5e3,1e3))}function Xo(e){return Er()[e.fields[0]]}function Fo(e,n,t,r){return e(new Wr(0,"DrawImageWithTopLeftAtInt",n,t,r))}function Go(e,n,t,r,i,o){return e(new Wr(2,"DrawStretchedImageWithTopLeftAt",n,t,r,i,o))}function Oo(e,n,t,r){let i;i=oe(r);const o=n-i[0]/Math.fround(2),a=t-i[1]/Math.fround(2);return e(new Wr(2,"DrawStretchedImageWithTopLeftAt",o,a,r,i[0],i[1]))}function Lo(e,n,t,r,i,o){const a=0|r.length,u=i/a,s=Math.abs(~~(o/u))%a|0;s<a&&Oo(e,n,t,r[s])}function No(e,n,t,r,i,o){return e(new Wr(1,"DrawFilledRectangle",n,t,r,i,o))}function Ko(e,n,t,r,i,o,a){!function(e,n,t,r,i,o,a,u){const s=function(e){return e.length*n};let l=0|(1===a.tag?r-~~(s(o)/2):2===a.tag?r-s(o):r);const c=0|(1===u.tag?i-~~(t/2):2===u.tag?i-t:i);xn((function(t){const r=function(n){e(n,l,c)};t>="0"&&t<="9"?r(t.charCodeAt(0)-48):t>="A"&&t<="Z"?r(t.charCodeAt(0)-55):t>="a"&&t<="z"?r(t.charCodeAt(0)-87):"."===t&&r(36),l+=n}),o.split(""))}((function(t,r,i){e(new Wr(4,"DrawCharImageWithTopLeftAt",r,i,t>>>0,n))}),8,8,i,o,a,t,r)}function Ro(e,n,t,r,i,o,a){Ko(e,n,t,r,i,o,a.toString())}function jo(e,n,t,r,i,o,a,u){var s;s=function(u,s){Ko(e,n,t,r,i,o+a*u|0,s)},er((function(e,n,t){s(e,t)}),null,u)}function Uo(e,n){let t;let r;t=~~(n*Math.fround(5))%89-89|0,r=Xo(Fr);for(let n=1;n<=5;n++)Fo(e,t,0,r),t+=89}const Jo=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const zo=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const Vo=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const _o=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const Yo=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const qo=Math.fround(2),Zo=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const $o=v((function(e,n,t,r){this.ScreenStartTime=e,this.GameGlobalState=n,this.HiScore=t,this.State=r}),X);function Qo(e,n,t){const r=new Zo(0,"GameTitleAwaitingFireButton");return new $o(t,n,e,r)}const ea=v((function(e,n){this.ptx=e,this.pty=n}),X);const na=v((function(e,n){this.modx=e,this.mody=n}),X);const ta=v((function(e,n,t,r){this.Left=e,this.Top=n,this.Right=t,this.Bottom=r}),X);function ra(e,n){return e.ptx<n.ptx}function ia(e,n){return e.ptx>n.ptx}function oa(e,n,t){return Math.abs(e.ptx-t.ptx)<n&&Math.abs(e.pty-t.pty)<n}function aa(e,n){return n.ptx>=e.Left&&n.ptx<=e.Right&&n.pty>=e.Top&&n.pty<=e.Bottom}function ua(e,n){return new ea(n.ptx+e.modx,n.pty+e.mody)}const sa=Math.fround(20),la=Math.fround(.30000001192092896),ca=Math.fround(.30000001192092896),fa=new ea(Math.fround(97),Math.fround(129)),ha=Math.fround(2),da=new ta(Math.fround(134),Math.fround(35),Math.fround(147),Math.fround(47)),ga=new ta(Math.fround(86),Math.fround(75),Math.fround(238),Math.fround(139)),wa=new ta(Math.fround(68),Math.fround(130),Math.fround(91),Math.fround(141));function pa(e,n,t){let r;return r=ua(function(e,n){const t=function(n,t){return n.Held&&t.Held?Math.fround(0):n.Held?-e:t.Held?e:Math.fround(0)};return new na(t(n.Left,n.Right),t(n.Up,n.Down))}(la,n),e),i=r,yr((function(e){return aa(e,i)}),t)?r:e;var i}function Sa(e,n){const t=aa(ga,r=n)?r:fa;var r;if(oa(t,Math.fround(1),e))return e;{let n;return n=function(e,n,t){var r,i;return new na((r=e.ptx-t.ptx)>n?n:r<Math.fround(0)?-n:Math.fround(0),(i=e.pty-t.pty)>n?n:i<Math.fround(0)?-n:Math.fround(0))}(t,ca,e),ua(n,e)}}const Ma=v((function(e,n){this.Score=e,this.HiScore=n}),X);function ma(e,n){const t=n.Score+e;return new Ma(t,C(M,t,n.HiScore))}const ya=v((function(e,n,t,r,i){this.BlueCount=e,this.RedCount=n,this.RedCharIndex=t,this.BlueCharIndex=r,this.CharSpacing=i}),X);function Ta(e,n,t,r){let i,o=0|n;const a=0|~~r.CharSpacing;i=a;const u=function(n,r,a){let u=n;for(;u>0;)e(new Wr(4,"DrawCharImageWithTopLeftAt",o,t,r,a)),u-=1,o+=i};u(r.BlueCount,r.BlueCharIndex,Xr),u(r.RedCount,r.RedCharIndex,Xr)}function Ia(e,n){return No(e,0,n,320,200-n,new br(0,"SolidColour",0))}function Ca(e){return 2*e}const Aa=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const ka=v((function(e,n,t,r,i,o,a){this.ScoreAndHiScore=e,this.ShipsPending=n,this.ShipsThrough=t,this.Tanks=r,this.Damage=i,this.Ammunition=o,this.Elevation=a}),X);function Ea(e,n,t){const r=n+4|0;Ko(e,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),4,r,"SCORE"),Ro(e,Dr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),68,r,t.ScoreAndHiScore.Score);const i=r+12|0;var o;Ko(e,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),4,i,"SHIPS"),Ta(e,68,i,new ya((o=t).ShipsThrough,o.ShipsPending,2,4,8));const a=r+24|0;Ko(e,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),4,a,"DAMAGE"),Ro(e,Hr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),68,a,t.Damage);const u=r+16|0;Ko(e,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),160,u,"TANKS"),Ta(e,208,u,new ya(t.Tanks,0,1,3,8));const s=r+24|0;var l,c,f,h,d,g,w;Ko(e,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),160,s,"ELEVATION"),l=e,c=Hr,f=new Jo(0,"LeftAlign"),h=new zo(0,"TopAlign"),d=256,g=s,w=t.Elevation,Ko(l,c,f,h,d,g,et("{0:#.##}",w))}const va=new ea(Math.fround(290),Math.fround(15)),ba=cr([new ta(Math.fround(38),Math.fround(7),Math.fround(310),Math.fround(19)),new ta(Math.fround(125),Math.fround(19),Math.fround(310),Math.fround(35)),new ta(Math.fround(133),Math.fround(35),Math.fround(310),Math.fround(41)),new ta(Math.fround(168),Math.fround(41),Math.fround(310),Math.fround(50)),new ta(Math.fround(200),Math.fround(49),Math.fround(310),Math.fround(139)),new ta(Math.fround(86),Math.fround(75),Math.fround(276),Math.fround(139)),da,wa]),Wa=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const xa=v((function(e,n,t,r){this.ScoreAndHiScore=e,this.EnemyFleetCentre=n,this.AlliedState=t,this.NumShips=r}),X);function Da(e,n){const t=new Wa(0,"MapInPlay",va);return new xa(n,fa,t,e)}const Pa=v((function(e,n,...t){D.call(this,e,n,...t)}),D);function Ha(e,n,t){let r;var i,o,a;switch(1===e.AlliedState.tag?1:3===e.AlliedState.tag||2===e.AlliedState.tag?2:0){case 0:{const u=pa(e.AlliedState.fields[0],n,ba),s=Sa(e.EnemyFleetCentre,u),l=(o=s,a=t,aa(da,i=u)?new Wa(1,"FleetEngagedOnMap",i,a,new Wa(2,"ScreenOverEngagedSecretPassage")):oa(o,sa,i)?new Wa(1,"FleetEngagedOnMap",i,a,new Wa(3,"ScreenOverEngagedEnemyAtSea")):new Wa(0,"MapInPlay",i));r=new xa(e.ScoreAndHiScore,s,l,e.NumShips);break}case 1:r=t-e.AlliedState.fields[1]>ha?new xa(e.ScoreAndHiScore,e.EnemyFleetCentre,e.AlliedState.fields[2],e.NumShips):e;break;case 2:r=e}switch(1===r.AlliedState.tag?0:2===r.AlliedState.tag?1:3===r.AlliedState.tag?2:0){case 0:return new Pa(0,"StayOnInitialMap",r);case 1:return new Pa(1,"GoToSecretPassage",r);case 2:return new Pa(2,"GoToBattleAtSea",r)}}function Ba(e,n,t){const r=n(t);let i;return i=gr((function(e){const t=n(e);return p(r,t)}),e),null==i}function Xa(e,n){return mr(e,n)?n:Sr(e,n)}const Fa=v((function(e,n,...t){D.call(this,e,n,...t)}),D);function Ga(e,n,t,r,i){const o=(t.ptx-n.ptx)/i,a=(t.pty-n.pty)/i;return function(t){const u=t-r;if(u>=Math.fround(0)){if(u<=i){const t=e(u,i),r=n.ptx+o*t,s=n.pty+a*t;return new Fa(1,"MOMVisibleAtPosition",new ea(r,s))}return new Fa(2,"MOMDisappeared")}return new Fa(0,"MOMYetToAppear")}}function Oa(e,n){return e}function La(e,n){const t=e/n;return t*t*n}function Na(e,n){const t=e/n,r=Math.fround(1)-t;return(Math.fround(1)-r*r)*n}const Ka=v((function(e,n,t,r){this.PositionGetter=e,this.StartPosition=n,this.FinalPosition=t,this.EndGameTime=r}),X);function Ra(e,n,t){return new Ka(function(e,n,t){const r=n+t;return function(t){return t>=n?t<=r?new Fa(1,"MOMVisibleAtPosition",e):new Fa(2,"MOMDisappeared"):new Fa(0,"MOMYetToAppear")}}(e,n,t),e,e,n+t)}function ja(e,n,t,r,i){return new Ka(Ga(e,n,t,r,i),n,t,r+i)}function Ua(e,n){const t=n.PositionGetter(e);switch(t.tag){case 0:return n.StartPosition;case 2:return n.FinalPosition;default:return t.fields[0]}}function Ja(e,n){return e<=n.EndGameTime}const za=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const Va=v((function(e,n,t,r){this.FlickBookDuration=e,this.FlickBookImages=n,this.VisibilityBeforeStart=t,this.VisibilityAfterEnd=r}),X);const _a=v((function(e,n,t){this.FlickBookType=e,this.FlickBookStartTime=n,this.FlickBookMechanicsObject=t}),X);function Ya(e){return e.FlickBookStartTime}function qa(e,n){return Ua(e,n.FlickBookMechanicsObject)}function Za(e,n,t){return Xa((function(t){return r=e,i=n(t),Ja(r,i.FlickBookMechanicsObject);var r,i}),t)}function $a(e,n){return Za(e,(function(e){return e}),n)}function Qa(e,n,t){const r=t-n.FlickBookStartTime,i=0|n.FlickBookType.FlickBookImages.length,o=n.FlickBookMechanicsObject.PositionGetter(t);switch(o.tag){case 1:{const t=n.FlickBookType.FlickBookDuration/i,a=0|Math.abs(~~(r/t));a<i&&Oo(e,o.fields[0].ptx,o.fields[0].pty,n.FlickBookType.FlickBookImages[a]);break}case 2:p(n.FlickBookType.VisibilityAfterEnd,new za(0,"Visible"))&&i>0&&Oo(e,n.FlickBookMechanicsObject.FinalPosition.ptx,n.FlickBookMechanicsObject.FinalPosition.pty,n.FlickBookType.FlickBookImages[n.FlickBookType.FlickBookImages.length-1]);break;default:p(n.FlickBookType.VisibilityBeforeStart,new za(0,"Visible"))&&i>0&&Oo(e,n.FlickBookMechanicsObject.StartPosition.ptx,n.FlickBookMechanicsObject.StartPosition.pty,n.FlickBookType.FlickBookImages[0])}}function eu(e,n,t,r){lr((function(t){Qa(e,n(t),r)}),t)}function nu(e,n,t){eu(e,(function(e){return e}),n,t)}const tu=Math.fround(4),ru=Math.fround(4),iu=Math.fround(10),ou=Math.fround(3),au=Math.fround(.75);function uu(){return new Va(au,qt(Xo,[qr,Zr,$r,Qr],Array),new za(1,"Hidden"),new za(1,"Hidden"))}const su=v((function(e,n,t){this.ShipsStillToNavigate=e,this.ShipsSuccess=n,this.Score=t}),X);const lu=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const cu=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const fu=v((function(e,n,t){this.ShipRotation=e,this.ShipSpeed=n,this.ShipCentre=t}),X);const hu=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const du=v((function(e){this.MineLocation=e}),X);const gu=v((function(e,n,t){this.TorpedoLaunchDetail=e,this.TorpedoPositionGetter=n,this.TorpedoIsHorizontal=t}),X);const wu=v((function(e,n,t,r,i){this.FleetStats=e,this.LiveTorpedos=n,this.Mines=t,this.Animations=r,this.Ship=i}),X);function pu(e,n){return n.Left.JustDown?function(e){switch(e.tag){case 1:return new lu(0,"FacingLeft");case 2:return new lu(1,"Facing1");case 3:return new lu(2,"Facing2");case 4:return new lu(3,"Facing3");default:return new lu(0,"FacingLeft")}}(e):n.Right.JustDown?function(e){switch(e.tag){case 1:return new lu(2,"Facing2");case 2:return new lu(3,"Facing3");case 3:case 4:return new lu(4,"FacingUp");default:return new lu(1,"Facing1")}}(e):e}function Su(e,n){return n.Up.JustDown?function(e){switch(e.tag){case 1:return new cu(2,"ShipMedium");case 2:case 3:return new cu(3,"ShipFast");default:return new cu(1,"ShipSlow")}}(e):n.Down.JustDown?function(e){switch(e.tag){case 1:return new cu(0,"ShipStationary");case 2:return new cu(1,"ShipSlow");case 3:return new cu(2,"ShipMedium");default:return new cu(0,"ShipStationary")}}(e):e}function Mu(e){switch(e.tag){case 1:return Math.fround(.9229999780654907);case 2:return Math.fround(.7070000171661377);case 3:return Math.fround(.382999986410141);case 4:return Math.fround(0);default:return Math.fround(1)}}function mu(e){switch(e.tag){case 1:return Math.fround(.382999986410141);case 2:return Math.fround(.7070000171661377);case 3:return Math.fround(.9229999780654907);case 4:return Math.fround(1);default:return Math.fround(0)}}function yu(e,n,t){let r;return r=function(e){switch(e.tag){case 1:return Math.fround(.20000000298023224);case 2:return Math.fround(.4000000059604645);case 3:return Math.fround(.6000000238418579);default:return Math.fround(0)}}(t),new ea(e.ptx+Mu(n)*-r,e.pty-mu(n)*r)}const Tu=cr([[.2,.352],[.404,.338],[.556,.196],[.294,.606],[.7,.336],[.264,.808],[.564,.688],[.812,.512],[.908,.662],[.87,.832]]);function Iu(){return ur((function(e){return function(e,n){let t,r;return r=Xo(Kr),t=oe(r),new du(new ea(e*t[0],n*t[1]))}(e[0],e[1])}),Tu)}const Cu=cr([[[.086,.214],[.318,.082],Math.fround(5),Math.fround(1)],[[.086,.214],[.616,.214],Math.fround(4.099999904632568),Math.fround(2.5)],[[.132,.39],[.454,.126],Math.fround(6.199999809265137),Math.fround(2)],[[.132,.39],[.826,.39],Math.fround(5.300000190734863),Math.fround(3)],[[.17,.592],[.776,.312],Math.fround(7),Math.fround(3.5)],[[.17,.592],[.958,.592],Math.fround(7.099999904632568),Math.fround(2)],[[.206,.79],[.846,.41],Math.fround(7.199999809265137),Math.fround(3.5)],[[.206,.79],[.984,.79],Math.fround(8.300000190734863),Math.fround(1)],[[.382,.102],[.138,.336],Math.fround(6),Math.fround(1)],[[.698,.204],[.078,.204],Math.fround(6.400000095367432),Math.fround(2.5)],[[.698,.204],[.152,.49],Math.fround(6.5),Math.fround(2.5)],[[.884,.454],[.13,.454],Math.fround(7.599999904632568),Math.fround(1.5)],[[.962,.608],[.26,.914],Math.fround(7.699999809265137),Math.fround(3)],[[.962,.608],[.178,.608],Math.fround(7.800000190734863),Math.fround(1)]]);function Au(e,n,t,r,i){let o,a;a=Xo(Kr),o=oe(a);const u=e[0]*o[0],s=n[0]*o[0],l=e[1]*o[1],c=n[1]*o[1],f=i+r;return new gu([e,n,t,r],Ga(Oa,new ea(u,l),new ea(s,c),f,t),l===c)}function ku(e,n){return Au(e.TorpedoLaunchDetail[0],e.TorpedoLaunchDetail[1],e.TorpedoLaunchDetail[2],e.TorpedoLaunchDetail[3],n)}function Eu(){let e,n;return n=Xo(Kr),e=oe(n),new fu(new lu(0,"FacingLeft"),new cu(0,"ShipStationary"),new ea(Math.fround(.8859999775886536)*e[0],Math.fround(.9380000233650208)*e[1]))}function vu(e,n,t,r){const i=Math.fround(10),o=Mu(n),a=mu(n),u=function(e,n){return new ea(e.ptx+o*n,e.pty+a*n)},s=t(r,u(e,i*Math.fround(1))),l=t(s,e);return t(l,u(e,i*Math.fround(-1)))}function bu(e,n,t){return vu(e.ShipCentre,e.ShipRotation,(function(e,r){return!!e||oa(n,t,r)}),!1)}function Wu(e,n){return new _a(uu(),n,Ra(e,n,au))}function xu(e,n,t,r){switch(t.tag){case 1:case 3:return[n,t];case 0:{let i;return i=nr((function(e,n){return i=bu(t.fields[0],n.MineLocation,ru)?n.MineLocation:null,o=e[1],a=e[0],u=r,null==i?[a,o]:[new x(Wu(i,u),a),new hu(2,"ShipExploding",u)];var i,o,a,u}),[n,t],e),[i[0],i[1]]}default:return[n,t]}}const Du=[Math.fround(0),cr([[Math.fround(.02199999988079071),Math.fround(0)],[Math.fround(.13199999928474426),Math.fround(.3799999952316284)],[Math.fround(.22200000286102295),Math.fround(.8899999856948853)],[Math.fround(.3199999928474426),Math.fround(1)]])],Pu=[Math.fround(1),cr([[Math.fround(.23999999463558197),Math.fround(0)],[Math.fround(.335999995470047),Math.fround(.11599999666213989)],[Math.fround(.6959999799728394),Math.fround(.20000000298023224)],[Math.fround(1),Math.fround(.7260000109672546)],[Math.fround(1),Math.fround(1)]])];function Hu(e,n,t){let r,i;i=Xo(Kr),r=oe(i);const o=t/r[1];let a,u;return u=hr((function(e){return o<e[0][1]||o>e[1][1]?null:(n=e[0][1],t=e[0][0],r=e[1][1],i=e[1][0],t+(i-t)/(r-n)*(o-n));var n,t,r,i}),function(e){const n=function(e,n,t){for(;;){const r=e,i=n,o=t;if(null==r.tail)return cr(i);{let a=i;$t([o,r.head],a),e=r.tail,n=i,t=r.head}}};var t,r,i,o;switch(null!=e.tail&&null!=e.tail.tail?(t=1,r=e.head,i=e.tail.head,o=e.tail.tail):t=0,t){case 0:return new x;case 1:{const e=[];return $t([r,i],e),A(2,n,[o])(e)(i)}}}(n)),a=le(u,e),new ea(a*r[0],t)}function Bu(e,n,t,r){return vu(e.ShipCentre,e.ShipRotation,(function(e,i){if(null==e){const e=Hu(t,r,i.pty);return n(i,e)?i:null}return e}),null)}function Xu(e,n){switch(e.tag){case 1:case 3:return e;case 0:return e.fields[0].ShipCentre.pty<iu?new hu(1,"ShipGotThrough",n,e.fields[0]):e;default:return e}}function Fu(e,n,t){let r,i,o,a;var u,s,l;switch(r=Xo(Rr),i=Xo(_r),o=Xo(Yr),a=Xo(Kr),Fo(e,0,0,a),Ia(e,a.EngineImageMetadata.ImageHeight),lr((function(n){Oo(e,n.MineLocation.ptx,n.MineLocation.pty,r)}),t.Mines),lr((function(t){const r=t.TorpedoPositionGetter(n);switch(r.tag){case 2:break;case 1:{const n=t.TorpedoIsHorizontal?i:o;Oo(e,r.fields[0].ptx,r.fields[0].pty,n);break}}}),t.LiveTorpedos),2===t.Ship.tag?u=0:1===t.Ship.tag?(u=1,s=t.Ship.fields[1]):0===t.Ship.tag?(u=1,s=t.Ship.fields[0]):u=0,u){case 1:Oo(e,s.ShipCentre.ptx,s.ShipCentre.pty,Xo(1===(l=s.ShipRotation).tag?Ur:2===l.tag?Jr:3===l.tag?zr:4===l.tag?Vr:jr))}nu(e,t.Animations,n);const c=new ka(t.FleetStats.Score,t.FleetStats.ShipsStillToNavigate,t.FleetStats.ShipsSuccess,Ca(t.FleetStats.ShipsSuccess),0,10,Math.fround(0));Ea(e,a.EngineImageMetadata.ImageHeight,c)}function Gu(e,n,t){const r=new su(n,0,e),i=(o=t,sr((function(e,n){return Au(n[0],n[1],n[2],n[3],o)}),Cu));var o;const a=new hu(0,"ShipInPlay",Eu()),u=new x;return new wu(r,i,Iu(),u,a)}function Ou(e,n,t){const r=function(e,n,t){const r=new su(e.ShipsStillToNavigate-1,n,t);return[r,0===r.ShipsStillToNavigate?new hu(3,"SecretPassageScreenOver"):new hu(0,"ShipInPlay",Eu())]};if(!function(e,n){var t,r;switch(e.tag){case 0:t=0;break;case 2:case 1:t=1,r=e.fields[0];break;default:t=0}switch(t){case 0:return!1;case 1:return n>r+ou}}(n,t))return[e,n];switch(n.tag){case 3:throw new Error("should not happen");case 2:return r(e,e.ShipsSuccess,e.Score);case 1:return r(e,e.ShipsSuccess+1,ma(3e3,e.Score));default:throw new Error("should not happen")}}function Lu(e,n,t){let r;if(3===e.Ship.tag)r=e;else{const o=function(e,n){var t,r;switch(e.tag){case 2:case 1:case 3:return e;default:return new hu(0,"ShipInPlay",(t=yu(e.fields[0].ShipCentre,e.fields[0].ShipRotation,e.fields[0].ShipSpeed),r=Su(e.fields[0].ShipSpeed,n),new fu(pu(e.fields[0].ShipRotation,n),r,t)))}}(e.Ship,n);let a,u;i=t,a=ur((function(e){return 2===e.TorpedoPositionGetter(i).tag?ku(e,i):e}),e.LiveTorpedos),u=$a(t,e.Animations);const s=function(e,n,t,r){switch(t.tag){case 1:case 3:return[e,n,t];case 0:{let i;return i=nr((function(e,n){let i;const o=n.TorpedoPositionGetter(r);switch(o.tag){case 2:i=null;break;case 1:i=bu(t.fields[0],o.fields[0],tu)?o.fields[0]:null;break;default:i=null}if(null==i)return[new x(n,e[0]),e[1],e[2]];{const t=i;return[new x(ku(n,r),e[0]),new x(Wu(t,r),e[1]),new hu(2,"ShipExploding",r)]}}),[new x,n,t],e),[i[0],i[1],i[2]]}default:return[e,n,t]}}(a,u,o,t),l=xu(e.Mines,s[1],s[2],t),c=function(e,n,t){switch(n.tag){case 1:case 3:return[e,n];case 0:{let r;if(r=le(Bu(n.fields[0],ra,Du[0],Du[1]),Bu(n.fields[0],ia,Pu[0],Pu[1])),null!=r){return[new x(Wu(r,t),e),new hu(2,"ShipExploding",t)]}return[e,n]}default:return[e,n]}}(l[0],l[1],t),f=Xu(c[1],t),h=Ou(e.FleetStats,f,t);r=new wu(h[0],s[0],e.Mines,c[0],h[1])}var i;return 3===r.Ship.tag?r.FleetStats.ShipsSuccess>0?new Yo(1,"GoToNextChapter2",r):new Yo(2,"GameOver2",r):new Yo(0,"StayOnThisChapter2",r)}const Nu=new ea(Math.fround(124),Math.fround(75)),Ku=new x(new ta(Math.fround(86),Math.fround(75),Math.fround(276),Math.fround(139)),new x),Ru=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const ju=v((function(e,n,t,r){this.ScoreAndHiScore=e,this.ShipsThrough=n,this.AlliedState=t,this.EnemyFleetCentre=r}),X);function Uu(e,n){return new ju(e,n,new Ru(0,"AlliedFleetInPlay",Nu),fa)}function Ju(e,n,t){let r;if(1===e.AlliedState.tag){if(t-e.AlliedState.fields[1]>ha){const n=new Ru(2,"PostPassageScreenOver");r=new ju(e.ScoreAndHiScore,e.ShipsThrough,n,e.EnemyFleetCentre)}else r=e}else if(2===e.AlliedState.tag)r=e;else{const a=pa(e.AlliedState.fields[0],n,Ku),u=Sa(e.EnemyFleetCentre,a),s=(o=t,oa(u,sa,i=a)?new Ru(1,"Paused",i,o):new Ru(0,"AlliedFleetInPlay",i));r=new ju(e.ScoreAndHiScore,e.ShipsThrough,s,u)}var i,o;return 2===r.AlliedState.tag?new _o(1,"GoToNextChapter1",r):new _o(0,"StayOnThisChapter1",r)}const zu=v((function(e,n){this.ShellMechanicsObject=e,this.ShellStartTime=n}),X);const Vu=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const _u=v((function(e,n,t,r,i,o,a,u,s,l){this.GunType=e,this.GunLeftExtent=n,this.GunRightExtent=t,this.GunStepRatePerSecond=r,this.HighestShellY=i,this.GunRepeatTime=o,this.GunShellDuration=a,this.GunLowestElevation=u,this.GunHighestElevation=s,this.GunElevationStepRate=l}),X);const Yu=v((function(e,n,t,r,i){this.GunTraits=e,this.GunCentreX=n,this.GunElevation=t,this.Shells=r,this.LastFireTime=i}),X);function qu(e,n,t,r,i){const o=(a=r,new _u(e,Math.fround(20),Math.fround(300),Math.fround(80),Math.fround(0),Math.fround(.5),Math.fround(.699999988079071),Math.fround(5),Math.fround(80),a));var a;return new Yu(o,n,t,new x,i-o.GunRepeatTime)}function Zu(e){const n=So*Math.fround(.6000000238418579);return[e-n,e+n]}function $u(e,n){const t=n.GunElevation/Math.fround(10),r=~~(Math.fround(9.5)+Math.fround(.15199999511241913)*t),i=~~(Math.fround(15.5)+Math.fround(.10400000214576721)*t);return[i,r,e-i,e-(i+r)]}function Qu(e,n,t,r){const i=function(r){const i=$u(n,t),o=r-po/Math.fround(2),a=r-So/Math.fround(2);Go(e,o,i[2],Xo(to),po,i[0]),Go(e,a,i[3],Xo(no),So,i[1])};if(1===t.GunTraits.GunType.tag){const e=Zu(t.GunCentreX);i(e[0]),i(e[1])}else i(t.GunCentreX);lr((function(n){const i=n.ShellMechanicsObject.PositionGetter(r);if(1===i.tag){const a=Math.fround(1)-(o=t.GunTraits,(r-n.ShellStartTime)/o.GunShellDuration),u=a*Math.fround(12)+Math.fround(4),s=a*Math.fround(5)+Math.fround(1),l=i.fields[0].ptx-u/Math.fround(2),c=i.fields[0].pty-s/Math.fround(2);Go(e,l,c,Xo(ro),u,s)}var o}),t.Shells)}function es(e,n,t,r,i){const o=e.Up.Held&&e.Down.Held?i.GunElevation:e.Up.Held?C(M,i.GunTraits.GunLowestElevation,i.GunElevation-i.GunTraits.GunElevationStepRate*t):e.Down.Held?I(M,i.GunTraits.GunHighestElevation,i.GunElevation+i.GunTraits.GunElevationStepRate*t):i.GunElevation,a=e.Left.Held&&e.Right.Held?i.GunCentreX:e.Left.Held?C(M,i.GunTraits.GunLeftExtent,i.GunCentreX-i.GunTraits.GunStepRatePerSecond*t):e.Right.Held?I(M,i.GunTraits.GunRightExtent,i.GunCentreX+i.GunTraits.GunStepRatePerSecond*t):i.GunCentreX;let u;const s=n-i.LastFireTime;if(e.Fire.JustDown&&s>i.GunTraits.GunRepeatTime){const e=function(e){return function(e,n,t,r){const i=$u(n,t),o=new ea(e,i[3]),a=new ea(e,function(e,n,t){const r=e.GunHighestElevation-t,i=(n-e.HighestShellY)/e.GunHighestElevation;return e.HighestShellY+r*i}(t.GunTraits,i[3],t.GunElevation));return new zu(ja(Na,o,a,r,t.GunTraits.GunShellDuration),r)}(e,r,i,n)};if(1===i.GunTraits.GunType.tag){const t=Zu(i.GunCentreX);u=[new x(e(t[0]),new x(e(t[1]),i.Shells)),n]}else{u=[new x(e(i.GunCentreX),i.Shells),n]}}else u=[i.Shells,i.LastFireTime];return new Yu(i.GunTraits,a,o,u[0],u[1])}function ns(e,n){let t;var r,i;return r=function(e){return e.ShellMechanicsObject},i=e,t=Xa((function(e){const n=r(e);return Ja(i,n)}),n.Shells),new Yu(n.GunTraits,n.GunCentreX,n.GunElevation,t,n.LastFireTime)}const ts=Math.fround(3),rs=Math.fround(6),is=v((function(e,n,...t){D.call(this,e,n,...t)}),D);function os(e){return e<=Math.fround(45)?e:Math.fround(90)-e}function as(e){let n,t;n=os(e);const r=Math.fround(0),i=Math.fround(45),o=Math.fround(1);let a,u;t=n*((Math.fround(0)-o)/(i-r))+o,a=t*t;const s=Math.fround(0),l=Math.fround(1),c=Math.fround(100);return u=a*((Math.fround(148)-c)/(l-s))+c,u+Math.fround(.5)}const us=v((function(e,n,t,r,i){this.CentreX=e,this.BaseY=n,this.ShipImage=t,this.SinkStartTime=r,this.ElevationToHit=i}),X);function ss(e,n,t){return new us(e,as(t),n,null,t)}function ls(){return cr([ss(Math.fround(29),Xo(Ei),Math.fround(44)),ss(Math.fround(143),Xo(vi),Math.fround(39.5)),ss(Math.fround(198),Xo(bi),Math.fround(36.5)),ss(Math.fround(248),Xo(Wi),Math.fround(41)),ss(Math.fround(288),Xo(xi),Math.fround(32.5))])}function cs(e,n){return Xa((function(n){return function(e,n){if(null!=n.SinkStartTime){return e-n.SinkStartTime<=rs}return!0}(e,n)}),n)}function fs(e,n,t){lr((function(n){let r,i;if(null!=n.SinkStartTime){const e=n.SinkStartTime;r=I(M,t-e,rs)/rs*n.ShipImage.EngineImageMetadata.ImageHeight}else r=Math.fround(0);i=n.ShipImage.EngineImageMetadata.ImageWidth;const o=n.ShipImage.EngineImageMetadata.ImageHeight-~~(r+Math.fround(.5))|0,a=n.CentreX-n.ShipImage.EngineImageMetadata.ImageWidth/Math.fround(2),u=n.BaseY-(n.ShipImage.EngineImageMetadata.ImageHeight-r);let s,l;s=n.ShipImage.EngineImageMetadata.ImageWidth,l=o;const c=new Wr(3,"DrawSubImageStretchedToTarget",0,0,i,o,a,u,s,l,n.ShipImage);e(c)}),n)}function hs(e){let n,t,r;n=Xo(Ii),t=n.EngineImageMetadata.ImageWidth,r=n.EngineImageMetadata.ImageHeight;const i=new Va(ts,[Xo(Ci),Xo(Ai),Xo(Ai),Xo(ki),Xo(ki)],new za(1,"Hidden"),new za(1,"Hidden")),o=Ra(new ea(t/Math.fround(2),r/Math.fround(2)),e,ts);return new _a(i,e,o)}function ds(e){Ko(e,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,75,"STAGE COMPLETE")}function gs(e){Ko(e,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,75,"SHIP DESTROYED")}const ws=v((function(e,n){this.ExplosionsList=e,this.TotalScore=n}),X);function ps(e,n,t,r,i,o,a,u){let s;if(s=Sr((function(e){return t(e[0],e[1])}),ir(function(e,n){let t=!0;const r=[];return kn(e=>t?(t=!1,Pn(n=>(r.push(n),[e,n]),n)):r.map(n=>[e,n]),e)}(e,n))),null==s.tail)return[e,n,o,a];{let t,l,c,f,h,g;let w;return t=rr((function(e,n){return[new x(e[0],n[0]),new x(e[1],n[1])]}),s,[new x,new x]),l=Ir(r,t[0],{Equals:p,GetHashCode:d}),c=Ir(i,t[1],{Equals:p,GetHashCode:d}),f=Sr((function(e){return Ba(l,r,e)}),e),h=Sr((function(e){return Ba(c,i,e)}),n),w=nr((function(e,n){const t=u(n);return new ws(new x(t[0],e.ExplosionsList),e.TotalScore+t[1])}),new ws(o,0),l),g=[w.ExplosionsList,w.TotalScore],[f,h,g[0],ma(g[1],a)]}}const Ss=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const Ms=Math.fround(30),ms=Math.fround(160),ys=Math.fround(6),Ts=Math.fround(4),Is=Math.fround(.75),Cs=Math.fround(6),As=Math.fround(3),ks=Math.fround(5),Es=Math.fround(1),vs=Math.fround(150),bs=Math.fround(30);function Ws(e){return qt(Xo,e,Array)}const xs=v((function(e,n){this.PlaneFlickBookInstance=e,this.PlaneHasReleasedBombs=n}),X);const Ds=v((function(e,n,t,r,i,o,a,u,s,l,c,f){this.ScoreAndHiScore=e,this.ShipsRemaining=n,this.Planes=t,this.PlaneBombs=r,this.PlanesRemaining=i,this.GunAim=o,this.AlliedState=a,this.SkyExplosion=u,this.Explosions=s,this.EnemyShips=l,this.Damage=c,this.LastSortieAt=f}),X);function Ps(e){return e.PlaneFlickBookInstance}function Hs(e,n){const t=new Va(Is,Ws([di,gi,wi]),new za(1,"Hidden"),new za(0,"Visible")),r=Ra(e,n,Is);return new _a(t,n,r)}function Bs(e,n,t,r,i){return ps(e,n,(function(e,n){return function(e,n,t){if(Ja(e,n.ShellMechanicsObject))return!1;{let r,i;return i=Ps(t),r=qa(e,i),oa(r,ys,n.ShellMechanicsObject.FinalPosition)}}(i,e,n)}),(function(e){return e.ShellStartTime}),(function(e){return e.PlaneFlickBookInstance.FlickBookStartTime}),t,r,(function(e){let n;return n=Ua(i,e.ShellMechanicsObject),[Hs(n,i),2e3]}))}function Xs(e){const n=~~e%4|0;return 0===n?[function(){return new Va(Cs,Ws([ei,ni,ti,ri,oi,si,fi]),new za(1,"Hidden"),new za(0,"Visible"))},Math.fround(-50)]:1===n?[function(){return new Va(Cs,Ws([ei,ni,ti,ri,ai,li,hi]),new za(1,"Hidden"),new za(0,"Visible"))},Math.fround(50)]:[function(){return new Va(Cs,Ws([ei,ni,ti,ri,ii,ui,ci]),new za(1,"Hidden"),new za(0,"Visible"))},Math.fround(0)]}function Fs(e){const n=Xs(e),t=~~e%24*10+40,r=t+n[1];return new xs(new _a(n[0](),e,ja(La,new ea(t,Math.fround(90)),new ea(r,Math.fround(-14)),e,Cs)),!1)}function Gs(e,n){let t;t=qa(n,e.PlaneFlickBookInstance);const r=new ea(t.ptx,vs);return new _a(new Va(Es,Ws([Si,Mi,mi,yi,Ti]),new za(1,"Hidden"),new za(0,"Visible")),n,ja(La,t,r,n,Es))}function Os(e,n,t){return nr((function(n,t){if(t.PlaneHasReleasedBombs)return[n[0],new x(t,n[1])];if(e-t.PlaneFlickBookInstance.FlickBookStartTime>=As){return[new x(Gs(t,e),n[0]),new x(new xs(t.PlaneFlickBookInstance,!0),n[1])]}return[n[0],new x(t,n[1])]}),[n,new x],t)}function Ls(e,n,t,r){let i;i=1===e.tag?20:40;const o=qu(new Vu(1,"DoubleBarrelGun"),ms,Ms,bs,r),a=new is(0,"AlliedShipInPlay"),u=new x,s=new x,l=ls();return new Ds(n,t,new x,new x,i,o,a,s,u,l,0,Math.fround(0))}function Ns(e,n,t,r){let i;if(2===e.AlliedState.tag){if(t-e.AlliedState.fields[0]>Ts){const n=new is(3,"AirOrSeaBattleScreenOver");i=new Ds(e.ScoreAndHiScore,e.ShipsRemaining,e.Planes,e.PlaneBombs,e.PlanesRemaining,e.GunAim,n,e.SkyExplosion,e.Explosions,e.EnemyShips,e.Damage,e.LastSortieAt)}else i=e}else if(1===e.AlliedState.tag){if(t-e.AlliedState.fields[0]>Ts)if(e.ShipsRemaining>1){const n=new is(0,"AlliedShipInPlay"),t=e.ShipsRemaining-1,r=new x;i=new Ds(e.ScoreAndHiScore,t,e.Planes,e.PlaneBombs,e.PlanesRemaining,e.GunAim,n,r,e.Explosions,e.EnemyShips,0,e.LastSortieAt)}else{const n=new is(3,"AirOrSeaBattleScreenOver"),t=new x;i=new Ds(e.ScoreAndHiScore,0,e.Planes,e.PlaneBombs,e.PlanesRemaining,e.GunAim,n,t,e.Explosions,e.EnemyShips,e.Damage,e.LastSortieAt)}else i=e}else if(3===e.AlliedState.tag)i=e;else if(0===e.PlanesRemaining&&null==e.Planes.tail){const n=new is(2,"WonScreen",t);i=new Ds(e.ScoreAndHiScore,e.ShipsRemaining,e.Planes,e.PlaneBombs,e.PlanesRemaining,e.GunAim,n,e.SkyExplosion,e.Explosions,e.EnemyShips,e.Damage,e.LastSortieAt)}else{let l;let c,f,h;l=0|Xo(Ii).EngineImageMetadata.ImageHeight,c=$a(t,e.Explosions),f=$a(t,e.SkyExplosion),h=Za(t,Ps,e.Planes);const d=0|or(e.PlaneBombs);let g;g=$a(t,e.PlaneBombs);const w=0|or(g),p=e.Damage+(d-w>>>0),S=es(n,t,r,l,e.GunAim),M=Os(t,g,h),m=(o=t,a=e.PlanesRemaining,u=e.LastSortieAt,s=M[1],a>0&&o>u+ks&&or(s)<3?[a-1,o,new x(Fs(o),s)]:[a,u,s]),y=p>=5?[new is(1,"ShipSinking",t),new x(hs(t),new x)]:[e.AlliedState,f],T=Bs(S.Shells,m[2],c,e.ScoreAndHiScore,t);let I;I=ns(t,new Yu(S.GunTraits,S.GunCentreX,S.GunElevation,T[0],S.LastFireTime)),i=new Ds(T[3],e.ShipsRemaining,T[1],M[0],m[0],I,y[0],y[1],T[2],e.EnemyShips,p,m[1])}var o,a,u,s;return 3===i.AlliedState.tag?i.ShipsRemaining>0?new Yo(1,"GoToNextChapter2",i):new Yo(2,"GameOver2",i):new Yo(0,"StayOnThisChapter2",i)}const Ks=v((function(e,n){this.ToDoTime=e,this.ToDoData=n}),X);function Rs(e,n){return new Ks(e,n)}const js=v((function(e,n,...t){D.call(this,e,n,...t)}),D);function Us(e,n,t){const r=function(e,n){return e>=n.ToDoTime};if(yr(A(1,r,[e]),t[1])){let o,a;return a=tr(t[1]),o=nr((function(t,i){if(r(e,i)){const r=n(t[0],i.ToDoData,e);return 1===r.tag?[r.fields[0],ar(r.fields[1],t[1])]:[r.fields[0],t[1]]}return[t[0],new x(i,t[1])]}),[t[0],new x],a),[(i=o)[0],tr(i[1])]}return[t[0],t[1]];var i}const Js=Math.fround(30),zs=Math.fround(160),Vs=Math.fround(4),_s=(Math.fround(.75),Math.fround(6),Math.fround(.20000000298023224)),Ys=Math.fround(3.5),qs=Math.fround(.30000001192092896),Zs=Math.fround(155),$s=Math.fround(140),Qs=Math.fround(4),el=Math.fround(10),nl=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const tl=v((function(e){this.HitShipX=e}),X);const rl=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const il=v((function(e,n,t,r,i,o,a,u,s,l,c,f,h,d){this.ScoreAndHiScore=e,this.ShipsRemaining=n,this.GunAim=t,this.AlliedState=r,this.AlliedCountToSink=0|i,this.EnemyShips=o,this.Decoratives=a,this.SkyExplosion=u,this.PendingIncoming=s,this.PendingDamage=l,this.PendingHits=c,this.PendingMessageTexts=f,this.PendingScoreChanges=h,this.MessageText=d}),X);function ol(e){return qt(Xo,e,Array)}function al(e,n,t){const r=new Va(_s,ol([pi]),new za(1,"Hidden"),new za(1,"Hidden")),i=Ra(new ea(n,t),e,_s);return new _a(r,e,i)}function ul(e,n){return gr((function(e){const t=e.ShipImage.EngineImageMetadata.ImageWidth/Math.fround(2);return null==e.SinkStartTime&&(r=e.CentreX,i=t,o=n,Math.abs(r-o)<i);var r,i,o}),e)}const sl=new Va(Math.fround(.699999988079071),ol([Si,Mi]),new za(1,"Hidden"),new za(1,"Hidden")),ll=new Va(Math.fround(.699999988079071),ol([yi,Ti]),new za(1,"Hidden"),new za(1,"Hidden"));function cl(e,n,t,r,i,o){var a,u,s;if(null!=e.tail){if(null!=e.head.SinkStartTime)return new js(1,"PendingDoneWithAdditionalToDos",[e,n,t,r],new x((a=new rl(0,"IncomingChange",null),Rs(o+Qs,a)),new x));{const t=1===r,i=function(e,n,t,r){const i=e.BaseY-e.ShipImage.EngineImageMetadata.ImageHeight,o=t?Zs:$s,a=r+sl.FlickBookDuration+qs,u=a+ll.FlickBookDuration,s=u+Ys,l=new _a(sl,r,ja(La,new ea(e.CentreX,i),new ea(e.CentreX,Math.fround(-10)),r,sl.FlickBookDuration)),c=new _a(ll,a,ja(La,new ea(e.CentreX,Math.fround(-100)),new ea(e.CentreX,o),a,ll.FlickBookDuration)),f=t?n:new x(al(u,e.CentreX,o),n);return[new x(l,new x(c,f)),u,s]}(e.head,n,t,o),a=t?new x((u=new nl(0,"DamageChange",null),Rs(i[1],u)),new x):new x,l=r-1|0;return new js(1,"PendingDoneWithAdditionalToDos",[e,i[0],a,l],new x((s=new rl(0,"IncomingChange",null),Rs(i[2],s)),new x))}}return new js(0,"PendingDone",[e,n,t,r])}function fl(e,n){let t;t=0|Xo(pi).EngineImageMetadata.ImageHeight;const r=as(e.GunElevation)-t/Math.fround(2);return al(n,e.GunCentreX,r)}const hl=v((function(e,n,...t){D.call(this,e,n,...t)}),D);function dl(e,n,t,r){var i,o,a,u,s,l,c;if(e.Fire.JustDown){const e=r+n.GunTraits.GunShellDuration*Math.fround(2);let f;if(f=ul(t,n.GunCentreX),null!=f){const t=f,r=function(e,n){const t=~~os(e.GunElevation)-~~n.ElevationToHit|0;return 0===t?new hl(0,"DirectHit"):t<0?new hl(2,"TooNearBy",Ae(t)):new hl(1,"TooFarBy",t)}(n,t),h=2===r.tag?[null,(o=100*Math.abs(r.fields[0])|0,a=$n(Zn("%dM SHORT")),i=a(o),Rs(e,i)),null]:1===r.tag?[null,(s=100*Math.abs(r.fields[0])|0,l=$n(Zn("%dM LONG")),u=l(s),Rs(e,u)),null]:[(c=new tl(t.CentreX),Rs(e,c)),Rs(e,"DIRECT HIT"),Rs(e,2e3)],d=2===r.tag?fl(n,e):(r.tag,null);return[h[0],h[1],h[2],d]}return[null,null,null,fl(n,e)]}return[null,null,null,null]}function gl(e,n,t){return new il(e,n,qu(new Vu(1,"DoubleBarrelGun"),zs,Js,el,t),new is(0,"AlliedShipInPlay"),5,ls(),new x,new x,new x(Rs(t,new rl(0,"IncomingChange",null)),new x),new x,new x,new x,new x,"")}function wl(e,n,t,r){let i;if(2===e.AlliedState.tag){if(t-e.AlliedState.fields[0]>Vs){const n=new is(3,"AirOrSeaBattleScreenOver");i=new il(e.ScoreAndHiScore,e.ShipsRemaining,e.GunAim,n,e.AlliedCountToSink,e.EnemyShips,e.Decoratives,e.SkyExplosion,e.PendingIncoming,e.PendingDamage,e.PendingHits,e.PendingMessageTexts,e.PendingScoreChanges,e.MessageText)}else i=e}else if(1===e.AlliedState.tag){if(t-e.AlliedState.fields[0]>Vs)if(e.ShipsRemaining>1){const n=new is(0,"AlliedShipInPlay"),t=e.ShipsRemaining-1;i=new il(e.ScoreAndHiScore,t,e.GunAim,n,e.AlliedCountToSink,e.EnemyShips,e.Decoratives,e.SkyExplosion,e.PendingIncoming,e.PendingDamage,e.PendingHits,e.PendingMessageTexts,e.PendingScoreChanges,e.MessageText)}else{const n=new is(3,"AirOrSeaBattleScreenOver");i=new il(e.ScoreAndHiScore,0,e.GunAim,n,e.AlliedCountToSink,e.EnemyShips,e.Decoratives,e.SkyExplosion,e.PendingIncoming,e.PendingDamage,e.PendingHits,e.PendingMessageTexts,e.PendingScoreChanges,e.MessageText)}else i=e}else if(3===e.AlliedState.tag)i=e;else if(null==e.EnemyShips.tail){const n=new is(2,"WonScreen",t);i=new il(e.ScoreAndHiScore,e.ShipsRemaining,e.GunAim,n,e.AlliedCountToSink,e.EnemyShips,e.Decoratives,e.SkyExplosion,e.PendingIncoming,e.PendingDamage,e.PendingHits,e.PendingMessageTexts,e.PendingScoreChanges,e.MessageText)}else{let o,a,u,s;o=$a(t,e.SkyExplosion),a=$a(t,e.Decoratives),u=cs(t,e.EnemyShips),s=0|Xo(Ii).EngineImageMetadata.ImageHeight;const l=es(n,t,r,s,e.GunAim);let c,f,h,d,g,w;c=Us(t,(function(e,n,t){return cl(e[0],e[1],e[2],e[3],0,t)}),[[u,a,e.PendingDamage,e.AlliedCountToSink],e.PendingIncoming]),f=Us(t,(function(e,n,t){return new js(0,"PendingDone",[new is(1,"ShipSinking",t),new x(hs(t),new x),5])}),[[e.AlliedState,o,c[0][3]],c[0][2]]),h=Us(t,(function(e,n,t){return new js(0,"PendingDone",(r=t,i=n.HitShipX,ur((function(e){if(e.CentreX===i){const n=r;return new us(e.CentreX,e.BaseY,e.ShipImage,n,e.ElevationToHit)}return e}),e)));var r,i}),[c[0][0],e.PendingHits]),d=Us(t,(function(e,n,t){return new js(0,"PendingDone",n)}),[e.MessageText,e.PendingMessageTexts]),g=Us(t,(function(e,n,t){return new js(0,"PendingDone",ma(n,e))}),[e.ScoreAndHiScore,e.PendingScoreChanges]),w=ns(t,l);const p=dl(n,w,h[0],t),S=function(e,n){if(null!=e){return new x(se(e),n)}return n},M=S(p[0],h[1]),m=S(p[1],d[1]),y=S(p[2],g[1]),T=S(p[3],c[0][1]);i=new il(g[0],e.ShipsRemaining,w,f[0][0],f[0][2],h[0],T,f[0][1],c[1],f[1],M,m,y,d[0])}return 3===i.AlliedState.tag?i.ShipsRemaining>0?new Yo(1,"GoToNextChapter2",i):new Yo(2,"GameOver2",i):new Yo(0,"StayOnThisChapter2",i)}const pl=new ea(Math.fround(120),Math.fround(97)),Sl=cr([new ta(Math.fround(86),Math.fround(75),Math.fround(156),Math.fround(139)),wa]),Ml=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const ml=v((function(e,n,t){this.ScoreAndHiScore=e,this.ShipsThrough=n,this.AlliedState=t}),X);function yl(e,n){return new ml(e,n,new Ml(0,"FleetBeforeBeachLandingInPlay",pl))}function Tl(e,n,t){let r;if(1===e.AlliedState.tag){if(t-e.AlliedState.fields[1]>ha){const n=new Ml(2,"ScreenOver");r=new ml(e.ScoreAndHiScore,e.ShipsThrough,n)}else r=e}else if(2===e.AlliedState.tag)r=e;else{const a=pa(e.AlliedState.fields[0],n,Sl),u=(o=t,aa(wa,i=a)?new Ml(1,"EngagedBeachLanding",i,o):new Ml(0,"FleetBeforeBeachLandingInPlay",i));r=new ml(e.ScoreAndHiScore,e.ShipsThrough,u)}var i,o;return 0===r.AlliedState.tag?new _o(0,"StayOnThisChapter1",r):new _o(1,"GoToNextChapter1",r)}const Il=v((function(e,n,t,r){this.TilesHorizontally=0|e,this.TilesVertically=0|n,this.TileWidthPixels=t,this.TileHeightPixels=r}),X);const Cl=v((function(e,n,t,r){this.WindowLeft=e,this.WindowTop=n,this.WindowWidth=t,this.WindowHeight=r}),X);const Al=v((function(e,n){this.OffsetX=e,this.OffsetY=n}),X);function kl(e,n,t,r){const i=function(e,n){if(n<=0){const t=0|~~(Ae(n)/e);return[n+e*t|0,t]}return[n,0]},o=i(e.TileWidthPixels,t.OffsetX),a=i(e.TileHeightPixels,t.OffsetY);if(n.WindowWidth>0&&n.WindowHeight>0){const t=n.WindowLeft+n.WindowWidth|0,i=n.WindowTop+n.WindowHeight|0;let u=n.WindowTop+a[0]|0,s=0|a[1];for(;u<i&&s<e.TilesVertically;){let i=n.WindowLeft+o[0]|0,a=0|o[1];for(;i<t&&a<e.TilesHorizontally;)r(i,u,a,s),i+=e.TileWidthPixels,a+=1;u+=e.TileHeightPixels,s+=1}}}const El=v((function(e){this.TargetLocation=e}),X);const vl=v((function(e,n){this.TargetsOnFinalBoss=e,this.TankBattleMapNumber=0|n}),X);const bl=cr([[Math.fround(169),Math.fround(50)],[Math.fround(134),Math.fround(71)],[Math.fround(194),Math.fround(90)],[Math.fround(123),Math.fround(111)],[Math.fround(221),Math.fround(68)],[Math.fround(74),Math.fround(108)],[Math.fround(249),Math.fround(116)],[Math.fround(163),Math.fround(83)],[Math.fround(104),Math.fround(70)],[Math.fround(231),Math.fround(96)]]);function Wl(){return new vl(ur((function(e){return new El(new ea(e[0],e[1]))}),bl),0)}const xl=Math.fround(60),Dl=Math.fround(188),Pl=(xl+Dl)/Math.fround(2),Hl=xr-Math.fround(16),Bl=Math.fround(12),Xl=Math.fround(3),Fl=Math.fround(12),Gl=Math.fround(1),Ol=Math.fround(3),Ll=Math.fround(4),Nl=(Math.fround(120),Math.fround(15)),Kl=Math.fround(2.5),Rl=Math.fround(.20000000298023224),jl=Math.fround(.75),Ul=Math.fround(7);function Jl(e){return qt(Xo,e,Array)}function zl(e,n){return new _a(new Va(jl,Jl([qr,Zr,$r,Qr]),new za(1,"Hidden"),new za(1,"Hidden")),n,Ra(e,n,jl))}const Vl=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const _l=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const Yl=v((function(e,n){this.etmx=e,this.etmy=n}),X);const ql=v((function(e,n,t,r){this.ScreenStartTime=e,this.TileMatrixTraits=n,this.LevelMap=t,this.FinalBossAndTankBattleData=r}),X);const Zl=v((function(e,n,t,r,i,o,a,u){this.Constants=e,this.ScoreAndHiScore=n,this.TanksRemaining=t,this.AlliedState=r,this.Decoratives=i,this.AlliedMissiles=o,this.EnemyMissiles=a,this.EnemyTankLocations=u}),X);function $l(){return new Va(Math.fround(3),[Xo(_r)],new za(1,"Hidden"),new za(1,"Hidden"))}function Ql(e,n,t){switch(t.tag){case 2:case 0:return new ta(e-Math.fround(8),n-Math.fround(6),e+Math.fround(8),n+Math.fround(6));default:return new ta(e-Math.fround(8),n-Math.fround(4),e+Math.fround(8),n+Math.fround(4))}}function ec(e,n){let t;return t=0|~~(n*Math.fround(5)),16*Ae(e)+320+t|0}function nc(e,n,t){return(0|Ae(ec(e,n)))+(0|~~(t+Math.fround(.5)))|0}function tc(e,n,t){let r;let i;return r=0|ec(e,t),i=52,new ea(r+n.etmx,52+n.etmy)}function rc(e,n,t,r){const i=Ql(Hl,e,n),o=new Cl(0|~~(i.Left+Math.fround(.5)),0|~~(i.Top+Math.fround(.5)),0|~~((u=i).Right-u.Left+Math.fround(.5)),0|~~((a=i).Bottom-a.Top+Math.fround(.5)));var a,u;const s=new Al(ec(r.LevelMap.TilesHorizontally,t)-o.WindowLeft,0|~~(-(i.Top-52)+Math.fround(.5)));let l=!0;return kl(r.TileMatrixTraits,o,s,(function(e,n,t,i){const o=r.LevelMap.TilesArray[i*r.LevelMap.TilesHorizontally+t];var a;l=!!l&&(!!p(a=o,Bi)||p(a,Pi))})),!l}function ic(e){switch(e.tag){case 0:return Jl([Li,Ri]);case 2:return Jl([Ni,ji]);default:return Jl([Oi,Ki])}}function oc(e,n,t,r){let i;const o=0|ec(e,n);let a;i=o,a=52,lr((function(e){t(e.etmx+i,e.etmy+52)}),r)}function ac(e,n,t){var r;const i=t-n.Constants.ScreenStartTime;let o;o=Xo(Gi);const a=function(){Uo(e,i),function(e,n,t){const r=new Cl(0,52,320,144),i=new Al(ec(n.LevelMap.TilesHorizontally,t),0);kl(n.TileMatrixTraits,r,i,(function(t,r,i,o){let a;a=Xo(n.LevelMap.TilesArray[o*n.LevelMap.TilesHorizontally+i]),Fo(e,t,r,a)}))}(e,n.Constants,i),nu(e,n.AlliedMissiles,i),nu(e,n.EnemyMissiles,i),oc(n.Constants.LevelMap.TilesHorizontally,i,(function(n,t){Oo(e,n,t,o)}),n.EnemyTankLocations)},u=function(){nu(e,n.Decoratives,i)},s=Math.fround(0);switch(1===n.AlliedState.tag?1:2===n.AlliedState.tag||3===n.AlliedState.tag?2:0){case 0:{a();const t=i-n.Constants.ScreenStartTime;Lo(e,Hl,n.AlliedState.fields[0],ic(n.AlliedState.fields[1]),Rl,t),u();break}case 1:a(),u()}!function(e,n,t,r){const i=n+2|0;let o;o=$n(Zn("SCORE  %d     TANKS  %d"))(t)(r),Ko(e,Br,new Jo(1,"CentreAlign"),new zo(0,"TopAlign"),160,i,o)}(e,(r=0|~~(s+Math.fround(.5)),r),n.ScoreAndHiScore.Score,n.TanksRemaining)}function uc(e,n,t,r,i){const o=function(e,n){const t=0|or(e);if(t<1)throw new Error("List of tank battle maps should never be empty");return pr(n%t,e)}(r,t.TankBattleMapNumber),a=new Il(o.TilesHorizontally,9,16,16),u=new ql(i,a,o,t);return new Zl(u,e,n,new _l(0,"AlliedTankInPlay",Pl,new Vl(1,"TankFacingLeft")),new x,new x,new x,ur((function(e){return new Yl(16*e.etx+8|0,16*e.ety+8|0)}),o.EnemyTanks))}function sc(e,n,t,r){if(n.Fire.JustDown&&function(e,n,t){let r;var i;if(r=null!=(i=e).tail?i.head.FlickBookStartTime:null,null!=r){return t-r>=n}return!0}(t,Kl,r)){return new x((i=Hl-Bl,o=e-Xl,a=r,new _a($l(),a,ja(Oa,new ea(i,o),new ea(i-xr,o),a,Kl))),t)}return t;var i,o,a}function lc(e,n){let t;return t=Ua(n,e.FlickBookMechanicsObject),zl(t,n)}function cc(e,n,t){return function(e,n){const t=e.ptx+Fl,r=e.pty-Gl;return new _a($l(),n,ja(Oa,new ea(t,r),new ea(t+xr,r),n,Kl))}(tc(n,e,t),t)}function fc(e,n,t,r,i,o){switch(e.tag){case 2:case 1:return[e,n];case 0:{const u=function(e,n,t){const r=t*Nl;switch(n.tag){case 2:return I(M,e+r,Dl);case 1:return e;default:return C(M,e-r,xl)}}(e.fields[0],e.fields[1],t),s=(a=r).Up.Held&&a.Down.Held?new Vl(1,"TankFacingLeft"):a.Up.Held?new Vl(0,"TankFacingUpLeft"):a.Down.Held?new Vl(2,"TankFacingDownLeft"):new Vl(1,"TankFacingLeft");if(rc(u,s,o,i)){const e=new x(zl(new ea(Hl,u),o),n);return[new _l(1,"AlliedTankExploding",o),e]}return[new _l(0,"AlliedTankInPlay",u,s),n]}default:return[e,n]}var a}function hc(e,n,t,r,i){switch(e.tag){case 3:case 1:return[n,e,t,r];case 0:{const o=function(e,n,t,r,i,o,a){const u=ps(e,new x(n,new x),t,r,(function(e){return 1}),i,o,a),s=null==u[1].tail?new Ss(0,"PlayerDestroyed"):new Ss(1,"PlayerSurvives");return[u[0],s,u[2],u[3]]}(n,e.fields[0],(function(e,n){return function(e,n,t){const r=new ea(Hl,t);let i;return i=qa(e,n),oa(r,Ul,i)}(i,e,n)}),Ya,t,r,(function(e){return[lc(e,i),0]}));return 0===o[1].tag?[o[0],new _l(1,"AlliedTankExploding",i),o[2],o[3]]:[o[0],e,o[2],o[3]]}default:return[n,e,t,r]}}function dc(e,n,t,r,i){switch(e.tag){case 2:case 1:return[e,n];case 0:if(function(e,n,t,r,i){const o=Ql(Hl,r,i),a=Xo(Gi).EngineImageMetadata;let u=!1;return oc(e,n,(function(e,n){if(u)u=!0;else{let t;const r=e-a.ImageWidth/Math.fround(2),i=n-a.ImageHeight/Math.fround(2);t=new ta(r,i,r+a.ImageWidth,i+a.ImageHeight),u=function(e,n){return!(e.Left>n.Right||e.Right<n.Left||e.Top>n.Bottom||e.Bottom<n.Top)}(t,o)}}),t),u}(r,i,t,e.fields[0],e.fields[1])){return[new _l(1,"AlliedTankExploding",i),new x(zl(new ea(Hl,e.fields[0]),i),n)]}return[e,n];default:return[e,n]}}const gc=v((function(e,n,...t){D.call(this,e,n,...t)}),D);function wc(e,n,t,r){let i;var o,a,u;switch(2===e.AlliedState.tag||3===e.AlliedState.tag?0:1){case 0:i=e;break;case 1:{const o=t-e.Constants.ScreenStartTime,a=0|nc(e.Constants.LevelMap.TilesHorizontally,o,Hl);let u,s,l;u=$a(o,e.Decoratives),s=$a(o,e.AlliedMissiles),l=$a(o,e.EnemyMissiles);const c=function(e,n,t){switch(e.tag){case 2:case 0:return[e,n];case 1:return t-e.fields[0]>Ll?[new _l(3,"AlliedTankDestroyed"),n-1]:[e,n];default:return[e,n]}}(function(e,n){switch(e.tag){case 2:case 1:return e;case 0:return n<64?new _l(2,"AlliedTankReachedFort"):e;default:return e}}(e.AlliedState,a),e.TanksRemaining,o),f=fc(c[0],u,r,n,e.Constants,o),h=ps(function(e,n,t,r){switch(e.tag){case 2:case 1:return t;case 0:return sc(e.fields[0],n,t,r);default:return t}}(f[0],n,s,o),e.EnemyTankLocations,(function(n,t){return function(e,n,t,r){const i=tc(e,r,n);let o;return o=qa(n,t),oa(i,Ul,o)}(e.Constants.LevelMap.TilesHorizontally,o,n,t)}),Ya,(function(e){return e}),f[1],e.ScoreAndHiScore,(function(e){return[lc(e,o),1e3]})),d=hc(f[0],l,h[2],h[3],o),g=dc(d[1],d[2],h[1],e.Constants.LevelMap.TilesHorizontally,o),w=function(e,n,t,r){var i;let o,a,u,s;if(a=nc(e,r,Math.fround(0)),o=a,s=nc(e,r,xr),u=s,i=r-Ol,r-(null!=t.tail?t.head.FlickBookStartTime:i)>=Ol){let i,a;a=Xa((function(e){return e.etmx>=o&&e.etmx<=u}),n);const s=0|or(a);if(s>0){i=pr(~~r%s|0,a)}else i=null;if(null!=i){return new x(cc(i,e,r),t)}return t}return t}(e.Constants.LevelMap.TilesHorizontally,h[1],d[0],o);i=new Zl(e.Constants,d[3],c[1],g[0],g[1],h[0],w,h[1]);break}}switch(3===i.AlliedState.tag?1:0===i.AlliedState.tag||1===i.AlliedState.tag?2:0){case 0:return new gc(2,"TankCompletedCourseSuccessfully",new Zl((u=(o=i).Constants.FinalBossAndTankBattleData.TankBattleMapNumber+1|0,a=new vl(o.Constants.FinalBossAndTankBattleData.TargetsOnFinalBoss,u),new ql(o.Constants.ScreenStartTime,o.Constants.TileMatrixTraits,o.Constants.LevelMap,a)),o.ScoreAndHiScore,o.TanksRemaining,o.AlliedState,o.Decoratives,o.AlliedMissiles,o.EnemyMissiles,o.EnemyTankLocations));case 1:return i.TanksRemaining>0?new gc(3,"RestartTankBattle",i):new gc(1,"GameOverOnTankBattleScreen",i);case 2:return new gc(0,"StayOnTankBattleScreen",i)}}const pc=Math.fround(3),Sc=Math.fround(160),Mc=new ea(Math.fround(160),Math.fround(20)),mc=Math.fround(4),yc=Math.fround(20),Tc=Math.fround(.75),Ic=Math.fround(.5),Cc=Math.fround(30),Ac=Math.fround(30);function kc(e){return qt(Xo,e,Array)}const Ec=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const vc=v((function(e,n,t,r,i,o,a,u){this.FinalBossAndTankBattleData=e,this.ScoreAndHiScore=n,this.TanksRemaining=t,this.ScreenStartTime=r,this.GunAim=i,this.AlliedState=o,this.Explosions=a,this.BossGunFlickBook=u}),X);function bc(e,n){const t=new Va(Tc,kc([qr,Zr,$r,Qr]),new za(0,"Visible"),new za(0,"Visible")),r=Ra(e,n,Tc);return new _a(t,n,r)}function Wc(e,n,t,r,i){return ps(e,n,(function(e,t){return!!p(t.TargetLocation,function(e){if(null!=e.tail)return e.head;throw new Error("List was empty")}(n).TargetLocation)&&(!Ja(i,e.ShellMechanicsObject)&&oa(t.TargetLocation,pc,e.ShellMechanicsObject.FinalPosition))}),(function(e){return e.ShellStartTime}),(function(e){return e.TargetLocation.ptx}),t,r,(function(e){let n;return n=Ua(i,e.ShellMechanicsObject),[bc(n,i),2e3]}))}function xc(e,n,t){let r;r=Xo(Ui);const i=function(){Fo(e,0,0,r)},o=function(t){Qu(e,r.EngineImageMetadata.ImageHeight,n.GunAim,t)};if(1===n.AlliedState.tag){i();const r=t-n.ScreenStartTime;Lo(e,Mc.ptx,Mc.pty,kc([Zi,$i]),Ic,r),nu(e,n.Explosions,t),o(t)}else if(2===n.AlliedState.tag)No(e,0,0,320,200,new br(0,"SolidColour",0)),Ko(e,Dr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,100,"TANK DESTROYED");else if(3===n.AlliedState.tag);else{i(),function(n,t){for(;;){const r=n,i=t;if(null==i.tail)break;{const o=r?Qi:eo;Oo(e,i.head.TargetLocation.ptx,i.head.TargetLocation.pty,Xo(o)),n=!1,t=i.tail}}}(!0,n.FinalBossAndTankBattleData.TargetsOnFinalBoss),Qa(e,n.BossGunFlickBook,t),nu(e,n.Explosions,t),o(t)}const a=new ka(n.ScoreAndHiScore,0,0,n.TanksRemaining,0,10,n.GunAim.GunElevation);Ia(e,r.EngineImageMetadata.ImageHeight),Ea(e,r.EngineImageMetadata.ImageHeight,a)}function Dc(e,n,t,r){return new vc(t,e,n,r,qu(new Vu(0,"SingleBarrelGun"),Sc,Ac,Cc,r),new Ec(0,"AlliedTankInPlay"),new x,new _a(new Va(yc,kc([Ji,zi,Vi,_i,Yi,qi]),new za(0,"Visible"),new za(0,"Visible")),r,Ra(Mc,r,yc)))}const Pc=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const Hc=v((function(e,n,t){this.ScoreAndHiScore=e,this.HiScoreText=n,this.RestartNow=t}),X);function Bc(e){return new Hc(e,"HI SCORE   "+e.HiScore.toString(),!1)}const Xc=Math.fround(4),Fc=v((function(e,n){this.EndTime=e,this.NextChapterConstructor=n}),X);function Gc(e,n){return new Fc(e+Xc,n)}const Oc=v((function(e,n,t,r,i,o){this.ScoreAndHiScore=e,this.ScoreText=n,this.HiScoreText=t,this.NextAnimStageTime=r,this.AnimationStage=i,this.RestartNow=o}),X);const Lc=Math.fround(1),Nc=cr(["----|--x","----|--x","----|P-x","----|PCx","----|-Cx","----|---","----|---"]),Kc=cr(["---P|---","123P|---","123P|---","123P|---","123-|---"]),Rc=cr(["---P|---","-23P|---","-23P|---","-23P|---","-23-|---","1---|---","1--P|---","123P|---","123P|---","123P|---","123-|---"]),jc=cr(["----|---","----|---","----|---","----|---"]),Uc=ar(Nc,ar(Kc,jc)),Jc=ar(Nc,ar(Rc,jc));function zc(e,n,t){Fo(e,0,0,Xo(oo)),null!=n.AnimationStage.tail?function(e,n){const t=function(e,n,t,r){return Oo(e,n,t,Xo(r))},r="x"===n[7],i="C"===n[6],o="P"===n[5],a="P"===n[3],u="3"===n[2],s="2"===n[1],l="1"===n[0],c=Math.fround(100),f=Math.fround(80);t(e,Math.fround(256),c,a?go:o?ho:wo),t(e,Math.fround(192),c,u?uo:i?ao:so),t(e,r?o||i?Math.fround(224):Math.fround(256):Math.fround(192),f,fo),t(e,Math.fround(128),c,s?lo:co),t(e,Math.fround(64),c,l?lo:co)}(e,n.AnimationStage.head):(Ko(e,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,75,"CONGRATULATIONS"),Ko(e,Dr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,100,"MISSION COMPLETE"),Ko(e,Hr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,125,n.ScoreText),Ko(e,Hr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,150,n.HiScoreText))}function Vc(e,n){return new Oc(e,"FINAL SCORE   "+e.Score.toString(),"HI SCORE   "+e.HiScore.toString(),n+Lc,n%Math.fround(4)<Math.fround(1)?Jc:Uc,!1)}const _c=v((function(e,n,t,r){this.Name=e,this.SelectorIndex=0|n,this.MaxNameLength=0|t,this.Complete=r}),X);const Yc=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const qc="ABCDEFGHIJKLMNOPQRSTUVWXYZ .X ";function Zc(e,n){const t=qc.length-1|0,r=t-1|0;switch(e.tag){case 1:{const e=0|(n.SelectorIndex===t?0:n.SelectorIndex+1);return new _c(n.Name,e,n.MaxNameLength,n.Complete)}case 2:{const e=n.Name.length===n.MaxNameLength,t=e?n.Name:n.SelectorIndex===r?0===n.Name.length?n.Name:it(n.Name,0,n.Name.length-1):n.Name+qc[n.SelectorIndex];return new _c(t,n.SelectorIndex,n.MaxNameLength,e)}default:{const e=0|(0===n.SelectorIndex?t:n.SelectorIndex-1);return new _c(n.Name,e,n.MaxNameLength,n.Complete)}}}function $c(e,n){const t=0|e.length,r=n-(0|~~(t/2))|0,i=0|(r<0?r+t:r);return it(e,i)+it(e,0,i)}function Qc(e){return cr(["ENTER YOUR NAME","","",(n=e.Name,t=e.MaxNameLength,r=".",rt(n,t,r,!0)),"",""," .",$c(qc,e.SelectorIndex)]);var n,t,r}const ef=v((function(e,n,t){this.ScoreAndHiScore=e,this.DataModel=n,this.MemoizedText=t}),X);function nf(e){const n=new _c("",0,12,!1);return new ef(e,n,Qc(n))}function tf(e,n,t,r){if(xo(e,n.ScoreAndHiScore.Score)){let r;const l=(u=n.DataModel,(s=t).Fire.JustDown?Zc(new Yc(2,"SelectLetter"),u):s.Left.JustDown?Zc(new Yc(0,"RotateLeft"),u):s.Right.JustDown?Zc(new Yc(1,"RotateRight"),u):null);if(null!=l){const e=l;let t;t=Qc(e),r=new ef(n.ScoreAndHiScore,e,t)}else r=n;return r.DataModel.Complete?new _o(1,"GoToNextChapter1",[(i=r.DataModel,o=n.ScoreAndHiScore.Score,a=e,Do(new vo(i.Name,o),a)),r]):new _o(0,"StayOnThisChapter1",[e,r])}return new _o(1,"GoToNextChapter1",[e,n]);var i,o,a,u,s}const rf=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const of=v((function(e){this.TankMapsList=e}),X);function af(e,n,t){switch(n.tag){case 1:!function(e,n){let t;var r,i;switch(t=Xo(Or),Fo(e,0,0,t),1===n.AlliedState.tag?(r=0,i=n.AlliedState.fields[0]):3===n.AlliedState.tag||2===n.AlliedState.tag?r=1:(r=0,i=n.AlliedState.fields[0]),r){case 0:Oo(e,i.ptx,i.pty,Xo(Lr)),Oo(e,n.EnemyFleetCentre.ptx,n.EnemyFleetCentre.pty,Xo(Nr))}Ia(e,t.EngineImageMetadata.ImageHeight);const o=new ka(n.ScoreAndHiScore,0,n.NumShips,Ca(n.NumShips),0,10,Math.fround(0));Ea(e,t.EngineImageMetadata.ImageHeight,o)}(e,n.fields[0]);break;case 2:Fu(e,t,n.fields[0]);break;case 3:!function(e,n){let t;var r,i;switch(t=Xo(Or),Fo(e,0,0,t),1===n.AlliedState.tag?(r=0,i=n.AlliedState.fields[0]):2===n.AlliedState.tag?r=1:(r=0,i=n.AlliedState.fields[0]),r){case 0:Oo(e,i.ptx,i.pty,Xo(Lr)),Oo(e,n.EnemyFleetCentre.ptx,n.EnemyFleetCentre.pty,Xo(Nr))}Ia(e,t.EngineImageMetadata.ImageHeight);const o=new ka(n.ScoreAndHiScore,0,n.ShipsThrough,Ca(n.ShipsThrough),0,10,Math.fround(0));Ea(e,t.EngineImageMetadata.ImageHeight,o)}(e,n.fields[0]);break;case 4:!function(e,n,t){const r=0|Xo(Ii).EngineImageMetadata.ImageHeight,i=function(t){Qu(e,r,n.GunAim,t)},o=function(){Fo(e,0,0,Xo(Ii)),nu(e,n.SkyExplosion,t),fs(e,n.EnemyShips,t),eu(e,Ps,n.Planes,t),nu(e,n.PlaneBombs,t),nu(e,n.Explosions,t)};2===n.AlliedState.tag?(o(),i(t),ds(e)):1===n.AlliedState.tag?(o(),gs(e)):3===n.AlliedState.tag||(o(),i(t));const a=new ka(n.ScoreAndHiScore,n.ShipsRemaining,0,Ca(n.ShipsRemaining),n.Damage,10,n.GunAim.GunElevation);Ia(e,r),Ea(e,r,a)}(e,n.fields[0],t);break;case 5:!function(e,n,t){let r;r=Xo(Ii);const i=function(t){Qu(e,r.EngineImageMetadata.ImageHeight,n.GunAim,t)},o=function(){Fo(e,0,0,r),nu(e,n.SkyExplosion,t),fs(e,n.EnemyShips,t),nu(e,n.Decoratives,t)};2===n.AlliedState.tag?(o(),i(t),ds(e)):1===n.AlliedState.tag?(o(),gs(e)):3===n.AlliedState.tag||(o(),i(t));const a=new ka(n.ScoreAndHiScore,0,n.ShipsRemaining,Ca(n.ShipsRemaining),0,10,n.GunAim.GunElevation);Ko(e,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,15,n.MessageText),Ia(e,r.EngineImageMetadata.ImageHeight),Ea(e,r.EngineImageMetadata.ImageHeight,a)}(e,n.fields[0],t);break;case 6:!function(e,n){let t;var r,i;switch(t=Xo(Or),Fo(e,0,0,t),1===n.AlliedState.tag?(r=0,i=n.AlliedState.fields[0]):2===n.AlliedState.tag?r=1:(r=0,i=n.AlliedState.fields[0]),r){case 0:Oo(e,i.ptx,i.pty,Xo(Lr))}Ia(e,t.EngineImageMetadata.ImageHeight);const o=new ka(n.ScoreAndHiScore,0,n.ShipsThrough,Ca(n.ShipsThrough),0,10,Math.fround(0));Ea(e,t.EngineImageMetadata.ImageHeight,o)}(e,n.fields[0]);break;case 7:ac(e,n.fields[0],t);break;case 8:xc(e,n.fields[0],t);break;case 9:!function(e,n,t){No(e,0,0,320,200,new br(0,"SolidColour",0)),Ko(e,Pr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,100,"GAME OVER"),Ko(e,Hr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,125,n.HiScoreText)}(e,n.fields[0]);break;case 10:!function(e,n,t){Fo(e,0,0,Xo(io)),Ko(e,Pr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,100,"GET READY")}(e,n.fields[0]);break;case 11:zc(e,n.fields[0]);break;case 12:!function(e,n,t){Uo(e,t),jo(e,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,75,10,n.MemoizedText)}(e,n.fields[0],t);break;default:!function(e,n,t){Uo(e,t/Math.fround(4)),Oo(e,Math.fround(160),Math.fround(68),Xo(Gr));const r=Po(30,n.GameGlobalState.GameScoreBoard);jo(e,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,94,20,r),Ko(e,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,180,"USE CURSOR KEYS ... Z TO FIRE")}(e,n.fields[0],t)}}const uf=v((function(e,n,...t){D.call(this,e,n,...t)}),D);function sf(e,n){return function(e,n,t){switch(t.tag){case 1:{const e=Da(10,new Ma(0,12345));return new rf(1,"InitialMapChapter",e)}case 2:return new rf(10,"IntermissionChapter",Gc(n,(function(e){return new rf(2,"SecretPassageChapter",Gu(new Ma(0,1e4),7,e))})));case 3:{const e=Gu(new Ma(0,1e4),7,n);return new rf(2,"SecretPassageChapter",e)}case 4:{const e=Uu(new Ma(0,1e4),5);return new rf(3,"MapPostPassageChapter",e)}case 5:{const e=Ls(new Aa(0,"StrongEnemy"),new Ma(100,1e3),4,n);return new rf(4,"AirBattleChapter",e)}case 6:{const e=gl(new Ma(100,1e3),4,n);return new rf(5,"SeaBattleChapter",e)}case 7:{const e=yl(new Ma(100,1e3),4);return new rf(6,"MapBeforeBeachLandingChapter",e)}case 8:{const t=Wl(),r=uc(new Ma(100,1e3),8,t,e.TankMapsList,n);return new rf(7,"TankBattleChapter",r)}case 9:{const e=Wl(),t=Dc(new Ma(100,1e3),3,e,n);return new rf(8,"FinalBossChapter",t)}case 10:{const e=Vc(new Ma(25e3,37e3),n);return new rf(11,"VictoryChapter",e)}case 11:{const e=nf(new Ma(25e3,25e3));return new rf(12,"PotentialEnterYourNameChapter",e)}case 12:{const e=Bc(new Ma(25e3,25e3));return new rf(9,"GameOverChapter",e)}default:return new rf(0,"GameTitleChapter",Qo(2e3,Bo(),n))}}(e,n,new uf(0,"RunGameNormally"))}function lf(e,n,t,r,i,o){var a,u,s,l,c,f,h,d,g,w,p,S,M,m,y,T,I,C,A,k,E,v;const b=function(e){return new rf(10,"IntermissionChapter",Gc(i,e))};switch(t.tag){case 1:return new Vo(0,"NextStoryboard",1===(a=Ha(t.fields[0],r,i)).tag?b((function(e){const n=Gu(a.fields[0].ScoreAndHiScore,a.fields[0].NumShips,e);return new rf(2,"SecretPassageChapter",n)})):2===a.tag?b((function(e){const n=Ls(new Aa(0,"StrongEnemy"),a.fields[0].ScoreAndHiScore,a.fields[0].NumShips,e);return new rf(4,"AirBattleChapter",n)})):new rf(1,"InitialMapChapter",a.fields[0]));case 2:return new Vo(0,"NextStoryboard",1===(u=Lu(t.fields[0],r,i)).tag?b((function(e){const n=Uu(u.fields[0].FleetStats.Score,u.fields[0].FleetStats.ShipsSuccess);return new rf(3,"MapPostPassageChapter",n)})):2===u.tag?(s=Bc(u.fields[0].FleetStats.Score),new rf(9,"GameOverChapter",s)):new rf(2,"SecretPassageChapter",u.fields[0]));case 3:return new Vo(0,"NextStoryboard",1===(l=Ju(t.fields[0],r,i)).tag?(c=Ls(new Aa(1,"WeakerEnemy"),l.fields[0].ScoreAndHiScore,t.fields[0].ShipsThrough,i),new rf(4,"AirBattleChapter",c)):new rf(3,"MapPostPassageChapter",l.fields[0]));case 4:return new Vo(0,"NextStoryboard",1===(f=Ns(t.fields[0],r,i,o)).tag?(h=gl(f.fields[0].ScoreAndHiScore,f.fields[0].ShipsRemaining,i),new rf(5,"SeaBattleChapter",h)):2===f.tag?(d=Bc(f.fields[0].ScoreAndHiScore),new rf(9,"GameOverChapter",d)):new rf(4,"AirBattleChapter",f.fields[0]));case 5:return new Vo(0,"NextStoryboard",1===(g=wl(t.fields[0],r,i,o)).tag?(w=yl(g.fields[0].ScoreAndHiScore,g.fields[0].ShipsRemaining),new rf(6,"MapBeforeBeachLandingChapter",w)):2===g.tag?(p=Bc(g.fields[0].ScoreAndHiScore),new rf(9,"GameOverChapter",p)):new rf(5,"SeaBattleChapter",g.fields[0]));case 6:return new Vo(0,"NextStoryboard",1===(S=Tl(t.fields[0],r,i)).tag?b((function(n){const t=Wl(),r=uc(S.fields[0].ScoreAndHiScore,Ca(S.fields[0].ShipsThrough),t,e.TankMapsList,n);return new rf(7,"TankBattleChapter",r)})):new rf(6,"MapBeforeBeachLandingChapter",S.fields[0]));case 7:return new Vo(0,"NextStoryboard",2===(M=wc(t.fields[0],r,i,o)).tag?b((function(e){const n=Dc(M.fields[0].ScoreAndHiScore,M.fields[0].TanksRemaining,M.fields[0].Constants.FinalBossAndTankBattleData,e);return new rf(8,"FinalBossChapter",n)})):1===M.tag?(m=Bc(M.fields[0].ScoreAndHiScore),new rf(9,"GameOverChapter",m)):3===M.tag?b((function(n){const t=uc(M.fields[0].ScoreAndHiScore,M.fields[0].TanksRemaining,M.fields[0].Constants.FinalBossAndTankBattleData,e.TankMapsList,n);return new rf(7,"TankBattleChapter",t)})):new rf(7,"TankBattleChapter",M.fields[0]));case 8:return new Vo(0,"NextStoryboard",1===(y=function(e,n,t,r){let i;var o,a;switch(1===e.AlliedState.tag||2===e.AlliedState.tag?(o=1,a=e.AlliedState.fields[0]):o=3===e.AlliedState.tag?2:0,o){case 0:{const o=t-e.ScreenStartTime;if(null==e.FinalBossAndTankBattleData.TargetsOnFinalBoss.tail){const n=new Ec(1,"WonScreen",t);i=new vc(e.FinalBossAndTankBattleData,e.ScoreAndHiScore,e.TanksRemaining,e.ScreenStartTime,e.GunAim,n,e.Explosions,e.BossGunFlickBook)}else if(o>yc){const n=new Ec(2,"TankIsShot",t);i=new vc(e.FinalBossAndTankBattleData,e.ScoreAndHiScore,e.TanksRemaining,e.ScreenStartTime,e.GunAim,n,e.Explosions,e.BossGunFlickBook)}else{let o,a;o=$a(t,e.Explosions),a=0|Xo(Ui).EngineImageMetadata.ImageHeight;const u=es(n,t,r,a,e.GunAim),s=Wc(u.Shells,e.FinalBossAndTankBattleData.TargetsOnFinalBoss,o,e.ScoreAndHiScore,t);let l;l=ns(t,new Yu(u.GunTraits,u.GunCentreX,u.GunElevation,s[0],u.LastFireTime)),i=new vc(new vl(s[1],e.FinalBossAndTankBattleData.TankBattleMapNumber),s[3],e.TanksRemaining,e.ScreenStartTime,l,e.AlliedState,s[2],e.BossGunFlickBook)}break}case 1:if(t-a>mc){const n=new Ec(3,"FinalBossScreenOver"),t=e.TanksRemaining-1;i=new vc(e.FinalBossAndTankBattleData,e.ScoreAndHiScore,t,e.ScreenStartTime,e.GunAim,n,e.Explosions,e.BossGunFlickBook)}else i=e;break;case 2:i=e}return 3===i.AlliedState.tag?null==i.FinalBossAndTankBattleData.TargetsOnFinalBoss.tail?new Pc(1,"Victory",i):i.TanksRemaining>0?new Pc(2,"FinalBossDestroyedTheTank",i):new Pc(3,"GameOverBecauseOfFinalBoss",i):new Pc(0,"StayOnFinalBossScreen",i)}(t.fields[0],r,i,o)).tag?(T=Vc(y.fields[0].ScoreAndHiScore,i),new rf(11,"VictoryChapter",T)):2===y.tag?(I=uc(y.fields[0].ScoreAndHiScore,y.fields[0].TanksRemaining,y.fields[0].FinalBossAndTankBattleData,e.TankMapsList,i),new rf(7,"TankBattleChapter",I)):3===y.tag?(C=Bc(y.fields[0].ScoreAndHiScore),new rf(9,"GameOverChapter",C)):new rf(8,"FinalBossChapter",y.fields[0]));case 10:return new Vo(0,"NextStoryboard",(W=t.fields[0],1===(A=i>=W.EndTime?new _o(1,"GoToNextChapter1",W):new _o(0,"StayOnThisChapter1",W)).tag?A.fields[0].NextChapterConstructor(i):new rf(10,"IntermissionChapter",A.fields[0])));case 9:return new Vo(0,"NextStoryboard",1===(k=function(e,n,t){const r=n.Fire.JustDown?new Hc(e.ScoreAndHiScore,e.HiScoreText,!0):e;return r.RestartNow?new _o(1,"GoToNextChapter1",r):new _o(0,"StayOnThisChapter1",r)}(t.fields[0],r)).tag?new rf(12,"PotentialEnterYourNameChapter",nf(k.fields[0].ScoreAndHiScore)):new rf(9,"GameOverChapter",k.fields[0]));case 11:return new Vo(0,"NextStoryboard",1===(E=function(e,n,t){let r;if(n.Fire.JustDown)r=new Oc(e.ScoreAndHiScore,e.ScoreText,e.HiScoreText,e.NextAnimStageTime,e.AnimationStage,!0);else{const n=null!=e.AnimationStage.tail&&t>e.NextAnimStageTime?[t+Lc,e.AnimationStage.tail]:[e.NextAnimStageTime,e.AnimationStage];r=new Oc(e.ScoreAndHiScore,e.ScoreText,e.HiScoreText,n[0],n[1],e.RestartNow)}return r.RestartNow?new _o(1,"GoToNextChapter1",r):new _o(0,"StayOnThisChapter1",r)}(t.fields[0],r,i)).tag?new rf(12,"PotentialEnterYourNameChapter",nf(E.fields[0].ScoreAndHiScore)):new rf(11,"VictoryChapter",E.fields[0]));case 12:{let e;const o=tf(n.GameScoreBoard,t.fields[0],r);if(1===o.tag){const n=new Ho(o.fields[0][0]);e=[n,new rf(0,"GameTitleChapter",Qo(o.fields[0][1].ScoreAndHiScore.HiScore,n,i))]}else{e=[new Ho(o.fields[0][0]),new rf(12,"PotentialEnterYourNameChapter",o.fields[0][1])]}return new Vo(1,"NextStoryboardAndGlobals",e[0],e[1])}default:return new Vo(0,"NextStoryboard",1===(v=function(e,n,t){var r;if(1===e.State.tag)return new _o(0,"StayOnThisChapter1",e);if(n.Fire.JustDown){return t>e.ScreenStartTime+qo?new _o(1,"GoToNextChapter1",(r=new Zo(1,"GameTitleScreenOver"),new $o(e.ScreenStartTime,e.GameGlobalState,e.HiScore,r))):new _o(0,"StayOnThisChapter1",e)}return new _o(0,"StayOnThisChapter1",e)}(t.fields[0],r,i)).tag?new rf(1,"InitialMapChapter",Da(10,new Ma(0,v.fields[0].HiScore))):new rf(0,"GameTitleChapter",v.fields[0]))}var W}const cf=v((function(e,n){this.JustDown=e,this.Held=n}),X);const ff=new cf(!1,!1),hf=v((function(e,n,t,r,i){this.Left=e,this.Right=n,this.Up=t,this.Down=r,this.Fire=i}),X);new hf(ff,ff,ff,ff,ff);function df(e){var n,t,r,i,o,a;switch(null!=e.MutableKeyStatesList.tail&&null!=e.MutableKeyStatesList.tail.tail&&null!=e.MutableKeyStatesList.tail.tail.tail&&null!=e.MutableKeyStatesList.tail.tail.tail.tail&&null!=e.MutableKeyStatesList.tail.tail.tail.tail.tail&&null==e.MutableKeyStatesList.tail.tail.tail.tail.tail.tail?(n=0,t=e.MutableKeyStatesList.tail.tail.tail.head,r=e.MutableKeyStatesList.tail.tail.tail.tail.head,i=e.MutableKeyStatesList.head,o=e.MutableKeyStatesList.tail.head,a=e.MutableKeyStatesList.tail.tail.head):n=1,n){case 0:return new hf(new cf(i.MutJustPressed,i.MutHeld),new cf(o.MutJustPressed,o.MutHeld),new cf(a.MutJustPressed,a.MutHeld),new cf(t.MutJustPressed,t.MutHeld),new cf(r.MutJustPressed,r.MutHeld));case 1:throw new Error("Immutable key record needs extending")}}const gf=v((function(e,n,...t){D.call(this,e,n,...t)}),D);const wf=v((function(e,n,t,r){this.ThisKeyScanCode=e,this.MutHeld=n,this.MutJustPressed=t,this.MutWaitingRelease=r}),X);function pf(e){return new wf(e,!1,!1,!1)}const Sf=v((function(e,n,t){this.MutableKeyStatesList=e,this.PauseKey=n,this.GameIsPaused=t}),X);const Mf=v((function(e,n,t){this.SystemKeyStateStore=e,this.UserKeyStatesSnapshot=n,this.SnapshotObtainer=t}),X);function mf(e,n){let t;if(t=gr((function(e){return p(e.ThisKeyScanCode,n)}),e.MutableKeyStatesList),null==t)return p(n,e.PauseKey.ThisKeyScanCode)?e.PauseKey:null;return t}function yf(e,n){0===n.tag||(e.UserKeyStatesSnapshot=e.SnapshotObtainer(e.SystemKeyStateStore))}function Tf(e,n){let t;const r=mf(e.SystemKeyStateStore,n);if(null!=r){const n=r;n.MutWaitingRelease?t=new gf(0,"NoKeyStateChanged"):(p(n.ThisKeyScanCode,e.SystemKeyStateStore.PauseKey.ThisKeyScanCode)&&((i=e).SystemKeyStateStore.GameIsPaused=!i.SystemKeyStateStore.GameIsPaused),n.MutHeld=!0,n.MutJustPressed=!0,n.MutWaitingRelease=!0,t=new gf(1,"KeyStateChanged"))}else t=new gf(0,"NoKeyStateChanged");var i;return yf(e,t),t}function If(e,n){let t;const r=mf(e.SystemKeyStateStore,n);if(null!=r){const e=r;e.MutHeld=!1,e.MutWaitingRelease=!1,t=new gf(1,"KeyStateChanged")}else t=new gf(0,"NoKeyStateChanged");return yf(e,t),t}const Cf=v((function(e,n){this.Fonts=e,this.Images=n}),X);function Af(){return J("App.JavascriptGraphicResources",[],Cf,()=>[["Fonts",V(ie())],["Images",V(ie())]])}function kf(e,n,t,r,i,o){const a=[];!function e(n,o,u){if(null!=n.tail){const i=o(n.head),s=u(n.head),l=0|t(n.head),c=0|r(n.head);loadImageThenDo(i,s,(function(t){$t(new re(new ee(i,s?new Q(1,"MagentaColourKey"):new Q(0,"NoColourKey"),l,c),new te(0,"HostImageObject",t)),a),e(n.tail,o,u)}))}else i(a.slice())}(o,e,n)}function Ef(e){const n=function(e){return e.ImageFileName},t=function(e){return 1===e.ImageColourKey.tag},r=function(e){return e.ImageWidth},i=function(e){return e.ImageHeight};kf(n,t,r,i,(function(o){kf(n,t,r,i,(function(n){e(o,n)}),kr)}),Ar)}function vf(e,n,t){const r=function(e){return~~(e+Math.fround(.5))};switch(t.tag){case 2:{let e,i;e=t.fields[2].EngineImageMetadata.ImageWidth,i=t.fields[2].EngineImageMetadata.ImageHeight;const o=0|r(t.fields[0]),a=0|r(t.fields[1]),u=0|r(t.fields[3]),s=0|r(t.fields[4]);return n.drawImage(t.fields[2].HostImageObject.fields[0],0,0,e,i,o,a,u,s)}case 3:{const e=0|r(t.fields[4]),i=0|r(t.fields[5]),o=0|r(t.fields[6]),a=0|r(t.fields[7]);return n.drawImage(t.fields[8].HostImageObject.fields[0],t.fields[0],t.fields[1],t.fields[2],t.fields[3],e,i,o,a)}case 4:{let r;if(!(t.fields[3].fields[0]>=0&&t.fields[3].fields[0]<e.Fonts.length))throw new Error("invalid font resource index");r=e.Fonts[t.fields[3].fields[0]];const i=8*~~t.fields[2]|0;let o,a;return o=t.fields[0],a=t.fields[1],n.drawImage(r.HostImageObject.fields[0],i,0,8,8,o,a,8,8)}case 1:{let e,r,i,o;e=t.fields[2],r=t.fields[3],i=t.fields[0],o=t.fields[1];const a="#"+et("{0:x6}",t.fields[4].fields[0]);return n.fillStyle=a,n.fillRect(i,o,e,r)}default:{const e=0|t.fields[0],r=0|t.fields[1];return n.drawImage(t.fields[2].HostImageObject.fields[0],e,r)}}}function bf(e,n){const t=new Cf(e,n);Er(n);const r=document.getElementById("gameScreen").getContext("2d"),i=function(){let e,n;return n=ur(Eo,ir(Hn(0,1,3))),e=mo((function(e){return 1===e.tag?new Mo(1,"SecondList",e.fields[0]):new Mo(0,"FirstList",e.fields[0])}),n),null==e[1].tail?new ce(0,"Ok",e[0]):new ce(1,"Error",tt("\n",e[1]))}();if(1===i.tag)console.log(i.fields[0]);else{const e=Math.fround(0),n=new of(i.fields[0]),o=sf(n,e),a=Math.fround(.019999999552965164),u=Bo(),s=function(e,n,t){const r=new Sf(ur(pf,t),pf(n),!1);return new Mf(r,e(r),e)}(df,80,cr([37,39,38,40,90])),l=function(e,n){document.addEventListener(e,(function(e){0===n(s,~~e.keyCode).tag||e.preventDefault()}))};l("keydown",Tf),l("keyup",If),document.getElementById("loaderScreen").classList.add("hidden"),document.getElementById("gameScreen").classList.remove("hidden"),function e(i,o,u,l){const c=u+1,f=c/Math.fround(50);let h;af((function(e){vf(t,r,e)}),o,f);const d=lf(n,i,o,s.UserKeyStatesSnapshot,f,a);h=1===d.tag?[d.fields[0],d.fields[1]]:[i,d.fields[0]],function(e){let n;yr((function(e){return e.MutJustPressed}),e.SystemKeyStateStore.MutableKeyStatesList)?(lr((function(e){e.MutJustPressed=!1}),e.SystemKeyStateStore.MutableKeyStatesList),n=new gf(1,"KeyStateChanged")):n=new gf(0,"NoKeyStateChanged"),yf(e,n)}(s);window.setTimeout(A(1,e,[h[0],h[1],c]),20)}(u,o,0,null)}}Ef(bf),t.d(n,"JavascriptGraphicResources",(function(){return Cf})),t.d(n,"JavascriptGraphicResources$reflection",(function(){return Af})),t.d(n,"LoadFileListThenDo",(function(){return kf})),t.d(n,"LoadResourceFilesThenDo",(function(){return Ef})),t.d(n,"RenderToWebCanvas",(function(){return vf})),t.d(n,"StartGame",(function(){return bf}))}]);