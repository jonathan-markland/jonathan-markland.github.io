!function(n){var e={};function t(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return n[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var i in n)t.d(r,i,function(e){return n[e]}.bind(null,i));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=0)}([function(n,e,t){"use strict";function r(n){return null!=n&&(Array.isArray(n)||ArrayBuffer.isView(n))}function i(n){return null!=n&&"function"==typeof n.Dispose}t.r(e);function o(n,e,t){return n.has(e)?[!0,n.get(e)]:[!1,t]}function a(n,e){return!e.has(n)&&(e.add(n),!0)}function u(n,e){let t=n.toString(10);for(;t.length<e;)t="0"+t;return t}function s(n){const e=n;return"number"==typeof e.offset?e.offset:1===n.kind?0:-6e4*n.getTimezoneOffset()}class c{static id(n){return c.idMap.has(n)||c.idMap.set(n,++c.count),c.idMap.get(n)}}function l(n){let e=0,t=5381;const r=n.length;for(;e<r;)t=33*t^n.charCodeAt(e++);return t}function f(n){return 2654435761*n|0}function h(n){return 0===n.length?0:n.reduce((n,e)=>(n<<5)+n^e)}function d(n){if(null==n)return 0;switch(typeof n){case"boolean":return n?1:0;case"number":return f(n);case"string":return l(n);default:if(function(n){return null!=n&&"function"==typeof n.GetHashCode}(n))return n.GetHashCode();if(r(n)){const e=n.length,t=new Array(e);for(let r=0;r<e;r++)t[r]=d(n[r]);return h(t)}return l(String(n))}}function g(n,e,t){if(null==n)return null==e;if(null==e)return!1;if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function w(n,e){return g(n,e,p)}function p(n,e){return n===e||(null==n?null==e:null!=e&&("object"==typeof n&&(function(n){return null!=n&&"function"==typeof n.Equals}(n)?n.Equals(e):r(n)?r(e)&&w(n,e):n instanceof Date&&(e instanceof Date&&0===m(n,e)))))}function m(n,e){let t,r;return"offset"in n&&"offset"in e?(t=n.getTime(),r=e.getTime()):(t=n.getTime()+s(n),r=e.getTime()+s(e)),t===r?0:t<r?-1:1}function S(n,e){return n===e?0:n<e?-1:1}function M(n,e,t){if(null==n)return null==e?0:1;if(null==e)return-1;if(n.length!==e.length)return n.length<e.length?-1:1;for(let r=0,i=0;r<n.length;r++)if(i=t(n[r],e[r]),0!==i)return i;return 0}function y(n,e){return M(n,e,I)}function I(n,e){return n===e?0:null==n?null==e?0:-1:null==e?1:"object"!=typeof n?n<e?-1:1:function(n){return null!=n&&"function"==typeof n.CompareTo}(n)?n.CompareTo(e):r(n)&&r(e)?y(n,e):n instanceof Date&&e instanceof Date?m(n,e):1}function T(n,e,t){return n(e,t)<0?e:t}function C(n,e,t){return n(e,t)>0?e:t}function W(n){let e=n;return n=>void 0===n?e:void(e=n)}c.idMap=new WeakMap,c.count=0;function A(n,e){if(null==e)return null;if(e.length>1)return e;let t;switch(n){case 2:t=(n,t)=>e(n)(t);break;case 3:t=(n,t,r)=>e(n)(t)(r);break;case 4:t=(n,t,r,i)=>e(n)(t)(r)(i);break;case 5:t=(n,t,r,i,o)=>e(n)(t)(r)(i)(o);break;case 6:t=(n,t,r,i,o,a)=>e(n)(t)(r)(i)(o)(a);break;case 7:t=(n,t,r,i,o,a,u)=>e(n)(t)(r)(i)(o)(a)(u);break;case 8:t=(n,t,r,i,o,a,u,s)=>e(n)(t)(r)(i)(o)(a)(u)(s);break;default:throw new Error("Uncurrying to more than 8-arity is not supported: "+n)}return t.__CURRIED__=e,t}function k(n,e){if(null!=e){if("__CURRIED__"in e)return e.__CURRIED__;switch(n){case 2:return n=>t=>e(n,t);case 3:return n=>t=>r=>e(n,t,r);case 4:return n=>t=>r=>i=>e(n,t,r,i);case 5:return n=>t=>r=>i=>o=>e(n,t,r,i,o);case 6:return n=>t=>r=>i=>o=>a=>e(n,t,r,i,o,a);case 7:return n=>t=>r=>i=>o=>a=>u=>e(n,t,r,i,o,a,u);case 8:return n=>t=>r=>i=>o=>a=>u=>s=>e(n,t,r,i,o,a,u,s);default:throw new Error("Currying to more than 8-arity is not supported: "+n)}}}function v(n,e,t){if(null==e)return null;if("__CURRIED__"in e){e=e.__CURRIED__;for(let n=0;n<t.length;n++)e=e(t[n]);return e}switch(n){case 1:return n=>e.apply(null,t.concat([n]));case 2:return n=>r=>e.apply(null,t.concat([n,r]));case 3:return n=>r=>i=>e.apply(null,t.concat([n,r,i]));case 4:return n=>r=>i=>o=>e.apply(null,t.concat([n,r,i,o]));case 5:return n=>r=>i=>o=>a=>e.apply(null,t.concat([n,r,i,o,a]));case 6:return n=>r=>i=>o=>a=>u=>e.apply(null,t.concat([n,r,i,o,a,u]));case 7:return n=>r=>i=>o=>a=>u=>s=>e.apply(null,t.concat([n,r,i,o,a,u,s]));case 8:return n=>r=>i=>o=>a=>u=>s=>c=>e.apply(null,t.concat([n,r,i,o,a,u,s,c]));default:throw new Error("Partially applying to more than 8-arity is not supported: "+n)}}function b(n,e){if(n.has(e))return n.get(e);throw new Error(`The given key '${e}' was not present in the dictionary.`)}function E(n,e){return null!=e&&Object.getPrototypeOf(n).constructor===Object.getPrototypeOf(e).constructor}function x(n,e){return function(n,e){n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}(n,e||D),n}function D(){}function H(n,e){if(n===e)return 0;if(null==e)return-1;for(;null!=n.tail;){if(null==e.tail)return 1;const t=I(n.head,e.head);if(0!==t)return t;n=n.tail,e=e.tail}return null==e.tail?0:-1}function P(n,e){this.head=n,this.tail=e}function O(n,e,...t){this.tag=0|n,this.name=e,this.fields=t}function X(n,e){const t={},r=null==e?Object.keys(n):e(n);for(let e=0;e<r.length;e++)t[r[e]]=n[r[e]];return t}function F(n,e,t){if(n===e)return!0;if(E(n,e)){const r=null==t?Object.keys(n):t(n);for(let t=0;t<r.length;t++)if(!p(n[r[t]],e[r[t]]))return!1;return!0}return!1}function G(n,e,t){if(n===e)return 0;if(E(n,e)){const r=null==t?Object.keys(n):t(n);for(let t=0;t<r.length;t++){const i=I(n[r[t]],e[r[t]]);if(0!==i)return i}return 0}return-1}function B(){}D.prototype.toString=function(){return"{"+Object.keys(this).map(n=>n+" = "+String(this[n])).join(";\n ")+"}"},D.prototype.GetHashCode=function(){return function(n){if(null==n)return 0;switch(typeof n){case"boolean":return n?1:0;case"number":return f(n);case"string":return l(n);default:return f(c.id(n))}}(this)},D.prototype.Equals=function(n){return this===n},P.prototype.toString=function(){return"["+Array.from(this).map(n=>String(n)).join("; ")+"]"},P.prototype.toJSON=function(){return Array.from(this)},P.prototype[Symbol.iterator]=function(){let n=this;return{next:()=>{const e=n;return n=n.tail,{done:null==e.tail,value:e.head}}}},P.prototype.GetHashCode=function(){return h(Array.from(this).map(d))},P.prototype.Equals=function(n){return 0===H(this,n)},P.prototype.CompareTo=function(n){return H(this,n)},O.prototype.toString=function(){const n=this.fields.length;return 0===n?this.name:1===n?this.name+" "+String(this.fields[0]):this.name+" ("+this.fields.map(n=>String(n)).join(",")+")"},O.prototype.toJSON=function(){return 0===this.fields.length?this.name:[this.name].concat(this.fields)},O.prototype.GetHashCode=function(){const n=this.fields.map(n=>d(n));return n.splice(0,0,f(this.tag)),h(n)},O.prototype.Equals=function(n){return this===n||E(this,n)&&this.tag===n.tag&&w(this.fields,n.fields)},O.prototype.CompareTo=function(n){return this===n?0:E(this,n)?this.tag===n.tag?y(this.fields,n.fields):this.tag<n.tag?-1:1:-1},B.prototype.toString=function(){return"{"+Object.keys(this).map(n=>n+" = "+String(this[n])).join(";\n ")+"}"},B.prototype.toJSON=function(){return X(this)},B.prototype.GetHashCode=function(){return h(Object.keys(this).map(n=>d(this[n])))},B.prototype.Equals=function(n){return F(this,n)},B.prototype.CompareTo=function(n){return G(this,n)};const L=x((function(n){this.contents=n}),B),R=x((function(n){this.stack=Error().stack,this.message=n}),D);function K(n){return Object.keys(n).filter(n=>"message"!==n&&"stack"!==n)}const N=x((function(){R.call(this)}),R);N.prototype.toString=function(){const n=K(this),e=n.length;return 0===e?this.message:1===e?this.message+" "+String(this[n[0]]):this.message+" ("+n.map(n=>String(this[n])).join(",")+")"},N.prototype.toJSON=function(){return X(this,K)},N.prototype.GetHashCode=function(){return h(K(this).map(n=>d(this[n])))},N.prototype.Equals=function(n){return F(this,n,K)},N.prototype.CompareTo=function(n){return G(this,n,K)};x((function(n,e,t){this.arg1=n,this.arg2=0|e,this.arg3=0|t,this.message="The match cases were incomplete"}),N),x((function(){}),D);class j{constructor(n,e,t,r,i,o){this.fullname=n,this.generics=e,this.constructor=t,this.fields=r,this.cases=i,this.enumCases=o}toString(){return function n(e){const t=null==e.generics||q(e)?[]:e.generics;return t.length>0?e.fullname+"["+t.map(e=>n(e)).join(",")+"]":e.fullname}(this)}Equals(n){return U(this,n)}CompareTo(n){return z(this,n)}}function _(n){return null!=n.generics?n.generics:[]}function U(n,e){return""===n.fullname?""===e.fullname&&g(V(n),V(e),([n,e],[t,r])=>n===t&&U(e,r)):n.fullname===e.fullname&&g(_(n),_(e),U)}function z(n,e){return n.fullname!==e.fullname?n.fullname<e.fullname?-1:1:M(_(n),_(e),z)}new j("System.Object"),new j("Microsoft.FSharp.Core.Unit"),new j("System.Char"),new j("System.String"),new j("System.Boolean"),new j("System.SByte"),new j("System.Byte"),new j("System.Int16"),new j("System.UInt16"),new j("System.Int32"),new j("System.UInt32"),new j("System.Single"),new j("System.Double"),new j("System.Decimal");function q(n){return n.fullname.endsWith("[]")}function V(n){if(null!=n.fields)return n.fields();throw new Error(`${n.fullname} is not an F# record type`)}const J=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Y=x((function(n,e){this.JustDown=n,this.Held=e}),B);const Z=new Y(!1,!1);class ${constructor(n){this.value=n}toString(){return String(this.value)}toJSON(){return this.value}GetHashCode(){return d(this.value)}Equals(n){return null!=n&&p(this.value,n instanceof $?n.value:n)}CompareTo(n){return null==n?1:I(this.value,n instanceof $?n.value:n)}}function Q(n){return null==(n=void 0===n?null:n)||n instanceof $?new $(n):n}function nn(n,e){if(null==n){if(!e)throw new Error("Option has no value");return null}return n instanceof $?n.value:n}function en(n,e,t){return null!=n?null!=t?t(nn(n)):nn(n):e}x((function(n,e,t){O.call(this,n,e,t)}),O);const tn=x((function(n,e,t){O.call(this,n,e,t)}),O);function rn(n,e){return 1===e.tag?(t=n(e.fields[0]),new tn(1,"Error",t)):e;var t}var on={GetHashCode(){return h([this.s,this.e].concat(this.c))},Equals(n){return!this.cmp(n)},CompareTo(n){return this.cmp(n)}},an="[big.js] ",un=an+"Invalid ",sn=un+"decimal places",cn=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function ln(n,e){var t,r,i;if(0===e&&1/e<0)e="-0";else if(!cn.test(e+=""))throw Error(un+"number");for(n.s="-"==e.charAt(0)?(e=e.slice(1),-1):1,(t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),i=e.length,r=0;r<t&&r<i&&"0"==e.charAt(r);)++r;if(r==i)n.c=[n.e=0];else for(n.e=t-r-1,n.c=[],t=0;r<i;)n.c[t++]=+e.charAt(r++);return n=fn(n,dn.DP,dn.RM)}function fn(n,e,t,r){var i=n.c,o=n.e+e+1;if(o<i.length){if(1===t)r=i[o]>=5;else if(2===t)r=i[o]>5||5==i[o]&&(r||o<0||void 0!==i[o+1]||1&i[o-1]);else if(3===t)r=r||!!i[0];else if(r=!1,0!==t)throw Error("[big.js] Invalid rounding mode");if(o<1)i.length=1,r?(n.e=-e,i[0]=1):i[0]=n.e=0;else{if(i.length=o--,r)for(;++i[o]>9;)i[o]=0,o--||(++n.e,i.unshift(1));for(o=i.length;!i[--o];)i.pop()}}else if(t<0||t>3||t!==~~t)throw Error("[big.js] Invalid rounding mode");return n}function hn(n,e,t,r){var i,o,a=n.constructor,u=!n.c[0];if(void 0!==t){if(t!==~~t||t<(3==e)||t>1e6)throw Error(3==e?un+"precision":sn);for(t=r-(n=new a(n)).e,n.c.length>++r&&fn(n,t,a.RM),2==e&&(r=n.e+t+1);n.c.length<r;)n.c.push(0)}if(i=n.e,t=(o=n.c.join("")).length,2!=e&&(1==e||3==e&&r<=i||i<=a.NE||i>=a.PE))o=o.charAt(0)+(t>1?"."+o.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)o="0"+o;o="0."+o}else if(i>0)if(++i>t)for(i-=t;i--;)o+="0";else i<t&&(o=o.slice(0,i)+"."+o.slice(i));else t>1&&(o=o.charAt(0)+"."+o.slice(1));return n.s<0&&(!u||4==e)?"-"+o:o}on.abs=function(){var n=new this.constructor(this);return n.s=1,n},on.cmp=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.c),o=n.c,a=r.s,u=n.s,s=r.e,c=n.e;if(!i[0]||!o[0])return i[0]?a:o[0]?-u:0;if(a!=u)return a;if(e=a<0,s!=c)return s>c^e?1:-1;for(u=Math.max(i.length,o.length),a=0;a<u;a++)if((s=a<i.length?i[a]:0)!=(c=a<o.length?o[a]:0))return s>c^e?1:-1;return 0},on.div=function(n){var e=this.constructor,t=new e(this),r=(n=new e(n),t.c),i=n.c,o=t.s==n.s?1:-1,a=e.DP;if(a!==~~a||a<0||a>1e6)throw Error(sn);if(!i[0])throw Error("[big.js] Division by zero");if(!r[0])return new e(0*o);var u,s,c,l,f,h=i.slice(),d=u=i.length,g=r.length,w=r.slice(0,u),p=w.length,m=n,S=m.c=[],M=0,y=a+(m.e=t.e-n.e)+1;for(m.s=o,o=y<0?0:y,h.unshift(0);p++<u;)w.push(0);do{for(c=0;c<10;c++){if(u!=(p=w.length))l=u>p?1:-1;else for(f=-1,l=0;++f<u;)if(i[f]!=w[f]){l=i[f]>w[f]?1:-1;break}if(!(l<0))break;for(s=p==u?i:h;p;){if(w[--p]<s[p]){for(f=p;f&&!w[--f];)w[f]=9;--w[f],w[p]+=10}w[p]-=s[p]}for(;!w[0];)w.shift()}S[M++]=l?c:++c,w[0]&&l?w[p]=r[d]||0:w=[r[d]]}while((d++<g||void 0!==w[0])&&o--);return S[0]||1==M||(S.shift(),m.e--),M>y&&fn(m,a,e.RM,void 0!==w[0]),m},on.eq=function(n){return!this.cmp(n)},on.gt=function(n){return this.cmp(n)>0},on.gte=function(n){return this.cmp(n)>-1},on.lt=function(n){return this.cmp(n)<0},on.lte=function(n){return this.cmp(n)<1},on.minus=on.sub=function(n){var e,t,r,i,o=this.constructor,a=new o(this),u=(n=new o(n),a.s),s=n.s;if(u!=s)return n.s=-s,a.plus(n);var c=a.c.slice(),l=a.e,f=n.c,h=n.e;if(!c[0]||!f[0])return f[0]?(n.s=-s,n):new o(c[0]?a:0);if(u=l-h){for((i=u<0)?(u=-u,r=c):(h=l,r=f),r.reverse(),s=u;s--;)r.push(0);r.reverse()}else for(t=((i=c.length<f.length)?c:f).length,u=s=0;s<t;s++)if(c[s]!=f[s]){i=c[s]<f[s];break}if(i&&(r=c,c=f,f=r,n.s=-n.s),(s=(t=f.length)-(e=c.length))>0)for(;s--;)c[e++]=0;for(s=e;t>u;){if(c[--t]<f[t]){for(e=t;e&&!c[--e];)c[e]=9;--c[e],c[t]+=10}c[t]-=f[t]}for(;0===c[--s];)c.pop();for(;0===c[0];)c.shift(),--h;return c[0]||(n.s=1,c=[h=0]),n.c=c,n.e=h,n},on.mod=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.s),o=n.s;if(!n.c[0])throw Error("[big.js] Division by zero");return r.s=n.s=1,e=1==n.cmp(r),r.s=i,n.s=o,e?new t(r):(i=t.DP,o=t.RM,t.DP=t.RM=0,r=r.div(n),t.DP=i,t.RM=o,this.minus(r.times(n)))},on.plus=on.add=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.s),o=n.s;if(i!=o)return n.s=-o,r.minus(n);var a=r.e,u=r.c,s=n.e,c=n.c;if(!u[0]||!c[0])return c[0]?n:new t(u[0]?r:0*i);if(u=u.slice(),i=a-s){for(i>0?(s=a,e=c):(i=-i,e=u),e.reverse();i--;)e.push(0);e.reverse()}for(u.length-c.length<0&&(e=c,c=u,u=e),i=c.length,o=0;i;u[i]%=10)o=(u[--i]=u[i]+c[i]+o)/10|0;for(o&&(u.unshift(o),++s),i=u.length;0===u[--i];)u.pop();return n.c=u,n.e=s,n},on.pow=function(n){var e=this.constructor,t=new e(this),r=new e(1),i=new e(1),o=n<0;if(n!==~~n||n<-1e6||n>1e6)throw Error(un+"exponent");for(o&&(n=-n);1&n&&(r=r.times(t)),n>>=1;)t=t.times(t);return o?i.div(r):r},on.round=function(n,e){var t=this.constructor;if(void 0===n)n=0;else if(n!==~~n||n<-1e6||n>1e6)throw Error(sn);return fn(new t(this),n,void 0===e?t.RM:e)},on.sqrt=function(){var n,e,t,r=this.constructor,i=new r(this),o=i.s,a=i.e,u=new r(.5);if(!i.c[0])return new r(i);if(o<0)throw Error(an+"No square root");0===(o=Math.sqrt(i+""))||o===1/0?((e=i.c.join("")).length+a&1||(e+="0"),a=((a+1)/2|0)-(a<0||1&a),n=new r(((o=Math.sqrt(e))==1/0?"1e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):n=new r(o),a=n.e+(r.DP+=4);do{t=n,n=u.times(t.plus(i.div(t)))}while(t.c.slice(0,a).join("")!==n.c.slice(0,a).join(""));return fn(n,r.DP-=4,r.RM)},on.times=on.mul=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.c),o=n.c,a=i.length,u=o.length,s=r.e,c=n.e;if(n.s=r.s==n.s?1:-1,!i[0]||!o[0])return new t(0*n.s);for(n.e=s+c,a<u&&(e=i,i=o,o=e,c=a,a=u,u=c),e=new Array(c=a+u);c--;)e[c]=0;for(s=u;s--;){for(u=0,c=a+s;c>s;)u=e[c]+o[s]*i[c-s-1]+u,e[c--]=u%10,u=u/10|0;e[c]=(e[c]+u)%10}for(u?++n.e:e.shift(),s=e.length;!e[--s];)e.pop();return n.c=e,n},on.toExponential=function(n){return hn(this,1,n,n)},on.toFixed=function(n){return hn(this,2,n,this.e+n)},on.toPrecision=function(n){return hn(this,3,n,n-1)},on.toString=function(){return hn(this)},on.valueOf=on.toJSON=function(){return hn(this,4)};var dn=function n(){function e(t){var r=this;if(!(r instanceof e))return void 0===t?n():new e(t);t instanceof e?(r.s=t.s,r.e=t.e,r.c=t.c.slice(),function(n){if((n=fn(n,28,0)).c.length>1&&!n.c[0]){let e=n.c.findIndex(n=>n);n.c=n.c.slice(e),n.e=n.e-e}}(r)):ln(r,t),r.constructor=e}return e.prototype=on,e.DP=28,e.RM=1,e.NE=-29,e.PE=29,e.version="5.2.2",e}(),gn=dn,wn=gn;new gn(0),new gn(1),new gn(-1),new gn("79228162514264337593543950335"),new gn("-79228162514264337593543950335");var pn;function mn(n){return-2147483648===n?n:-n}!function(n){n[n.AllowHexSpecifier=512]="AllowHexSpecifier"}(pn||(pn={}));var Sn=null;try{Sn=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(n){}function Mn(n,e,t){this.low=0|n,this.high=0|e,this.unsigned=!!t}function yn(n){return!0===(n&&n.__isLong__)}Mn.prototype.GetHashCode=function(){let n=this.unsigned?1:0;return n=(n<<5)+n^this.high,n=(n<<5)+n^this.low,n},Mn.prototype.Equals=function(n){return qn(this,n)},Mn.prototype.CompareTo=function(n){return Zn(this,n)},Mn.prototype.toString=function(n){return jn(this,n)},Mn.prototype.toJSON=function(){return jn(this)},Mn.prototype.__isLong__,Object.defineProperty(Mn.prototype,"__isLong__",{value:!0});var In={},Tn={};function Cn(n,e){var t,r,i;return e?(i=0<=(n>>>=0)&&n<256)&&(r=Tn[n])?r:(t=An(n,(0|n)<0?-1:0,!0),i&&(Tn[n]=t),t):(i=-128<=(n|=0)&&n<128)&&(r=In[n])?r:(t=An(n,n<0?-1:0,!1),i&&(In[n]=t),t)}function Wn(n,e){if(isNaN(n))return e?On:Pn;if(e){if(n<0)return On;if(n>=xn)return Ln}else{if(n<=-Dn)return Rn;if(n+1>=Dn)return Bn}return n<0?$n(Wn(-n,e)):An(n%En|0,n/En|0,e)}function An(n,e,t){return new Mn(n,e,t)}var kn=Math.pow;function vn(n,e,t){if(0===n.length)throw Error("empty string");if("NaN"===n||"Infinity"===n||"+Infinity"===n||"-Infinity"===n)return Pn;if("number"==typeof e?(t=e,e=!1):e=!!e,(t=t||10)<2||36<t)throw RangeError("radix");var r=n.indexOf("-");if(r>0)throw Error("interior hyphen");if(0===r)return $n(vn(n.substring(1),e,t));for(var i=Wn(kn(t,8)),o=Pn,a=0;a<n.length;a+=8){var u=Math.min(8,n.length-a),s=parseInt(n.substring(a,a+u),t);if(u<8)o=Qn(ee(o,Wn(kn(t,u))),Wn(s));else o=Qn(o=ee(o,i),Wn(s))}return o.unsigned=e,o}function bn(n,e){return"number"==typeof n?Wn(n,e):"string"==typeof n?vn(n,e):An(n.low,n.high,"boolean"==typeof e?e:n.unsigned)}var En=4294967296,xn=En*En,Dn=xn/2,Hn=Cn(1<<24),Pn=Cn(0),On=Cn(0,!0),Xn=Cn(1),Fn=Cn(1,!0),Gn=Cn(-1),Bn=An(-1,2147483647,!1),Ln=An(-1,-1,!0),Rn=An(0,-2147483648,!1);function Kn(n){return n.unsigned?n.low>>>0:n.low}function Nn(n){return n.unsigned?(n.high>>>0)*En+(n.low>>>0):n.high*En+(n.low>>>0)}function jn(n,e){if((e=e||10)<2||36<e)throw RangeError("radix");if(_n(n))return"0";if(Un(n)){if(qn(n,Rn)){var t=Wn(e),r=te(n,t),i=ne(ee(r,t),n);return jn(r,e)+Kn(i).toString(e)}return"-"+jn($n(n),e)}for(var o=Wn(kn(e,6),n.unsigned),a=n,u="";;){var s=te(a,o),c=(Kn(ne(a,ee(s,o)))>>>0).toString(e);if(_n(a=s))return c+u;for(;c.length<6;)c="0"+c;u=""+c+u}}function _n(n){return 0===n.high&&0===n.low}function Un(n){return!n.unsigned&&n.high<0}function zn(n){return 1==(1&n.low)}function qn(n,e){return yn(e)||(e=bn(e)),(n.unsigned===e.unsigned||n.high>>>31!=1||e.high>>>31!=1)&&(n.high===e.high&&n.low===e.low)}function Vn(n,e){return Zn(n,e)<0}function Jn(n,e){return Zn(n,e)>0}function Yn(n,e){return Zn(n,e)>=0}function Zn(n,e){if(yn(e)||(e=bn(e)),qn(n,e))return 0;var t=Un(n),r=Un(e);return t&&!r?-1:!t&&r?1:n.unsigned?e.high>>>0>n.high>>>0||e.high===n.high&&e.low>>>0>n.low>>>0?-1:1:Un(ne(n,e))?-1:1}function $n(n){return!n.unsigned&&qn(n,Rn)?Rn:Qn(re(n),Xn)}function Qn(n,e){yn(e)||(e=bn(e));var t=n.high>>>16,r=65535&n.high,i=n.low>>>16,o=65535&n.low,a=e.high>>>16,u=65535&e.high,s=e.low>>>16,c=0,l=0,f=0,h=0;return f+=(h+=o+(65535&e.low))>>>16,l+=(f+=i+s)>>>16,c+=(l+=r+u)>>>16,c+=t+a,An((f&=65535)<<16|(h&=65535),(c&=65535)<<16|(l&=65535),n.unsigned)}function ne(n,e){return yn(e)||(e=bn(e)),Qn(n,$n(e))}function ee(n,e){if(_n(n))return n.unsigned?On:Pn;if(yn(e)||(e=bn(e)),Sn)return An(Sn.mul(n.low,n.high,e.low,e.high),Sn.get_high(),n.unsigned);if(_n(e))return n.unsigned?On:Pn;if(qn(n,Rn))return zn(e)?Rn:Pn;if(qn(e,Rn))return zn(n)?Rn:Pn;if(Un(n))return Un(e)?ee($n(n),$n(e)):$n(ee($n(n),e));if(Un(e))return $n(ee(n,$n(e)));if(Vn(n,Hn)&&Vn(e,Hn))return Wn(Nn(n)*Nn(e),n.unsigned);var t=n.high>>>16,r=65535&n.high,i=n.low>>>16,o=65535&n.low,a=e.high>>>16,u=65535&e.high,s=e.low>>>16,c=65535&e.low,l=0,f=0,h=0,d=0;return h+=(d+=o*c)>>>16,f+=(h+=i*c)>>>16,h&=65535,f+=(h+=o*s)>>>16,l+=(f+=r*c)>>>16,f&=65535,l+=(f+=i*s)>>>16,f&=65535,l+=(f+=o*u)>>>16,l+=t*c+r*s+i*u+o*a,An((h&=65535)<<16|(d&=65535),(l&=65535)<<16|(f&=65535),n.unsigned)}function te(n,e){if(yn(e)||(e=bn(e)),_n(e))throw Error("division by zero");var t,r,i;if(Sn)return n.unsigned||-2147483648!==n.high||-1!==e.low||-1!==e.high?An((n.unsigned?Sn.div_u:Sn.div_s)(n.low,n.high,e.low,e.high),Sn.get_high(),n.unsigned):n;if(_n(n))return n.unsigned?On:Pn;if(n.unsigned){if(e.unsigned||(e=function(n){return n.unsigned?n:An(n.low,n.high,!0)}(e)),Jn(e,n))return On;if(Jn(e,ae(n,1)))return Fn;i=On}else{if(qn(n,Rn))return qn(e,Xn)||qn(e,Gn)?Rn:qn(e,Rn)?Xn:qn(t=ie(te(oe(n,1),e),1),Pn)?Un(e)?Xn:Gn:i=Qn(t,te(r=ne(n,ee(e,t)),e));if(qn(e,Rn))return n.unsigned?On:Pn;if(Un(n))return Un(e)?te($n(n),$n(e)):$n(te($n(n),e));if(Un(e))return $n(te(n,$n(e)));i=Pn}for(r=n;Yn(r,e);){t=Math.max(1,Math.floor(Nn(r)/Nn(e)));for(var o=Math.ceil(Math.log(t)/Math.LN2),a=o<=48?1:kn(2,o-48),u=Wn(t),s=ee(u,e);Un(s)||Jn(s,r);)s=ee(u=Wn(t-=a,n.unsigned),e);_n(u)&&(u=Xn),i=Qn(i,u),r=ne(r,s)}return i}function re(n){return An(~n.low,~n.high,n.unsigned)}function ie(n,e){return yn(e)&&(e=Kn(e)),0==(e&=63)?n:e<32?An(n.low<<e,n.high<<e|n.low>>>32-e,n.unsigned):An(0,n.low<<e-32,n.unsigned)}function oe(n,e){return yn(e)&&(e=Kn(e)),0==(e&=63)?n:e<32?An(n.low>>>e|n.high<<32-e,n.high>>e,n.unsigned):An(n.high>>e-32,n.high>=0?0:-1,n.unsigned)}function ae(n,e){if(yn(e)&&(e=Kn(e)),0===(e&=63))return n;var t=n.high;return e<32?An(n.low>>>e|t<<32-e,t>>>e,n.unsigned):An(32===e?t:t>>>e-32,0,n.unsigned)}var ue=Mn;const se=ee,ce=Zn,le=function(n,e,t){return t?function(n,e){return new Mn(n[0]|n[1]<<8|n[2]<<16|n[3]<<24,n[4]|n[5]<<8|n[6]<<16|n[7]<<24,e)}(n,e):function(n,e){return new Mn(n[4]<<24|n[5]<<16|n[6]<<8|n[7],n[0]<<24|n[1]<<16|n[2]<<8|n[3],e)}(n,e)},fe=function(n,e){return e?function(n){var e=n.high,t=n.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]}(n):function(n){var e=n.high,t=n.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]}(n)},he=jn;class de{constructor(n){this.iter=n}MoveNext(){const n=this.iter.next();return this.current=n.value,!n.done}get Current(){return this.current}Reset(){throw new Error("JS iterators cannot be reset")}Dispose(){}}function ge(n){return new de(n[Symbol.iterator]())}function we(n){return{next:()=>n.MoveNext()?{done:!1,value:n.Current}:{done:!0,value:null}}}function pe(n){return Se(()=>{const e=n[Symbol.iterator]();let t={value:null};return be(n=>{let r=!1;for(;!r;)if(null==n){const t=e.next();t.done?r=!0:n=t.value[Symbol.iterator]()}else{const e=n.next();e.done?n=null:(t={value:e.value},r=!0)}return null!=n&&null!=t?[t.value,n]:null},null)})}function me(n,e){return pe(We(n,e))}function Se(n){return{[Symbol.iterator]:()=>n()[Symbol.iterator]()}}function Me(){return be(()=>null,void 0)}function ye(n,e){let t;for(const r=e[Symbol.iterator]();t=r.next(),!t.done;)if(n(t.value))return!0;return!1}function Ie(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))return t.reduce(n,e);{let r;for(let i=0,o=t[Symbol.iterator]();r=o.next(),!r.done;i++)e=n(e,r.value,i);return e}}function Te(n,e){Ie((e,t)=>(n(t),null),null,e)}function Ce(n,e){Ie((e,t,r)=>(n(null!=r?r:0,t),null),null,e)}function We(n,e){return Se(()=>be(e=>{const t=e.next();return t.done?null:[n(t.value),e]},e[Symbol.iterator]()))}function Ae(n,e,t){if(0===e)throw new Error("Step cannot be 0");return Se(()=>be(n=>e>0&&n<=t||e<0&&n>=t?[n,n+e]:null,n))}function ke(n){return[n]}function ve(n,e,t){return Ie((e,r)=>t.Add(e,n(r)),t.GetZero(),e)}function be(n,e){return{[Symbol.iterator]:()=>{let t=e;return{next:()=>{const e=n(t);if(null!=e){const n=nn(e);if(null!=n)return t=n[1],{done:!1,value:n[0]}}return{done:!0,value:void 0}}}}}}function Ee(n){const e=n<0,t=(n=Math.abs(n))%36e5/6e4;return(e?"-":"+")+u(~~(n/36e5),2)+":"+u(t,2)}function xe(n,e){const t=n.toISOString();return"first"===e?t.substring(0,t.indexOf("T")):t.substring(t.indexOf("T")+1,t.length-1)}function De(n,e,t){return e.replace(/(\w)\1*/g,e=>{let r=Number.NaN;switch(e.substring(0,1)){case"y":const i=t?n.getUTCFullYear():n.getFullYear();r=e.length<4?i%100:i;break;case"M":r=(t?n.getUTCMonth():n.getMonth())+1;break;case"d":r=t?n.getUTCDate():n.getDate();break;case"H":r=t?n.getUTCHours():n.getHours();break;case"h":const o=t?n.getUTCHours():n.getHours();r=o>12?o%12:o;break;case"m":r=t?n.getUTCMinutes():n.getMinutes();break;case"s":r=t?n.getUTCSeconds():n.getSeconds();break;case"f":r=t?n.getUTCMilliseconds():n.getMilliseconds()}return Number.isNaN(r)?e:r<10&&e.length>1?"0"+r:""+r})}function He(n,e){var t,r,i;const o=new Date(n.getTime()+(null!=(t=n.offset)?t:0));if("string"!=typeof e)return o.toISOString().replace(/\.\d+/,"").replace(/[A-Z]|\.\d+/g," ")+Ee(null!=(r=n.offset)?r:0);if(1!==e.length)return De(o,e,!0);switch(e){case"D":case"d":return xe(o,"first");case"T":case"t":return xe(o,"second");case"O":case"o":return function(n,e){const t=n.toISOString();return t.substring(0,t.length-1)+Ee(e)}(o,null!=(i=n.offset)?i:0);default:throw new Error("Unrecognized Date print format")}}function Pe(n,e){const t=1===n.kind;if("string"!=typeof e)return t?n.toUTCString():n.toLocaleString();if(1!==e.length)return De(n,e,t);switch(e){case"D":case"d":return t?xe(n,"first"):n.toLocaleDateString();case"T":case"t":return t?xe(n,"second"):n.toLocaleTimeString();case"O":case"o":return function(n,e){if(e)return n.toISOString();{const e=null==n.kind||2===n.kind;return u(n.getFullYear(),4)+"-"+u(n.getMonth()+1,2)+"-"+u(n.getDate(),2)+"T"+u(n.getHours(),2)+":"+u(n.getMinutes(),2)+":"+u(n.getSeconds(),2)+"."+u(n.getMilliseconds(),3)+(e?Ee(-6e4*n.getTimezoneOffset()):"")}}(n,t);default:throw new Error("Unrecognized Date print format")}}const Oe=/(^|[^%])%([0+\- ]*)(\d+)?(?:\.(\d+))?(\w)/,Xe=/\{(\d+)(,-?\d+)?(?:\:([a-zA-Z])(\d{0,2})|\:(.+?))?\}/g;function Fe(n){return"number"==typeof n||n instanceof ue||n instanceof wn}function Ge(n,e){return n instanceof ue?ce(n,e)<0:n instanceof wn?n.cmp(e)<0:n<e}function Be(n,e){return n instanceof ue?se(n,e):n instanceof wn?n.mul(e):n*e}function Le(n,e){return n instanceof ue?String(n)+(0).toFixed(e).substr(1):n.toFixed(e)}function Re(n,e){return n instanceof ue?String(n)+(0).toPrecision(e).substr(1):n.toPrecision(e)}function Ke(n,e){return n instanceof ue?String(n)+(0).toExponential(e).substr(1):n.toExponential(e)}function Ne(n){return n instanceof ue?he(n.unsigned?n:le(fe(n),!0),16):(Number(n)>>>0).toString(16)}function je(n){return{input:n,cont:(e=n,n=>Oe.test(e)?function n(e,t){return(...r)=>{let i=e;for(const n of r)i=Ue(i,n);return Oe.test(i)?n(i,t):t(i.replace(/%%/g,"%"))}}(e,n):n(e))};var e}function _e(n){return n.cont(n=>n)}function Ue(n,e){return n.replace(Oe,(n,t,r,i,o,a)=>{let u="";if(Fe(e))switch("x"!==a.toLowerCase()&&(Ge(e,0)?(e=Be(e,-1),u="-"):r.indexOf(" ")>=0?u=" ":r.indexOf("+")>=0&&(u="+")),o=null==o?null:parseInt(o,10),a){case"f":case"F":e=Le(e,o=null!=o?o:6);break;case"g":case"G":e=null!=o?Re(e,o):Re(e);break;case"e":case"E":e=null!=o?Ke(e,o):Ke(e);break;case"x":e=Ne(e);break;case"X":e=Ne(e).toUpperCase();break;default:e=String(e)}if(i=parseInt(i,10),isNaN(i))e=u+e;else{const n=r.indexOf("0")>=0,t=r.indexOf("-")>=0,o=t||!n?" ":"0";e="0"===o?u+(e=Je(e,i-u.length,o,t)):Je(u+e,i,o,t)}return(t+e).replace(/%/g,"%%")})}function ze(n,...e){return"object"==typeof n&&e.length>0&&(n=e[0],e.shift()),n.replace(Xe,(n,t,r,i,o,a)=>{let u=e[t];if(Fe(u))switch(o=null==o?null:parseInt(o,10),i){case"f":case"F":u=Le(u,o=null!=o?o:2);break;case"g":case"G":u=null!=o?Re(u,o):Re(u);break;case"e":case"E":u=null!=o?Ke(u,o):Ke(u);break;case"p":case"P":o=null!=o?o:2,u=Le(Be(u,100),o)+" %";break;case"d":case"D":u=null!=o?Je(String(u),o,"0"):String(u);break;case"x":case"X":u=null!=o?Je(Ne(u),o,"0"):Ne(u),"X"===i&&(u=u.toUpperCase());break;default:if(a){let n="";u=a.replace(/(0+)(\.0+)?/,(e,t,r)=>(Ge(u,0)&&(u=Be(u,-1),n="-"),u=Le(u,null!=r?r.length-1:0),Je(u,(t||"").length-n.length+(null!=r?r.length:0),"0"))),u=n+u}}else u instanceof Date&&(u=function(n,e){return null!=n.offset?He(n,e):Pe(n,e)}(u,a||i));return r=parseInt((r||" ").substring(1),10),isNaN(r)||(u=Je(String(u),Math.abs(r)," ",r<0)),u})}function qe(n,e){if(n<0)throw new Error("String length must be non-negative");const t=new Array(n);for(let r=0;r<n;r++)t[r]=e(r);return t.join("")}function Ve(n,e){return Array.isArray(e)?e.join(n):Array.from(e).join(n)}function Je(n,e,t,r){t=t||" ",e-=n.length;for(let i=0;i<e;i++)n=r?n+t:t+n;return n}function Ye(n,e,t){if(e+(t||0)>n.length)throw new Error("Invalid startIndex and/or length");return null!=t?n.substr(e,t):n.substr(e)}const Ze=x((function(n,e){const t=new L(null);this.comparer=e,t.contents=this,this.hashMap=new Map([]),this["init@20-1"]=1,Te((function(n){tt(t.contents,n[0],n[1])}),n)}));function $e(n,e){const t=0|n.comparer.GetHashCode(e),r=o(n.hashMap,t,null);return r[0]?[!0,t,r[1].findIndex((function(t){return n.comparer.Equals(e,t[0])}))]:[!1,t,-1]}function Qe(n,e){const t=$e(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return b(n.hashMap,t[1])[t[2]];case 1:return null}}function nt(n){n.hashMap.clear()}function et(n){return 0|ve((function(n){return n.length}),n.hashMap.values(),{GetZero:()=>0,Add:(n,e)=>n+e})}function tt(n,e,t){const r=$e(n,e);switch(r[0]&&r[2]>-1?0:1){case 0:{let n;throw n=_e(je("An item with the same key has already been added. Key: %A"))(e),new Error(n)}case 1:if(r[0]){_t([e,t],b(n.hashMap,r[1]))}else n.hashMap.set(r[1],[[e,t]])}}function rt(n,e){const t=$e(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return b(n.hashMap,t[1]).splice(t[2],1),!0;case 1:return!1}}Ze.prototype[Symbol.iterator]=function(){const n=this;return we(ge(Se((function(){return me((function(n){return We((function(n){return n}),n)}),n.hashMap.values())}))))},Ze.prototype.Add=function(n){tt(this,n[0],n[1])},Ze.prototype.Clear=function(){nt(this)},Ze.prototype.Contains=function(n){const e=Qe(this,n[0]);switch(null!=e&&p(e[1],n[1])?0:1){case 0:return!0;case 1:return!1}},Ze.prototype.CopyTo=function(n,e){Ce((function(t,r){n[e+t]=r}),this)},Object.defineProperty(Ze.prototype,"Count",{get:function(){return 0|et(this)}}),Object.defineProperty(Ze.prototype,"IsReadOnly",{get:function(){return!1}}),Ze.prototype.Remove=function(n){const e=this,t=Qe(e,n[0]);if(null!=t){if(p(t[1],n[1])){rt(e,n[0])}return!0}return!1},Object.defineProperty(Ze.prototype,"size",{get:function(){return 0|et(this)}}),Ze.prototype.clear=function(){nt(this)},Ze.prototype.delete=function(n){return rt(this,n)},Ze.prototype.entries=function(){return We((function(n){return n}),this)},Ze.prototype.get=function(n){return function(n,e){const t=Qe(n,e);if(null!=t){return t[1]}throw new Error("The item was not found in collection")}(this,n)},Ze.prototype.has=function(n){return function(n,e){const t=$e(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return!0;case 1:return!1}}(this,n)},Ze.prototype.keys=function(){return We((function(n){return n[0]}),this)},Ze.prototype.set=function(n,e){return function(n,e,t){const r=$e(n,e);switch(r[0]&&r[2]>-1?0:1){case 0:b(n.hashMap,r[1])[r[2]]=[e,t];break;case 1:if(r[0]){_t([e,t],b(n.hashMap,r[1]))}else n.hashMap.set(r[1],[[e,t]])}}(this,n,e),this},Ze.prototype.values=function(){return We((function(n){return n[1]}),this)};const it=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function ot(n){return function n(e,t){n:for(;;){const r=e,i=t;switch(i.tag){case 1:return r+1|0;case 2:e=n(r+1,i.fields[2]),t=i.fields[3];continue n;default:return 0|r}break}}(0,n)}function at(n,e,t){n:for(;;){const r=n,i=e,o=t;switch(o.tag){case 1:if(0===(0|r.Compare(i,o.fields[0])))return o.fields[1];throw new Error("key not found");case 2:{const a=0|r.Compare(i,o.fields[0]);if(a<0){n=r,e=i,t=o.fields[2];continue n}if(0===a)return o.fields[1];n=r,e=i,t=o.fields[3];continue n}default:throw new Error("key not found")}break}}function ut(n,e,t){n:for(;;){const r=n,i=e,o=t;switch(o.tag){case 1:return 0===r.Compare(i,o.fields[0]);case 2:{const a=0|r.Compare(i,o.fields[0]);if(a<0){n=r,e=i,t=o.fields[2];continue n}if(0===a)return!0;n=r,e=i,t=o.fields[3];continue n}default:return!1}break}}const st=x((function(n,e){this.stack=n,this.started=e}),B);function ct(n){for(;;){const e=n;if(null==e.tail)return new P;if(1===e.head.tag)return e;2!==e.head.tag?n=e.tail:n=new P(e.head.fields[2],new P(new it(1,"MapOne",e.head.fields[0],e.head.fields[1]),new P(e.head.fields[3],e.tail)))}}function lt(n){return new st(ct(new P(n,new P)),!1)}function ft(n){if(n.started){const e=n.stack;if(null==e.tail)return function(){throw new Error("enumeration already finished")}();if(1===e.head.tag)return[e.head.fields[0],e.head.fields[1]];throw new Error("Please report error: Map iterator, unexpected stack for current")}return function(){throw new Error("enumeration not started")}()}const ht=x((function(n){this.s=n,this.i=lt(this.s)}));function dt(n){return function(n){return this instanceof ht?ht.call(this,n):new ht(n)}(n)}function gt(n){return be((function(n){return n.MoveNext()?[n.Current,n]:null}),dt(n))}Object.defineProperty(ht.prototype,"Current",{get:function(){return ft(this.i)}}),ht.prototype.MoveNext=function(){return function(n){if(n.started){const e=n.stack;if(null==e.tail)return!1;if(1===e.head.tag)return n.stack=ct(e.tail),!(null==n.stack.tail);throw new Error("Please report error: Map iterator, unexpected stack for moveNext")}return n.started=!0,!(null==n.stack.tail)}(this.i)},ht.prototype.Reset=function(){this.i=lt(this.s)},ht.prototype.Dispose=function(){};const wt=x((function(n,e){this.comparer=n,this.tree=e}));function pt(n){return n.tree}function mt(n,e){return at(n.comparer,e,n.tree)}function St(n){return ot(n.tree)}function Mt(n,e){return ut(n.comparer,e,n.tree)}wt.prototype.toString=function(){return"map ["+Ve("; ",We((function(n){return _e(je("(%A, %A)"))(n[0])(n[1])}),this))+"]"},wt.prototype.GetHashCode=function(){const n=function(n,e){return(n<<1)+e+631};let e=0;const t=dt(pt(this));for(;t.MoveNext();){const r=t.Current;e=n(e,d(r[0])),e=n(e,d(r[1]))}return 0|Math.abs(e)},wt.prototype.Equals=function(n){return 0===this.CompareTo(n)},wt.prototype[Symbol.iterator]=function(){return we(dt(this.tree))},wt.prototype.CompareTo=function(n){const e=this;let t=0,r=!1;const o=dt(pt(e));try{const a=dt(pt(n));try{for(;!r&&0===t;){const n=[o.MoveNext(),a.MoveNext()];if(n[0])if(n[1]){const n=o.Current,r=a.Current,i=0|e.comparer.Compare(n[0],r[0]);t=0!==i?i:I(n[1],r[1])}else t=1;else n[1]?t=-1:r=!0}return 0|t}finally{i(a)&&a.Dispose()}}finally{i(o)&&o.Dispose()}},Object.defineProperty(wt.prototype,"size",{get:function(){return 0|St(this)}}),wt.prototype.clear=function(){throw new Error("Map cannot be mutated")},wt.prototype.delete=function(n){throw new Error("Map cannot be mutated")},wt.prototype.entries=function(){return gt(pt(this))},wt.prototype.get=function(n){return mt(this,n)},wt.prototype.has=function(n){return Mt(this,n)},wt.prototype.keys=function(){return We((function(n){return n[0]}),gt(pt(this)))},wt.prototype.set=function(n,e){throw new Error("Map cannot be mutated")},wt.prototype.values=function(){return We((function(n){return n[1]}),gt(pt(this)))};const yt=x((function(n,e){const t=new L(null);this.comparer=e,t.contents=this,this.hashMap=new Map([]),this["init@21-2"]=1,Te((function(n){At(t.contents,n)}),n)}));function It(n,e){return this instanceof yt?yt.call(this,n,e):new yt(n,e)}function Tt(n,e){const t=0|n.comparer.GetHashCode(e),r=o(n.hashMap,t,null);return r[0]?[!0,t,r[1].findIndex((function(t){return n.comparer.Equals(e,t)}))]:[!1,t,-1]}function Ct(n){n.hashMap.clear()}function Wt(n){return 0|ve((function(n){return n.length}),n.hashMap.values(),{GetZero:()=>0,Add:(n,e)=>n+e})}function At(n,e){const t=Tt(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return!1;case 1:if(t[0]){_t(e,b(n.hashMap,t[1]));return!0}return n.hashMap.set(t[1],[e]),!0}}function kt(n,e){const t=Tt(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return!0;case 1:return!1}}function vt(n,e){const t=Tt(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return b(n.hashMap,t[1]).splice(t[2],1),!0;case 1:return!1}}yt.prototype[Symbol.iterator]=function(){const n=this;return we(ge(Se((function(){return me((function(n){return We((function(n){return n}),n)}),n.hashMap.values())}))))},yt.prototype.Add=function(n){At(this,n)},yt.prototype.Clear=function(){Ct(this)},yt.prototype.Contains=function(n){return kt(this,n)},yt.prototype.CopyTo=function(n,e){Ce((function(t,r){n[e+t]=r}),this)},Object.defineProperty(yt.prototype,"Count",{get:function(){return 0|Wt(this)}}),Object.defineProperty(yt.prototype,"IsReadOnly",{get:function(){return!1}}),yt.prototype.Remove=function(n){return vt(this,n)},Object.defineProperty(yt.prototype,"size",{get:function(){return 0|Wt(this)}}),yt.prototype.add=function(n){At(this,n);return this},yt.prototype.add_=function(n){return At(this,n)},yt.prototype.clear=function(){Ct(this)},yt.prototype.delete=function(n){return vt(this,n)},yt.prototype.has=function(n){return kt(this,n)},yt.prototype.keys=function(){return We((function(n){return n}),this)},yt.prototype.values=function(){return We((function(n){return n}),this)},yt.prototype.entries=function(){return We((function(n){return[n,n]}),this)};const bt=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function Et(n){return new bt(2,"SetOne",n)}function xt(n,e,t,r){return new bt(1,"SetNode",n,e,t,r)}const Dt=x((function(n,e){this.stack=n,this.started=e}),B);function Ht(n){for(;;){const e=n;if(null==e.tail)return new P;if(2===e.head.tag)return e;1!==e.head.tag?n=e.tail:n=new P(e.head.fields[1],new P(Et(e.head.fields[0]),new P(e.head.fields[2],e.tail)))}}function Pt(n){return new Dt(Ht(new P(n,new P)),!1)}function Ot(n){if(n.started){const e=n.stack;if(null==e.tail)return function(){throw new Error("Enumeration already started")}();if(2===e.head.tag)return e.head.fields[0];throw new Error("Please report error: Set iterator, unexpected stack for current")}return function(){throw new Error("Enumeration not started")}()}const Xt=x((function(n){this.s=n,this.i=Pt(this.s)}));function Ft(n){return function(n){return this instanceof Xt?Xt.call(this,n):new Xt(n)}(n)}function Gt(n,e,t){return 0===e.tag?0===t.tag?0:-1:0===t.tag?1:0|function(n,e,t){n:for(;;){const R=n,K=e,N=t;var r,i,o,a,u,s,c,l,f,h,d,g,w,p,m,S,M,y,I,T,C,W,A,k,v,b,E,x,D,H,O,X,F,G,B,L;switch(null!=K.tail?null!=N.tail?2===N.head.tag?2===K.head.tag?(r=4,a=K.head.fields[0],u=N.head.fields[0],s=K.tail,c=N.tail):1===K.head.tag?0===K.head.fields[1].tag?(r=6,w=K.head.fields[1],p=K.head.fields[0],m=K.head.fields[2],S=N.head.fields[0],M=K.tail,y=N.tail):(r=9,E=K.head.fields[0],x=K.head.fields[1],D=K.head.fields[2],H=K.tail):(r=10,O=N.head.fields[0],X=N.tail):1===N.head.tag?0===N.head.fields[1].tag?2===K.head.tag?(r=5,l=K.head.fields[0],f=N.head.fields[0],h=N.head.fields[2],d=K.tail,g=N.tail):1===K.head.tag?0===K.head.fields[1].tag?(r=7,I=K.head.fields[0],T=K.head.fields[2],C=N.head.fields[0],W=N.head.fields[2],A=K.tail,k=N.tail):(r=9,E=K.head.fields[0],x=K.head.fields[1],D=K.head.fields[2],H=K.tail):(r=11,F=N.head.fields[0],G=N.head.fields[1],B=N.head.fields[2],L=N.tail):2===K.head.tag?(r=8,v=K.head.fields[0],b=K.tail):1===K.head.tag?(r=9,E=K.head.fields[0],x=K.head.fields[1],D=K.head.fields[2],H=K.tail):(r=11,F=N.head.fields[0],G=N.head.fields[1],B=N.head.fields[2],L=N.tail):2===K.head.tag?(r=8,v=K.head.fields[0],b=K.tail):1===K.head.tag?(r=9,E=K.head.fields[0],x=K.head.fields[1],D=K.head.fields[2],H=K.tail):(r=3,i=K.tail,o=N.tail):r=2:r=null!=N.tail?1:0,r){case 0:return 0;case 1:return-1;case 2:return 1;case 3:n=R,e=i,t=o;continue n;case 4:{const r=0|R.Compare(a,u);if(0!==r)return 0|r;n=R,e=s,t=c;continue n}case 5:{const r=0|R.Compare(l,f);if(0!==r)return 0|r;n=R,e=new P(new bt(0,"SetEmpty"),d),t=new P(h,g);continue n}case 6:{const r=0|R.Compare(p,S);if(0!==r)return 0|r;n=R,e=new P(m,M),t=new P(w,y);continue n}case 7:{const r=0|R.Compare(I,C);if(0!==r)return 0|r;n=R,e=new P(T,A),t=new P(W,k);continue n}case 8:n=R,e=new P(new bt(0,"SetEmpty"),new P(Et(v),b)),t=N;continue n;case 9:n=R,e=new P(x,new P(xt(E,new bt(0,"SetEmpty"),D,0),H)),t=N;continue n;case 10:n=R,e=K,t=new P(new bt(0,"SetEmpty"),new P(Et(O),X));continue n;case 11:n=R,e=K,t=new P(G,new P(xt(F,new bt(0,"SetEmpty"),B,0),L));continue n}break}}(n,new P(e,new P),new P(t,new P))}Object.defineProperty(Xt.prototype,"Current",{get:function(){return Ot(this.i)}}),Xt.prototype.MoveNext=function(){return function(n){if(n.started){const e=n.stack;if(null==e.tail)return!1;if(2===e.head.tag)return n.stack=Ht(e.tail),!(null==n.stack.tail);throw new Error("Please report error: Set iterator, unexpected stack for moveNext")}return n.started=!0,!(null==n.stack.tail)}(this.i)},Xt.prototype.Reset=function(){this.i=Pt(this.s)},Xt.prototype.Dispose=function(){};const Bt=x((function(n,e){this.comparer=n,this.tree=e}));function Lt(n){return n.comparer}function Rt(n){return n.tree}function Kt(n,e){return It(n,e)}Bt.prototype.toString=function(){return"set ["+Ve("; ",We((function(n){return String(n)}),this))+"]"},Bt.prototype.GetHashCode=function(){let n=0;const e=Ft(Rt(this));for(;e.MoveNext();){n=((0|n)<<1)+(0|d(e.Current))+631}return 0|Math.abs(n)},Bt.prototype.Equals=function(n){return 0===Gt(Lt(this),Rt(this),Rt(n))},Bt.prototype.CompareTo=function(n){return 0|Gt(Lt(this),Rt(this),Rt(n))},Bt.prototype[Symbol.iterator]=function(){return we(Ft(Rt(this)))};function Nt(n,e,t){if(ArrayBuffer.isView(e)){const r=0|e.length,i=new t(r);for(let t=0;t<=r-1;t++)i[t]=n(e[t]);return i}return e.map((function(e){return n(e)}))}function jt(n,e){var t;const r=Array.isArray(n)?n:Array.from(n);switch(0|r.length){case 0:return new e(0);case 1:return r[0];default:if(t=r[0],ArrayBuffer.isView(t)){let n=0,t=0;for(let n=0;n<=r.length-1;n++){t+=r[n].length}const i=new e(t);for(let e=0;e<=r.length-1;e++){const t=r[e];for(let e=0;e<=t.length-1;e++)i[n]=t[e],n+=1}return i}return r[0].concat(...r.slice(1))}}function _t(n,e){e.push(n)}function Ut(n,e){return e.from(n)}function zt(n,e,t){return function(n,e,t,r){for(;;){const i=n,o=e,a=t,u=r;if(null==u.tail)return a;n=i,e=o+1,t=i(o,a,u.head),r=u.tail}}(n,0,e,t)}function qt(n,e,t){for(;;){const r=n,i=e,o=t;if(null==o.tail)return i;n=r,e=r(i,o.head),t=o.tail}}function Vt(n){return qt((function(n,e){return new P(e,n)}),new P,n)}function Jt(n,e,t){return qt((function(e,t){return n(t,e)}),t,Vt(e))}function Yt(n){return Vt(Ie((function(n,e){return new P(e,n)}),new P,n))}function Zt(n){return qt((function(n,e){return n+1}),0,n)}function $t(n,e){return qt((function(n,e){return new P(e,n)}),e,Vt(n))}function Qt(n,e){return Vt(qt((function(e,t){return new P(n(t),e)}),new P,e))}function nr(n,e){return Vt(zt((function(e,t,r){return new P(n(e,r),t)}),new P,e))}function er(n,e){qt((function(e,t){n(t)}),null,e)}function tr(n,e){zt((function(e,t,r){n(e,r)}),null,e)}function rr(n){let e=new P;for(let t=function(n){if(r(n))return n.length;{let e=0;for(const t of n)e++;return e}}(n)-1;t>=0;t--)e=new P(n[t],e);return e}function ir(n,e){return function(n,e,t){n:for(;;){const r=n,i=e,o=t;if(null!=o.tail){const a=r(i,o.head);if(null==a){n=r,e=i+1,t=o.tail;continue n}return a}return null}}(n,0,e)}function or(n,e){return ir((function(e,t){return n(t)}),e)}function ar(n,e){return ir((function(e,t){return n(e,t)?Q(t):null}),e)}function ur(n,e){return ir((function(e,t){return n(t)?Q(t):null}),e)}function sr(n,e){const t=ar(n,e);if(null!=t){return nn(t)}throw new Error("List did not contain any matching elements")}function cr(n,e){return sr((function(e,t){return n===e}),e)}function lr(n,e){return Vt(qt((function(e,t){return n(t)?new P(t,e):e}),new P,e))}function fr(n,e){if(null!=e.tail)return qt(n,e.head,e.tail);throw new Error("List was empty")}function hr(n,e){return qt((function(e,t){return!!e&&n(t)}),!0,e)}function dr(n,e){for(;;){const t=n,r=e;if(null==r.tail)return!1;if(t(r.head))return!0;n=t,e=r.tail}}function gr(n,e,t){let r;const i=Ut(e,Array);return i.sort((function(e,r){return-1*t.Compare(n(e),n(r))})),r=i,rr(r)}function wr(n,e,t){const r=Kt([],t);return lr((function(e){return a(n(e),r)}),e)}const pr=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const mr=x((function(n,e,t,r){this.ImageFileName=n,this.ImageTransparency=e,this.ImageWidth=t,this.ImageHeight=r}),B);const Sr=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Mr=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const yr=x((function(n,e){this.ImageMetadata=n,this.HostImageRef=e}),B);const Ir=x((function(n,e){this.FontImageMetadata=n,this.FontCharWidth=0|e}),B);const Tr=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Cr=x((function(n,e,t,r,i,o,a){this.FontImage=n,this.MagnifyX=0|e,this.MagnifyY=0|t,this.SrcCharWidth=0|r,this.SrcCharHeight=0|i,this.CharWidth=0|o,this.CharHeight=0|a}),B);const Wr=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Ar=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function kr(n,e,t,r){return new mr(e,n,t,r)}function vr(n,e,t,r){return new Ir(kr(new pr(1,"MagentaColourKeyImage"),n,e,r),t)}const br=rr([vr("MilitaryFontRed.png",296,8,8),vr("MilitaryFontYellow.png",296,8,8),vr("MilitaryFontBlue.png",296,8,8),vr("MilitaryFontBlack.png",296,8,8),vr("MilitaryFontSymbols.png",296,8,8)]),Er=rr([kr(new pr(0,"OpaqueImage"),"CliffsTile.png",89,200),kr(new pr(1,"MagentaColourKeyImage"),"Title.png",297,20),kr(new pr(0,"OpaqueImage"),"Map.png",320,160),kr(new pr(1,"MagentaColourKeyImage"),"AlliedFleetSymbol.png",21,21),kr(new pr(1,"MagentaColourKeyImage"),"EnemyFleetSymbol.png",20,20),kr(new pr(0,"OpaqueImage"),"SecretPassage.png",320,160),kr(new pr(1,"MagentaColourKeyImage"),"Mine.png",6,8),kr(new pr(1,"MagentaColourKeyImage"),"Ship0.png",40,13),kr(new pr(1,"MagentaColourKeyImage"),"Ship1.png",34,18),kr(new pr(1,"MagentaColourKeyImage"),"Ship2.png",31,21),kr(new pr(1,"MagentaColourKeyImage"),"Ship3.png",26,26),kr(new pr(1,"MagentaColourKeyImage"),"Ship4.png",12,36),kr(new pr(1,"MagentaColourKeyImage"),"Torpedo0.png",8,2),kr(new pr(1,"MagentaColourKeyImage"),"Torpedo22degrees.png",8,5),kr(new pr(1,"MagentaColourKeyImage"),"ShipExplode0.png",25,25),kr(new pr(1,"MagentaColourKeyImage"),"ShipExplode1.png",50,37),kr(new pr(1,"MagentaColourKeyImage"),"ShipExplode2.png",50,49),kr(new pr(1,"MagentaColourKeyImage"),"ShipExplode3.png",50,49),kr(new pr(1,"MagentaColourKeyImage"),"Plane0.png",6,2),kr(new pr(1,"MagentaColourKeyImage"),"Plane1.png",18,6),kr(new pr(1,"MagentaColourKeyImage"),"Plane2.png",31,10),kr(new pr(1,"MagentaColourKeyImage"),"Plane3.png",49,19),kr(new pr(1,"MagentaColourKeyImage"),"Plane4.png",72,26),kr(new pr(1,"MagentaColourKeyImage"),"Plane4BankingLeft.png",62,21),kr(new pr(1,"MagentaColourKeyImage"),"Plane4BankingRight.png",62,21),kr(new pr(1,"MagentaColourKeyImage"),"Plane5.png",73,22),kr(new pr(1,"MagentaColourKeyImage"),"Plane5BankingLeft.png",66,20),kr(new pr(1,"MagentaColourKeyImage"),"Plane5BankingRight.png",66,20),kr(new pr(1,"MagentaColourKeyImage"),"Plane6.png",71,27),kr(new pr(1,"MagentaColourKeyImage"),"Plane6BankingLeft.png",69,26),kr(new pr(1,"MagentaColourKeyImage"),"Plane6BankingRight.png",69,26),kr(new pr(1,"MagentaColourKeyImage"),"PlaneExplode0.png",45,23),kr(new pr(1,"MagentaColourKeyImage"),"PlaneExplode1.png",51,26),kr(new pr(1,"MagentaColourKeyImage"),"PlaneExplode2.png",35,19),kr(new pr(1,"MagentaColourKeyImage"),"Splash0.png",12,9),kr(new pr(1,"MagentaColourKeyImage"),"PlaneBomb0.png",2,2),kr(new pr(1,"MagentaColourKeyImage"),"PlaneBomb1.png",4,4),kr(new pr(1,"MagentaColourKeyImage"),"PlaneBomb2.png",6,6),kr(new pr(1,"MagentaColourKeyImage"),"PlaneBomb3.png",10,10),kr(new pr(1,"MagentaColourKeyImage"),"PlaneBomb4.png",12,12),kr(new pr(1,"MagentaColourKeyImage"),"SeaBattleBackground0.png",320,160),kr(new pr(1,"MagentaColourKeyImage"),"SeaBattleBackground1.png",320,160),kr(new pr(1,"MagentaColourKeyImage"),"SeaBattleBackground2.png",320,160),kr(new pr(1,"MagentaColourKeyImage"),"SeaBattleBackground3.png",320,160),kr(new pr(1,"MagentaColourKeyImage"),"EnemyShip0.png",12,15),kr(new pr(1,"MagentaColourKeyImage"),"EnemyShip1.png",32,16),kr(new pr(1,"MagentaColourKeyImage"),"EnemyShip2.png",67,16),kr(new pr(1,"MagentaColourKeyImage"),"EnemyShip3.png",12,15),kr(new pr(1,"MagentaColourKeyImage"),"EnemyShip4.png",34,16),kr(new pr(0,"OpaqueImage"),"TankBattleMissile.png",12,1),kr(new pr(0,"OpaqueImage"),"TileBarricade.png",16,16),kr(new pr(0,"OpaqueImage"),"TileBridge.png",16,16),kr(new pr(0,"OpaqueImage"),"TileMine.png",16,16),kr(new pr(0,"OpaqueImage"),"TileSand.png",16,16),kr(new pr(0,"OpaqueImage"),"TileTower.png",16,16),kr(new pr(0,"OpaqueImage"),"TileWater.png",16,16),kr(new pr(1,"MagentaColourKeyImage"),"EnemyTankGun1.png",24,12),kr(new pr(1,"MagentaColourKeyImage"),"TankFacingLeft0.png",24,12),kr(new pr(1,"MagentaColourKeyImage"),"TankFacingUpLeft0.png",24,14),kr(new pr(1,"MagentaColourKeyImage"),"TankFacingDownLeft0.png",24,14),kr(new pr(1,"MagentaColourKeyImage"),"TankFacingLeft1.png",24,12),kr(new pr(1,"MagentaColourKeyImage"),"TankFacingUpLeft1.png",24,14),kr(new pr(1,"MagentaColourKeyImage"),"TankFacingDownLeft1.png",24,14),kr(new pr(0,"OpaqueImage"),"FinalBossBackground.png",320,160),kr(new pr(1,"MagentaColourKeyImage"),"FinalBoss0.png",207,43),kr(new pr(1,"MagentaColourKeyImage"),"FinalBoss1.png",152,42),kr(new pr(1,"MagentaColourKeyImage"),"FinalBoss2.png",94,42),kr(new pr(1,"MagentaColourKeyImage"),"FinalBoss3.png",94,42),kr(new pr(1,"MagentaColourKeyImage"),"FinalBoss4.png",94,42),kr(new pr(1,"MagentaColourKeyImage"),"FinalBoss5.png",94,42),kr(new pr(1,"MagentaColourKeyImage"),"FinalBossSurrender0.png",16,35),kr(new pr(1,"MagentaColourKeyImage"),"FinalBossSurrender1.png",16,35),kr(new pr(1,"MagentaColourKeyImage"),"FinalBossActiveTarget.png",4,4),kr(new pr(1,"MagentaColourKeyImage"),"FinalBossTarget.png",4,4),kr(new pr(1,"MagentaColourKeyImage"),"ShipGunNozzle.png",16,8),kr(new pr(0,"OpaqueImage"),"ShipGunStem.png",12,1),kr(new pr(1,"MagentaColourKeyImage"),"ShipGunBullet.png",16,8),kr(new pr(0,"OpaqueImage"),"IntermissionBackground.png",320,200),kr(new pr(0,"OpaqueImage"),"VictoryScreen.png",320,200),kr(new pr(1,"MagentaColourKeyImage"),"ColonelReceivingMedal.png",70,130),kr(new pr(1,"MagentaColourKeyImage"),"ColonelSaluting.png",72,130),kr(new pr(1,"MagentaColourKeyImage"),"ColonelStanding.png",50,130),kr(new pr(1,"MagentaColourKeyImage"),"SoldierSaluting.png",54,120),kr(new pr(1,"MagentaColourKeyImage"),"SoldierStanding.png",54,120),kr(new pr(1,"MagentaColourKeyImage"),"Medal.png",7,16),kr(new pr(1,"MagentaColourKeyImage"),"PresidentPresentingMedal.png",66,130),kr(new pr(1,"MagentaColourKeyImage"),"PresidentSaluting.png",62,130),kr(new pr(1,"MagentaColourKeyImage"),"PresidentStanding.png",39,130)]),xr=new P,Dr=x((function(n,e){this.NewPlayerName=n,this.NewPlayerScore=e}),B);const Hr=x((function(n,e,t){this.PlayerName=n,this.PlayerScore=e,this.PlayerScoreString=t}),B);function Pr(n){return n.PlayerScore}function Or(n){let e;var t,r;return t=Pr,r={Compare:S},e=fr((function(n,e){return r.Compare(t(e),t(n))>0?e:n}),n),Pr(e)}function Xr(n,e){if(p(n,new P))return!1;{let i,o;return t=Pr,r={Compare:S},o=fr((function(n,e){return r.Compare(t(e),t(n))>0?n:e}),n),i=Pr(o),e>=i}var t,r}function Fr(n,e){if(Xr(e,n.NewPlayerScore)){let t,r;return r=function(n,e,t){let r;const i=Ut(e,Array);return i.sort((function(e,r){return t.Compare(n(e),n(r))})),r=i,rr(r)}(Pr,new P(new Hr(n.NewPlayerName.trim(),n.NewPlayerScore,n.NewPlayerScore.toString()),e),{Compare:S}),t=function(n){if(null!=n.tail)return n.tail;throw new Error("List was empty")}(r),gr(Pr,t,{Compare:S})}return e}function Gr(n,e){return Qt((function(e){return function(n,e,t){const r=(0|n.length)+(0|e.length)+2|0;return r>t?"":n+" "+qe(t-r|0,(function(n){return"."}))+" "+e}(e.PlayerName,e.PlayerScoreString,n)}),e)}const Br=x((function(n,e){this.Score=n,this.HiScore=e}),B);function Lr(n,e){if(0!==n){const t=e.Score+n;return new Br(t,C(S,t,e.HiScore))}return e}const Rr=x((function(n,e,t,r){this.Name=n,this.SelectorIndex=0|e,this.MaxNameLength=0|t,this.Complete=r}),B);const Kr=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Nr="ABCDEFGHIJKLMNOPQRSTUVWXYZ .X ";function jr(n,e){const t=Nr.length-1|0,r=t-1|0;switch(n.tag){case 1:{const n=0|(e.SelectorIndex===t?0:e.SelectorIndex+1);return new Rr(e.Name,n,e.MaxNameLength,e.Complete)}case 2:{const n=e.Name.length===e.MaxNameLength,t=n?e.Name:e.SelectorIndex===r?0===e.Name.length?e.Name:Ye(e.Name,0,e.Name.length-1):e.Name+Nr[e.SelectorIndex];return new Rr(t,e.SelectorIndex,e.MaxNameLength,n)}default:{const n=0|(0===e.SelectorIndex?t:e.SelectorIndex-1);return new Rr(e.Name,n,e.MaxNameLength,e.Complete)}}}function _r(n,e){const t=0|n.length,r=e-(0|~~(t/2))|0,i=0|(r<0?r+t:r);return Ye(n,i)+Ye(n,0,i)}function Ur(n){return rr(["ENTER YOUR NAME","","",(e=n.Name,t=n.MaxNameLength,r=".",Je(e,t,r,!0)),"",""," V",_r(Nr,n.SelectorIndex)]);var e,t,r}const zr=x((function(){}));function qr(){return this instanceof zr?zr.call(this):new zr}const Vr=x((function(n,e,t,r){qr.call(this),this["Model@"]=n,this["DrawFunc@"]=e,this["FrameFunc@"]=t,this["SoundEffectCommands@"]=r}),zr);function Jr(n,e,t,r){return this instanceof Vr?Vr.call(this,n,e,t,r):new Vr(n,e,t,r)}function Yr(n){return n["Model@"]}function Zr(n){return k(3,n["DrawFunc@"])}function $r(n){return k(4,n["FrameFunc@"])}function Qr(n){return n["SoundEffectCommands@"]}function ni(n){return null==Qr(n).tail?n:Jr(Yr(n),A(3,Zr(n)),A(4,$r(n)),new P)}function ei(n,e,t,r){return ni(n)}Vr.prototype.Draw=function(n,e){Zr(this)(n)(Yr(this))(e)},Vr.prototype.Frame=function(n,e,t){return $r(this)(this)(n)(e)(t)},Vr.prototype.Sounds=function(){return Qr(this)};const ti=W([]),ri=W([]),ii=W([]);const oi=Math.fround(320),ai=(Math.fround(200),new Tr(0,"FontID",0)),ui=new Tr(0,"FontID",1),si=new Tr(0,"FontID",2),ci=new Tr(0,"FontID",3),li=new Tr(0,"FontID",4),fi=new Sr(0,"ImageID",0),hi=new Sr(0,"ImageID",1),di=new Sr(0,"ImageID",2),gi=new Sr(0,"ImageID",3),wi=new Sr(0,"ImageID",4),pi=new Sr(0,"ImageID",5),mi=new Sr(0,"ImageID",6),Si=new Sr(0,"ImageID",7),Mi=new Sr(0,"ImageID",8),yi=new Sr(0,"ImageID",9),Ii=new Sr(0,"ImageID",10),Ti=new Sr(0,"ImageID",11),Ci=new Sr(0,"ImageID",12),Wi=new Sr(0,"ImageID",13),Ai=new Sr(0,"ImageID",14),ki=new Sr(0,"ImageID",15),vi=new Sr(0,"ImageID",16),bi=new Sr(0,"ImageID",17),Ei=new Sr(0,"ImageID",18),xi=new Sr(0,"ImageID",19),Di=new Sr(0,"ImageID",20),Hi=new Sr(0,"ImageID",21),Pi=new Sr(0,"ImageID",22),Oi=new Sr(0,"ImageID",23),Xi=new Sr(0,"ImageID",24),Fi=new Sr(0,"ImageID",25),Gi=new Sr(0,"ImageID",26),Bi=new Sr(0,"ImageID",27),Li=new Sr(0,"ImageID",28),Ri=new Sr(0,"ImageID",29),Ki=new Sr(0,"ImageID",30),Ni=new Sr(0,"ImageID",31),ji=new Sr(0,"ImageID",32),_i=new Sr(0,"ImageID",33),Ui=new Sr(0,"ImageID",34),zi=new Sr(0,"ImageID",35),qi=new Sr(0,"ImageID",36),Vi=new Sr(0,"ImageID",37),Ji=new Sr(0,"ImageID",38),Yi=new Sr(0,"ImageID",39),Zi=new Sr(0,"ImageID",40),$i=new Sr(0,"ImageID",41),Qi=new Sr(0,"ImageID",42),no=new Sr(0,"ImageID",43),eo=new Sr(0,"ImageID",44),to=new Sr(0,"ImageID",45),ro=new Sr(0,"ImageID",46),io=new Sr(0,"ImageID",47),oo=new Sr(0,"ImageID",48),ao=(new Sr(0,"ImageID",49),new Sr(0,"ImageID",50)),uo=new Sr(0,"ImageID",51),so=new Sr(0,"ImageID",52),co=new Sr(0,"ImageID",53),lo=new Sr(0,"ImageID",54),fo=new Sr(0,"ImageID",55),ho=new Sr(0,"ImageID",56),go=new Sr(0,"ImageID",57),wo=new Sr(0,"ImageID",58),po=new Sr(0,"ImageID",59),mo=new Sr(0,"ImageID",60),So=new Sr(0,"ImageID",61),Mo=new Sr(0,"ImageID",62),yo=new Sr(0,"ImageID",63),Io=new Sr(0,"ImageID",64),To=new Sr(0,"ImageID",65),Co=new Sr(0,"ImageID",66),Wo=new Sr(0,"ImageID",67),Ao=new Sr(0,"ImageID",68),ko=new Sr(0,"ImageID",69),vo=new Sr(0,"ImageID",70),bo=new Sr(0,"ImageID",71),Eo=new Sr(0,"ImageID",72),xo=new Sr(0,"ImageID",73),Do=new Sr(0,"ImageID",74),Ho=new Sr(0,"ImageID",75),Po=new Sr(0,"ImageID",76),Oo=new Sr(0,"ImageID",77),Xo=new Sr(0,"ImageID",78),Fo=new Sr(0,"ImageID",79),Go=new Sr(0,"ImageID",80),Bo=new Sr(0,"ImageID",81),Lo=new Sr(0,"ImageID",82),Ro=new Sr(0,"ImageID",83),Ko=new Sr(0,"ImageID",84),No=new Sr(0,"ImageID",85),jo=new Sr(0,"ImageID",86),_o=new Sr(0,"ImageID",87),Uo=Math.fround(16),zo=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const qo=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function Vo(n,e,t,r){return n(new qo(0,"DrawImageWithTopLeftAtInt",e,t,r))}function Jo(n,e,t,r,i,o){return n(new qo(2,"DrawStretchedImageWithTopLeftAt",e,t,r,i,o))}function Yo(n,e,t,r){let i;i=[r.ImageMetadata.ImageWidth,r.ImageMetadata.ImageHeight];const o=e-(0|~~(i[0]/2)),a=t-(0|~~(i[1]/2));return n(new qo(2,"DrawStretchedImageWithTopLeftAt",o,a,r,i[0],i[1]))}function Zo(n,e,t,r,i,o){const a=0|r.length,u=i/a,s=Math.abs(~~(o/u))%a|0;s<a&&Yo(n,e,t,r[s])}function $o(n,e,t,r,i,o){return n(new qo(1,"DrawFilledRectangle",e,t,r,i,o))}function Qo(n,e,t,r,i){const o=~~r*i.SrcCharWidth|0;return n(new qo(3,"DrawSubImageStretchedToTarget",o,0,i.SrcCharWidth,i.SrcCharHeight,e,t,i.CharWidth,i.CharHeight,i.FontImage))}function na(n,e,t,r,i,o,a){!function(n,e,t,r,i,o,a,u){const s=function(n){return n.length*e};let c=0|(1===a.tag?r-~~(s(o)/2):2===a.tag?r-s(o):r);const l=0|(1===u.tag?i-~~(t/2):2===u.tag?i-t:i);Te((function(t){const r=function(e){n(e,c,l)};t>="0"&&t<="9"?r(t.charCodeAt(0)-48):t>="A"&&t<="Z"?r(t.charCodeAt(0)-55):t>="a"&&t<="z"?r(t.charCodeAt(0)-87):"."===t&&r(36),c+=e}),o.split(""))}((function(t,r,i){Qo(n,r,i,t>>>0,e)}),e.CharWidth,e.CharHeight,i,o,a,t,r)}function ea(n,e,t,r,i,o,a){na(n,ri()[e.fields[0]],t,r,i,o,a)}function ta(n,e,t,r,i,o,a,u){return function(n,e,t,r,i,o,a,u){let s=0|o,c=0|a,l=u;for(;l>0;)Qo(n,s,c,i,e),l-=1,s+=t,c+=r;return[s,c]}(n,ri()[e.fields[0]],t,r,i,o,a,u)}function ra(n,e,t,r,i,o,a,u){!function(n,e,t,r,i,o,a,u){if(null==u.tail);else{let s;s=e.CharHeight;const c=0|C(S,s,a),l=(Zt(u)-1)*c+s|0,f=0|(1===r.tag?o-~~(l/2):2===r.tag?o-l:o);tr((function(r,o){const a=f+c*r|0;na(n,e,t,new Ar(0,"TopAlign"),i,a,o)}),u)}}(n,ri()[e.fields[0]],t,r,i,o,a,u)}function ia(n,e){let t;let r;t=~~(e*Math.fround(5))%89-89|0,r=ti()[fi.fields[0]];for(let e=1;e<=5;e++)Vo(n,t,0,r),t+=89}const oa=x((function(n,e,t,r,i){this.Left=n,this.Right=e,this.Up=t,this.Down=r,this.Fire=i}),B);new oa(Z,Z,Z,Z,Z);function aa(n){const e=n(new J(0,"WebBrowserKeyCode",38)),t=n(new J(0,"WebBrowserKeyCode",40)),r=n(new J(0,"WebBrowserKeyCode",37)),i=n(new J(0,"WebBrowserKeyCode",39)),o=n(new J(0,"WebBrowserKeyCode",90));return new oa(r,i,e,t,o)}function ua(n){return 2*n}const sa=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const ca=x((function(n,e,t,r,i){this.Scoreboard=n,this.ScoreAndHiScore=e,this.EnterYourNameModel=t,this.MemoizedText=r,this.WhereToAfterCtor=i}),B);function la(n,e,t){ia(n,t),ra(n,ci,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,100,10,e.MemoizedText)}function fa(n,e,t,r){let i;i=aa(e);const o=Yr(n),a=(u=o.EnterYourNameModel,(s=i).Fire.JustDown?jr(new Kr(2,"SelectLetter"),u):s.Left.JustDown?jr(new Kr(0,"RotateLeft"),u):s.Right.JustDown?jr(new Kr(1,"RotateRight"),u):null);var u,s,c,l,f;if(null!=a){const e=a;if(e.Complete){let n;return c=e,l=o.ScoreAndHiScore.Score,f=o.Scoreboard,n=Fr(new Dr(c.Name,l),f),o.WhereToAfterCtor(n,t)}{const t=new ca(o.Scoreboard,o.ScoreAndHiScore,e,Ur(e),o.WhereToAfterCtor),r=$r(n);return Jr(t,A(3,Zr(n)),A(4,r),new P)}}return ni(n)}function ha(n,e,t,r){if(Xr(e,n.Score)){const r=new Rr("",0,12,!1);return Jr(new ca(e,n,r,Ur(r),t),la,fa,new P)}return t(e,r)}const da=x((function(n,e,t){this.ScoreAndHiScore=n,this.HiScoreText=e,this.WhereAfter=t}),B);function ga(n,e,t){$o(n,0,0,320,200,new zo(0,"SolidColour",0)),ea(n,ui,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,100,"GAME OVER"),ea(n,si,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,125,e.HiScoreText)}function wa(n,e,t,r){const i=Yr(n);let o;return o=aa(e),o.Fire.JustDown?i.WhereAfter(i.ScoreAndHiScore,t):ni(n)}const pa=x((function(n,e,t,r,i,o){this.ScoreAndHiScore=n,this.ScoreText=e,this.HiScoreText=t,this.NextAnimStageTime=r,this.AnimationStage=i,this.WhereToAfterCtor=o}),B);const ma=Math.fround(1),Sa=rr(["----|--x","----|--x","----|P-x","----|PCx","----|-Cx","----|---","----|---"]),Ma=rr(["---P|---","123P|---","123P|---","123P|---","123-|---"]),ya=rr(["---P|---","-23P|---","-23P|---","-23P|---","-23-|---","1---|---","1--P|---","123P|---","123P|---","123P|---","123-|---"]),Ia=rr(["----|---","----|---","----|---","----|---"]),Ta=$t(Sa,$t(Ma,Ia)),Ca=$t(Sa,$t(ya,Ia));function Wa(n,e,t){Vo(n,0,0,ti()[Xo.fields[0]]),null!=e.AnimationStage.tail?function(n,e){const t=function(n,e,t,r){return Yo(n,e,t,ti()[r.fields[0]])},r="x"===e[7],i="C"===e[6],o="P"===e[5],a="P"===e[3],u="3"===e[2],s="2"===e[1],c="1"===e[0],l=Math.fround(100),f=Math.fround(80);t(n,Math.fround(256),l,a?jo:o?No:_o),t(n,Math.fround(192),l,u?Go:i?Fo:Bo),t(n,r?o||i?Math.fround(224):Math.fround(256):Math.fround(192),f,Ko),t(n,Math.fround(128),l,s?Lo:Ro),t(n,Math.fround(64),l,c?Lo:Ro)}(n,e.AnimationStage.head):(ea(n,ci,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,75,"CONGRATULATIONS"),ea(n,ai,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,100,"MISSION COMPLETE"),ea(n,si,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,125,e.ScoreText),ea(n,si,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,150,e.HiScoreText))}function Aa(n,e,t,r){let i;i=aa(e);const o=Yr(n);if(i.Fire.JustDown)return o.WhereToAfterCtor(o.ScoreAndHiScore,t);{const e=null!=o.AnimationStage.tail&&t>o.NextAnimStageTime?[t+ma,o.AnimationStage.tail]:[o.NextAnimStageTime,o.AnimationStage],r=new pa(o.ScoreAndHiScore,o.ScoreText,o.HiScoreText,e[0],e[1],o.WhereToAfterCtor),i=$r(n);return Jr(r,A(3,Zr(n)),A(4,i),new P)}}function ka(n,e,t){return Jr(new pa(n,"FINAL SCORE   "+n.Score.toString(),"HI SCORE   "+n.HiScore.toString(),t+ma,t%Math.fround(4)<Math.fround(1)?Ca:Ta,e),Wa,Aa,new P)}const va=x((function(n,e){this.ptx=n,this.pty=e}),B);const ba=x((function(n,e){this.modx=n,this.mody=e}),B);const Ea=x((function(n,e,t,r){this.Left=n,this.Top=e,this.Right=t,this.Bottom=r}),B);x((function(n,e){this.dimx=n,this.dimy=e}),B);function xa(n,e){return I(n.ptx,e.ptx)<0}function Da(n,e){return I(n.ptx,e.ptx)>0}function Ha(n,e){return I(e.ptx,n.Left)>=0&&I(e.ptx,n.Right)<=0&&I(e.pty,n.Top)>=0&&I(e.pty,n.Bottom)<=0}x((function(n,e,...t){O.call(this,n,e,...t)}),O);function Pa(n,e,t){const r=e(t);let i;return i=ur((function(n){const t=e(n);return p(r,t)}),n),null==i}function Oa(n,e){return hr(n,e)?e:lr(n,e)}const Xa=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function Fa(n,e,t,r,i){const o=(t.ptx-e.ptx)/i,a=(t.pty-e.pty)/i;return function(t){const u=t-r;if(u>=Math.fround(0)){if(u<=i){const t=n(u,i),r=e.ptx+o*t,s=e.pty+a*t;return new Xa(1,"MOMVisibleAtPosition",new va(r,s))}return new Xa(2,"MOMDisappeared")}return new Xa(0,"MOMYetToAppear")}}const Ga=x((function(n,e,t,r){this.PositionGetter=n,this.StartPosition=e,this.FinalPosition=t,this.EndGameTime=r}),B);function Ba(n,e,t){return new Ga(function(n,e,t){const r=e+t;return function(t){return t>=e?t<=r?new Xa(1,"MOMVisibleAtPosition",n):new Xa(2,"MOMDisappeared"):new Xa(0,"MOMYetToAppear")}}(n,e,t),n,n,e+t)}function La(n,e,t,r,i){return new Ga(Fa(n,e,t,r,i),e,t,r+i)}function Ra(n,e){const t=e.PositionGetter(n);switch(t.tag){case 0:return e.StartPosition;case 2:return e.FinalPosition;default:return t.fields[0]}}function Ka(n,e){return n<=e.EndGameTime}const Na=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const ja=x((function(n,e,t,r){this.FlickBookDuration=n,this.FlickBookImages=e,this.VisibilityBeforeStart=t,this.VisibilityAfterEnd=r}),B);const _a=x((function(n,e,t){this.FlickBookType=n,this.FlickBookStartTime=e,this.FlickBookMechanicsObject=t}),B);function Ua(n){return n.FlickBookStartTime}function za(n,e){return Ra(n,e.FlickBookMechanicsObject)}function qa(n,e,t){return Oa((function(t){return r=n,i=e(t),Ka(r,i.FlickBookMechanicsObject);var r,i}),t)}function Va(n,e){return qa(n,(function(n){return n}),e)}function Ja(n,e,t){const r=t-e.FlickBookStartTime,i=0|e.FlickBookType.FlickBookImages.length,o=e.FlickBookMechanicsObject.PositionGetter(t);switch(o.tag){case 1:{const t=e.FlickBookType.FlickBookDuration/i,a=0|Math.abs(~~(r/t));a<i&&Yo(n,o.fields[0].ptx,o.fields[0].pty,e.FlickBookType.FlickBookImages[a]);break}case 2:p(e.FlickBookType.VisibilityAfterEnd,new Na(0,"Visible"))&&i>0&&Yo(n,e.FlickBookMechanicsObject.FinalPosition.ptx,e.FlickBookMechanicsObject.FinalPosition.pty,e.FlickBookType.FlickBookImages[e.FlickBookType.FlickBookImages.length-1]);break;default:p(e.FlickBookType.VisibilityBeforeStart,new Na(0,"Visible"))&&i>0&&Yo(n,e.FlickBookMechanicsObject.StartPosition.ptx,e.FlickBookMechanicsObject.StartPosition.pty,e.FlickBookType.FlickBookImages[0])}}function Ya(n,e,t,r){er((function(t){Ja(n,e(t),r)}),t)}function Za(n,e,t){Ya(n,(function(n){return n}),e,t)}const $a=x((function(n){this.TargetLocation=n}),B);const Qa=x((function(n){this.TargetsOnFinalBoss=n}),B);const nu=rr([[Math.fround(169),Math.fround(50)],[Math.fround(134),Math.fround(71)],[Math.fround(194),Math.fround(90)],[Math.fround(123),Math.fround(111)],[Math.fround(221),Math.fround(68)],[Math.fround(74),Math.fround(108)],[Math.fround(249),Math.fround(116)],[Math.fround(163),Math.fround(83)],[Math.fround(104),Math.fround(70)],[Math.fround(231),Math.fround(96)]]);const eu=x((function(n,e){this.ShellMechanicsObject=n,this.ShellStartTime=e}),B);const tu=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const ru=x((function(n,e,t,r,i,o,a,u,s,c){this.GunType=n,this.GunLeftExtent=e,this.GunRightExtent=t,this.GunStepRatePerSecond=r,this.HighestShellY=i,this.GunRepeatTime=o,this.GunShellDuration=a,this.GunLowestElevation=u,this.GunHighestElevation=s,this.GunElevationStepRate=c}),B);const iu=x((function(n,e,t,r,i){this.GunTraits=n,this.GunCentreX=e,this.GunElevation=t,this.Shells=r,this.LastFireTime=i}),B);function ou(n,e,t,r,i){const o=(a=r,new ru(n,Math.fround(20),Math.fround(300),Math.fround(80),Math.fround(0),Math.fround(.5),Math.fround(.699999988079071),Math.fround(5),Math.fround(80),a));var a;return new iu(o,e,t,new P,i-o.GunRepeatTime)}function au(n){const e=Uo*Math.fround(.6000000238418579);return[n-e,n+e]}function uu(n,e){const t=e.GunElevation/Math.fround(10),r=~~(Math.fround(9.5)+Math.fround(.15199999511241913)*t),i=~~(Math.fround(15.5)+Math.fround(.10400000214576721)*t);return[i,r,n-i,n-(i+r)]}function su(n,e,t,r){const i=function(r){const i=uu(e,t),o=r-(6,6,6),a=r-(8,8,8);Jo(n,o,i[2],ti()[Ho.fields[0]],12,0|~~(i[0]+Math.fround(.5))),Jo(n,a,i[3],ti()[Do.fields[0]],16,0|~~(i[1]+Math.fround(.5)))};if(1===t.GunTraits.GunType.tag){const n=au(t.GunCentreX);i(n[0]),i(n[1])}else i(t.GunCentreX);er((function(e){const i=e.ShellMechanicsObject.PositionGetter(r);if(1===i.tag){const a=Math.fround(1)-(o=t.GunTraits,(r-e.ShellStartTime)/o.GunShellDuration),u=a*Math.fround(12)+Math.fround(4),s=a*Math.fround(5)+Math.fround(1),c=i.fields[0].ptx-u/Math.fround(2),l=i.fields[0].pty-s/Math.fround(2);Jo(n,c,l,ti()[Po.fields[0]],0|~~(u+Math.fround(.5)),0|~~(s+Math.fround(.5)))}var o}),t.Shells)}function cu(n,e,t,r,i){const o=n.Up.Held&&n.Down.Held?i.GunElevation:n.Up.Held?C(S,i.GunTraits.GunLowestElevation,i.GunElevation-i.GunTraits.GunElevationStepRate*t):n.Down.Held?T(S,i.GunTraits.GunHighestElevation,i.GunElevation+i.GunTraits.GunElevationStepRate*t):i.GunElevation,a=n.Left.Held&&n.Right.Held?i.GunCentreX:n.Left.Held?C(S,i.GunTraits.GunLeftExtent,i.GunCentreX-i.GunTraits.GunStepRatePerSecond*t):n.Right.Held?T(S,i.GunTraits.GunRightExtent,i.GunCentreX+i.GunTraits.GunStepRatePerSecond*t):i.GunCentreX;let u;const s=e-i.LastFireTime;if(n.Fire.JustDown&&s>i.GunTraits.GunRepeatTime){const n=function(n){return function(n,e,t,r){const i=uu(e,t),o=new va(n,i[3]),a=new va(n,function(n,e,t){const r=n.GunHighestElevation-t,i=(e-n.HighestShellY)/n.GunHighestElevation;return n.HighestShellY+r*i}(t.GunTraits,i[3],t.GunElevation));return new eu(La((function(n,e){let t;let r,i,o;return t=n/e,o=function(n){let e,t;return t=Math.fround(1)-n,e=t*t,Math.fround(1)-e}(t),i=e*o,r=i,r}),o,a,r,t.GunTraits.GunShellDuration),r)}(n,r,i,e)};if(1===i.GunTraits.GunType.tag){const t=au(i.GunCentreX);u=[new P(n(t[0]),new P(n(t[1]),i.Shells)),e]}else{u=[new P(n(i.GunCentreX),i.Shells),e]}}else u=[i.Shells,i.LastFireTime];return new iu(i.GunTraits,a,o,u[0],u[1])}function lu(n,e){let t;var r,i;return r=function(n){return n.ShellMechanicsObject},i=n,t=Oa((function(n){const e=r(n);return Ka(i,e)}),e.Shells),new iu(e.GunTraits,e.GunCentreX,e.GunElevation,t,e.LastFireTime)}const fu=x((function(n,e){this.AdditionalExplosionsList=n,this.AdditionalScore=e}),B);function hu(n,e,t,r,i,o,a){let u;if(u=lr((function(n){return t(n[0],n[1])}),Yt(function(n,e){let t=!0;const r=[];return me(n=>t?(t=!1,We(e=>(r.push(e),[n,e]),e)):r.map(e=>[n,e]),n)}(n,e))),null==u.tail)return[n,e,new P,0];{let t,s,c,l,f,h;t=Jt((function(n,e){return[new P(n[0],e[0]),new P(n[1],e[1])]}),u,[new P,new P]),s=wr(r,t[0],{Equals:p,GetHashCode:d}),c=wr(i,t[1],{Equals:p,GetHashCode:d}),l=lr((function(n){return Pa(s,r,n)}),n),f=lr((function(n){return Pa(c,i,n)}),e);const g=new fu(new P,0),w=function(n,e,t){const r=n(t);return new fu(new P(r[0],e.AdditionalExplosionsList),e.AdditionalScore+r[1])};let m,S;if(null==o)m=g;else{m=qt(A(2,v(2,w,[o])),g,s)}if(null==a)S=m;else{S=qt(A(2,v(2,w,[a])),m,c)}return h=[S.AdditionalExplosionsList,S.AdditionalScore],[l,f,h[0],h[1]]}}const du=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const gu=x((function(n,e,t,r,i,o){this.BackgroundFont=n,this.BackgroundCharIndex=e,this.ForegroundFont=t,this.ForegroundCharIndex=r,this.SpacingX=i,this.SpacingY=o}),B);const wu=x((function(n,e){this.BarTotal=n,this.BarValue=e}),B);function pu(n,e,t,r,i){const o=T(S,i.BarTotal,i.BarValue),a=ta(n,r.BackgroundFont,r.SpacingX,r.SpacingY,r.BackgroundCharIndex,e,t,o);ta(n,r.ForegroundFont,r.SpacingX,r.SpacingY,r.ForegroundCharIndex,a[0],a[1],i.BarTotal-o)}const mu=new gu(li,4,li,2,8,0),Su=new gu(li,3,li,1,8,0),Mu=new gu(li,5,li,6,8,0),yu=new gu(li,7,li,7,8,0),Iu=x((function(n,e,t,r,i,o,a,u){this.ScoreAndHiScore=n,this.ShipsPending=e,this.ShipsThrough=t,this.Tanks=r,this.Damage=i,this.MaxDamage=o,this.PlaneIntel=a,this.Elevation=u}),B);function Tu(n,e,t){const r=e+4|0,i=r+12|0,o=r+24|0;var a,u,s,c,l,f,h,d,g,w,p,m,S,M,y,I,T,C;if(ea(n,ui,new Wr(0,"LeftAlign"),new Ar(0,"TopAlign"),4,r,"SCORE"),a=n,u=ai,s=new Wr(0,"LeftAlign"),c=new Ar(0,"TopAlign"),l=68,f=r,h=t.ScoreAndHiScore.Score,ea(a,u,s,c,l,f,h.toString()),ea(n,ui,new Wr(0,"LeftAlign"),new Ar(0,"TopAlign"),4,i,"SHIPS"),pu(n,68,i,mu,new wu((d=t).ShipsThrough+d.ShipsPending,d.ShipsThrough)),t.MaxDamage>0&&(ea(n,ui,new Wr(0,"LeftAlign"),new Ar(0,"TopAlign"),4,o,"DAMAGE"),pu(n,68,o,Mu,new wu((g=t).MaxDamage,g.Damage))),ea(n,ui,new Wr(0,"LeftAlign"),new Ar(0,"TopAlign"),160,r,"TANKS"),pu(n,208,r,Su,new wu((w=t).Tanks,w.Tanks)),ea(n,ui,new Wr(0,"LeftAlign"),new Ar(0,"TopAlign"),160,i,"ELEVATION"),p=n,m=si,S=new Wr(0,"LeftAlign"),M=new Ar(0,"TopAlign"),y=256,I=i,T=t.Elevation,ea(p,m,S,M,y,I,_e(je("%.1f"))(T)),null==t.PlaneIntel);else{const e=t.PlaneIntel;ea(n,ui,new Wr(0,"LeftAlign"),new Ar(0,"TopAlign"),160,o,"INTEL"),pu(n,208,o,yu,new wu(C=e,C))}}function Cu(n,e){return $o(n,0,e,320,200-e,new zo(0,"SolidColour",0))}const Wu=Math.fround(3),Au=Math.fround(160),ku=new va(Math.fround(160),Math.fround(20)),vu=Math.fround(4),bu=Math.fround(20),Eu=Math.fround(.75),xu=Math.fround(.5),Du=Math.fround(30),Hu=Math.fround(30);function Pu(n){return Nt((function(n){return ti()[n.fields[0]]}),n,Array)}const Ou=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Xu=x((function(n,e,t,r,i,o,a,u,s,c,l,f){this.FinalBossTargets=n,this.ScoreAndHiScore=e,this.TanksRemaining=t,this.ScreenStartTime=r,this.GunAim=i,this.AlliedState=o,this.Explosions=a,this.BossGunFlickBook=u,this.WhereToGoOnGameOver=s,this.WhereToOnVictory=c,this.WhereToOnTankDestroyed=l,this.MapNumber=0|f}),B);function Fu(n,e){const t=new ja(Eu,Pu([Ai,ki,vi,bi]),new Na(0,"Visible"),new Na(0,"Visible")),r=Ba(n,e,Eu);return new _a(t,e,r)}function Gu(n,e,t,r,i){const o=hu(n,e,(function(n,t){return!!p(t.TargetLocation,function(n){if(null!=n.tail)return n.head;throw new Error("List was empty")}(e).TargetLocation)&&(!Ka(i,n.ShellMechanicsObject)&&(Math.abs(t.TargetLocation.ptx-n.ShellMechanicsObject.FinalPosition.ptx)<Wu&&Math.abs(t.TargetLocation.pty-n.ShellMechanicsObject.FinalPosition.pty)<Wu))}),(function(n){return n.ShellStartTime}),(function(n){return n.TargetLocation.ptx}),(function(n){let e;return e=Ra(i,n.ShellMechanicsObject),[Fu(e,i),2e3]}),null);return[o[0],o[1],$t(o[2],t),Lr(o[3],r)]}function Bu(n,e,t){let r;r=ti()[yo.fields[0]];const i=function(){Vo(n,0,0,r)},o=function(t){su(n,r.ImageMetadata.ImageHeight,e.GunAim,t)};if(1===e.AlliedState.tag){i();const r=t-e.ScreenStartTime;Zo(n,ku.ptx,ku.pty,Pu([vo,bo]),xu,r),Za(n,e.Explosions,t),o(t)}else if(2===e.AlliedState.tag)$o(n,0,0,320,200,new zo(0,"SolidColour",0)),ea(n,ai,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,100,"TANK DESTROYED");else if(3===e.AlliedState.tag);else{i(),function(e,t){for(;;){const r=e,i=t;if(null==i.tail)break;{const o=r?Eo:xo;Yo(n,i.head.TargetLocation.ptx,i.head.TargetLocation.pty,ti()[o.fields[0]]),e=!1,t=i.tail}}}(!0,e.FinalBossTargets.TargetsOnFinalBoss),Ja(n,e.BossGunFlickBook,t),Za(n,e.Explosions,t),o(t)}const a=new Iu(e.ScoreAndHiScore,0,0,e.TanksRemaining,0,0,null,e.GunAim.GunElevation);Cu(n,r.ImageMetadata.ImageHeight),Tu(n,r.ImageMetadata.ImageHeight,a)}function Lu(n,e,t,r,i,o,a,u){return new Xu(t,n,e,u,ou(new tu(0,"SingleBarrelGun"),Au,Hu,Du,u),new Ou(0,"AlliedTankInPlay"),new P,new _a(new ja(bu,Pu([Io,To,Co,Wo,Ao,ko]),new Na(0,"Visible"),new Na(0,"Visible")),u,Ba(ku,u,bu)),i,o,a,r)}function Ru(n,e,t,r){const i=function(n,e,t,r){let i;var o,a;switch(i=aa(e),1===n.AlliedState.tag||2===n.AlliedState.tag?(o=1,a=n.AlliedState.fields[0]):o=3===n.AlliedState.tag?2:0,o){case 0:{const e=t-n.ScreenStartTime;if(null==n.FinalBossTargets.TargetsOnFinalBoss.tail){const e=new Ou(1,"WonScreen",t);return new Xu(n.FinalBossTargets,n.ScoreAndHiScore,n.TanksRemaining,n.ScreenStartTime,n.GunAim,e,n.Explosions,n.BossGunFlickBook,n.WhereToGoOnGameOver,n.WhereToOnVictory,n.WhereToOnTankDestroyed,n.MapNumber)}if(e>bu){const e=new Ou(2,"TankIsShot",t);return new Xu(n.FinalBossTargets,n.ScoreAndHiScore,n.TanksRemaining,n.ScreenStartTime,n.GunAim,e,n.Explosions,n.BossGunFlickBook,n.WhereToGoOnGameOver,n.WhereToOnVictory,n.WhereToOnTankDestroyed,n.MapNumber)}{let e,o;e=Va(t,n.Explosions),o=0|ti()[yo.fields[0]].ImageMetadata.ImageHeight;const a=cu(i,t,r,o,n.GunAim),u=Gu(a.Shells,n.FinalBossTargets.TargetsOnFinalBoss,e,n.ScoreAndHiScore,t);let s;return s=lu(t,new iu(a.GunTraits,a.GunCentreX,a.GunElevation,u[0],a.LastFireTime)),new Xu(new Qa(u[1]),u[3],n.TanksRemaining,n.ScreenStartTime,s,n.AlliedState,u[2],n.BossGunFlickBook,n.WhereToGoOnGameOver,n.WhereToOnVictory,n.WhereToOnTankDestroyed,n.MapNumber)}}case 1:if(t-a>vu){const e=new Ou(3,"FinalBossScreenOver"),t=n.TanksRemaining-1;return new Xu(n.FinalBossTargets,n.ScoreAndHiScore,t,n.ScreenStartTime,n.GunAim,e,n.Explosions,n.BossGunFlickBook,n.WhereToGoOnGameOver,n.WhereToOnVictory,n.WhereToOnTankDestroyed,n.MapNumber)}return n;case 2:return n}}(Yr(n),e,t,r);switch(1===i.AlliedState.tag||2===i.AlliedState.tag?0:3===i.AlliedState.tag?1:0){case 0:{const e=$r(n);return Jr(i,A(3,Zr(n)),A(4,e),new P)}case 1:return null==i.FinalBossTargets.TargetsOnFinalBoss.tail?i.WhereToOnVictory(i.ScoreAndHiScore,t):i.TanksRemaining>0?i.WhereToOnTankDestroyed(i.MapNumber+1,i.TanksRemaining,i.ScoreAndHiScore,i.FinalBossTargets,t):i.WhereToGoOnGameOver(i.ScoreAndHiScore)}}const Ku=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function Nu(n,e){let t;return t=function(n,e){let t=new P,r=new P,i=e;for(;null!=i.tail;)if(null!=i.tail){const e=i.tail,o=n(i.head);switch(o.tag){case 1:r=new P(o.fields[0],r);break;case 2:break;default:t=new P(o.fields[0],t)}i=e}return[t,r]}(n,e),[Vt(t[0]),Vt(t[1])]}const ju=[["T----------X-------------WWWW------WW-WW---","X-T--------X-T-T----------WW-----WWW-WWWW--","X----------X------W-------W->------WWW--WW-","X----------X------WW-T->--W----------------","X------X---X---T--WWW----------------------","->-WWW-X---X-----WWWW--------\x3e-----WW------","----\x3e--X--------WWWW--------------WWW------","--T-T--X------\x3e--------T--XX-----WWW---WWWW","T------X-----------------XXXX-----------WWW"],["WW-------X-----WWWWW-*---X---WWWWWWWWW-X","W--XXXXXXXXXX---W-W-W*->-X----W-WWW-W--X","W----------\x3e-------=======----------T--X","WW---XXXXXXXX----X--**>--X--X----X->X---","==--X--=====---\x3e-X--*-------X-------X--X","WW-X-----X->-----X-----**X>-X----X-----X","==------X>----------***--X-------X--T--X","W-T------X---\x3e----WW*--\x3e-X------XXX----X","W-XXXX---X------XXXX*----X-------X-----X"],["XXX--XX--XXXXXXXXXXXXX----X-WW---T-------WWWW","--X-X--XX--WWW--WWWW------X-W--T---*----WWWW-","---X--------WWWWW---------X-------***----W>W-","-----\x3e--------WWWWW-------X---XXX*****---WWWW","->-----------WWWWWW---X>--XT-----\x3e-------====","-----\x3e------\x3e-W====---X-------XXX*****---WWWW","---X------\x3e-=====WWW--X>----------***---\x3e====","--X-X--XX------WW-----X--------T---*-----WWW-","XXX--XX--XXXXXXXXXXXXXX---WWW----T-----WWWWW-"],["-WWWWW-X--X***--T-----X----WWWWWWWWWWWW--WW","W-WWW--X>-X***---WWT--X----WWWW-WWWWWW-WW--","----T--X--X***>-------X---===-----W--W-----","-X->X-----=-------X---X>----WWW==----------","----X--X--X>--\x3e---X>--X----=========-------","-X-----X-----------X>-------WWW==----------","-X--T--X--X***--T--X------WW>---------W----","XXX----X>-X***-T-T-X-------WWWWWWWWWWWWW---","-X-----X--X***-----X---*---WW****WWW*WW*WWW"]],_u=x((function(n,e){this.etx=0|n,this.ety=0|e}),B);const Uu=x((function(n,e,t){this.TilesHorizontally=0|n,this.TilesArray=e,this.EnemyTanks=t}),B);function zu(n){switch(n){case"*":return so;case"-":return co;case"=":return uo;case">":return co;case"T":return lo;case"W":return fo;case"X":return ao;default:return null}}function qu(n){return e=function(n){let e;return e=zu(n),null!=e},!ye(n=>!e(n),n.split(""));var e}function Vu(n){if(n.length<9)return new tn(1,"Error","Map matrix file has insufficient rows.");if(function(n){if(n.length>=9){return hr((function(e){return n[e].length===n[0].length}),Yt(Ae(0,1,8)))}return!1}(n)){if(function(n){if(n.length>=9){return n.slice(0,9).every(qu)}return!1}(n)){let t;return t=Nt((function(n){return"-----"+n+"-----"}),n.slice(0,9),Array),new tn(0,"Ok",new Uu(t[0].length,(e=t,jt(Se((function(){return We((function(n){let t;return t=We((function(n){let e;return e=zu(n),en(e,co)}),e[n].split("")),r=t,Array.from(r);var r}),Ae(0,1,8))})),Array)),function(n){if(n.length>0){const e=0|n[0].length;return Yt(Se((function(){return me((function(t){const r=n[t];return me((function(n){return">"===r[n]?ke(new _u(n,t)):Me()}),Ae(0,1,e-1))}),Ae(0,1,8))})))}return new P}(t)))}return new tn(1,"Error","The map matrix contains illegal characters.")}return new tn(1,"Error","The map matrix rows must all be the same length.");var e}function Ju(n){let e;return e=Vu(ju[n]),rn((function(e){return _e(je("TankMapDefinitions.[%d]: Error: %s"))(n)(e)}),e)}const Yu=x((function(n,e,t,r){this.TilesHorizontally=0|n,this.TilesVertically=0|e,this.TileWidthPixels=t,this.TileHeightPixels=r}),B);const Zu=x((function(n,e,t,r){this.WindowLeft=n,this.WindowTop=e,this.WindowWidth=t,this.WindowHeight=r}),B);const $u=x((function(n,e){this.OffsetX=n,this.OffsetY=e}),B);function Qu(n,e,t,r){const i=function(n,e){if(e<=0){const t=0|~~(mn(e)/n);return[e+n*t|0,t]}return[e,0]},o=i(n.TileWidthPixels,t.OffsetX),a=i(n.TileHeightPixels,t.OffsetY);if(e.WindowWidth>0&&e.WindowHeight>0){const t=e.WindowLeft+e.WindowWidth|0,i=e.WindowTop+e.WindowHeight|0;let u=e.WindowTop+a[0]|0,s=0|a[1];for(;u<i&&s<n.TilesVertically;){let i=e.WindowLeft+o[0]|0,a=0|o[1];for(;i<t&&a<n.TilesHorizontally;)r(i,u,a,s),i+=n.TileWidthPixels,a+=1;u+=n.TileHeightPixels,s+=1}}}const ns=x((function(n,e,t,r,i){this.BackgroundImage=n,this.Font=e,this.MessageText=t,this.ScreenWidthInt=r,this.ScreenHeightInt=i}),B);function es(n,e,t){Vo(n,0,0,e.BackgroundImage),na(n,e.Font,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),~~(e.ScreenWidthInt/2),~~(e.ScreenHeightInt/2),e.MessageText)}const ts=x((function(n,e,t,r){this.FrozenGameState=n,this.TimeFiddler=e,this.UnfreezeGameTime=t,this.PostFreezeCtor=r}),B);function rs(n,e,t){const r=e.TimeFiddler(t);e.FrozenGameState.Draw(n,r)}function is(n,e,t,r){const i=Yr(n);return t<i.UnfreezeGameTime?ni(n):i.PostFreezeCtor((o=i.FrozenGameState,Jr(null,(function(n,e,t){o.Draw(n,t)}),ei,new P)),t);var o}function os(n){return function(e){return function(e){return n(e)}}}function as(n,e,t,r){return Jr(new ts(r,(function(n){return e}),e+n,t),rs,is,new P)}function us(n,e){const t=(r=ti()[Oo.fields[0]],i=ri()[ui.fields[0]],Jr(new ns(r,i,"GET READY",320,200),es,ei,new P));var r,i;return as(Math.fround(4),e,n,t)}const ss=Math.fround(60),cs=Math.fround(188),ls=(ss+cs)/Math.fround(2),fs=oi-Math.fround(16),hs=Math.fround(12),ds=Math.fround(3),gs=Math.fround(12),ws=Math.fround(1),ps=Math.fround(3),ms=Math.fround(4),Ss=(Math.fround(120),Math.fround(15)),Ms=Math.fround(2.5),ys=Math.fround(.20000000298023224),Is=Math.fround(.75),Ts=Math.fround(7);function Cs(n){return Nt((function(n){return ti()[n.fields[0]]}),n,Array)}function Ws(n,e){return new _a(new ja(Is,Cs([Ai,ki,vi,bi]),new Na(1,"Hidden"),new Na(1,"Hidden")),e,Ba(n,e,Is))}const As=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const ks=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const vs=x((function(n,e){this.etmx=n,this.etmy=e}),B);const bs=x((function(n,e,t,r,i,o,a){this.ScreenStartTime=n,this.TileMatrixTraits=e,this.LevelMap=t,this.GameOverOnTankBattleScreen=r,this.TankCompletedCourseSuccessfully=i,this.TankMapsList=o,this.MapNumber=0|a}),B);const Es=x((function(n,e,t,r,i,o,a,u){this.Constants=n,this.ScoreAndHiScore=e,this.TanksRemaining=t,this.AlliedState=r,this.Decoratives=i,this.AlliedMissiles=o,this.EnemyMissiles=a,this.EnemyTankLocations=u}),B);function xs(){return new ja(Math.fround(3),[ti()[Ci.fields[0]]],new Na(1,"Hidden"),new Na(1,"Hidden"))}function Ds(n,e,t){switch(t.tag){case 2:case 0:return new Ea(n-Math.fround(8),e-Math.fround(6),n+Math.fround(8),e+Math.fround(6));default:return new Ea(n-Math.fround(8),e-Math.fround(4),n+Math.fround(8),e+Math.fround(4))}}function Hs(n,e){let t;return t=0|~~(e*Math.fround(5)),16*mn(n)+320+t|0}function Ps(n,e,t){return(0|mn(Hs(n,e)))+(0|~~(t+Math.fround(.5)))|0}function Os(n,e,t){let r;let i;r=0|Hs(n,t);return i=52,new va(r+e.etmx,52+e.etmy)}function Xs(n,e,t,r){const i=Ds(fs,n,e),o=new Zu(0|~~(i.Left+Math.fround(.5)),0|~~(i.Top+Math.fround(.5)),0|~~(i.Right-i.Left+Math.fround(.5)),0|~~(i.Bottom-i.Top+Math.fround(.5))),a=new $u(Hs(r.LevelMap.TilesHorizontally,t)-o.WindowLeft,0|~~(-(i.Top-(52,52))+Math.fround(.5)));let u=!0;return Qu(r.TileMatrixTraits,o,a,(function(n,e,t,i){const o=r.LevelMap.TilesArray[i*r.LevelMap.TilesHorizontally+t];var a;u=!!u&&(!!p(a=o,co)||p(a,uo))})),!u}function Fs(n){switch(n.tag){case 0:return Cs([wo,So]);case 2:return Cs([po,Mo]);default:return Cs([go,mo])}}function Gs(n,e,t,r){let i;const o=0|Hs(n,e);let a;i=o;a=52,er((function(n){t(n.etmx+i,n.etmy+52)}),r)}function Bs(n,e,t){var r;const i=t-e.Constants.ScreenStartTime;let o;o=ti()[ho.fields[0]];const a=function(){ia(n,i),function(n,e,t){const r=new Zu(0,52,320,144),i=new $u(Hs(e.LevelMap.TilesHorizontally,t),0);Qu(e.TileMatrixTraits,r,i,(function(t,r,i,o){let a;const u=e.LevelMap.TilesArray[o*e.LevelMap.TilesHorizontally+i];a=ti()[u.fields[0]],Vo(n,t,r,a)})),Qu(e.TileMatrixTraits,r,i,(function(t,r,i,o){let a;const u=e.LevelMap.TilesArray[o*e.LevelMap.TilesHorizontally+i];a=ti()[u.fields[0]],Vo(n,t,r,a)})),Qu(e.TileMatrixTraits,r,i,(function(t,r,i,o){let a;const u=e.LevelMap.TilesArray[o*e.LevelMap.TilesHorizontally+i];a=ti()[u.fields[0]],Vo(n,t,r,a)}))}(n,e.Constants,i),Za(n,e.AlliedMissiles,i),Za(n,e.EnemyMissiles,i),Gs(e.Constants.LevelMap.TilesHorizontally,i,(function(e,t){Yo(n,e,t,o)}),e.EnemyTankLocations)},u=function(){Za(n,e.Decoratives,i)},s=Math.fround(0);switch(1===e.AlliedState.tag?1:2===e.AlliedState.tag||3===e.AlliedState.tag?2:0){case 0:{a();const t=i-e.Constants.ScreenStartTime;Zo(n,fs,e.AlliedState.fields[0],Fs(e.AlliedState.fields[1]),ys,t),u();break}case 1:a(),u()}!function(n,e,t,r){const i=e+2|0;let o;o=_e(je("SCORE  %d     TANKS  %d"))(t)(r),ea(n,ci,new Wr(1,"CentreAlign"),new Ar(0,"TopAlign"),160,i,o)}(n,(r=0|~~(s+Math.fround(.5)),r),e.ScoreAndHiScore.Score,e.TanksRemaining)}function Ls(n,e,t,r,i,o,a){const u=function(n,e){const t=0|Zt(n);if(t<1)throw new Error("List of tank battle maps should never be empty");return cr(e%t,n)}(r,t),s=new Yu(u.TilesHorizontally,9,16,16),c=new bs(a,s,u,i,o,r,t);return new Es(c,n,e,new ks(0,"AlliedTankInPlay",ls,new As(1,"TankFacingLeft")),new P,new P,new P,Qt((function(n){return new vs(16*n.etx+8|0,16*n.ety+8|0)}),u.EnemyTanks))}function Rs(n,e,t,r){if(e.Fire.JustDown&&function(n,e,t){let r;var i;if(r=null!=(i=n).tail?i.head.FlickBookStartTime:null,null!=r){return t-r>=e}return!0}(t,Ms,r)){return new P((i=fs-hs,o=n-ds,a=r,new _a(xs(),a,La((function(n,e){return n}),new va(i,o),new va(i-oi,o),a,Ms))),t)}return t;var i,o,a}function Ks(n,e,t,r,i){const o=Ds(fs,r,i),a=ti()[ho.fields[0]].ImageMetadata;let u=!1;return Gs(n,e,(function(n,e){if(u)u=!0;else{let t;const r=n-a.ImageWidth/Math.fround(2),i=e-a.ImageHeight/Math.fround(2);t=new Ea(r,i,r+a.ImageWidth,i+a.ImageHeight),u=function(n,e){return!(I(n.Left,e.Right)>=0||I(n.Right,e.Left)<=0||I(n.Top,e.Bottom)>=0||I(n.Bottom,e.Top)<=0)}(t,o)}}),t),u}function Ns(n,e){let t;return t=Ra(e,n.FlickBookMechanicsObject),Ws(t,e)}function js(n,e,t){return function(n,e){const t=n.ptx+gs,r=n.pty-ws;return new _a(xs(),e,La((function(n,e){return n}),new va(t,r),new va(t+oi,r),e,Ms))}(Os(e,n,t),t)}function _s(n,e,t,r,i,o){switch(n.tag){case 2:case 1:return[n,e];case 0:{const u=function(n,e,t){const r=t*Ss;switch(e.tag){case 2:return T(S,n+r,cs);case 1:return n;default:return C(S,n-r,ss)}}(n.fields[0],n.fields[1],t),s=(a=r).Up.Held&&a.Down.Held?new As(1,"TankFacingLeft"):a.Up.Held?new As(0,"TankFacingUpLeft"):a.Down.Held?new As(2,"TankFacingDownLeft"):new As(1,"TankFacingLeft");if(Xs(u,s,o,i)){const n=new P(Ws(new va(fs,u),o),e);return[new ks(1,"AlliedTankExploding",o),n]}return[new ks(0,"AlliedTankInPlay",u,s),e]}default:return[n,e]}var a}function Us(n,e,t,r,i){switch(n.tag){case 3:case 1:return[e,n,t,r];case 0:{const o=function(n,e,t,r,i){const o=hu(n,new P(e,new P),t,r,(function(n){return 1}),i,null),a=null==o[1].tail?new du(0,"PlayerDestroyed"):new du(1,"PlayerSurvives");return[o[0],a,o[2],o[3]]}(e,n.fields[0],(function(n,e){return function(n,e,t){const r=new va(fs,t);let i;return i=za(n,e),Math.abs(r.ptx-i.ptx)<Ts&&Math.abs(r.pty-i.pty)<Ts}(i,n,e)}),Ua,(function(n){return[Ns(n,i),0]}));let a,u;return a=$t(o[2],t),u=Lr(o[3],r),0===o[1].tag?[o[0],new ks(1,"AlliedTankExploding",i),a,u]:[o[0],n,a,u]}default:return[e,n,t,r]}}x((function(n,e,...t){O.call(this,n,e,...t)}),O);function zs(n,e,t,r){let i,o;switch(i=aa(e),2===n.AlliedState.tag||3===n.AlliedState.tag?0:1){case 0:o=n;break;case 1:{const e=t-n.Constants.ScreenStartTime,a=0|Ps(n.Constants.LevelMap.TilesHorizontally,e,fs);let u,s,c;u=Va(e,n.Decoratives),s=Va(e,n.AlliedMissiles),c=Va(e,n.EnemyMissiles);const l=function(n,e,t){switch(n.tag){case 2:case 0:return[n,e];case 1:return t-n.fields[0]>ms?[new ks(3,"AlliedTankDestroyed"),e-1]:[n,e];default:return[n,e]}}(function(n,e){switch(n.tag){case 2:case 1:return n;case 0:return e<64?new ks(2,"AlliedTankReachedFort"):n;default:return n}}(n.AlliedState,a),n.TanksRemaining,e),f=_s(l[0],u,r,i,n.Constants,e),h=hu(function(n,e,t,r){switch(n.tag){case 2:case 1:return t;case 0:return Rs(n.fields[0],e,t,r);default:return t}}(f[0],i,s,e),n.EnemyTankLocations,(function(t,r){return function(n,e,t,r){const i=Os(n,r,e);let o;return o=za(e,t),Math.abs(i.ptx-o.ptx)<Ts&&Math.abs(i.pty-o.pty)<Ts}(n.Constants.LevelMap.TilesHorizontally,e,t,r)}),Ua,(function(n){return n}),(function(n){return[Ns(n,e),1e3]}),null);let d,g;d=$t(h[2],f[1]),g=Lr(h[3],n.ScoreAndHiScore);const w=Us(f[0],c,d,g,e),p=function(n,e,t,r,i){switch(n.tag){case 2:case 1:return[n,e];case 0:if(Ks(r,i,t,n.fields[0],n.fields[1])){return[new ks(1,"AlliedTankExploding",i),new P(Ws(new va(fs,n.fields[0]),i),e)]}return[n,e];default:return[n,e]}}(w[1],w[2],h[1],n.Constants.LevelMap.TilesHorizontally,e),m=function(n,e,t,r){var i;let o,a,u,s;if(a=Ps(n,r,Math.fround(0)),o=a,s=Ps(n,r,oi),u=s,i=r-ps,r-(null!=t.tail?t.head.FlickBookStartTime:i)>=ps){let i,a;a=Oa((function(n){return n.etmx>=o&&n.etmx<=u}),e);const s=0|Zt(a);if(s>0){i=cr(~~r%s|0,a)}else i=null;if(null!=i){return new P(js(i,n,r),t)}return t}return t}(n.Constants.LevelMap.TilesHorizontally,h[1],w[0],e);o=new Es(n.Constants,w[3],l[1],p[0],p[1],h[0],m,h[1]);break}}return o}const qs=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function Vs(n,e,t,r){const i=zs(Yr(n),e,t,r);switch(function(n){switch(3===n.AlliedState.tag?1:0===n.AlliedState.tag||1===n.AlliedState.tag?2:0){case 0:return new qs(1,"TankCompletedCourseSuccessfully");case 1:return n.TanksRemaining>0?new qs(3,"RestartTankBattle"):new qs(2,"TankBattleGameOver");case 2:return new qs(0,"StayOnTankBattleScreen")}}(i).tag){case 2:return i.Constants.GameOverOnTankBattleScreen(i.ScoreAndHiScore);case 0:{const e=$r(n);return Jr(i,A(3,Zr(n)),A(4,e),new P)}case 3:{const e=Ls(i.ScoreAndHiScore,i.TanksRemaining,i.Constants.MapNumber,i.Constants.TankMapsList,i.Constants.GameOverOnTankBattleScreen,i.Constants.TankCompletedCourseSuccessfully,t);return us((function(t,r){const i=$r(n),o=Zr(n);return Jr(e,A(3,o),A(4,i),new P)}),t)}default:return i.Constants.TankCompletedCourseSuccessfully(i.TanksRemaining,i.ScoreAndHiScore,t)}}const Js=Math.fround(20),Ys=Math.fround(.30000001192092896),Zs=Math.fround(.30000001192092896),$s=new va(Math.fround(97),Math.fround(129)),Qs=Math.fround(2),nc=new Ea(Math.fround(134),Math.fround(35),Math.fround(147),Math.fround(47)),ec=new Ea(Math.fround(86),Math.fround(75),Math.fround(238),Math.fround(139)),tc=new Ea(Math.fround(58),Math.fround(130),Math.fround(68),Math.fround(141));function rc(n,e,t){let r;const i=function(n,e){const t=function(e,t){return e.Held&&t.Held?Math.fround(0):e.Held?-n:t.Held?n:Math.fround(0)};return new ba(t(e.Left,e.Right),t(e.Up,e.Down))}(Ys,e);return r=new va(n.ptx+i.modx,n.pty+i.mody),o=r,dr((function(n){return Ha(n,o)}),t)?r:n;var o}function ic(n,e){var t;const r=Ha(ec,i=e)?i:$s;var i,o,a,u,s,c;if(t=Math.fround(1),Math.abs(r.ptx-n.ptx)<t&&Math.abs(r.pty-n.pty)<t)return n;{let e;return a=Zs,u=n,e=new ba((s=(o=r).ptx-u.ptx)>a?a:s<Math.fround(0)?-a:Math.fround(0),(c=o.pty-u.pty)>a?a:c<Math.fround(0)?-a:Math.fround(0)),new va(n.ptx+e.modx,n.pty+e.mody)}}const oc=new va(Math.fround(135),Math.fround(120)),ac=rr([new Ea(Math.fround(86),Math.fround(75),Math.fround(156),Math.fround(139)),new Ea(Math.fround(68),Math.fround(130),Math.fround(91),Math.fround(141)),tc]),uc=x((function(n,e,t,r){this.ScoreAndHiScore=n,this.ShipsThrough=e,this.Location=t,this.BeachLandingCtor=r}),B);function sc(n,e,t){let r;r=ti()[di.fields[0]],Vo(n,0,0,r),Yo(n,e.Location.ptx,e.Location.pty,ti()[gi.fields[0]]),Cu(n,r.ImageMetadata.ImageHeight);const i=new Iu(e.ScoreAndHiScore,0,e.ShipsThrough,ua(e.ShipsThrough),0,0,null,Math.fround(0));Tu(n,r.ImageMetadata.ImageHeight,i)}function cc(n,e,t,r){let i;i=aa(e);const o=Yr(n),a=rc(o.Location,i,ac);if(Ha(tc,a)){let e;return e=os(o.BeachLandingCtor),as(Qs,t,A(2,e),n)}{const e=new uc(o.ScoreAndHiScore,o.ShipsThrough,a,o.BeachLandingCtor),t=$r(n);return Jr(e,A(3,Zr(n)),A(4,t),new P)}}const lc=Math.fround(3),fc=Math.fround(6),hc=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function dc(n){return n<=Math.fround(45)?n:Math.fround(90)-n}function gc(n){let e,t;e=dc(n);const r=Math.fround(0),i=Math.fround(45),o=Math.fround(1);let a,u;t=e*((Math.fround(0)-o)/(i-r))+o,a=t*t;const s=Math.fround(0),c=Math.fround(1),l=Math.fround(100);return u=a*((Math.fround(148)-l)/(c-s))+l,u+Math.fround(.5)}const wc=x((function(n,e,t,r,i){this.CentreX=n,this.BaseY=e,this.ShipImage=t,this.SinkStartTime=r,this.ElevationToHit=i}),B);function pc(n,e,t){return new wc(n,gc(t),e,null,t)}function mc(){return rr([pc(Math.fround(29),ti()[eo.fields[0]],Math.fround(44)),pc(Math.fround(143),ti()[to.fields[0]],Math.fround(39.5)),pc(Math.fround(198),ti()[ro.fields[0]],Math.fround(36.5)),pc(Math.fround(248),ti()[io.fields[0]],Math.fround(41)),pc(Math.fround(288),ti()[oo.fields[0]],Math.fround(32.5))])}function Sc(n,e){return Oa((function(e){return function(n,e){if(null!=e.SinkStartTime){return n-e.SinkStartTime<=fc}return!0}(n,e)}),e)}function Mc(n,e,t){er((function(e){let r,i;if(null!=e.SinkStartTime){const n=e.SinkStartTime;r=T(S,t-n,fc)/fc*e.ShipImage.ImageMetadata.ImageHeight}else r=Math.fround(0);i=e.ShipImage.ImageMetadata.ImageWidth;const o=e.ShipImage.ImageMetadata.ImageHeight-~~(r+Math.fround(.5))|0,a=e.CentreX-e.ShipImage.ImageMetadata.ImageWidth/Math.fround(2),u=e.BaseY-(e.ShipImage.ImageMetadata.ImageHeight-r);let s;s=o;const c=new qo(3,"DrawSubImageStretchedToTarget",0,0,i,o,a,u,e.ShipImage.ImageMetadata.ImageWidth,s,e.ShipImage);n(c)}),e)}function yc(n){let e,t;let r;e=ti()[Zi.fields[0]],t=e.ImageMetadata.ImageWidth,r=e.ImageMetadata.ImageHeight;const i=new ja(lc,[ti()[$i.fields[0]],ti()[Qi.fields[0]],ti()[Qi.fields[0]],ti()[no.fields[0]],ti()[no.fields[0]]],new Na(1,"Hidden"),new Na(1,"Hidden")),o=Ba(new va(t/Math.fround(2),r/Math.fround(2)),n,lc);return new _a(i,n,o)}function Ic(n){ea(n,ci,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,75,"STAGE COMPLETE")}function Tc(n){ea(n,ci,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,75,"SHIP DESTROYED")}const Cc=x((function(n,e){this.ToDoTime=n,this.ToDoData=e}),B);function Wc(n,e){return new Cc(n,e)}const Ac=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function kc(n,e,t){const r=function(n,e){return n>=e.ToDoTime};if(dr(v(1,r,[n]),t[1])){let o,a;return a=Vt(t[1]),o=qt((function(t,i){if(r(n,i)){const r=e(t[0],i.ToDoData,n);return 1===r.tag?[r.fields[0],$t(r.fields[1],t[1])]:[r.fields[0],t[1]]}return[t[0],new P(i,t[1])]}),[t[0],new P],a),[(i=o)[0],Vt(i[1])]}return[t[0],t[1]];var i}const vc=Math.fround(30),bc=Math.fround(160),Ec=Math.fround(4),xc=(Math.fround(.75),Math.fround(6),Math.fround(.20000000298023224)),Dc=Math.fround(3.5),Hc=Math.fround(.30000001192092896),Pc=Math.fround(155),Oc=Math.fround(140),Xc=Math.fround(4),Fc=Math.fround(10),Gc=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Bc=x((function(n){this.HitShipX=n}),B);const Lc=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Rc=x((function(n,e,t,r,i,o,a,u,s,c,l,f,h,d,g,w){this.ScoreAndHiScore=n,this.ShipsRemaining=e,this.GunAim=t,this.AlliedState=r,this.AlliedCountToSink=0|i,this.EnemyShips=o,this.Decoratives=a,this.SkyExplosion=u,this.PendingIncoming=s,this.PendingDamage=c,this.PendingHits=l,this.PendingMessageTexts=f,this.PendingScoreChanges=h,this.MessageText=d,this.WhereToGoOnGameOver=g,this.WhereToOnCourseCompletion=w}),B);function Kc(n){return Nt((function(n){return ti()[n.fields[0]]}),n,Array)}function Nc(n,e,t){const r=new ja(xc,Kc([Ui]),new Na(1,"Hidden"),new Na(1,"Hidden")),i=Ba(new va(e,t),n,xc);return new _a(r,n,i)}function jc(n,e){return ur((function(n){const t=n.ShipImage.ImageMetadata.ImageWidth/Math.fround(2);return null==n.SinkStartTime&&Math.abs(n.CentreX-e)<t}),n)}function _c(n,e,t,r){const i=n.BaseY-n.ShipImage.ImageMetadata.ImageHeight,o=t?Pc:Oc,a=new ja(Math.fround(.699999988079071),Kc([zi,qi]),new Na(1,"Hidden"),new Na(1,"Hidden")),u=new ja(Math.fround(.699999988079071),Kc([Ji,Yi]),new Na(1,"Hidden"),new Na(1,"Hidden")),s=r+a.FlickBookDuration+Hc,c=s+u.FlickBookDuration,l=c+Dc,f=new _a(a,r,La((function(n,e){let t;let r,i,o;var a;return t=n/e,o=(a=t)*a,i=e*o,r=i,r}),new va(n.CentreX,i),new va(n.CentreX,Math.fround(-10)),r,a.FlickBookDuration)),h=new _a(u,s,La((function(n,e){let t;let r,i,o;var a;return t=n/e,o=(a=t)*a,i=e*o,r=i,r}),new va(n.CentreX,Math.fround(-100)),new va(n.CentreX,o),s,u.FlickBookDuration)),d=t?e:new P(Nc(c,n.CentreX,o),e);return[new P(f,new P(h,d)),c,l]}function Uc(n,e){let t;t=0|ti()[Ui.fields[0]].ImageMetadata.ImageHeight;const r=gc(n.GunElevation)-t/Math.fround(2);return Nc(e,n.GunCentreX,r)}const zc=x((function(n,e,...t){O.call(this,n,e,...t)}),O);function qc(n,e,t,r){var i,o,a,u,s,c,l;if(n.Fire.JustDown){const n=r+e.GunTraits.GunShellDuration*Math.fround(2);let f;if(f=jc(t,e.GunCentreX),null!=f){const t=f,r=function(n,e){const t=~~dc(n.GunElevation)-~~e.ElevationToHit|0;return 0===t?new zc(0,"DirectHit"):t<0?new zc(2,"TooNearBy",mn(t)):new zc(1,"TooFarBy",t)}(e,t),h=2===r.tag?[null,(o=100*Math.abs(r.fields[0])|0,a=_e(je("%dM SHORT")),i=a(o),Wc(n,i)),null]:1===r.tag?[null,(s=100*Math.abs(r.fields[0])|0,c=_e(je("%dM LONG")),u=c(s),Wc(n,u)),null]:[(l=new Bc(t.CentreX),Wc(n,l)),Wc(n,"DIRECT HIT"),Wc(n,2e3)],d=2===r.tag?Uc(e,n):(r.tag,null);return[h[0],h[1],h[2],d]}return[null,null,null,Uc(e,n)]}return[null,null,null,null]}function Vc(n,e,t){let r;r=ti()[Zi.fields[0]];const i=function(t){su(n,r.ImageMetadata.ImageHeight,e.GunAim,t)},o=function(){Vo(n,0,0,r),Za(n,e.SkyExplosion,t),Mc(n,e.EnemyShips,t),Za(n,e.Decoratives,t)};2===e.AlliedState.tag?(o(),i(t),Ic(n)):1===e.AlliedState.tag?(o(),Tc(n)):3===e.AlliedState.tag||(o(),i(t));const a=new Iu(e.ScoreAndHiScore,0,e.ShipsRemaining,ua(e.ShipsRemaining),5-(e.AlliedCountToSink>>>0),5,null,e.GunAim.GunElevation);ea(n,ci,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,15,e.MessageText),Cu(n,r.ImageMetadata.ImageHeight),Tu(n,r.ImageMetadata.ImageHeight,a)}function Jc(n,e,t,r){let i;if(i=aa(e),2===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>Ec){const e=new hc(3,"AirOrSeaBattleScreenOver");return new Rc(n.ScoreAndHiScore,n.ShipsRemaining,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText,n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}return n}if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>Ec){if(n.ShipsRemaining>1){const e=new hc(0,"AlliedShipInPlay"),t=n.ShipsRemaining-1;return new Rc(n.ScoreAndHiScore,t,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText,n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}{const e=new hc(3,"AirOrSeaBattleScreenOver");return new Rc(n.ScoreAndHiScore,0,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText,n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}}return n}if(3===n.AlliedState.tag)return n;if(null==n.EnemyShips.tail){const e=new hc(2,"WonScreen",t);return new Rc(n.ScoreAndHiScore,n.ShipsRemaining,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText,n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}{let e,o,a,u;e=Va(t,n.SkyExplosion),o=Va(t,n.Decoratives),a=Sc(t,n.EnemyShips),u=0|ti()[Zi.fields[0]].ImageMetadata.ImageHeight;const s=cu(i,t,r,u,n.GunAim);let c,l,f,h,d,g;c=kc(t,(function(n,e,t){return function(n,e,t,r,i,o){var a,u,s;if(null!=n.tail){if(null!=n.head.SinkStartTime)return new Ac(1,"PendingDoneWithAdditionalToDos",[n,e,t,r],new P((a=new Lc(0,"IncomingChange",null),Wc(o+Xc,a)),new P));{const t=1===r,i=_c(n.head,e,t,o),a=t?new P((u=new Gc(0,"DamageChange",null),Wc(i[1],u)),new P):new P,c=r-1|0;return new Ac(1,"PendingDoneWithAdditionalToDos",[n,i[0],a,c],new P((s=new Lc(0,"IncomingChange",null),Wc(i[2],s)),new P))}}return new Ac(0,"PendingDone",[n,e,t,r])}(n[0],n[1],n[2],n[3],0,t)}),[[a,o,n.PendingDamage,n.AlliedCountToSink],n.PendingIncoming]),l=kc(t,(function(n,e,t){return new Ac(0,"PendingDone",[new hc(1,"ShipSinking",t),new P(yc(t),new P),5])}),[[n.AlliedState,e,c[0][3]],c[0][2]]),f=kc(t,(function(n,e,t){return new Ac(0,"PendingDone",(r=t,i=e.HitShipX,Qt((function(n){if(n.CentreX===i&&null==n.SinkStartTime){const e=r;return new wc(n.CentreX,n.BaseY,n.ShipImage,e,n.ElevationToHit)}return n}),n)));var r,i}),[c[0][0],n.PendingHits]),h=kc(t,(function(n,e,t){return new Ac(0,"PendingDone",e)}),[n.MessageText,n.PendingMessageTexts]),d=kc(t,(function(n,e,t){return new Ac(0,"PendingDone",Lr(e,n))}),[n.ScoreAndHiScore,n.PendingScoreChanges]),g=lu(t,s);const w=qc(i,g,f[0],t),p=function(n,e){if(null!=n){return new P(nn(n),e)}return e},m=p(w[0],f[1]),S=p(w[1],h[1]),M=p(w[2],d[1]),y=p(w[3],c[0][1]);return new Rc(d[0],n.ShipsRemaining,g,l[0][0],l[0][2],f[0],y,l[0][1],c[1],l[1],m,S,M,h[0],n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}}function Yc(n,e,t,r){const i=Jc(Yr(n),e,t,r);switch(1===i.AlliedState.tag||2===i.AlliedState.tag?0:3===i.AlliedState.tag?1:0){case 0:{const e=$r(n);return Jr(i,A(3,Zr(n)),A(4,e),new P)}case 1:return i.ShipsRemaining>0?i.WhereToOnCourseCompletion(i.ShipsRemaining,i.ScoreAndHiScore,t):i.WhereToGoOnGameOver(i.ScoreAndHiScore)}}function Zc(n,e,t,r,i){var o,a,u;return Jr((o=t,a=r,u=i,new Rc(n,e,ou(new tu(1,"DoubleBarrelGun"),bc,vc,Fc,u),new hc(0,"AlliedShipInPlay"),5,mc(),new P,new P,new P(Wc(u,new Lc(0,"IncomingChange",null)),new P),new P,new P,new P,new P,"",o,a)),Vc,Yc,new P)}const $c=Math.fround(30),Qc=Math.fround(160),nl=Math.fround(6),el=Math.fround(4),tl=Math.fround(.75),rl=Math.fround(6),il=Math.fround(3),ol=Math.fround(5),al=Math.fround(1),ul=Math.fround(150),sl=Math.fround(30);function cl(n){return Nt((function(n){return ti()[n.fields[0]]}),n,Array)}const ll=x((function(n,e){this.PlaneFlickBookInstance=n,this.PlaneHasReleasedBombs=e}),B);const fl=x((function(n,e,t,r,i,o,a,u,s,c,l,f,h,d){this.ScoreAndHiScore=n,this.ShipsRemaining=e,this.Planes=t,this.PlaneBombs=r,this.PlanesRemaining=i,this.GunAim=o,this.AlliedState=a,this.SkyExplosion=u,this.Explosions=s,this.EnemyShips=c,this.Damage=l,this.LastSortieAt=f,this.WhereToGoOnGameOver=h,this.WhereToOnCourseCompletion=d}),B);function hl(n){return n.PlaneFlickBookInstance}function dl(n,e){const t=new ja(tl,cl([Ni,ji,_i]),new Na(1,"Hidden"),new Na(0,"Visible")),r=Ba(n,e,tl);return new _a(t,e,r)}function gl(n,e,t,r,i){const o=hu(n,e,(function(n,e){return function(n,e,t){if(Ka(n,e.ShellMechanicsObject))return!1;{let r,i;return i=hl(t),r=za(n,i),Math.abs(r.ptx-e.ShellMechanicsObject.FinalPosition.ptx)<nl&&Math.abs(r.pty-e.ShellMechanicsObject.FinalPosition.pty)<nl}}(i,n,e)}),(function(n){return n.ShellStartTime}),(function(n){return n.PlaneFlickBookInstance.FlickBookStartTime}),(function(n){let e;return e=Ra(i,n.ShellMechanicsObject),[dl(e,i),2e3]}),null);return[o[0],o[1],$t(o[2],t),Lr(o[3],r)]}function wl(n,e,t){const r=0|ti()[Zi.fields[0]].ImageMetadata.ImageHeight,i=function(t){su(n,r,e.GunAim,t)},o=function(){Vo(n,0,0,ti()[Zi.fields[0]]),Za(n,e.SkyExplosion,t),Mc(n,e.EnemyShips,t),Ya(n,hl,e.Planes,t),Za(n,e.PlaneBombs,t),Za(n,e.Explosions,t)};2===e.AlliedState.tag?(o(),i(t),Ic(n)):1===e.AlliedState.tag?(o(),Tc(n)):3===e.AlliedState.tag||(o(),i(t));const a=new Iu(e.ScoreAndHiScore,e.ShipsRemaining,0,ua(e.ShipsRemaining),e.Damage,5,~~((e.PlanesRemaining+3)/4),e.GunAim.GunElevation);Cu(n,r),Tu(n,r,a)}function pl(n){const e=~~n%4|0;return 0===e?[function(){return new ja(rl,cl([Ei,xi,Di,Hi,Oi,Gi,Ri]),new Na(1,"Hidden"),new Na(0,"Visible"))},Math.fround(-50)]:1===e?[function(){return new ja(rl,cl([Ei,xi,Di,Hi,Xi,Bi,Ki]),new Na(1,"Hidden"),new Na(0,"Visible"))},Math.fround(50)]:[function(){return new ja(rl,cl([Ei,xi,Di,Hi,Pi,Fi,Li]),new Na(1,"Hidden"),new Na(0,"Visible"))},Math.fround(0)]}function ml(n){const e=pl(n),t=~~n%24*10+40,r=t+e[1];return new ll(new _a(e[0](),n,La((function(n,e){let t;let r,i,o;var a;return t=n/e,o=(a=t)*a,i=e*o,r=i,r}),new va(t,Math.fround(90)),new va(r,Math.fround(-14)),n,rl)),!1)}function Sl(n,e){let t;t=za(e,n.PlaneFlickBookInstance);const r=new va(t.ptx,ul);return new _a(new ja(al,cl([zi,qi,Vi,Ji,Yi]),new Na(1,"Hidden"),new Na(0,"Visible")),e,La((function(n,e){let t;let r,i,o;var a;return t=n/e,o=(a=t)*a,i=e*o,r=i,r}),t,r,e,al))}function Ml(n,e,t){return qt((function(e,t){if(t.PlaneHasReleasedBombs)return[e[0],new P(t,e[1])];if(n-t.PlaneFlickBookInstance.FlickBookStartTime>=il){return[new P(Sl(t,n),e[0]),new P(new ll(t.PlaneFlickBookInstance,!0),e[1])]}return[e[0],new P(t,e[1])]}),[e,new P],t)}function yl(n,e,t,r){let i;if(i=aa(e),2===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>el){const e=new hc(3,"AirOrSeaBattleScreenOver");return new fl(n.ScoreAndHiScore,n.ShipsRemaining,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,n.SkyExplosion,n.Explosions,n.EnemyShips,n.Damage,n.LastSortieAt,n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}return n}if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>el){if(n.ShipsRemaining>1){const e=new hc(0,"AlliedShipInPlay"),t=n.ShipsRemaining-1,r=new P;return new fl(n.ScoreAndHiScore,t,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,r,n.Explosions,n.EnemyShips,0,n.LastSortieAt,n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}{const e=new hc(3,"AirOrSeaBattleScreenOver"),t=new P;return new fl(n.ScoreAndHiScore,0,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,t,n.Explosions,n.EnemyShips,n.Damage,n.LastSortieAt,n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}}return n}if(3===n.AlliedState.tag)return n;if(0===n.PlanesRemaining&&null==n.Planes.tail){const e=new hc(2,"WonScreen",t);return new fl(n.ScoreAndHiScore,n.ShipsRemaining,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,n.SkyExplosion,n.Explosions,n.EnemyShips,n.Damage,n.LastSortieAt,n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}{let e;let c,l,f;e=0|ti()[Zi.fields[0]].ImageMetadata.ImageHeight,c=Va(t,n.Explosions),l=Va(t,n.SkyExplosion),f=qa(t,hl,n.Planes);const h=0|Zt(n.PlaneBombs);let d;d=Va(t,n.PlaneBombs);const g=0|Zt(d),w=n.Damage+(h-g>>>0),p=cu(i,t,r,e,n.GunAim),m=Ml(t,d,f),S=(o=t,a=n.PlanesRemaining,u=n.LastSortieAt,s=m[1],a>0&&o>u+ol&&Zt(s)<3?[a-1,o,new P(ml(o),s)]:[a,u,s]),M=w>=5?[new hc(1,"ShipSinking",t),new P(yc(t),new P)]:[n.AlliedState,l],y=gl(p.Shells,S[2],c,n.ScoreAndHiScore,t);let I;return I=lu(t,new iu(p.GunTraits,p.GunCentreX,p.GunElevation,y[0],p.LastFireTime)),new fl(y[3],n.ShipsRemaining,y[1],m[0],S[0],I,M[0],M[1],y[2],n.EnemyShips,w,S[1],n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}var o,a,u,s}function Il(n,e,t,r){const i=yl(Yr(n),e,t,r);switch(1===i.AlliedState.tag||2===i.AlliedState.tag?0:3===i.AlliedState.tag?1:0){case 0:{const e=$r(n);return Jr(i,A(3,Zr(n)),A(4,e),new P)}case 1:return i.ShipsRemaining>0?i.WhereToOnCourseCompletion(i.ShipsRemaining,i.ScoreAndHiScore,t):i.WhereToGoOnGameOver(i.ScoreAndHiScore)}}function Tl(n,e,t,r,i,o){return Jr(function(n,e,t,r,i,o){let a;a=1===n.tag?20:40;const u=ou(new tu(1,"DoubleBarrelGun"),Qc,$c,sl,o),s=new hc(0,"AlliedShipInPlay"),c=new P,l=new P,f=mc();return new fl(e,t,new P,new P,a,u,s,l,c,f,0,Math.fround(0),r,i)}(n,e,t,r,i,o),wl,Il,new P)}const Cl=new va(Math.fround(124),Math.fround(75)),Wl=new P(new Ea(Math.fround(86),Math.fround(75),Math.fround(276),Math.fround(139)),new P),Al=x((function(n,e,t,r,i){this.ScoreAndHiScore=n,this.ShipsThrough=e,this.AlliedFleetCentre=t,this.EnemyFleetCentre=r,this.BattleCtor=i}),B);function kl(n,e,t){let r;r=ti()[di.fields[0]],Vo(n,0,0,r),Yo(n,e.AlliedFleetCentre.ptx,e.AlliedFleetCentre.pty,ti()[gi.fields[0]]),Yo(n,e.EnemyFleetCentre.ptx,e.EnemyFleetCentre.pty,ti()[wi.fields[0]]),Cu(n,r.ImageMetadata.ImageHeight);const i=new Iu(e.ScoreAndHiScore,0,e.ShipsThrough,ua(e.ShipsThrough),0,0,null,Math.fround(0));Tu(n,r.ImageMetadata.ImageHeight,i)}function vl(n,e,t,r){let i;i=aa(e);const o=Yr(n),a=rc(o.AlliedFleetCentre,i,Wl),u=ic(o.EnemyFleetCentre,a);if(Math.abs(u.ptx-a.ptx)<Js&&Math.abs(u.pty-a.pty)<Js){let e;return e=os(o.BattleCtor),as(Qs,t,A(2,e),n)}{const e=new Al(o.ScoreAndHiScore,o.ShipsThrough,a,u,o.BattleCtor),t=$r(n);return Jr(e,A(3,Zr(n)),A(4,t),new P)}}const bl=Math.fround(4),El=Math.fround(4),xl=Math.fround(10),Dl=Math.fround(3),Hl=Math.fround(.75);function Pl(){return new ja(Hl,Nt((function(n){return ti()[n.fields[0]]}),[Ai,ki,vi,bi],Array),new Na(1,"Hidden"),new Na(1,"Hidden"))}const Ol=x((function(n,e,t){this.ShipsStillToNavigate=n,this.ShipsSuccess=e,this.ScoreAndHiScore=t}),B);const Xl=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Fl=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Gl=x((function(n,e,t){this.ShipRotation=n,this.ShipSpeed=e,this.ShipCentre=t}),B);const Bl=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Ll=x((function(n){this.MineLocation=n}),B);const Rl=x((function(n,e,t){this.TorpedoLaunchDetail=n,this.TorpedoPositionGetter=e,this.TorpedoIsHorizontal=t}),B);const Kl=x((function(n,e,t,r,i,o,a){this.FleetStats=n,this.LiveTorpedos=e,this.Mines=t,this.Animations=r,this.Ship=i,this.WhereToGoOnGameOver=o,this.WhereToOnCourseCompletion=a}),B);function Nl(n,e){return e.Left.JustDown?function(n){switch(n.tag){case 1:return new Xl(0,"FacingLeft");case 2:return new Xl(1,"Facing1");case 3:return new Xl(2,"Facing2");case 4:return new Xl(3,"Facing3");default:return new Xl(0,"FacingLeft")}}(n):e.Right.JustDown?function(n){switch(n.tag){case 1:return new Xl(2,"Facing2");case 2:return new Xl(3,"Facing3");case 3:case 4:return new Xl(4,"FacingUp");default:return new Xl(1,"Facing1")}}(n):n}function jl(n,e){return e.Up.JustDown?function(n){switch(n.tag){case 1:return new Fl(2,"ShipMedium");case 2:case 3:return new Fl(3,"ShipFast");default:return new Fl(1,"ShipSlow")}}(n):e.Down.JustDown?function(n){switch(n.tag){case 1:return new Fl(0,"ShipStationary");case 2:return new Fl(1,"ShipSlow");case 3:return new Fl(2,"ShipMedium");default:return new Fl(0,"ShipStationary")}}(n):n}function _l(n){switch(n.tag){case 1:return Math.fround(.9229999780654907);case 2:return Math.fround(.7070000171661377);case 3:return Math.fround(.382999986410141);case 4:return Math.fround(0);default:return Math.fround(1)}}function Ul(n){switch(n.tag){case 1:return Math.fround(.382999986410141);case 2:return Math.fround(.7070000171661377);case 3:return Math.fround(.9229999780654907);case 4:return Math.fround(1);default:return Math.fround(0)}}function zl(n,e,t){let r;return r=function(n){switch(n.tag){case 1:return Math.fround(.20000000298023224);case 2:return Math.fround(.4000000059604645);case 3:return Math.fround(.6000000238418579);default:return Math.fround(0)}}(t),new va(n.ptx+_l(e)*-r,n.pty-Ul(e)*r)}const ql=rr([[.2,.352],[.404,.338],[.556,.196],[.294,.606],[.7,.336],[.264,.808],[.564,.688],[.812,.512],[.908,.662],[.87,.832]]);function Vl(){return Qt((function(n){return function(n,e){var t,r;let i,o;return o=ti()[pi.fields[0]],i=[(t=o.ImageMetadata.ImageWidth,t),(r=o.ImageMetadata.ImageHeight,r)],new Ll(new va(n*i[0],e*i[1]))}(n[0],n[1])}),ql)}const Jl=rr([[[.086,.214],[.318,.082],Math.fround(5),Math.fround(1)],[[.086,.214],[.616,.214],Math.fround(4.099999904632568),Math.fround(2.5)],[[.132,.39],[.454,.126],Math.fround(6.199999809265137),Math.fround(2)],[[.132,.39],[.826,.39],Math.fround(5.300000190734863),Math.fround(3)],[[.17,.592],[.776,.312],Math.fround(7),Math.fround(3.5)],[[.17,.592],[.958,.592],Math.fround(7.099999904632568),Math.fround(2)],[[.206,.79],[.846,.41],Math.fround(7.199999809265137),Math.fround(3.5)],[[.206,.79],[.984,.79],Math.fround(8.300000190734863),Math.fround(1)],[[.382,.102],[.138,.336],Math.fround(6),Math.fround(1)],[[.698,.204],[.078,.204],Math.fround(6.400000095367432),Math.fround(2.5)],[[.698,.204],[.152,.49],Math.fround(6.5),Math.fround(2.5)],[[.884,.454],[.13,.454],Math.fround(7.599999904632568),Math.fround(1.5)],[[.962,.608],[.26,.914],Math.fround(7.699999809265137),Math.fround(3)],[[.962,.608],[.178,.608],Math.fround(7.800000190734863),Math.fround(1)]]);function Yl(n,e,t,r,i){var o,a;let u,s;s=ti()[pi.fields[0]],u=[(o=s.ImageMetadata.ImageWidth,o),(a=s.ImageMetadata.ImageHeight,a)];const c=n[0]*u[0],l=e[0]*u[0],f=n[1]*u[1],h=e[1]*u[1],d=i+r;return new Rl([n,e,t,r],Fa((function(n,e){return n}),new va(c,f),new va(l,h),d,t),f===h)}function Zl(n,e){return Yl(n.TorpedoLaunchDetail[0],n.TorpedoLaunchDetail[1],n.TorpedoLaunchDetail[2],n.TorpedoLaunchDetail[3],e)}function $l(){var n,e;let t,r;return r=ti()[pi.fields[0]],t=[(n=r.ImageMetadata.ImageWidth,n),(e=r.ImageMetadata.ImageHeight,e)],new Gl(new Xl(0,"FacingLeft"),new Fl(0,"ShipStationary"),new va(Math.fround(.8859999775886536)*t[0],Math.fround(.9380000233650208)*t[1]))}function Ql(n,e,t,r){const i=Math.fround(10),o=_l(e),a=Ul(e),u=function(n,e){return new va(n.ptx+o*e,n.pty+a*e)},s=t(r,u(n,i*Math.fround(1))),c=t(s,n);return t(c,u(n,i*Math.fround(-1)))}function nf(n,e,t){return Ql(n.ShipCentre,n.ShipRotation,(function(n,r){return!!n||Math.abs(e.ptx-r.ptx)<t&&Math.abs(e.pty-r.pty)<t}),!1)}function ef(n,e){return new _a(Pl(),e,Ba(n,e,Hl))}function tf(n,e,t,r){switch(t.tag){case 1:case 3:return[e,t];case 0:{let i;return i=qt((function(n,e){return i=nf(t.fields[0],e.MineLocation,El)?e.MineLocation:null,o=n[1],a=n[0],u=r,null==i?[a,o]:[new P(ef(i,u),a),new Bl(2,"ShipExploding",u)];var i,o,a,u}),[e,t],n),[i[0],i[1]]}default:return[e,t]}}const rf=[Math.fround(0),rr([[Math.fround(.02199999988079071),Math.fround(0)],[Math.fround(.13199999928474426),Math.fround(.3799999952316284)],[Math.fround(.22200000286102295),Math.fround(.8899999856948853)],[Math.fround(.3199999928474426),Math.fround(1)]])],of=[Math.fround(1),rr([[Math.fround(.23999999463558197),Math.fround(0)],[Math.fround(.335999995470047),Math.fround(.11599999666213989)],[Math.fround(.6959999799728394),Math.fround(.20000000298023224)],[Math.fround(1),Math.fround(.7260000109672546)],[Math.fround(1),Math.fround(1)]])];function af(n,e,t){var r,i;let o,a;a=ti()[pi.fields[0]],o=[(r=a.ImageMetadata.ImageWidth,r),(i=a.ImageMetadata.ImageHeight,i)];const u=t/o[1];let s,c;return c=or((function(n){return u<n[0][1]||u>n[1][1]?null:(e=n[0][1],t=n[0][0],r=n[1][1],i=n[1][0],t+(i-t)/(r-e)*(u-e));var e,t,r,i}),function(n){const e=function(n,e,t){for(;;){const r=n,i=e,o=t;if(null==r.tail)return rr(i);{let a=i;_t([o,r.head],a),n=r.tail,e=i,t=r.head}}};var t,r,i,o;switch(null!=n.tail&&null!=n.tail.tail?(t=1,r=n.head,i=n.tail.head,o=n.tail.tail):t=0,t){case 0:return new P;case 1:{const n=[];return _t([r,i],n),v(2,e,[o])(n)(i)}}}(e)),s=en(c,n),new va(s*o[0],t)}function uf(n,e,t,r){return Ql(n.ShipCentre,n.ShipRotation,(function(n,i){if(null==n){const n=af(t,r,i.pty);return e(i,n)?i:null}return n}),null)}function sf(n,e){switch(n.tag){case 1:case 3:return n;case 0:return n.fields[0].ShipCentre.pty<xl?new Bl(1,"ShipGotThrough",e,n.fields[0]):n;default:return n}}function cf(n,e,t){let r,i,o,a;var u,s;switch(r=ti()[mi.fields[0]],i=ti()[Ci.fields[0]],o=ti()[Wi.fields[0]],a=ti()[pi.fields[0]],Vo(n,0,0,a),Cu(n,a.ImageMetadata.ImageHeight),er((function(e){Yo(n,e.MineLocation.ptx,e.MineLocation.pty,r)}),e.Mines),er((function(e){const r=e.TorpedoPositionGetter(t);switch(r.tag){case 2:break;case 1:{const t=e.TorpedoIsHorizontal?i:o;Yo(n,r.fields[0].ptx,r.fields[0].pty,t);break}}}),e.LiveTorpedos),2===e.Ship.tag?u=0:1===e.Ship.tag?(u=1,s=e.Ship.fields[1]):0===e.Ship.tag?(u=1,s=e.Ship.fields[0]):u=0,u){case 1:Yo(n,s.ShipCentre.ptx,s.ShipCentre.pty,function(n){const e=1===n.tag?Mi:2===n.tag?yi:3===n.tag?Ii:4===n.tag?Ti:Si;return ti()[e.fields[0]]}(s.ShipRotation))}Za(n,e.Animations,t);const c=new Iu(e.FleetStats.ScoreAndHiScore,e.FleetStats.ShipsStillToNavigate,e.FleetStats.ShipsSuccess,ua(e.FleetStats.ShipsSuccess),0,0,null,Math.fround(0));Tu(n,a.ImageMetadata.ImageHeight,c)}function lf(n,e,t,r,i){const o=new Ol(e,0,n),a=(u=i,nr((function(n,e){return Yl(e[0],e[1],e[2],e[3],u)}),Jl));var u;const s=new Bl(0,"ShipInPlay",$l()),c=new P;return new Kl(o,a,Vl(),c,s,t,r)}function ff(n,e,t){const r=function(n,e,t){const r=new Ol(n.ShipsStillToNavigate-1,e,t);return[r,0===r.ShipsStillToNavigate?new Bl(3,"SecretPassageScreenOver"):new Bl(0,"ShipInPlay",$l())]};if(!function(n,e){var t,r;switch(n.tag){case 0:t=0;break;case 2:case 1:t=1,r=n.fields[0];break;default:t=0}switch(t){case 0:return!1;case 1:return e>r+Dl}}(e,t))return[n,e];switch(e.tag){case 3:throw new Error("should not happen");case 2:return r(n,n.ShipsSuccess,n.ScoreAndHiScore);case 1:return r(n,n.ShipsSuccess+1,Lr(3e3,n.ScoreAndHiScore));default:throw new Error("should not happen")}}function hf(n,e,t){let r;if(r=aa(e),3===n.Ship.tag)return n;{const e=function(n,e){var t,r,i;switch(n.tag){case 2:return n;case 1:return new Bl(1,"ShipGotThrough",n.fields[0],(t=zl(n.fields[1].ShipCentre,n.fields[1].ShipRotation,n.fields[1].ShipSpeed),new Gl(n.fields[1].ShipRotation,n.fields[1].ShipSpeed,t)));case 3:return n;default:return new Bl(0,"ShipInPlay",(r=zl(n.fields[0].ShipCentre,n.fields[0].ShipRotation,n.fields[0].ShipSpeed),i=jl(n.fields[0].ShipSpeed,e),new Gl(Nl(n.fields[0].ShipRotation,e),i,r)))}}(n.Ship,r);let o,a;i=t,o=Qt((function(n){return 2===n.TorpedoPositionGetter(i).tag?Zl(n,i):n}),n.LiveTorpedos),a=Va(t,n.Animations);const u=function(n,e,t,r){switch(t.tag){case 1:case 3:return[n,e,t];case 0:{let i;return i=qt((function(n,e){let i;const o=e.TorpedoPositionGetter(r);switch(o.tag){case 2:i=null;break;case 1:i=nf(t.fields[0],o.fields[0],bl)?o.fields[0]:null;break;default:i=null}if(null==i)return[new P(e,n[0]),n[1],n[2]];{const t=i;return[new P(Zl(e,r),n[0]),new P(ef(t,r),n[1]),new Bl(2,"ShipExploding",r)]}}),[new P,e,t],n),[i[0],i[1],i[2]]}default:return[n,e,t]}}(o,a,e,t),s=tf(n.Mines,u[1],u[2],t),c=function(n,e,t){switch(e.tag){case 1:case 3:return[n,e];case 0:{let r;if(r=en(uf(e.fields[0],xa,rf[0],rf[1]),uf(e.fields[0],Da,of[0],of[1])),null!=r){return[new P(ef(r,t),n),new Bl(2,"ShipExploding",t)]}return[n,e]}default:return[n,e]}}(s[0],s[1],t),l=sf(c[1],t),f=ff(n.FleetStats,l,t);return new Kl(f[0],u[0],n.Mines,c[0],f[1],n.WhereToGoOnGameOver,n.WhereToOnCourseCompletion)}var i}function df(n,e,t,r){const i=hf(Yr(n),e,t);switch(1===i.Ship.tag||2===i.Ship.tag?0:3===i.Ship.tag?1:0){case 0:{const e=$r(n);return Jr(i,A(3,Zr(n)),A(4,e),new P)}case 1:return i.FleetStats.ShipsSuccess>0?i.WhereToOnCourseCompletion(i.FleetStats.ShipsSuccess,i.FleetStats.ScoreAndHiScore,t):i.WhereToGoOnGameOver(i.FleetStats.ScoreAndHiScore)}}const gf=Math.fround(2),wf=new va(Math.fround(290),Math.fround(15)),pf=rr([new Ea(Math.fround(38),Math.fround(7),Math.fround(310),Math.fround(19)),new Ea(Math.fround(125),Math.fround(19),Math.fround(310),Math.fround(35)),new Ea(Math.fround(133),Math.fround(35),Math.fround(310),Math.fround(41)),new Ea(Math.fround(168),Math.fround(41),Math.fround(310),Math.fround(50)),new Ea(Math.fround(200),Math.fround(49),Math.fround(310),Math.fround(139)),new Ea(Math.fround(86),Math.fround(75),Math.fround(276),Math.fround(139)),nc,tc]),mf=x((function(n,e,t,r,i){this.ScoreAndHiScore=n,this.AlliedFleetCentre=e,this.EnemyFleetCentre=t,this.SecretPassageCtor=r,this.EngageEnemyCtor=i}),B);function Sf(n,e,t){let r;r=ti()[di.fields[0]],Vo(n,0,0,r),Yo(n,e.AlliedFleetCentre.ptx,e.AlliedFleetCentre.pty,ti()[gi.fields[0]]),Yo(n,e.EnemyFleetCentre.ptx,e.EnemyFleetCentre.pty,ti()[wi.fields[0]]),Cu(n,r.ImageMetadata.ImageHeight);const i=new Iu(e.ScoreAndHiScore,0,10,ua(10),0,0,null,Math.fround(0));Tu(n,r.ImageMetadata.ImageHeight,i)}function Mf(n,e,t,r){let i;i=aa(e);const o=Yr(n),a=rc(o.AlliedFleetCentre,i,pf),u=ic(o.EnemyFleetCentre,a);if(Ha(nc,a)){let e,r,i;return i=os(o.SecretPassageCtor),r=function(n){return us(A(2,i),n)},e=os(r),as(gf,t,A(2,e),n)}if(Math.abs(u.ptx-a.ptx)<Js&&Math.abs(u.pty-a.pty)<Js){let e,r,i;return i=os(o.EngageEnemyCtor),r=function(n){return us(A(2,i),n)},e=os(r),as(gf,t,A(2,e),n)}{const e=new mf(o.ScoreAndHiScore,a,u,o.SecretPassageCtor,o.EngageEnemyCtor),t=$r(n);return Jr(e,A(3,Zr(n)),A(4,t),new P)}}const yf=Math.fround(2),If=x((function(n,e,t,r,i){this.Scoreboard=n,this.ScreenStartTime=e,this.HiScore=t,this.ScoreboardMemo=r,this.NextScreenConstructor=i}),B);function Tf(n,e){return e>n.ScreenStartTime+yf}function Cf(n,e,t){ia(n,t/Math.fround(4)),Yo(n,Math.fround(160),Math.fround(68),ti()[hi.fields[0]]),ra(n,ci,new Wr(1,"CentreAlign"),new Ar(0,"TopAlign"),160,94,20,e.ScoreboardMemo),Tf(e,t)&&ea(n,ci,new Wr(1,"CentreAlign"),new Ar(1,"MiddleAlign"),160,180,"USE CURSOR KEYS ... Z TO FIRE")}function Wf(n,e,t,r){let i;i=aa(e);const o=Yr(n);return i.Fire.JustDown&&Tf(o,t)?o.NextScreenConstructor(new Br(0,o.HiScore)):ni(n)}let Af=new P;function kf(n,e){return ha(n,Af,(function(n,e){return Af=n,Gf(e)}),e)}function vf(n){return t=kf,Jr(new da(e=n,"HI SCORE   "+e.HiScore.toString(),t),ga,wa,new P);var e,t}function bf(n,e){return ka(n,kf,e)}function Ef(n,e,t,r,i){return Jr(Lu(t,e,r,n,vf,bf,xf,i),Bu,Ru,new P)}function xf(n,e,t,r,i){const o=function(){let n,e;return e=Qt(Ju,Yt(Ae(0,1,3))),n=Nu((function(n){return 1===n.tag?new Ku(1,"SecondList",n.fields[0]):new Ku(0,"FirstList",n.fields[0])}),e),null==n[1].tail?new tn(0,"Ok",n[0]):new tn(1,"Error",Ve("\n",n[1]))}();if(0===o.tag)return a=t,u=e,s=n,c=o.fields[0],Jr(Ls(a,u,s,c,vf,(function(e,t,i){return Ef(n,e,t,r,i)}),i),Bs,Vs,new P);throw new Error("Failed to parse the tank battle level definitions.");var a,u,s,c}function Df(n,e,t){const r=new Qa(Qt((function(n){return new $a(new va(n[0],n[1]))}),nu));return function(n,e,t){return Jr(new uc(n,e,oc,t),sc,cc,new P)}(e,n,(function(t){return xf(0,ua(n),e,r,t)}))}function Hf(n,e,t){return Zc(e,n,vf,Df,t)}function Pf(n,e,t,r){return Tl(n,t,e,vf,Hf,r)}function Of(n,e,t){return Jr(new Al(e,n,Cl,$s,(function(t){return Pf(new sa(1,"WeakerEnemy"),n,e,t)})),kl,vl,new P)}function Xf(n,e){return Jr(lf(n,10,vf,Of,e),cf,df,new P)}function Ff(n){return Jr(new mf(n,wf,$s,(function(e){return Xf(n,e)}),(function(e){return Pf(new sa(0,"StrongEnemy"),10,n,e)})),Sf,Mf,new P)}function Gf(n){const e=Or(Af);return r=Ff,Jr(new If(t=Af,n,e,Gr(30,t),r),Cf,Wf,new P);var t,r}function Bf(n,e){return Af=function(n,e,t){let r;return r=nr((function(n,r){const i=e+(n>>>0)*t;return new Hr(r,i,i.toString())}),n),gr(Pr,r,{Compare:S})}(rr(["Bob","Scott","Lara","J"]),1e4,5e3),Gf(e)}const Lf=x((function(n){this.SoundFileName=n}),B);x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Rf=x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Kf=x((function(n,e){this.SoundMetadata=n,this.HostSoundRef=e}),B);x((function(n,e,...t){O.call(this,n,e,...t)}),O);const Nf=new J(0,"WebBrowserKeyCode",80),jf=x((function(n,e,t,r,i){this.WebBrowserKeyCode=n,this.ThisKeyScanCode=e,this.MutHeld=t,this.MutJustPressed=r,this.MutWaitingRelease=i}),B);function _f(n,e){return new jf(n,e,!1,!1,!1)}function Uf(n){return new Y(n.MutJustPressed,n.MutHeld)}const zf=x((function(n,e,t){this.MutableKeyStatesList=n,this.PauseKey=e,this.GameIsPaused=t}),B);function qf(n,e){let t;if(t=ur((function(n){return p(n.ThisKeyScanCode,e)}),n.MutableKeyStatesList),null==t)return p(e,n.PauseKey.ThisKeyScanCode)?n.PauseKey:null;return t}function Vf(n,e){const t=qf(n,e);if(null!=t){const e=t;return e.MutWaitingRelease||(p(e.ThisKeyScanCode,n.PauseKey.ThisKeyScanCode)&&((r=n).GameIsPaused=!r.GameIsPaused),e.MutHeld=!0,e.MutJustPressed=!0,e.MutWaitingRelease=!0),!0}return!1;var r}function Jf(n,e){const t=qf(n,e);if(null!=t){const n=t;return n.MutHeld=!1,n.MutWaitingRelease=!1,!0}return!1}x((function(n,e){this.Fonts=n,this.Images=e}),B);function Yf(n,e,t,r,i,o){const a=[];!function o(u){if(null!=u.tail){const i=n(u.head),s=0|e(u.head),c=0|r(u.head),l=0|t(u.head);loadImageThenDo(i,!0,(function(n){_t(function(n,e){const t=0|n.ImageMetadata.ImageHeight;return new Cr(n,1,1,e,t,e,t)}(new yr(new mr(i,new pr(1,"MagentaColourKeyImage"),s,c),new Mr(0,"HostImageRef",n)),l),a),o(u.tail)}))}else i(a.slice())}(o)}function Zf(n,e,t,r){Yf((function(n){return n.FontImageMetadata.ImageFileName}),(function(n){return n.FontImageMetadata.ImageWidth}),(function(n){return n.FontCharWidth}),(function(n){return n.FontImageMetadata.ImageHeight}),(function(e){!function(n,e,t,r,i,o){const a=[];!function o(u){if(null!=u.tail){const i=n(u.head),s=e(u.head),c=0|t(u.head),l=0|r(u.head);loadImageThenDo(i,s,(function(n){_t(new yr(new mr(i,s?new pr(1,"MagentaColourKeyImage"):new pr(0,"OpaqueImage"),c,l),new Mr(0,"HostImageRef",n)),a),o(u.tail)}))}else i(a.slice())}(o)}((function(n){return n.ImageFileName}),(function(n){return 1===n.ImageTransparency.tag}),(function(n){return n.ImageWidth}),(function(n){return n.ImageHeight}),(function(n){!function(n,e,t){const r=[];!function t(i){if(null!=i.tail){const e=n(i.head);loadSoundThenDo(e,(function(n){_t(new Kf(new Lf(e),new Rf(0,"HostSoundRef",n)),r),t(i.tail)}))}else e(r.slice())}(t)}((function(n){return n.SoundFileName}),(function(t){r(n,e,t)}),t)}),n)}),e)}function $f(n,e,t,r,i,o){var a,u;a=i,u=o,ti(r),ri(a),ii(u);const s=document.getElementById("gameScreen").getContext("2d");let c;s.imageSmoothingEnabled=!1;const l=e();if(0!==l.tag)throw new Error(l.fields[0]);c=l.fields[0];const f=Math.fround(0),h=Math.fround(.019999999552965164);let d=t(c,f);const g=(w=80,m=Qt((function(n){return[n.fields[0],new J(0,"WebBrowserKeyCode",n.fields[0])]}),n),new zf(Qt((function(n){return _f(n[1],n[0])}),m),_f(Nf,w),!1));var w,m;const S=function(n,e){document.addEventListener(n,(function(n){e(g,~~n.keyCode)&&n.preventDefault()}))};S("keydown",Vf),S("keyup",Jf),document.getElementById("loaderScreen").classList.add("hidden"),document.getElementById("gameScreen").classList.remove("hidden");let M=0;window.setInterval((function(){let n;let e;var t;console.log("Jonathan [c]"),M+=1,n=M/Math.fround(50),d.Draw((function(n){!function(n,e){switch(e.tag){case 2:{let t,r,i,o,a,u;t=e.fields[2].ImageMetadata.ImageWidth,r=e.fields[2].ImageMetadata.ImageHeight,i=~~(e.fields[0]+Math.fround(.5)),o=~~(e.fields[1]+Math.fround(.5)),a=e.fields[3],u=e.fields[4],t>0&&r>0&&a>0&&u>0&&n.drawImage(e.fields[2].HostImageRef.fields[0],0,0,t,r,i,o,a,u);break}case 3:{let t,r,i,o;t=~~(e.fields[4]+Math.fround(.5)),r=~~(e.fields[5]+Math.fround(.5)),i=e.fields[6],o=e.fields[7],e.fields[2]>0&&e.fields[3]>0&&i>0&&o>0&&n.drawImage(e.fields[8].HostImageRef.fields[0],e.fields[0],e.fields[1],e.fields[2],e.fields[3],t,r,i,o);break}case 1:{let t,r,i,o;t=e.fields[2],r=e.fields[3],i=e.fields[0],o=e.fields[1];const a="#"+ze("{0:x6}",e.fields[4].fields[0]);n.fillStyle=a,n.fillRect(i,o,t,r);break}default:{let t,r;t=e.fields[0],r=e.fields[1],n.drawImage(e.fields[2].HostImageRef.fields[0],t,r)}}}(s,n)}),n),e=d.Frame((function(n){return function(n,e){let t;return t=ur((function(n){return p(n.WebBrowserKeyCode,e)}),n.MutableKeyStatesList),null==t?p(e,n.PauseKey.WebBrowserKeyCode)?Uf(n.PauseKey):Z:Uf(t)}(g,n)}),n,h),er((function(n){var e;e=n.fields[0].HostSoundRef,playSound(e.fields[0])}),e.Sounds()),dr((function(n){return n.MutJustPressed}),(t=g).MutableKeyStatesList)&&er((function(n){n.MutJustPressed=!1}),t.MutableKeyStatesList),d=e}),20,null)}function Qf(){const n=rr([new J(0,"WebBrowserKeyCode",37),new J(0,"WebBrowserKeyCode",39),new J(0,"WebBrowserKeyCode",38),new J(0,"WebBrowserKeyCode",40),new J(0,"WebBrowserKeyCode",90)]);Zf(Er,br,xr,(function(e,t,r){$f(n,(function(){return new tn(0,"Ok",1)}),Bf,e,t,r)}))}Qf(),t.d(e,"WebMain",(function(){return Qf}))}]);