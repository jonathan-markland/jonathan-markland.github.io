!function(n){var e={};function t(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return n[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var i in n)t.d(r,i,function(e){return n[e]}.bind(null,i));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=0)}([function(n,e,t){"use strict";function r(n){return null!=n&&(Array.isArray(n)||ArrayBuffer.isView(n))}function i(n){return null!=n&&"function"==typeof n.Dispose}t.r(e);function o(n,e,t){return n.has(e)?[!0,n.get(e)]:[!1,t]}function a(n,e){return!e.has(n)&&(e.add(n),!0)}function u(n,e){let t=n.toString(10);for(;t.length<e;)t="0"+t;return t}function s(n){const e=n;return"number"==typeof e.offset?e.offset:1===n.kind?0:-6e4*n.getTimezoneOffset()}class l{static id(n){return l.idMap.has(n)||l.idMap.set(n,++l.count),l.idMap.get(n)}}function c(n){let e=0,t=5381;const r=n.length;for(;e<r;)t=33*t^n.charCodeAt(e++);return t}function f(n){return 2654435761*n|0}function h(n){return 0===n.length?0:n.reduce((n,e)=>(n<<5)+n^e)}function d(n){if(null==n)return 0;switch(typeof n){case"boolean":return n?1:0;case"number":return f(n);case"string":return c(n);default:if(function(n){return null!=n&&"function"==typeof n.GetHashCode}(n))return n.GetHashCode();if(r(n)){const e=n.length,t=new Array(e);for(let r=0;r<e;r++)t[r]=d(n[r]);return h(t)}return c(String(n))}}function g(n,e,t){if(null==n)return null==e;if(null==e)return!1;if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function w(n,e){return g(n,e,p)}function p(n,e){return n===e||(null==n?null==e:null!=e&&("object"==typeof n&&(function(n){return null!=n&&"function"==typeof n.Equals}(n)?n.Equals(e):r(n)?r(e)&&w(n,e):n instanceof Date&&(e instanceof Date&&0===S(n,e)))))}function S(n,e){let t,r;return"offset"in n&&"offset"in e?(t=n.getTime(),r=e.getTime()):(t=n.getTime()+s(n),r=e.getTime()+s(e)),t===r?0:t<r?-1:1}function M(n,e){return n===e?0:n<e?-1:1}function m(n,e,t){if(null==n)return null==e?0:1;if(null==e)return-1;if(n.length!==e.length)return n.length<e.length?-1:1;for(let r=0,i=0;r<n.length;r++)if(i=t(n[r],e[r]),0!==i)return i;return 0}function y(n,e){return m(n,e,T)}function T(n,e){return n===e?0:null==n?null==e?0:-1:null==e?1:"object"!=typeof n?n<e?-1:1:function(n){return null!=n&&"function"==typeof n.CompareTo}(n)?n.CompareTo(e):r(n)&&r(e)?y(n,e):n instanceof Date&&e instanceof Date?S(n,e):1}function I(n,e,t){return n(e,t)<0?e:t}function C(n,e,t){return n(e,t)>0?e:t}l.idMap=new WeakMap,l.count=0;function A(n,e,t){if(null==e)return null;if("__CURRIED__"in e){e=e.__CURRIED__;for(let n=0;n<t.length;n++)e=e(t[n]);return e}switch(n){case 1:return n=>e.apply(null,t.concat([n]));case 2:return n=>r=>e.apply(null,t.concat([n,r]));case 3:return n=>r=>i=>e.apply(null,t.concat([n,r,i]));case 4:return n=>r=>i=>o=>e.apply(null,t.concat([n,r,i,o]));case 5:return n=>r=>i=>o=>a=>e.apply(null,t.concat([n,r,i,o,a]));case 6:return n=>r=>i=>o=>a=>u=>e.apply(null,t.concat([n,r,i,o,a,u]));case 7:return n=>r=>i=>o=>a=>u=>s=>e.apply(null,t.concat([n,r,i,o,a,u,s]));case 8:return n=>r=>i=>o=>a=>u=>s=>l=>e.apply(null,t.concat([n,r,i,o,a,u,s,l]));default:throw new Error("Partially applying to more than 8-arity is not supported: "+n)}}function k(n,e){if(n.has(e))return n.get(e);throw new Error(`The given key '${e}' was not present in the dictionary.`)}function E(n,e){return null!=e&&Object.getPrototypeOf(n).constructor===Object.getPrototypeOf(e).constructor}function b(n,e){return function(n,e){n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}(n,e||v),n}function v(){}function W(n,e){if(n===e)return 0;if(null==e)return-1;for(;null!=n.tail;){if(null==e.tail)return 1;const t=T(n.head,e.head);if(0!==t)return t;n=n.tail,e=e.tail}return null==e.tail?0:-1}function x(n,e){this.head=n,this.tail=e}function D(n,e,...t){this.tag=0|n,this.name=e,this.fields=t}function P(n,e){const t={},r=null==e?Object.keys(n):e(n);for(let e=0;e<r.length;e++)t[r[e]]=n[r[e]];return t}function H(n,e,t){if(n===e)return!0;if(E(n,e)){const r=null==t?Object.keys(n):t(n);for(let t=0;t<r.length;t++)if(!p(n[r[t]],e[r[t]]))return!1;return!0}return!1}function B(n,e,t){if(n===e)return 0;if(E(n,e)){const r=null==t?Object.keys(n):t(n);for(let t=0;t<r.length;t++){const i=T(n[r[t]],e[r[t]]);if(0!==i)return i}return 0}return-1}function X(){}v.prototype.toString=function(){return"{"+Object.keys(this).map(n=>n+" = "+String(this[n])).join(";\n ")+"}"},v.prototype.GetHashCode=function(){return function(n){if(null==n)return 0;switch(typeof n){case"boolean":return n?1:0;case"number":return f(n);case"string":return c(n);default:return f(l.id(n))}}(this)},v.prototype.Equals=function(n){return this===n},x.prototype.toString=function(){return"["+Array.from(this).map(n=>String(n)).join("; ")+"]"},x.prototype.toJSON=function(){return Array.from(this)},x.prototype[Symbol.iterator]=function(){let n=this;return{next:()=>{const e=n;return n=n.tail,{done:null==e.tail,value:e.head}}}},x.prototype.GetHashCode=function(){return h(Array.from(this).map(d))},x.prototype.Equals=function(n){return 0===W(this,n)},x.prototype.CompareTo=function(n){return W(this,n)},D.prototype.toString=function(){const n=this.fields.length;return 0===n?this.name:1===n?this.name+" "+String(this.fields[0]):this.name+" ("+this.fields.map(n=>String(n)).join(",")+")"},D.prototype.toJSON=function(){return 0===this.fields.length?this.name:[this.name].concat(this.fields)},D.prototype.GetHashCode=function(){const n=this.fields.map(n=>d(n));return n.splice(0,0,f(this.tag)),h(n)},D.prototype.Equals=function(n){return this===n||E(this,n)&&this.tag===n.tag&&w(this.fields,n.fields)},D.prototype.CompareTo=function(n){return this===n?0:E(this,n)?this.tag===n.tag?y(this.fields,n.fields):this.tag<n.tag?-1:1:-1},X.prototype.toString=function(){return"{"+Object.keys(this).map(n=>n+" = "+String(this[n])).join(";\n ")+"}"},X.prototype.toJSON=function(){return P(this)},X.prototype.GetHashCode=function(){return h(Object.keys(this).map(n=>d(this[n])))},X.prototype.Equals=function(n){return H(this,n)},X.prototype.CompareTo=function(n){return B(this,n)};const F=b((function(n){this.contents=n}),X),G=b((function(n){this.stack=Error().stack,this.message=n}),v);function O(n){return Object.keys(n).filter(n=>"message"!==n&&"stack"!==n)}const L=b((function(){G.call(this)}),G);L.prototype.toString=function(){const n=O(this),e=n.length;return 0===e?this.message:1===e?this.message+" "+String(this[n[0]]):this.message+" ("+n.map(n=>String(this[n])).join(",")+")"},L.prototype.toJSON=function(){return P(this,O)},L.prototype.GetHashCode=function(){return h(O(this).map(n=>d(this[n])))},L.prototype.Equals=function(n){return H(this,n,O)},L.prototype.CompareTo=function(n){return B(this,n,O)};b((function(n,e,t){this.arg1=n,this.arg2=0|e,this.arg3=0|t,this.message="The match cases were incomplete"}),L),b((function(){}),v);class N{constructor(n,e,t,r){this.declaringType=n,this.tag=e,this.name=t,this.fields=r}}class K{constructor(n,e,t,r,i,o){this.fullname=n,this.generics=e,this.constructor=t,this.fields=r,this.cases=i,this.enumCases=o}toString(){return function n(e){const t=null==e.generics||Z(e)?[]:e.generics;return t.length>0?e.fullname+"["+t.map(e=>n(e)).join(",")+"]":e.fullname}(this)}Equals(n){return j(this,n)}CompareTo(n){return U(this,n)}}function R(n){return null!=n.generics?n.generics:[]}function j(n,e){return""===n.fullname?""===e.fullname&&g($(n),$(e),([n,e],[t,r])=>n===t&&j(e,r)):n.fullname===e.fullname&&g(R(n),R(e),j)}function U(n,e){return n.fullname!==e.fullname?n.fullname<e.fullname?-1:1:m(R(n),R(e),U)}function J(n,e,t,r){return new K(n,e,t,r)}function z(n,e,t,r){const i=new K(n,e,t,void 0,()=>r().map((n,e)=>"string"==typeof n?new N(i,e,n):new N(i,e,n[0],n[1])));return i}function V(n){return new K(n.fullname+"[]",[n])}const _=new K("System.Object"),Y=(new K("Microsoft.FSharp.Core.Unit"),new K("System.Char"),new K("System.String")),q=(new K("System.Boolean"),new K("System.SByte"),new K("System.Byte"),new K("System.Int16"),new K("System.UInt16"),new K("System.Int32"));new K("System.UInt32"),new K("System.Single"),new K("System.Double"),new K("System.Decimal");function Z(n){return n.fullname.endsWith("[]")}function $(n){if(null!=n.fields)return n.fields();throw new Error(`${n.fullname} is not an F# record type`)}const Q=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const nn=b((function(n,e,t,r){this.ImageFileName=n,this.ImageColourKey=e,this.ImageWidth=t,this.ImageHeight=r}),X);const en=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const tn=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const rn=b((function(n,e){this.EngineImageMetadata=n,this.HostImageObject=e}),X);function on(){return J("ResourceFileMetadata.ImageWithHostObject",[],rn,()=>[["EngineImageMetadata",J("ResourceFileMetadata.EngineImageMetadata",[],nn,()=>[["ImageFileName",Y],["ImageColourKey",z("ResourceFileMetadata.ImageColourKey",[],Q,()=>["NoColourKey","MagentaColourKey"])],["ImageWidth",q],["ImageHeight",q]])],["HostImageObject",z("ResourceFileMetadata.HostImageObject",[],tn,()=>[["HostImageObject",[_]]])]])}function an(n){return[n.EngineImageMetadata.ImageWidth,n.EngineImageMetadata.ImageHeight]}class un{constructor(n){this.value=n}toString(){return String(this.value)}toJSON(){return this.value}GetHashCode(){return d(this.value)}Equals(n){return null!=n&&p(this.value,n instanceof un?n.value:n)}CompareTo(n){return null==n?1:T(this.value,n instanceof un?n.value:n)}}function sn(n){return null==(n=void 0===n?null:n)||n instanceof un?new un(n):n}function ln(n,e){if(null==n){if(!e)throw new Error("Option has no value");return null}return n instanceof un?n.value:n}function cn(n,e,t){return null!=n?null!=t?t(ln(n)):ln(n):e}b((function(n,e,t){D.call(this,n,e,t)}),D);const fn=b((function(n,e,t){D.call(this,n,e,t)}),D);function hn(n,e){return 1===e.tag?(t=n(e.fields[0]),new fn(1,"Error",t)):e;var t}var dn={GetHashCode(){return h([this.s,this.e].concat(this.c))},Equals(n){return!this.cmp(n)},CompareTo(n){return this.cmp(n)}},gn="[big.js] ",wn=gn+"Invalid ",pn=wn+"decimal places",Sn=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Mn(n,e){var t,r,i;if(0===e&&1/e<0)e="-0";else if(!Sn.test(e+=""))throw Error(wn+"number");for(n.s="-"==e.charAt(0)?(e=e.slice(1),-1):1,(t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),i=e.length,r=0;r<t&&r<i&&"0"==e.charAt(r);)++r;if(r==i)n.c=[n.e=0];else for(n.e=t-r-1,n.c=[],t=0;r<i;)n.c[t++]=+e.charAt(r++);return n=mn(n,Tn.DP,Tn.RM)}function mn(n,e,t,r){var i=n.c,o=n.e+e+1;if(o<i.length){if(1===t)r=i[o]>=5;else if(2===t)r=i[o]>5||5==i[o]&&(r||o<0||void 0!==i[o+1]||1&i[o-1]);else if(3===t)r=r||!!i[0];else if(r=!1,0!==t)throw Error("[big.js] Invalid rounding mode");if(o<1)i.length=1,r?(n.e=-e,i[0]=1):i[0]=n.e=0;else{if(i.length=o--,r)for(;++i[o]>9;)i[o]=0,o--||(++n.e,i.unshift(1));for(o=i.length;!i[--o];)i.pop()}}else if(t<0||t>3||t!==~~t)throw Error("[big.js] Invalid rounding mode");return n}function yn(n,e,t,r){var i,o,a=n.constructor,u=!n.c[0];if(void 0!==t){if(t!==~~t||t<(3==e)||t>1e6)throw Error(3==e?wn+"precision":pn);for(t=r-(n=new a(n)).e,n.c.length>++r&&mn(n,t,a.RM),2==e&&(r=n.e+t+1);n.c.length<r;)n.c.push(0)}if(i=n.e,t=(o=n.c.join("")).length,2!=e&&(1==e||3==e&&r<=i||i<=a.NE||i>=a.PE))o=o.charAt(0)+(t>1?"."+o.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)o="0"+o;o="0."+o}else if(i>0)if(++i>t)for(i-=t;i--;)o+="0";else i<t&&(o=o.slice(0,i)+"."+o.slice(i));else t>1&&(o=o.charAt(0)+"."+o.slice(1));return n.s<0&&(!u||4==e)?"-"+o:o}dn.abs=function(){var n=new this.constructor(this);return n.s=1,n},dn.cmp=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.c),o=n.c,a=r.s,u=n.s,s=r.e,l=n.e;if(!i[0]||!o[0])return i[0]?a:o[0]?-u:0;if(a!=u)return a;if(e=a<0,s!=l)return s>l^e?1:-1;for(u=Math.max(i.length,o.length),a=0;a<u;a++)if((s=a<i.length?i[a]:0)!=(l=a<o.length?o[a]:0))return s>l^e?1:-1;return 0},dn.div=function(n){var e=this.constructor,t=new e(this),r=(n=new e(n),t.c),i=n.c,o=t.s==n.s?1:-1,a=e.DP;if(a!==~~a||a<0||a>1e6)throw Error(pn);if(!i[0])throw Error("[big.js] Division by zero");if(!r[0])return new e(0*o);var u,s,l,c,f,h=i.slice(),d=u=i.length,g=r.length,w=r.slice(0,u),p=w.length,S=n,M=S.c=[],m=0,y=a+(S.e=t.e-n.e)+1;for(S.s=o,o=y<0?0:y,h.unshift(0);p++<u;)w.push(0);do{for(l=0;l<10;l++){if(u!=(p=w.length))c=u>p?1:-1;else for(f=-1,c=0;++f<u;)if(i[f]!=w[f]){c=i[f]>w[f]?1:-1;break}if(!(c<0))break;for(s=p==u?i:h;p;){if(w[--p]<s[p]){for(f=p;f&&!w[--f];)w[f]=9;--w[f],w[p]+=10}w[p]-=s[p]}for(;!w[0];)w.shift()}M[m++]=c?l:++l,w[0]&&c?w[p]=r[d]||0:w=[r[d]]}while((d++<g||void 0!==w[0])&&o--);return M[0]||1==m||(M.shift(),S.e--),m>y&&mn(S,a,e.RM,void 0!==w[0]),S},dn.eq=function(n){return!this.cmp(n)},dn.gt=function(n){return this.cmp(n)>0},dn.gte=function(n){return this.cmp(n)>-1},dn.lt=function(n){return this.cmp(n)<0},dn.lte=function(n){return this.cmp(n)<1},dn.minus=dn.sub=function(n){var e,t,r,i,o=this.constructor,a=new o(this),u=(n=new o(n),a.s),s=n.s;if(u!=s)return n.s=-s,a.plus(n);var l=a.c.slice(),c=a.e,f=n.c,h=n.e;if(!l[0]||!f[0])return f[0]?(n.s=-s,n):new o(l[0]?a:0);if(u=c-h){for((i=u<0)?(u=-u,r=l):(h=c,r=f),r.reverse(),s=u;s--;)r.push(0);r.reverse()}else for(t=((i=l.length<f.length)?l:f).length,u=s=0;s<t;s++)if(l[s]!=f[s]){i=l[s]<f[s];break}if(i&&(r=l,l=f,f=r,n.s=-n.s),(s=(t=f.length)-(e=l.length))>0)for(;s--;)l[e++]=0;for(s=e;t>u;){if(l[--t]<f[t]){for(e=t;e&&!l[--e];)l[e]=9;--l[e],l[t]+=10}l[t]-=f[t]}for(;0===l[--s];)l.pop();for(;0===l[0];)l.shift(),--h;return l[0]||(n.s=1,l=[h=0]),n.c=l,n.e=h,n},dn.mod=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.s),o=n.s;if(!n.c[0])throw Error("[big.js] Division by zero");return r.s=n.s=1,e=1==n.cmp(r),r.s=i,n.s=o,e?new t(r):(i=t.DP,o=t.RM,t.DP=t.RM=0,r=r.div(n),t.DP=i,t.RM=o,this.minus(r.times(n)))},dn.plus=dn.add=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.s),o=n.s;if(i!=o)return n.s=-o,r.minus(n);var a=r.e,u=r.c,s=n.e,l=n.c;if(!u[0]||!l[0])return l[0]?n:new t(u[0]?r:0*i);if(u=u.slice(),i=a-s){for(i>0?(s=a,e=l):(i=-i,e=u),e.reverse();i--;)e.push(0);e.reverse()}for(u.length-l.length<0&&(e=l,l=u,u=e),i=l.length,o=0;i;u[i]%=10)o=(u[--i]=u[i]+l[i]+o)/10|0;for(o&&(u.unshift(o),++s),i=u.length;0===u[--i];)u.pop();return n.c=u,n.e=s,n},dn.pow=function(n){var e=this.constructor,t=new e(this),r=new e(1),i=new e(1),o=n<0;if(n!==~~n||n<-1e6||n>1e6)throw Error(wn+"exponent");for(o&&(n=-n);1&n&&(r=r.times(t)),n>>=1;)t=t.times(t);return o?i.div(r):r},dn.round=function(n,e){var t=this.constructor;if(void 0===n)n=0;else if(n!==~~n||n<-1e6||n>1e6)throw Error(pn);return mn(new t(this),n,void 0===e?t.RM:e)},dn.sqrt=function(){var n,e,t,r=this.constructor,i=new r(this),o=i.s,a=i.e,u=new r(.5);if(!i.c[0])return new r(i);if(o<0)throw Error(gn+"No square root");0===(o=Math.sqrt(i+""))||o===1/0?((e=i.c.join("")).length+a&1||(e+="0"),a=((a+1)/2|0)-(a<0||1&a),n=new r(((o=Math.sqrt(e))==1/0?"1e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):n=new r(o),a=n.e+(r.DP+=4);do{t=n,n=u.times(t.plus(i.div(t)))}while(t.c.slice(0,a).join("")!==n.c.slice(0,a).join(""));return mn(n,r.DP-=4,r.RM)},dn.times=dn.mul=function(n){var e,t=this.constructor,r=new t(this),i=(n=new t(n),r.c),o=n.c,a=i.length,u=o.length,s=r.e,l=n.e;if(n.s=r.s==n.s?1:-1,!i[0]||!o[0])return new t(0*n.s);for(n.e=s+l,a<u&&(e=i,i=o,o=e,l=a,a=u,u=l),e=new Array(l=a+u);l--;)e[l]=0;for(s=u;s--;){for(u=0,l=a+s;l>s;)u=e[l]+o[s]*i[l-s-1]+u,e[l--]=u%10,u=u/10|0;e[l]=(e[l]+u)%10}for(u?++n.e:e.shift(),s=e.length;!e[--s];)e.pop();return n.c=e,n},dn.toExponential=function(n){return yn(this,1,n,n)},dn.toFixed=function(n){return yn(this,2,n,this.e+n)},dn.toPrecision=function(n){return yn(this,3,n,n-1)},dn.toString=function(){return yn(this)},dn.valueOf=dn.toJSON=function(){return yn(this,4)};var Tn=function n(){function e(t){var r=this;if(!(r instanceof e))return void 0===t?n():new e(t);t instanceof e?(r.s=t.s,r.e=t.e,r.c=t.c.slice(),function(n){if((n=mn(n,28,0)).c.length>1&&!n.c[0]){let e=n.c.findIndex(n=>n);n.c=n.c.slice(e),n.e=n.e-e}}(r)):Mn(r,t),r.constructor=e}return e.prototype=dn,e.DP=28,e.RM=1,e.NE=-29,e.PE=29,e.version="5.2.2",e}(),In=Tn,Cn=In;new In(0),new In(1),new In(-1),new In("79228162514264337593543950335"),new In("-79228162514264337593543950335");var An;function kn(n){return-2147483648===n?n:-n}!function(n){n[n.AllowHexSpecifier=512]="AllowHexSpecifier"}(An||(An={}));var En=null;try{En=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(n){}function bn(n,e,t){this.low=0|n,this.high=0|e,this.unsigned=!!t}function vn(n){return!0===(n&&n.__isLong__)}bn.prototype.GetHashCode=function(){let n=this.unsigned?1:0;return n=(n<<5)+n^this.high,n=(n<<5)+n^this.low,n},bn.prototype.Equals=function(n){return ee(this,n)},bn.prototype.CompareTo=function(n){return oe(this,n)},bn.prototype.toString=function(n){return Zn(this,n)},bn.prototype.toJSON=function(){return Zn(this)},bn.prototype.__isLong__,Object.defineProperty(bn.prototype,"__isLong__",{value:!0});var Wn={},xn={};function Dn(n,e){var t,r,i;return e?(i=0<=(n>>>=0)&&n<256)&&(r=xn[n])?r:(t=Hn(n,(0|n)<0?-1:0,!0),i&&(xn[n]=t),t):(i=-128<=(n|=0)&&n<128)&&(r=Wn[n])?r:(t=Hn(n,n<0?-1:0,!1),i&&(Wn[n]=t),t)}function Pn(n,e){if(isNaN(n))return e?Rn:Kn;if(e){if(n<0)return Rn;if(n>=On)return Vn}else{if(n<=-Ln)return _n;if(n+1>=Ln)return zn}return n<0?ae(Pn(-n,e)):Hn(n%Gn|0,n/Gn|0,e)}function Hn(n,e,t){return new bn(n,e,t)}var Bn=Math.pow;function Xn(n,e,t){if(0===n.length)throw Error("empty string");if("NaN"===n||"Infinity"===n||"+Infinity"===n||"-Infinity"===n)return Kn;if("number"==typeof e?(t=e,e=!1):e=!!e,(t=t||10)<2||36<t)throw RangeError("radix");var r=n.indexOf("-");if(r>0)throw Error("interior hyphen");if(0===r)return ae(Xn(n.substring(1),e,t));for(var i=Pn(Bn(t,8)),o=Kn,a=0;a<n.length;a+=8){var u=Math.min(8,n.length-a),s=parseInt(n.substring(a,a+u),t);if(u<8)o=ue(le(o,Pn(Bn(t,u))),Pn(s));else o=ue(o=le(o,i),Pn(s))}return o.unsigned=e,o}function Fn(n,e){return"number"==typeof n?Pn(n,e):"string"==typeof n?Xn(n,e):Hn(n.low,n.high,"boolean"==typeof e?e:n.unsigned)}var Gn=4294967296,On=Gn*Gn,Ln=On/2,Nn=Dn(1<<24),Kn=Dn(0),Rn=Dn(0,!0),jn=Dn(1),Un=Dn(1,!0),Jn=Dn(-1),zn=Hn(-1,2147483647,!1),Vn=Hn(-1,-1,!0),_n=Hn(0,-2147483648,!1);function Yn(n){return n.unsigned?n.low>>>0:n.low}function qn(n){return n.unsigned?(n.high>>>0)*Gn+(n.low>>>0):n.high*Gn+(n.low>>>0)}function Zn(n,e){if((e=e||10)<2||36<e)throw RangeError("radix");if($n(n))return"0";if(Qn(n)){if(ee(n,_n)){var t=Pn(e),r=ce(n,t),i=se(le(r,t),n);return Zn(r,e)+Yn(i).toString(e)}return"-"+Zn(ae(n),e)}for(var o=Pn(Bn(e,6),n.unsigned),a=n,u="";;){var s=ce(a,o),l=(Yn(se(a,le(s,o)))>>>0).toString(e);if($n(a=s))return l+u;for(;l.length<6;)l="0"+l;u=""+l+u}}function $n(n){return 0===n.high&&0===n.low}function Qn(n){return!n.unsigned&&n.high<0}function ne(n){return 1==(1&n.low)}function ee(n,e){return vn(e)||(e=Fn(e)),(n.unsigned===e.unsigned||n.high>>>31!=1||e.high>>>31!=1)&&(n.high===e.high&&n.low===e.low)}function te(n,e){return oe(n,e)<0}function re(n,e){return oe(n,e)>0}function ie(n,e){return oe(n,e)>=0}function oe(n,e){if(vn(e)||(e=Fn(e)),ee(n,e))return 0;var t=Qn(n),r=Qn(e);return t&&!r?-1:!t&&r?1:n.unsigned?e.high>>>0>n.high>>>0||e.high===n.high&&e.low>>>0>n.low>>>0?-1:1:Qn(se(n,e))?-1:1}function ae(n){return!n.unsigned&&ee(n,_n)?_n:ue(fe(n),jn)}function ue(n,e){vn(e)||(e=Fn(e));var t=n.high>>>16,r=65535&n.high,i=n.low>>>16,o=65535&n.low,a=e.high>>>16,u=65535&e.high,s=e.low>>>16,l=0,c=0,f=0,h=0;return f+=(h+=o+(65535&e.low))>>>16,c+=(f+=i+s)>>>16,l+=(c+=r+u)>>>16,l+=t+a,Hn((f&=65535)<<16|(h&=65535),(l&=65535)<<16|(c&=65535),n.unsigned)}function se(n,e){return vn(e)||(e=Fn(e)),ue(n,ae(e))}function le(n,e){if($n(n))return n.unsigned?Rn:Kn;if(vn(e)||(e=Fn(e)),En)return Hn(En.mul(n.low,n.high,e.low,e.high),En.get_high(),n.unsigned);if($n(e))return n.unsigned?Rn:Kn;if(ee(n,_n))return ne(e)?_n:Kn;if(ee(e,_n))return ne(n)?_n:Kn;if(Qn(n))return Qn(e)?le(ae(n),ae(e)):ae(le(ae(n),e));if(Qn(e))return ae(le(n,ae(e)));if(te(n,Nn)&&te(e,Nn))return Pn(qn(n)*qn(e),n.unsigned);var t=n.high>>>16,r=65535&n.high,i=n.low>>>16,o=65535&n.low,a=e.high>>>16,u=65535&e.high,s=e.low>>>16,l=65535&e.low,c=0,f=0,h=0,d=0;return h+=(d+=o*l)>>>16,f+=(h+=i*l)>>>16,h&=65535,f+=(h+=o*s)>>>16,c+=(f+=r*l)>>>16,f&=65535,c+=(f+=i*s)>>>16,f&=65535,c+=(f+=o*u)>>>16,c+=t*l+r*s+i*u+o*a,Hn((h&=65535)<<16|(d&=65535),(c&=65535)<<16|(f&=65535),n.unsigned)}function ce(n,e){if(vn(e)||(e=Fn(e)),$n(e))throw Error("division by zero");var t,r,i;if(En)return n.unsigned||-2147483648!==n.high||-1!==e.low||-1!==e.high?Hn((n.unsigned?En.div_u:En.div_s)(n.low,n.high,e.low,e.high),En.get_high(),n.unsigned):n;if($n(n))return n.unsigned?Rn:Kn;if(n.unsigned){if(e.unsigned||(e=function(n){return n.unsigned?n:Hn(n.low,n.high,!0)}(e)),re(e,n))return Rn;if(re(e,ge(n,1)))return Un;i=Rn}else{if(ee(n,_n))return ee(e,jn)||ee(e,Jn)?_n:ee(e,_n)?jn:ee(t=he(ce(de(n,1),e),1),Kn)?Qn(e)?jn:Jn:i=ue(t,ce(r=se(n,le(e,t)),e));if(ee(e,_n))return n.unsigned?Rn:Kn;if(Qn(n))return Qn(e)?ce(ae(n),ae(e)):ae(ce(ae(n),e));if(Qn(e))return ae(ce(n,ae(e)));i=Kn}for(r=n;ie(r,e);){t=Math.max(1,Math.floor(qn(r)/qn(e)));for(var o=Math.ceil(Math.log(t)/Math.LN2),a=o<=48?1:Bn(2,o-48),u=Pn(t),s=le(u,e);Qn(s)||re(s,r);)s=le(u=Pn(t-=a,n.unsigned),e);$n(u)&&(u=jn),i=ue(i,u),r=se(r,s)}return i}function fe(n){return Hn(~n.low,~n.high,n.unsigned)}function he(n,e){return vn(e)&&(e=Yn(e)),0==(e&=63)?n:e<32?Hn(n.low<<e,n.high<<e|n.low>>>32-e,n.unsigned):Hn(0,n.low<<e-32,n.unsigned)}function de(n,e){return vn(e)&&(e=Yn(e)),0==(e&=63)?n:e<32?Hn(n.low>>>e|n.high<<32-e,n.high>>e,n.unsigned):Hn(n.high>>e-32,n.high>=0?0:-1,n.unsigned)}function ge(n,e){if(vn(e)&&(e=Yn(e)),0===(e&=63))return n;var t=n.high;return e<32?Hn(n.low>>>e|t<<32-e,t>>>e,n.unsigned):Hn(32===e?t:t>>>e-32,0,n.unsigned)}var we=bn;const pe=le,Se=oe,Me=function(n,e,t){return t?function(n,e){return new bn(n[0]|n[1]<<8|n[2]<<16|n[3]<<24,n[4]|n[5]<<8|n[6]<<16|n[7]<<24,e)}(n,e):function(n,e){return new bn(n[4]<<24|n[5]<<16|n[6]<<8|n[7],n[0]<<24|n[1]<<16|n[2]<<8|n[3],e)}(n,e)},me=function(n,e){return e?function(n){var e=n.high,t=n.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]}(n):function(n){var e=n.high,t=n.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]}(n)},ye=Zn;class Te{constructor(n){this.iter=n}MoveNext(){const n=this.iter.next();return this.current=n.value,!n.done}get Current(){return this.current}Reset(){throw new Error("JS iterators cannot be reset")}Dispose(){}}function Ie(n){return new Te(n[Symbol.iterator]())}function Ce(n){return{next:()=>n.MoveNext()?{done:!1,value:n.Current}:{done:!0,value:null}}}function Ae(n){return Ee(()=>{const e=n[Symbol.iterator]();let t={value:null};return Fe(n=>{let r=!1;for(;!r;)if(null==n){const t=e.next();t.done?r=!0:n=t.value[Symbol.iterator]()}else{const e=n.next();e.done?n=null:(t={value:e.value},r=!0)}return null!=n&&null!=t?[t.value,n]:null},null)})}function ke(n,e){return Ae(Pe(n,e))}function Ee(n){return{[Symbol.iterator]:()=>n()[Symbol.iterator]()}}function be(){return Fe(()=>null,void 0)}function ve(n,e){let t;for(const r=e[Symbol.iterator]();t=r.next(),!t.done;)if(n(t.value))return!0;return!1}function We(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))return t.reduce(n,e);{let r;for(let i=0,o=t[Symbol.iterator]();r=o.next(),!r.done;i++)e=n(e,r.value,i);return e}}function xe(n,e){We((e,t)=>(n(t),null),null,e)}function De(n,e){We((e,t,r)=>(n(null!=r?r:0,t),null),null,e)}function Pe(n,e){return Ee(()=>Fe(e=>{const t=e.next();return t.done?null:[n(t.value),e]},e[Symbol.iterator]()))}function He(n,e,t){if(0===e)throw new Error("Step cannot be 0");return Ee(()=>Fe(n=>e>0&&n<=t||e<0&&n>=t?[n,n+e]:null,n))}function Be(n){return[n]}function Xe(n,e,t){return We((e,r)=>t.Add(e,n(r)),t.GetZero(),e)}function Fe(n,e){return{[Symbol.iterator]:()=>{let t=e;return{next:()=>{const e=n(t);if(null!=e){const n=ln(e);if(null!=n)return t=n[1],{done:!1,value:n[0]}}return{done:!0,value:void 0}}}}}}function Ge(n){const e=n<0,t=(n=Math.abs(n))%36e5/6e4;return(e?"-":"+")+u(~~(n/36e5),2)+":"+u(t,2)}function Oe(n,e){const t=n.toISOString();return"first"===e?t.substring(0,t.indexOf("T")):t.substring(t.indexOf("T")+1,t.length-1)}function Le(n,e,t){return e.replace(/(\w)\1*/g,e=>{let r=Number.NaN;switch(e.substring(0,1)){case"y":const i=t?n.getUTCFullYear():n.getFullYear();r=e.length<4?i%100:i;break;case"M":r=(t?n.getUTCMonth():n.getMonth())+1;break;case"d":r=t?n.getUTCDate():n.getDate();break;case"H":r=t?n.getUTCHours():n.getHours();break;case"h":const o=t?n.getUTCHours():n.getHours();r=o>12?o%12:o;break;case"m":r=t?n.getUTCMinutes():n.getMinutes();break;case"s":r=t?n.getUTCSeconds():n.getSeconds();break;case"f":r=t?n.getUTCMilliseconds():n.getMilliseconds()}return Number.isNaN(r)?e:r<10&&e.length>1?"0"+r:""+r})}function Ne(n,e){var t,r,i;const o=new Date(n.getTime()+(null!=(t=n.offset)?t:0));if("string"!=typeof e)return o.toISOString().replace(/\.\d+/,"").replace(/[A-Z]|\.\d+/g," ")+Ge(null!=(r=n.offset)?r:0);if(1!==e.length)return Le(o,e,!0);switch(e){case"D":case"d":return Oe(o,"first");case"T":case"t":return Oe(o,"second");case"O":case"o":return function(n,e){const t=n.toISOString();return t.substring(0,t.length-1)+Ge(e)}(o,null!=(i=n.offset)?i:0);default:throw new Error("Unrecognized Date print format")}}function Ke(n,e){const t=1===n.kind;if("string"!=typeof e)return t?n.toUTCString():n.toLocaleString();if(1!==e.length)return Le(n,e,t);switch(e){case"D":case"d":return t?Oe(n,"first"):n.toLocaleDateString();case"T":case"t":return t?Oe(n,"second"):n.toLocaleTimeString();case"O":case"o":return function(n,e){if(e)return n.toISOString();{const e=null==n.kind||2===n.kind;return u(n.getFullYear(),4)+"-"+u(n.getMonth()+1,2)+"-"+u(n.getDate(),2)+"T"+u(n.getHours(),2)+":"+u(n.getMinutes(),2)+":"+u(n.getSeconds(),2)+"."+u(n.getMilliseconds(),3)+(e?Ge(-6e4*n.getTimezoneOffset()):"")}}(n,t);default:throw new Error("Unrecognized Date print format")}}const Re=/(^|[^%])%([0+\- ]*)(\d+)?(?:\.(\d+))?(\w)/,je=/\{(\d+)(,-?\d+)?(?:\:([a-zA-Z])(\d{0,2})|\:(.+?))?\}/g;function Ue(n){return"number"==typeof n||n instanceof we||n instanceof Cn}function Je(n,e){return n instanceof we?Se(n,e)<0:n instanceof Cn?n.cmp(e)<0:n<e}function ze(n,e){return n instanceof we?pe(n,e):n instanceof Cn?n.mul(e):n*e}function Ve(n,e){return n instanceof we?String(n)+(0).toFixed(e).substr(1):n.toFixed(e)}function _e(n,e){return n instanceof we?String(n)+(0).toPrecision(e).substr(1):n.toPrecision(e)}function Ye(n,e){return n instanceof we?String(n)+(0).toExponential(e).substr(1):n.toExponential(e)}function qe(n){return n instanceof we?ye(n.unsigned?n:Me(me(n),!0),16):(Number(n)>>>0).toString(16)}function Ze(n){return{input:n,cont:(e=n,n=>Re.test(e)?function n(e,t){return(...r)=>{let i=e;for(const n of r)i=Qe(i,n);return Re.test(i)?n(i,t):t(i.replace(/%%/g,"%"))}}(e,n):n(e))};var e}function $e(n){return n.cont(n=>n)}function Qe(n,e){return n.replace(Re,(n,t,r,i,o,a)=>{let u="";if(Ue(e))switch("x"!==a.toLowerCase()&&(Je(e,0)?(e=ze(e,-1),u="-"):r.indexOf(" ")>=0?u=" ":r.indexOf("+")>=0&&(u="+")),o=null==o?null:parseInt(o,10),a){case"f":case"F":e=Ve(e,o=null!=o?o:6);break;case"g":case"G":e=null!=o?_e(e,o):_e(e);break;case"e":case"E":e=null!=o?Ye(e,o):Ye(e);break;case"x":e=qe(e);break;case"X":e=qe(e).toUpperCase();break;default:e=String(e)}if(i=parseInt(i,10),isNaN(i))e=u+e;else{const n=r.indexOf("0")>=0,t=r.indexOf("-")>=0,o=t||!n?" ":"0";e="0"===o?u+(e=rt(e,i-u.length,o,t)):rt(u+e,i,o,t)}return(t+e).replace(/%/g,"%%")})}function nt(n,...e){return"object"==typeof n&&e.length>0&&(n=e[0],e.shift()),n.replace(je,(n,t,r,i,o,a)=>{let u=e[t];if(Ue(u))switch(o=null==o?null:parseInt(o,10),i){case"f":case"F":u=Ve(u,o=null!=o?o:2);break;case"g":case"G":u=null!=o?_e(u,o):_e(u);break;case"e":case"E":u=null!=o?Ye(u,o):Ye(u);break;case"p":case"P":o=null!=o?o:2,u=Ve(ze(u,100),o)+" %";break;case"d":case"D":u=null!=o?rt(String(u),o,"0"):String(u);break;case"x":case"X":u=null!=o?rt(qe(u),o,"0"):qe(u),"X"===i&&(u=u.toUpperCase());break;default:if(a){let n="";u=a.replace(/(0+)(\.0+)?/,(e,t,r)=>(Je(u,0)&&(u=ze(u,-1),n="-"),u=Ve(u,null!=r?r.length-1:0),rt(u,(t||"").length-n.length+(null!=r?r.length:0),"0"))),u=n+u}}else u instanceof Date&&(u=function(n,e){return null!=n.offset?Ne(n,e):Ke(n,e)}(u,a||i));return r=parseInt((r||" ").substring(1),10),isNaN(r)||(u=rt(String(u),Math.abs(r)," ",r<0)),u})}function et(n,e){if(n<0)throw new Error("String length must be non-negative");const t=new Array(n);for(let r=0;r<n;r++)t[r]=e(r);return t.join("")}function tt(n,e){return Array.isArray(e)?e.join(n):Array.from(e).join(n)}function rt(n,e,t,r){t=t||" ",e-=n.length;for(let i=0;i<e;i++)n=r?n+t:t+n;return n}function it(n,e,t){if(e+(t||0)>n.length)throw new Error("Invalid startIndex and/or length");return null!=t?n.substr(e,t):n.substr(e)}const ot=b((function(n,e){const t=new F(null);this.comparer=e,t.contents=this,this.hashMap=new Map([]),this["init@20-1"]=1,xe((function(n){ct(t.contents,n[0],n[1])}),n)}));function at(n,e){const t=0|n.comparer.GetHashCode(e),r=o(n.hashMap,t,null);return r[0]?[!0,t,r[1].findIndex((function(t){return n.comparer.Equals(e,t[0])}))]:[!1,t,-1]}function ut(n,e){const t=at(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return k(n.hashMap,t[1])[t[2]];case 1:return null}}function st(n){n.hashMap.clear()}function lt(n){return 0|Xe((function(n){return n.length}),n.hashMap.values(),{GetZero:()=>0,Add:(n,e)=>n+e})}function ct(n,e,t){const r=at(n,e);switch(r[0]&&r[2]>-1?0:1){case 0:{let n;throw n=$e(Ze("An item with the same key has already been added. Key: %A"))(e),new Error(n)}case 1:if(r[0]){$t([e,t],k(n.hashMap,r[1]))}else n.hashMap.set(r[1],[[e,t]])}}function ft(n,e){const t=at(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return k(n.hashMap,t[1]).splice(t[2],1),!0;case 1:return!1}}ot.prototype[Symbol.iterator]=function(){const n=this;return Ce(Ie(Ee((function(){return ke((function(n){return Pe((function(n){return n}),n)}),n.hashMap.values())}))))},ot.prototype.Add=function(n){ct(this,n[0],n[1])},ot.prototype.Clear=function(){st(this)},ot.prototype.Contains=function(n){const e=ut(this,n[0]);switch(null!=e&&p(e[1],n[1])?0:1){case 0:return!0;case 1:return!1}},ot.prototype.CopyTo=function(n,e){De((function(t,r){n[e+t]=r}),this)},Object.defineProperty(ot.prototype,"Count",{get:function(){return 0|lt(this)}}),Object.defineProperty(ot.prototype,"IsReadOnly",{get:function(){return!1}}),ot.prototype.Remove=function(n){const e=this,t=ut(e,n[0]);if(null!=t){if(p(t[1],n[1])){ft(e,n[0])}return!0}return!1},Object.defineProperty(ot.prototype,"size",{get:function(){return 0|lt(this)}}),ot.prototype.clear=function(){st(this)},ot.prototype.delete=function(n){return ft(this,n)},ot.prototype.entries=function(){return Pe((function(n){return n}),this)},ot.prototype.get=function(n){return function(n,e){const t=ut(n,e);if(null!=t){return t[1]}throw new Error("The item was not found in collection")}(this,n)},ot.prototype.has=function(n){return function(n,e){const t=at(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return!0;case 1:return!1}}(this,n)},ot.prototype.keys=function(){return Pe((function(n){return n[0]}),this)},ot.prototype.set=function(n,e){return function(n,e,t){const r=at(n,e);switch(r[0]&&r[2]>-1?0:1){case 0:k(n.hashMap,r[1])[r[2]]=[e,t];break;case 1:if(r[0]){$t([e,t],k(n.hashMap,r[1]))}else n.hashMap.set(r[1],[[e,t]])}}(this,n,e),this},ot.prototype.values=function(){return Pe((function(n){return n[1]}),this)};const ht=b((function(n,e,...t){D.call(this,n,e,...t)}),D);function dt(n){return function n(e,t){n:for(;;){const r=e,i=t;switch(i.tag){case 1:return r+1|0;case 2:e=n(r+1,i.fields[2]),t=i.fields[3];continue n;default:return 0|r}break}}(0,n)}function gt(n,e,t){n:for(;;){const r=n,i=e,o=t;switch(o.tag){case 1:if(0===(0|r.Compare(i,o.fields[0])))return o.fields[1];throw new Error("key not found");case 2:{const a=0|r.Compare(i,o.fields[0]);if(a<0){n=r,e=i,t=o.fields[2];continue n}if(0===a)return o.fields[1];n=r,e=i,t=o.fields[3];continue n}default:throw new Error("key not found")}break}}function wt(n,e,t){n:for(;;){const r=n,i=e,o=t;switch(o.tag){case 1:return 0===r.Compare(i,o.fields[0]);case 2:{const a=0|r.Compare(i,o.fields[0]);if(a<0){n=r,e=i,t=o.fields[2];continue n}if(0===a)return!0;n=r,e=i,t=o.fields[3];continue n}default:return!1}break}}const pt=b((function(n,e){this.stack=n,this.started=e}),X);function St(n){for(;;){const e=n;if(null==e.tail)return new x;if(1===e.head.tag)return e;2!==e.head.tag?n=e.tail:n=new x(e.head.fields[2],new x(new ht(1,"MapOne",e.head.fields[0],e.head.fields[1]),new x(e.head.fields[3],e.tail)))}}function Mt(n){return new pt(St(new x(n,new x)),!1)}function mt(n){if(n.started){const e=n.stack;if(null==e.tail)return function(){throw new Error("enumeration already finished")}();if(1===e.head.tag)return[e.head.fields[0],e.head.fields[1]];throw new Error("Please report error: Map iterator, unexpected stack for current")}return function(){throw new Error("enumeration not started")}()}const yt=b((function(n){this.s=n,this.i=Mt(this.s)}));function Tt(n){return function(n){return this instanceof yt?yt.call(this,n):new yt(n)}(n)}function It(n){return Fe((function(n){return n.MoveNext()?[n.Current,n]:null}),Tt(n))}Object.defineProperty(yt.prototype,"Current",{get:function(){return mt(this.i)}}),yt.prototype.MoveNext=function(){return function(n){if(n.started){const e=n.stack;if(null==e.tail)return!1;if(1===e.head.tag)return n.stack=St(e.tail),!(null==n.stack.tail);throw new Error("Please report error: Map iterator, unexpected stack for moveNext")}return n.started=!0,!(null==n.stack.tail)}(this.i)},yt.prototype.Reset=function(){this.i=Mt(this.s)},yt.prototype.Dispose=function(){};const Ct=b((function(n,e){this.comparer=n,this.tree=e}));function At(n){return n.tree}function kt(n,e){return gt(n.comparer,e,n.tree)}function Et(n){return dt(n.tree)}function bt(n,e){return wt(n.comparer,e,n.tree)}Ct.prototype.toString=function(){return"map ["+tt("; ",Pe((function(n){return $e(Ze("(%A, %A)"))(n[0])(n[1])}),this))+"]"},Ct.prototype.GetHashCode=function(){const n=function(n,e){return(n<<1)+e+631};let e=0;const t=Tt(At(this));for(;t.MoveNext();){const r=t.Current;e=n(e,d(r[0])),e=n(e,d(r[1]))}return 0|Math.abs(e)},Ct.prototype.Equals=function(n){return 0===this.CompareTo(n)},Ct.prototype[Symbol.iterator]=function(){return Ce(Tt(this.tree))},Ct.prototype.CompareTo=function(n){const e=this;let t=0,r=!1;const o=Tt(At(e));try{const a=Tt(At(n));try{for(;!r&&0===t;){const n=[o.MoveNext(),a.MoveNext()];if(n[0])if(n[1]){const n=o.Current,r=a.Current,i=0|e.comparer.Compare(n[0],r[0]);t=0!==i?i:T(n[1],r[1])}else t=1;else n[1]?t=-1:r=!0}return 0|t}finally{i(a)&&a.Dispose()}}finally{i(o)&&o.Dispose()}},Object.defineProperty(Ct.prototype,"size",{get:function(){return 0|Et(this)}}),Ct.prototype.clear=function(){throw new Error("Map cannot be mutated")},Ct.prototype.delete=function(n){throw new Error("Map cannot be mutated")},Ct.prototype.entries=function(){return It(At(this))},Ct.prototype.get=function(n){return kt(this,n)},Ct.prototype.has=function(n){return bt(this,n)},Ct.prototype.keys=function(){return Pe((function(n){return n[0]}),It(At(this)))},Ct.prototype.set=function(n,e){throw new Error("Map cannot be mutated")},Ct.prototype.values=function(){return Pe((function(n){return n[1]}),It(At(this)))};const vt=b((function(n,e){const t=new F(null);this.comparer=e,t.contents=this,this.hashMap=new Map([]),this["init@21-2"]=1,xe((function(n){Ht(t.contents,n)}),n)}));function Wt(n,e){return this instanceof vt?vt.call(this,n,e):new vt(n,e)}function xt(n,e){const t=0|n.comparer.GetHashCode(e),r=o(n.hashMap,t,null);return r[0]?[!0,t,r[1].findIndex((function(t){return n.comparer.Equals(e,t)}))]:[!1,t,-1]}function Dt(n){n.hashMap.clear()}function Pt(n){return 0|Xe((function(n){return n.length}),n.hashMap.values(),{GetZero:()=>0,Add:(n,e)=>n+e})}function Ht(n,e){const t=xt(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return!1;case 1:if(t[0]){$t(e,k(n.hashMap,t[1]));return!0}return n.hashMap.set(t[1],[e]),!0}}function Bt(n,e){const t=xt(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return!0;case 1:return!1}}function Xt(n,e){const t=xt(n,e);switch(t[0]&&t[2]>-1?0:1){case 0:return k(n.hashMap,t[1]).splice(t[2],1),!0;case 1:return!1}}vt.prototype[Symbol.iterator]=function(){const n=this;return Ce(Ie(Ee((function(){return ke((function(n){return Pe((function(n){return n}),n)}),n.hashMap.values())}))))},vt.prototype.Add=function(n){Ht(this,n)},vt.prototype.Clear=function(){Dt(this)},vt.prototype.Contains=function(n){return Bt(this,n)},vt.prototype.CopyTo=function(n,e){De((function(t,r){n[e+t]=r}),this)},Object.defineProperty(vt.prototype,"Count",{get:function(){return 0|Pt(this)}}),Object.defineProperty(vt.prototype,"IsReadOnly",{get:function(){return!1}}),vt.prototype.Remove=function(n){return Xt(this,n)},Object.defineProperty(vt.prototype,"size",{get:function(){return 0|Pt(this)}}),vt.prototype.add=function(n){Ht(this,n);return this},vt.prototype.add_=function(n){return Ht(this,n)},vt.prototype.clear=function(){Dt(this)},vt.prototype.delete=function(n){return Xt(this,n)},vt.prototype.has=function(n){return Bt(this,n)},vt.prototype.keys=function(){return Pe((function(n){return n}),this)},vt.prototype.values=function(){return Pe((function(n){return n}),this)},vt.prototype.entries=function(){return Pe((function(n){return[n,n]}),this)};const Ft=b((function(n,e,...t){D.call(this,n,e,...t)}),D);function Gt(n){return new Ft(2,"SetOne",n)}function Ot(n,e,t,r){return new Ft(1,"SetNode",n,e,t,r)}const Lt=b((function(n,e){this.stack=n,this.started=e}),X);function Nt(n){for(;;){const e=n;if(null==e.tail)return new x;if(2===e.head.tag)return e;1!==e.head.tag?n=e.tail:n=new x(e.head.fields[1],new x(Gt(e.head.fields[0]),new x(e.head.fields[2],e.tail)))}}function Kt(n){return new Lt(Nt(new x(n,new x)),!1)}function Rt(n){if(n.started){const e=n.stack;if(null==e.tail)return function(){throw new Error("Enumeration already started")}();if(2===e.head.tag)return e.head.fields[0];throw new Error("Please report error: Set iterator, unexpected stack for current")}return function(){throw new Error("Enumeration not started")}()}const jt=b((function(n){this.s=n,this.i=Kt(this.s)}));function Ut(n){return function(n){return this instanceof jt?jt.call(this,n):new jt(n)}(n)}function Jt(n,e,t){return 0===e.tag?0===t.tag?0:-1:0===t.tag?1:0|function(n,e,t){n:for(;;){const N=n,K=e,R=t;var r,i,o,a,u,s,l,c,f,h,d,g,w,p,S,M,m,y,T,I,C,A,k,E,b,v,W,D,P,H,B,X,F,G,O,L;switch(null!=K.tail?null!=R.tail?2===R.head.tag?2===K.head.tag?(r=4,a=K.head.fields[0],u=R.head.fields[0],s=K.tail,l=R.tail):1===K.head.tag?0===K.head.fields[1].tag?(r=6,w=K.head.fields[1],p=K.head.fields[0],S=K.head.fields[2],M=R.head.fields[0],m=K.tail,y=R.tail):(r=9,W=K.head.fields[0],D=K.head.fields[1],P=K.head.fields[2],H=K.tail):(r=10,B=R.head.fields[0],X=R.tail):1===R.head.tag?0===R.head.fields[1].tag?2===K.head.tag?(r=5,c=K.head.fields[0],f=R.head.fields[0],h=R.head.fields[2],d=K.tail,g=R.tail):1===K.head.tag?0===K.head.fields[1].tag?(r=7,T=K.head.fields[0],I=K.head.fields[2],C=R.head.fields[0],A=R.head.fields[2],k=K.tail,E=R.tail):(r=9,W=K.head.fields[0],D=K.head.fields[1],P=K.head.fields[2],H=K.tail):(r=11,F=R.head.fields[0],G=R.head.fields[1],O=R.head.fields[2],L=R.tail):2===K.head.tag?(r=8,b=K.head.fields[0],v=K.tail):1===K.head.tag?(r=9,W=K.head.fields[0],D=K.head.fields[1],P=K.head.fields[2],H=K.tail):(r=11,F=R.head.fields[0],G=R.head.fields[1],O=R.head.fields[2],L=R.tail):2===K.head.tag?(r=8,b=K.head.fields[0],v=K.tail):1===K.head.tag?(r=9,W=K.head.fields[0],D=K.head.fields[1],P=K.head.fields[2],H=K.tail):(r=3,i=K.tail,o=R.tail):r=2:r=null!=R.tail?1:0,r){case 0:return 0;case 1:return-1;case 2:return 1;case 3:n=N,e=i,t=o;continue n;case 4:{const r=0|N.Compare(a,u);if(0!==r)return 0|r;n=N,e=s,t=l;continue n}case 5:{const r=0|N.Compare(c,f);if(0!==r)return 0|r;n=N,e=new x(new Ft(0,"SetEmpty"),d),t=new x(h,g);continue n}case 6:{const r=0|N.Compare(p,M);if(0!==r)return 0|r;n=N,e=new x(S,m),t=new x(w,y);continue n}case 7:{const r=0|N.Compare(T,C);if(0!==r)return 0|r;n=N,e=new x(I,k),t=new x(A,E);continue n}case 8:n=N,e=new x(new Ft(0,"SetEmpty"),new x(Gt(b),v)),t=R;continue n;case 9:n=N,e=new x(D,new x(Ot(W,new Ft(0,"SetEmpty"),P,0),H)),t=R;continue n;case 10:n=N,e=K,t=new x(new Ft(0,"SetEmpty"),new x(Gt(B),X));continue n;case 11:n=N,e=K,t=new x(G,new x(Ot(F,new Ft(0,"SetEmpty"),O,0),L));continue n}break}}(n,new x(e,new x),new x(t,new x))}Object.defineProperty(jt.prototype,"Current",{get:function(){return Rt(this.i)}}),jt.prototype.MoveNext=function(){return function(n){if(n.started){const e=n.stack;if(null==e.tail)return!1;if(2===e.head.tag)return n.stack=Nt(e.tail),!(null==n.stack.tail);throw new Error("Please report error: Set iterator, unexpected stack for moveNext")}return n.started=!0,!(null==n.stack.tail)}(this.i)},jt.prototype.Reset=function(){this.i=Kt(this.s)},jt.prototype.Dispose=function(){};const zt=b((function(n,e){this.comparer=n,this.tree=e}));function Vt(n){return n.comparer}function _t(n){return n.tree}function Yt(n,e){return Wt(n,e)}zt.prototype.toString=function(){return"set ["+tt("; ",Pe((function(n){return String(n)}),this))+"]"},zt.prototype.GetHashCode=function(){let n=0;const e=Ut(_t(this));for(;e.MoveNext();){n=((0|n)<<1)+(0|d(e.Current))+631}return 0|Math.abs(n)},zt.prototype.Equals=function(n){return 0===Jt(Vt(this),_t(this),_t(n))},zt.prototype.CompareTo=function(n){return 0|Jt(Vt(this),_t(this),_t(n))},zt.prototype[Symbol.iterator]=function(){return Ce(Ut(_t(this)))};function qt(n,e,t){if(ArrayBuffer.isView(e)){const r=0|e.length,i=new t(r);for(let t=0;t<=r-1;t++)i[t]=n(e[t]);return i}return e.map((function(e){return n(e)}))}function Zt(n,e){var t;const r=Array.isArray(n)?n:Array.from(n);switch(0|r.length){case 0:return new e(0);case 1:return r[0];default:if(t=r[0],ArrayBuffer.isView(t)){let n=0,t=0;for(let n=0;n<=r.length-1;n++){t+=r[n].length}const i=new e(t);for(let e=0;e<=r.length-1;e++){const t=r[e];for(let e=0;e<=t.length-1;e++)i[n]=t[e],n+=1}return i}return r[0].concat(...r.slice(1))}}function $t(n,e){e.push(n)}function Qt(n,e){return e.from(n)}function nr(n,e,t){return function(n,e,t,r){for(;;){const i=n,o=e,a=t,u=r;if(null==u.tail)return a;n=i,e=o+1,t=i(o,a,u.head),r=u.tail}}(n,0,e,t)}function er(n,e,t){for(;;){const r=n,i=e,o=t;if(null==o.tail)return i;n=r,e=r(i,o.head),t=o.tail}}function tr(n){return er((function(n,e){return new x(e,n)}),new x,n)}function rr(n,e,t){return er((function(e,t){return n(t,e)}),t,tr(e))}function ir(n){return tr(We((function(n,e){return new x(e,n)}),new x,n))}function or(n){return er((function(n,e){return n+1}),0,n)}function ar(n,e){return er((function(n,e){return new x(e,n)}),e,tr(n))}function ur(n,e){return tr(er((function(e,t){return new x(n(t),e)}),new x,e))}function sr(n,e){return tr(nr((function(e,t,r){return new x(n(e,r),t)}),new x,e))}function lr(n,e){er((function(e,t){n(t)}),null,e)}function cr(n){let e=new x;for(let t=function(n){if(r(n))return n.length;{let e=0;for(const t of n)e++;return e}}(n)-1;t>=0;t--)e=new x(n[t],e);return e}function fr(n,e){return function(n,e,t){n:for(;;){const r=n,i=e,o=t;if(null!=o.tail){const a=r(i,o.head);if(null==a){n=r,e=i+1,t=o.tail;continue n}return a}return null}}(n,0,e)}function hr(n,e){return fr((function(e,t){return n(t)}),e)}function dr(n,e){return fr((function(e,t){return n(e,t)?sn(t):null}),e)}function gr(n,e){return fr((function(e,t){return n(t)?sn(t):null}),e)}function wr(n,e){const t=dr(n,e);if(null!=t){return ln(t)}throw new Error("List did not contain any matching elements")}function pr(n,e){return wr((function(e,t){return n===e}),e)}function Sr(n,e){return tr(er((function(e,t){return n(t)?new x(t,e):e}),new x,e))}function Mr(n,e){if(null!=e.tail)return er(n,e.head,e.tail);throw new Error("List was empty")}function mr(n,e){return er((function(e,t){return!!e&&n(t)}),!0,e)}function yr(n,e){for(;;){const t=n,r=e;if(null==r.tail)return!1;if(t(r.head))return!0;n=t,e=r.tail}}function Tr(n,e,t){let r;const i=Qt(e,Array);return i.sort((function(e,r){return-1*t.Compare(n(e),n(r))})),r=i,cr(r)}function Ir(n,e,t){const r=Yt([],t);return Sr((function(e){return a(n(e),r)}),e)}function Cr(n,e,t,r){return new nn(e,n,t,r)}const Ar=cr([Cr(new Q(1,"MagentaColourKey"),"MilitaryFontRed.png",296,8),Cr(new Q(1,"MagentaColourKey"),"MilitaryFontYellow.png",296,8),Cr(new Q(1,"MagentaColourKey"),"MilitaryFontBlue.png",296,8),Cr(new Q(1,"MagentaColourKey"),"MilitaryFontBlack.png",296,8),Cr(new Q(1,"MagentaColourKey"),"MilitaryFontSymbols.png",296,8)]),kr=cr([Cr(new Q(0,"NoColourKey"),"CliffsTile.png",89,200),Cr(new Q(1,"MagentaColourKey"),"Title.png",297,20),Cr(new Q(0,"NoColourKey"),"Map.png",320,160),Cr(new Q(1,"MagentaColourKey"),"AlliedFleetSymbol.png",21,21),Cr(new Q(1,"MagentaColourKey"),"EnemyFleetSymbol.png",20,20),Cr(new Q(0,"NoColourKey"),"SecretPassage.png",320,160),Cr(new Q(1,"MagentaColourKey"),"Mine.png",6,8),Cr(new Q(1,"MagentaColourKey"),"Ship0.png",40,13),Cr(new Q(1,"MagentaColourKey"),"Ship1.png",34,18),Cr(new Q(1,"MagentaColourKey"),"Ship2.png",31,21),Cr(new Q(1,"MagentaColourKey"),"Ship3.png",26,26),Cr(new Q(1,"MagentaColourKey"),"Ship4.png",12,36),Cr(new Q(1,"MagentaColourKey"),"Torpedo0.png",8,2),Cr(new Q(1,"MagentaColourKey"),"Torpedo22degrees.png",8,5),Cr(new Q(1,"MagentaColourKey"),"ShipExplode0.png",25,25),Cr(new Q(1,"MagentaColourKey"),"ShipExplode1.png",50,37),Cr(new Q(1,"MagentaColourKey"),"ShipExplode2.png",50,49),Cr(new Q(1,"MagentaColourKey"),"ShipExplode3.png",50,49),Cr(new Q(1,"MagentaColourKey"),"Plane0.png",6,2),Cr(new Q(1,"MagentaColourKey"),"Plane1.png",18,6),Cr(new Q(1,"MagentaColourKey"),"Plane2.png",31,10),Cr(new Q(1,"MagentaColourKey"),"Plane3.png",49,19),Cr(new Q(1,"MagentaColourKey"),"Plane4.png",72,26),Cr(new Q(1,"MagentaColourKey"),"Plane4BankingLeft.png",62,21),Cr(new Q(1,"MagentaColourKey"),"Plane4BankingRight.png",62,21),Cr(new Q(1,"MagentaColourKey"),"Plane5.png",73,22),Cr(new Q(1,"MagentaColourKey"),"Plane5BankingLeft.png",66,20),Cr(new Q(1,"MagentaColourKey"),"Plane5BankingRight.png",66,20),Cr(new Q(1,"MagentaColourKey"),"Plane6.png",71,27),Cr(new Q(1,"MagentaColourKey"),"Plane6BankingLeft.png",69,26),Cr(new Q(1,"MagentaColourKey"),"Plane6BankingRight.png",69,26),Cr(new Q(1,"MagentaColourKey"),"PlaneExplode0.png",45,23),Cr(new Q(1,"MagentaColourKey"),"PlaneExplode1.png",51,26),Cr(new Q(1,"MagentaColourKey"),"PlaneExplode2.png",35,19),Cr(new Q(1,"MagentaColourKey"),"Splash0.png",12,9),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb0.png",2,2),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb1.png",4,4),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb2.png",6,6),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb3.png",10,10),Cr(new Q(1,"MagentaColourKey"),"PlaneBomb4.png",12,12),Cr(new Q(1,"MagentaColourKey"),"SeaBattleBackground0.png",320,160),Cr(new Q(1,"MagentaColourKey"),"SeaBattleBackground1.png",320,160),Cr(new Q(1,"MagentaColourKey"),"SeaBattleBackground2.png",320,160),Cr(new Q(1,"MagentaColourKey"),"SeaBattleBackground3.png",320,160),Cr(new Q(1,"MagentaColourKey"),"EnemyShip0.png",12,15),Cr(new Q(1,"MagentaColourKey"),"EnemyShip1.png",32,16),Cr(new Q(1,"MagentaColourKey"),"EnemyShip2.png",67,16),Cr(new Q(1,"MagentaColourKey"),"EnemyShip3.png",12,15),Cr(new Q(1,"MagentaColourKey"),"EnemyShip4.png",34,16),Cr(new Q(0,"NoColourKey"),"TankBattleMissile.png",12,1),Cr(new Q(0,"NoColourKey"),"TileBarricade.png",16,16),Cr(new Q(0,"NoColourKey"),"TileBridge.png",16,16),Cr(new Q(0,"NoColourKey"),"TileMine.png",16,16),Cr(new Q(0,"NoColourKey"),"TileSand.png",16,16),Cr(new Q(0,"NoColourKey"),"TileTower.png",16,16),Cr(new Q(0,"NoColourKey"),"TileWater.png",16,16),Cr(new Q(1,"MagentaColourKey"),"EnemyTankGun1.png",24,12),Cr(new Q(1,"MagentaColourKey"),"TankFacingLeft0.png",24,12),Cr(new Q(1,"MagentaColourKey"),"TankFacingUpLeft0.png",24,14),Cr(new Q(1,"MagentaColourKey"),"TankFacingDownLeft0.png",24,14),Cr(new Q(1,"MagentaColourKey"),"TankFacingLeft1.png",24,12),Cr(new Q(1,"MagentaColourKey"),"TankFacingUpLeft1.png",24,14),Cr(new Q(1,"MagentaColourKey"),"TankFacingDownLeft1.png",24,14),Cr(new Q(0,"NoColourKey"),"FinalBossBackground.png",320,160),Cr(new Q(1,"MagentaColourKey"),"FinalBoss0.png",207,43),Cr(new Q(1,"MagentaColourKey"),"FinalBoss1.png",152,42),Cr(new Q(1,"MagentaColourKey"),"FinalBoss2.png",94,42),Cr(new Q(1,"MagentaColourKey"),"FinalBoss3.png",94,42),Cr(new Q(1,"MagentaColourKey"),"FinalBoss4.png",94,42),Cr(new Q(1,"MagentaColourKey"),"FinalBoss5.png",94,42),Cr(new Q(1,"MagentaColourKey"),"FinalBossSurrender0.png",16,35),Cr(new Q(1,"MagentaColourKey"),"FinalBossSurrender1.png",16,35),Cr(new Q(1,"MagentaColourKey"),"FinalBossActiveTarget.png",4,4),Cr(new Q(1,"MagentaColourKey"),"FinalBossTarget.png",4,4),Cr(new Q(1,"MagentaColourKey"),"ShipGunNozzle.png",16,8),Cr(new Q(0,"NoColourKey"),"ShipGunStem.png",12,1),Cr(new Q(1,"MagentaColourKey"),"ShipGunBullet.png",16,8),Cr(new Q(0,"NoColourKey"),"IntermissionBackground.png",320,200),Cr(new Q(0,"NoColourKey"),"VictoryScreen.png",320,200),Cr(new Q(1,"MagentaColourKey"),"ColonelReceivingMedal.png",70,130),Cr(new Q(1,"MagentaColourKey"),"ColonelSaluting.png",72,130),Cr(new Q(1,"MagentaColourKey"),"ColonelStanding.png",50,130),Cr(new Q(1,"MagentaColourKey"),"SoldierSaluting.png",54,120),Cr(new Q(1,"MagentaColourKey"),"SoldierStanding.png",54,120),Cr(new Q(1,"MagentaColourKey"),"Medal.png",7,16),Cr(new Q(1,"MagentaColourKey"),"PresidentPresentingMedal.png",66,130),Cr(new Q(1,"MagentaColourKey"),"PresidentSaluting.png",62,130),Cr(new Q(1,"MagentaColourKey"),"PresidentStanding.png",39,130)]),Er=function(n){let e=n;return n=>void 0===n?e:void(e=n)}([]);const br=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const vr=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const Wr=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const xr=Math.fround(320),Dr=(Math.fround(200),new br(0,"FontID",0)),Pr=new br(0,"FontID",1),Hr=new br(0,"FontID",2),Br=new br(0,"FontID",3),Xr=new br(0,"FontID",4),Fr=new en(0,"ImageID",0),Gr=new en(0,"ImageID",1),Or=new en(0,"ImageID",2),Lr=new en(0,"ImageID",3),Nr=new en(0,"ImageID",4),Kr=new en(0,"ImageID",5),Rr=new en(0,"ImageID",6),jr=new en(0,"ImageID",7),Ur=new en(0,"ImageID",8),Jr=new en(0,"ImageID",9),zr=new en(0,"ImageID",10),Vr=new en(0,"ImageID",11),_r=new en(0,"ImageID",12),Yr=new en(0,"ImageID",13),qr=new en(0,"ImageID",14),Zr=new en(0,"ImageID",15),$r=new en(0,"ImageID",16),Qr=new en(0,"ImageID",17),ni=new en(0,"ImageID",18),ei=new en(0,"ImageID",19),ti=new en(0,"ImageID",20),ri=new en(0,"ImageID",21),ii=new en(0,"ImageID",22),oi=new en(0,"ImageID",23),ai=new en(0,"ImageID",24),ui=new en(0,"ImageID",25),si=new en(0,"ImageID",26),li=new en(0,"ImageID",27),ci=new en(0,"ImageID",28),fi=new en(0,"ImageID",29),hi=new en(0,"ImageID",30),di=new en(0,"ImageID",31),gi=new en(0,"ImageID",32),wi=new en(0,"ImageID",33),pi=new en(0,"ImageID",34),Si=new en(0,"ImageID",35),Mi=new en(0,"ImageID",36),mi=new en(0,"ImageID",37),yi=new en(0,"ImageID",38),Ti=new en(0,"ImageID",39),Ii=new en(0,"ImageID",40),Ci=new en(0,"ImageID",41),Ai=new en(0,"ImageID",42),ki=new en(0,"ImageID",43),Ei=new en(0,"ImageID",44),bi=new en(0,"ImageID",45),vi=new en(0,"ImageID",46),Wi=new en(0,"ImageID",47),xi=new en(0,"ImageID",48),Di=(new en(0,"ImageID",49),new en(0,"ImageID",50)),Pi=new en(0,"ImageID",51),Hi=new en(0,"ImageID",52),Bi=new en(0,"ImageID",53),Xi=new en(0,"ImageID",54),Fi=new en(0,"ImageID",55),Gi=new en(0,"ImageID",56),Oi=new en(0,"ImageID",57),Li=new en(0,"ImageID",58),Ni=new en(0,"ImageID",59),Ki=new en(0,"ImageID",60),Ri=new en(0,"ImageID",61),ji=new en(0,"ImageID",62),Ui=new en(0,"ImageID",63),Ji=new en(0,"ImageID",64),zi=new en(0,"ImageID",65),Vi=new en(0,"ImageID",66),_i=new en(0,"ImageID",67),Yi=new en(0,"ImageID",68),qi=new en(0,"ImageID",69),Zi=new en(0,"ImageID",70),$i=new en(0,"ImageID",71),Qi=new en(0,"ImageID",72),no=new en(0,"ImageID",73),eo=new en(0,"ImageID",74),to=new en(0,"ImageID",75),ro=new en(0,"ImageID",76),io=new en(0,"ImageID",77),oo=new en(0,"ImageID",78),ao=new en(0,"ImageID",79),uo=new en(0,"ImageID",80),so=new en(0,"ImageID",81),lo=new en(0,"ImageID",82),co=new en(0,"ImageID",83),fo=new en(0,"ImageID",84),ho=new en(0,"ImageID",85),go=new en(0,"ImageID",86),wo=new en(0,"ImageID",87),po=Math.fround(12),So=(Math.fround(1),Math.fround(16)),Mo=(Math.fround(8),Math.fround(16),b((function(n,e,...t){D.call(this,n,e,...t)}),D));function mo(n,e){let t;return t=function(n,e){let t=new x,r=new x,i=e;for(;null!=i.tail;)if(null!=i.tail){const e=i.tail,o=n(i.head);switch(o.tag){case 1:r=new x(o.fields[0],r);break;case 2:break;default:t=new x(o.fields[0],t)}i=e}return[t,r]}(n,e),[tr(t[0]),tr(t[1])]}const yo=[["T----------X-------------WWWW------WW-WW---","X-T--------X-T-T----------WW-----WWW-WWWW--","X----------X------W-------W->------WWW--WW-","X----------X------WW-T->--W----------------","X------X---X---T--WWW----------------------","->-WWW-X---X-----WWWW--------\x3e-----WW------","----\x3e--X--------WWWW--------------WWW------","--T-T--X------\x3e--------T--XX-----WWW---WWWW","T------X-----------------XXXX-----------WWW"],["WW-------X-----WWWWW-M---X---WWWWWWWWW-X","W--XXXXXXXXXX---W-W-WM->-X----W-WWW-W--X","W----------\x3e-------=======----------T--X","WW---XXXXXXXX----X--MM>--X--X----X->X---","==--X--=====---\x3e-X--M-------X-------X--X","WW-X-----X->-----X-----MMX>-X----X-----X","==------X>----------MMM--X-------X--T--X","W-T------X---\x3e----WWM--\x3e-X------XXX----X","W-XXXX---X------XXXXM----X-------X-----X"],["XXX--XX--XXXXXXXXXXXXX----X-WW---T-------WWWW","--X-X--XX--WWW--WWWW------X-W--T---M----WWWW-","---X--------WWWWW---------X-------MMM----W>W-","-----\x3e--------WWWWW-------X---XXXMMMMM---WWWW","->-----------WWWWWW---X>--XT-----\x3e-------====","-----\x3e------\x3e-W====---X-------XXXMMMMM---WWWW","---X------\x3e-=====WWW--X>----------MMM---\x3e====","--X-X--XX------WW-----X--------T---M-----WWW-","XXX--XX--XXXXXXXXXXXXXX---WWW----T-----WWWWW-"],["-WWWWW-X--XMMM--T-----X----WWWWWWWWWWWW--WW","W-WWW--X>-XMMM---WWT--X----WWWW-WWWWWW-WW--","----T--X--XMMM>-------X---===-----W--W-----","-X->X-----=-------X---X>----WWW==----------","----X--X--X>--\x3e---X>--X----=========-------","-X-----X-----------X>-------WWW==----------","-X--T--X--XMMM--T--X------WW>---------W----","XXX----X>-XMMM-T-T-X-------WWWWWWWWWWWWW---","-X-----X--XMMM-----X---M---WWMMMMWWWMWWMWWW"]],To=b((function(n,e){this.etx=0|n,this.ety=0|e}),X);const Io=b((function(n,e,t){this.TilesHorizontally=0|n,this.TilesArray=e,this.EnemyTanks=t}),X);function Co(n){switch(n){case"-":return Bi;case"=":return Pi;case">":return Bi;case"M":return Hi;case"T":return Xi;case"W":return Fi;case"X":return Di;default:return null}}function Ao(n){return e=function(n){let e;return e=Co(n),null!=e},!ve(n=>!e(n),n.split(""));var e}function ko(n){if(n.length<9)return new fn(1,"Error","Map matrix file has insufficient rows.");if(function(n){if(n.length>=9){return mr((function(e){return n[e].length===n[0].length}),ir(He(0,1,8)))}return!1}(n)){if(function(n){if(n.length>=9){return n.slice(0,9).every(Ao)}return!1}(n)){let t;return t=qt((function(n){return"-----"+n+"-----"}),n.slice(0,9),Array),new fn(0,"Ok",new Io(t[0].length,(e=t,Zt(Ee((function(){return Pe((function(n){let t;return t=Pe((function(n){let e;return e=Co(n),cn(e,Bi)}),e[n].split("")),r=t,Array.from(r);var r}),He(0,1,8))})),Array)),function(n){if(n.length>0){const e=0|n[0].length;return ir(Ee((function(){return ke((function(t){const r=n[t];return ke((function(n){return">"===r[n]?Be(new To(n,t)):be()}),He(0,1,e-1))}),He(0,1,8))})))}return new x}(t)))}return new fn(1,"Error","The map matrix contains illegal characters.")}return new fn(1,"Error","The map matrix rows must all be the same length.");var e}function Eo(n){let e;return e=ko(yo[n]),hn((function(e){return $e(Ze("TankMapDefinitions.[%d]: Error: %s"))(n)(e)}),e)}const bo=b((function(n,e){this.NewPlayerName=n,this.NewPlayerScore=e}),X);const vo=b((function(n,e,t){this.PlayerName=n,this.PlayerScore=e,this.PlayerScoreString=t}),X);function Wo(n){return n.PlayerScore}function xo(n,e){if(p(n,new x))return!1;{let i,o;return t=Wo,r={Compare:M},o=Mr((function(n,e){return r.Compare(t(e),t(n))>0?n:e}),n),i=Wo(o),e>=i}var t,r}function Do(n,e){if(xo(e,n.NewPlayerScore)){let t,r;return r=function(n,e,t){let r;const i=Qt(e,Array);return i.sort((function(e,r){return t.Compare(n(e),n(r))})),r=i,cr(r)}(Wo,new x(new vo(n.NewPlayerName.trim(),n.NewPlayerScore,n.NewPlayerScore.toString()),e),{Compare:M}),t=function(n){if(null!=n.tail)return n.tail;throw new Error("List was empty")}(r),Tr(Wo,t,{Compare:M})}return e}function Po(n,e){return ur((function(e){return function(n,e,t){const r=(0|n.length)+(0|e.length)+2|0;return r>t?"":n+" "+et(t-r|0,(function(n){return"."}))+" "+e}(e.PlayerName,e.PlayerScoreString,n)}),e)}const Ho=b((function(n){this.GameScoreBoard=n}),X);function Bo(){return new Ho(function(n,e,t){let r;return r=sr((function(n,r){const i=e+(n>>>0)*t;return new vo(r,i,i.toString())}),n),Tr(Wo,r,{Compare:M})}(cr(["Bob","Scott","Lara","J"]),5e3,1e3))}function Xo(n){return Er()[n.fields[0]]}function Fo(n,e,t,r){return n(new Wr(0,"DrawImageWithTopLeftAtInt",e,t,r))}function Go(n,e,t,r,i,o){return n(new Wr(2,"DrawStretchedImageWithTopLeftAt",e,t,r,i,o))}function Oo(n,e,t,r){let i;i=an(r);const o=e-i[0]/Math.fround(2),a=t-i[1]/Math.fround(2);return n(new Wr(2,"DrawStretchedImageWithTopLeftAt",o,a,r,i[0],i[1]))}function Lo(n,e,t,r,i,o){const a=0|r.length,u=i/a,s=Math.abs(~~(o/u))%a|0;s<a&&Oo(n,e,t,r[s])}function No(n,e,t,r,i,o){return n(new Wr(1,"DrawFilledRectangle",e,t,r,i,o))}function Ko(n,e,t,r,i,o,a){!function(n,e,t,r,i,o,a,u){const s=function(n){return n.length*e};let l=0|(1===a.tag?r-~~(s(o)/2):2===a.tag?r-s(o):r);const c=0|(1===u.tag?i-~~(t/2):2===u.tag?i-t:i);xe((function(t){const r=function(e){n(e,l,c)};t>="0"&&t<="9"?r(t.charCodeAt(0)-48):t>="A"&&t<="Z"?r(t.charCodeAt(0)-55):t>="a"&&t<="z"?r(t.charCodeAt(0)-87):"."===t&&r(36),l+=e}),o.split(""))}((function(t,r,i){n(new Wr(4,"DrawCharImageWithTopLeftAt",r,i,t>>>0,e))}),8,8,i,o,a,t,r)}function Ro(n,e,t,r,i,o,a){Ko(n,e,t,r,i,o,a.toString())}function jo(n,e,t,r,i,o,a,u){var s;s=function(u,s){Ko(n,e,t,r,i,o+a*u|0,s)},nr((function(n,e,t){s(n,t)}),null,u)}function Uo(n,e){let t;let r;t=~~(e*Math.fround(5))%89-89|0,r=Xo(Fr);for(let e=1;e<=5;e++)Fo(n,t,0,r),t+=89}const Jo=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const zo=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const Vo=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const _o=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const Yo=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const qo=Math.fround(2),Zo=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const $o=b((function(n,e,t,r){this.ScreenStartTime=n,this.GameGlobalState=e,this.HiScore=t,this.State=r}),X);function Qo(n,e,t){const r=new Zo(0,"GameTitleAwaitingFireButton");return new $o(t,e,n,r)}const na=b((function(n,e){this.ptx=n,this.pty=e}),X);const ea=b((function(n,e){this.modx=n,this.mody=e}),X);const ta=b((function(n,e,t,r){this.Left=n,this.Top=e,this.Right=t,this.Bottom=r}),X);function ra(n,e){return n.ptx<e.ptx}function ia(n,e){return n.ptx>e.ptx}function oa(n,e,t){return Math.abs(n.ptx-t.ptx)<e&&Math.abs(n.pty-t.pty)<e}function aa(n,e){return e.ptx>=n.Left&&e.ptx<=n.Right&&e.pty>=n.Top&&e.pty<=n.Bottom}function ua(n,e){return new na(e.ptx+n.modx,e.pty+n.mody)}const sa=Math.fround(20),la=Math.fround(.30000001192092896),ca=Math.fround(.30000001192092896),fa=new na(Math.fround(97),Math.fround(129)),ha=Math.fround(2),da=new ta(Math.fround(134),Math.fround(35),Math.fround(147),Math.fround(47)),ga=new ta(Math.fround(86),Math.fround(75),Math.fround(238),Math.fround(139)),wa=new ta(Math.fround(68),Math.fround(130),Math.fround(91),Math.fround(141));function pa(n,e,t){let r;return r=ua(function(n,e){const t=function(e,t){return e.Held&&t.Held?Math.fround(0):e.Held?-n:t.Held?n:Math.fround(0)};return new ea(t(e.Left,e.Right),t(e.Up,e.Down))}(la,e),n),i=r,yr((function(n){return aa(n,i)}),t)?r:n;var i}function Sa(n,e){const t=aa(ga,r=e)?r:fa;var r;if(oa(t,Math.fround(1),n))return n;{let e;return e=function(n,e,t){var r,i;return new ea((r=n.ptx-t.ptx)>e?e:r<Math.fround(0)?-e:Math.fround(0),(i=n.pty-t.pty)>e?e:i<Math.fround(0)?-e:Math.fround(0))}(t,ca,n),ua(e,n)}}const Ma=b((function(n,e){this.Score=n,this.HiScore=e}),X);function ma(n,e){const t=e.Score+n;return new Ma(t,C(M,t,e.HiScore))}const ya=b((function(n,e,t,r,i){this.BlueCount=n,this.RedCount=e,this.RedCharIndex=t,this.BlueCharIndex=r,this.CharSpacing=i}),X);function Ta(n,e,t,r){let i,o=0|e;const a=0|~~r.CharSpacing;i=a;const u=function(e,r,a){let u=e;for(;u>0;)n(new Wr(4,"DrawCharImageWithTopLeftAt",o,t,r,a)),u-=1,o+=i};u(r.BlueCount,r.BlueCharIndex,Xr),u(r.RedCount,r.RedCharIndex,Xr)}function Ia(n,e){return No(n,0,e,320,200-e,new vr(0,"SolidColour",0))}function Ca(n){return 2*n}const Aa=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const ka=b((function(n,e,t,r,i,o,a){this.ScoreAndHiScore=n,this.ShipsPending=e,this.ShipsThrough=t,this.Tanks=r,this.Damage=i,this.Ammunition=o,this.Elevation=a}),X);function Ea(n,e,t){const r=e+4|0;Ko(n,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),4,r,"SCORE"),Ro(n,Dr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),68,r,t.ScoreAndHiScore.Score);const i=r+12|0;var o;Ko(n,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),4,i,"SHIPS"),Ta(n,68,i,new ya((o=t).ShipsThrough,o.ShipsPending,2,4,8));const a=r+24|0;Ko(n,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),4,a,"DAMAGE"),Ro(n,Hr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),68,a,t.Damage);const u=r+16|0;Ko(n,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),160,u,"TANKS"),Ta(n,208,u,new ya(t.Tanks,0,1,3,8));const s=r+24|0;var l,c,f,h,d,g,w;Ko(n,Pr,new Jo(0,"LeftAlign"),new zo(0,"TopAlign"),160,s,"ELEVATION"),l=n,c=Hr,f=new Jo(0,"LeftAlign"),h=new zo(0,"TopAlign"),d=256,g=s,w=t.Elevation,Ko(l,c,f,h,d,g,nt("{0:#.##}",w))}const ba=new na(Math.fround(290),Math.fround(15)),va=cr([new ta(Math.fround(38),Math.fround(7),Math.fround(310),Math.fround(19)),new ta(Math.fround(125),Math.fround(19),Math.fround(310),Math.fround(35)),new ta(Math.fround(133),Math.fround(35),Math.fround(310),Math.fround(41)),new ta(Math.fround(168),Math.fround(41),Math.fround(310),Math.fround(50)),new ta(Math.fround(200),Math.fround(49),Math.fround(310),Math.fround(139)),new ta(Math.fround(86),Math.fround(75),Math.fround(276),Math.fround(139)),da,wa]),Wa=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const xa=b((function(n,e,t,r){this.ScoreAndHiScore=n,this.EnemyFleetCentre=e,this.AlliedState=t,this.NumShips=r}),X);function Da(n,e){const t=new Wa(0,"MapInPlay",ba);return new xa(e,fa,t,n)}const Pa=b((function(n,e,...t){D.call(this,n,e,...t)}),D);function Ha(n,e,t){let r;var i,o,a;switch(1===n.AlliedState.tag?1:3===n.AlliedState.tag||2===n.AlliedState.tag?2:0){case 0:{const u=pa(n.AlliedState.fields[0],e,va),s=Sa(n.EnemyFleetCentre,u),l=(o=s,a=t,aa(da,i=u)?new Wa(1,"FleetEngagedOnMap",i,a,new Wa(2,"ScreenOverEngagedSecretPassage")):oa(o,sa,i)?new Wa(1,"FleetEngagedOnMap",i,a,new Wa(3,"ScreenOverEngagedEnemyAtSea")):new Wa(0,"MapInPlay",i));r=new xa(n.ScoreAndHiScore,s,l,n.NumShips);break}case 1:r=t-n.AlliedState.fields[1]>ha?new xa(n.ScoreAndHiScore,n.EnemyFleetCentre,n.AlliedState.fields[2],n.NumShips):n;break;case 2:r=n}switch(1===r.AlliedState.tag?0:2===r.AlliedState.tag?1:3===r.AlliedState.tag?2:0){case 0:return new Pa(0,"StayOnInitialMap",r);case 1:return new Pa(1,"GoToSecretPassage",r);case 2:return new Pa(2,"GoToBattleAtSea",r)}}function Ba(n,e,t){const r=e(t);let i;return i=gr((function(n){const t=e(n);return p(r,t)}),n),null==i}function Xa(n,e){return mr(n,e)?e:Sr(n,e)}const Fa=b((function(n,e,...t){D.call(this,n,e,...t)}),D);function Ga(n,e,t,r,i){const o=(t.ptx-e.ptx)/i,a=(t.pty-e.pty)/i;return function(t){const u=t-r;if(u>=Math.fround(0)){if(u<=i){const t=n(u,i),r=e.ptx+o*t,s=e.pty+a*t;return new Fa(1,"MOMVisibleAtPosition",new na(r,s))}return new Fa(2,"MOMDisappeared")}return new Fa(0,"MOMYetToAppear")}}function Oa(n,e){return n}function La(n,e){const t=n/e;return t*t*e}function Na(n,e){const t=n/e,r=Math.fround(1)-t;return(Math.fround(1)-r*r)*e}const Ka=b((function(n,e,t,r){this.PositionGetter=n,this.StartPosition=e,this.FinalPosition=t,this.EndGameTime=r}),X);function Ra(n,e,t){return new Ka(function(n,e,t){const r=e+t;return function(t){return t>=e?t<=r?new Fa(1,"MOMVisibleAtPosition",n):new Fa(2,"MOMDisappeared"):new Fa(0,"MOMYetToAppear")}}(n,e,t),n,n,e+t)}function ja(n,e,t,r,i){return new Ka(Ga(n,e,t,r,i),e,t,r+i)}function Ua(n,e){const t=e.PositionGetter(n);switch(t.tag){case 0:return e.StartPosition;case 2:return e.FinalPosition;default:return t.fields[0]}}function Ja(n,e){return n<=e.EndGameTime}const za=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const Va=b((function(n,e,t,r){this.FlickBookDuration=n,this.FlickBookImages=e,this.VisibilityBeforeStart=t,this.VisibilityAfterEnd=r}),X);const _a=b((function(n,e,t){this.FlickBookType=n,this.FlickBookStartTime=e,this.FlickBookMechanicsObject=t}),X);function Ya(n){return n.FlickBookStartTime}function qa(n,e){return Ua(n,e.FlickBookMechanicsObject)}function Za(n,e,t){return Xa((function(t){return r=n,i=e(t),Ja(r,i.FlickBookMechanicsObject);var r,i}),t)}function $a(n,e){return Za(n,(function(n){return n}),e)}function Qa(n,e,t){const r=t-e.FlickBookStartTime,i=0|e.FlickBookType.FlickBookImages.length,o=e.FlickBookMechanicsObject.PositionGetter(t);switch(o.tag){case 1:{const t=e.FlickBookType.FlickBookDuration/i,a=0|Math.abs(~~(r/t));a<i&&Oo(n,o.fields[0].ptx,o.fields[0].pty,e.FlickBookType.FlickBookImages[a]);break}case 2:p(e.FlickBookType.VisibilityAfterEnd,new za(0,"Visible"))&&i>0&&Oo(n,e.FlickBookMechanicsObject.FinalPosition.ptx,e.FlickBookMechanicsObject.FinalPosition.pty,e.FlickBookType.FlickBookImages[e.FlickBookType.FlickBookImages.length-1]);break;default:p(e.FlickBookType.VisibilityBeforeStart,new za(0,"Visible"))&&i>0&&Oo(n,e.FlickBookMechanicsObject.StartPosition.ptx,e.FlickBookMechanicsObject.StartPosition.pty,e.FlickBookType.FlickBookImages[0])}}function nu(n,e,t,r){lr((function(t){Qa(n,e(t),r)}),t)}function eu(n,e,t){nu(n,(function(n){return n}),e,t)}const tu=Math.fround(4),ru=Math.fround(4),iu=Math.fround(10),ou=Math.fround(3),au=Math.fround(.75);function uu(){return new Va(au,qt(Xo,[qr,Zr,$r,Qr],Array),new za(1,"Hidden"),new za(1,"Hidden"))}const su=b((function(n,e,t){this.ShipsStillToNavigate=n,this.ShipsSuccess=e,this.Score=t}),X);const lu=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const cu=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const fu=b((function(n,e,t){this.ShipRotation=n,this.ShipSpeed=e,this.ShipCentre=t}),X);const hu=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const du=b((function(n){this.MineLocation=n}),X);const gu=b((function(n,e,t){this.TorpedoLaunchDetail=n,this.TorpedoPositionGetter=e,this.TorpedoIsHorizontal=t}),X);const wu=b((function(n,e,t,r,i){this.FleetStats=n,this.LiveTorpedos=e,this.Mines=t,this.Animations=r,this.Ship=i}),X);function pu(n,e){return e.Left.JustDown?function(n){switch(n.tag){case 1:return new lu(0,"FacingLeft");case 2:return new lu(1,"Facing1");case 3:return new lu(2,"Facing2");case 4:return new lu(3,"Facing3");default:return new lu(0,"FacingLeft")}}(n):e.Right.JustDown?function(n){switch(n.tag){case 1:return new lu(2,"Facing2");case 2:return new lu(3,"Facing3");case 3:case 4:return new lu(4,"FacingUp");default:return new lu(1,"Facing1")}}(n):n}function Su(n,e){return e.Up.JustDown?function(n){switch(n.tag){case 1:return new cu(2,"ShipMedium");case 2:case 3:return new cu(3,"ShipFast");default:return new cu(1,"ShipSlow")}}(n):e.Down.JustDown?function(n){switch(n.tag){case 1:return new cu(0,"ShipStationary");case 2:return new cu(1,"ShipSlow");case 3:return new cu(2,"ShipMedium");default:return new cu(0,"ShipStationary")}}(n):n}function Mu(n){switch(n.tag){case 1:return Math.fround(.9229999780654907);case 2:return Math.fround(.7070000171661377);case 3:return Math.fround(.382999986410141);case 4:return Math.fround(0);default:return Math.fround(1)}}function mu(n){switch(n.tag){case 1:return Math.fround(.382999986410141);case 2:return Math.fround(.7070000171661377);case 3:return Math.fround(.9229999780654907);case 4:return Math.fround(1);default:return Math.fround(0)}}function yu(n,e,t){let r;return r=function(n){switch(n.tag){case 1:return Math.fround(.20000000298023224);case 2:return Math.fround(.4000000059604645);case 3:return Math.fround(.6000000238418579);default:return Math.fround(0)}}(t),new na(n.ptx+Mu(e)*-r,n.pty-mu(e)*r)}const Tu=cr([[.2,.352],[.404,.338],[.556,.196],[.294,.606],[.7,.336],[.264,.808],[.564,.688],[.812,.512],[.908,.662],[.87,.832]]);function Iu(){return ur((function(n){return function(n,e){let t,r;return r=Xo(Kr),t=an(r),new du(new na(n*t[0],e*t[1]))}(n[0],n[1])}),Tu)}const Cu=cr([[[.086,.214],[.318,.082],Math.fround(5),Math.fround(1)],[[.086,.214],[.616,.214],Math.fround(4.099999904632568),Math.fround(2.5)],[[.132,.39],[.454,.126],Math.fround(6.199999809265137),Math.fround(2)],[[.132,.39],[.826,.39],Math.fround(5.300000190734863),Math.fround(3)],[[.17,.592],[.776,.312],Math.fround(7),Math.fround(3.5)],[[.17,.592],[.958,.592],Math.fround(7.099999904632568),Math.fround(2)],[[.206,.79],[.846,.41],Math.fround(7.199999809265137),Math.fround(3.5)],[[.206,.79],[.984,.79],Math.fround(8.300000190734863),Math.fround(1)],[[.382,.102],[.138,.336],Math.fround(6),Math.fround(1)],[[.698,.204],[.078,.204],Math.fround(6.400000095367432),Math.fround(2.5)],[[.698,.204],[.152,.49],Math.fround(6.5),Math.fround(2.5)],[[.884,.454],[.13,.454],Math.fround(7.599999904632568),Math.fround(1.5)],[[.962,.608],[.26,.914],Math.fround(7.699999809265137),Math.fround(3)],[[.962,.608],[.178,.608],Math.fround(7.800000190734863),Math.fround(1)]]);function Au(n,e,t,r,i){let o,a;a=Xo(Kr),o=an(a);const u=n[0]*o[0],s=e[0]*o[0],l=n[1]*o[1],c=e[1]*o[1],f=i+r;return new gu([n,e,t,r],Ga(Oa,new na(u,l),new na(s,c),f,t),l===c)}function ku(n,e){return Au(n.TorpedoLaunchDetail[0],n.TorpedoLaunchDetail[1],n.TorpedoLaunchDetail[2],n.TorpedoLaunchDetail[3],e)}function Eu(){let n,e;return e=Xo(Kr),n=an(e),new fu(new lu(0,"FacingLeft"),new cu(0,"ShipStationary"),new na(Math.fround(.8859999775886536)*n[0],Math.fround(.9380000233650208)*n[1]))}function bu(n,e,t,r){const i=Math.fround(10),o=Mu(e),a=mu(e),u=function(n,e){return new na(n.ptx+o*e,n.pty+a*e)},s=t(r,u(n,i*Math.fround(1))),l=t(s,n);return t(l,u(n,i*Math.fround(-1)))}function vu(n,e,t){return bu(n.ShipCentre,n.ShipRotation,(function(n,r){return!!n||oa(e,t,r)}),!1)}function Wu(n,e){return new _a(uu(),e,Ra(n,e,au))}function xu(n,e,t,r){switch(t.tag){case 1:case 3:return[e,t];case 0:{let i;return i=er((function(n,e){return i=vu(t.fields[0],e.MineLocation,ru)?e.MineLocation:null,o=n[1],a=n[0],u=r,null==i?[a,o]:[new x(Wu(i,u),a),new hu(2,"ShipExploding",u)];var i,o,a,u}),[e,t],n),[i[0],i[1]]}default:return[e,t]}}const Du=[Math.fround(0),cr([[Math.fround(.02199999988079071),Math.fround(0)],[Math.fround(.13199999928474426),Math.fround(.3799999952316284)],[Math.fround(.22200000286102295),Math.fround(.8899999856948853)],[Math.fround(.3199999928474426),Math.fround(1)]])],Pu=[Math.fround(1),cr([[Math.fround(.23999999463558197),Math.fround(0)],[Math.fround(.335999995470047),Math.fround(.11599999666213989)],[Math.fround(.6959999799728394),Math.fround(.20000000298023224)],[Math.fround(1),Math.fround(.7260000109672546)],[Math.fround(1),Math.fround(1)]])];function Hu(n,e,t){let r,i;i=Xo(Kr),r=an(i);const o=t/r[1];let a,u;return u=hr((function(n){return o<n[0][1]||o>n[1][1]?null:(e=n[0][1],t=n[0][0],r=n[1][1],i=n[1][0],t+(i-t)/(r-e)*(o-e));var e,t,r,i}),function(n){const e=function(n,e,t){for(;;){const r=n,i=e,o=t;if(null==r.tail)return cr(i);{let a=i;$t([o,r.head],a),n=r.tail,e=i,t=r.head}}};var t,r,i,o;switch(null!=n.tail&&null!=n.tail.tail?(t=1,r=n.head,i=n.tail.head,o=n.tail.tail):t=0,t){case 0:return new x;case 1:{const n=[];return $t([r,i],n),A(2,e,[o])(n)(i)}}}(e)),a=cn(u,n),new na(a*r[0],t)}function Bu(n,e,t,r){return bu(n.ShipCentre,n.ShipRotation,(function(n,i){if(null==n){const n=Hu(t,r,i.pty);return e(i,n)?i:null}return n}),null)}function Xu(n,e){switch(n.tag){case 1:case 3:return n;case 0:return n.fields[0].ShipCentre.pty<iu?new hu(1,"ShipGotThrough",e,n.fields[0]):n;default:return n}}function Fu(n,e,t){let r,i,o,a;var u,s,l;switch(r=Xo(Rr),i=Xo(_r),o=Xo(Yr),a=Xo(Kr),Fo(n,0,0,a),Ia(n,a.EngineImageMetadata.ImageHeight),lr((function(e){Oo(n,e.MineLocation.ptx,e.MineLocation.pty,r)}),t.Mines),lr((function(t){const r=t.TorpedoPositionGetter(e);switch(r.tag){case 2:break;case 1:{const e=t.TorpedoIsHorizontal?i:o;Oo(n,r.fields[0].ptx,r.fields[0].pty,e);break}}}),t.LiveTorpedos),2===t.Ship.tag?u=0:1===t.Ship.tag?(u=1,s=t.Ship.fields[1]):0===t.Ship.tag?(u=1,s=t.Ship.fields[0]):u=0,u){case 1:Oo(n,s.ShipCentre.ptx,s.ShipCentre.pty,Xo(1===(l=s.ShipRotation).tag?Ur:2===l.tag?Jr:3===l.tag?zr:4===l.tag?Vr:jr))}eu(n,t.Animations,e);const c=new ka(t.FleetStats.Score,t.FleetStats.ShipsStillToNavigate,t.FleetStats.ShipsSuccess,Ca(t.FleetStats.ShipsSuccess),0,10,Math.fround(0));Ea(n,a.EngineImageMetadata.ImageHeight,c)}function Gu(n,e,t){const r=new su(e,0,n),i=(o=t,sr((function(n,e){return Au(e[0],e[1],e[2],e[3],o)}),Cu));var o;const a=new hu(0,"ShipInPlay",Eu()),u=new x;return new wu(r,i,Iu(),u,a)}function Ou(n,e,t){const r=function(n,e,t){const r=new su(n.ShipsStillToNavigate-1,e,t);return[r,0===r.ShipsStillToNavigate?new hu(3,"SecretPassageScreenOver"):new hu(0,"ShipInPlay",Eu())]};if(!function(n,e){var t,r;switch(n.tag){case 0:t=0;break;case 2:case 1:t=1,r=n.fields[0];break;default:t=0}switch(t){case 0:return!1;case 1:return e>r+ou}}(e,t))return[n,e];switch(e.tag){case 3:throw new Error("should not happen");case 2:return r(n,n.ShipsSuccess,n.Score);case 1:return r(n,n.ShipsSuccess+1,ma(3e3,n.Score));default:throw new Error("should not happen")}}function Lu(n,e,t){let r;if(3===n.Ship.tag)r=n;else{const o=function(n,e){var t,r;switch(n.tag){case 2:case 1:case 3:return n;default:return new hu(0,"ShipInPlay",(t=yu(n.fields[0].ShipCentre,n.fields[0].ShipRotation,n.fields[0].ShipSpeed),r=Su(n.fields[0].ShipSpeed,e),new fu(pu(n.fields[0].ShipRotation,e),r,t)))}}(n.Ship,e);let a,u;i=t,a=ur((function(n){return 2===n.TorpedoPositionGetter(i).tag?ku(n,i):n}),n.LiveTorpedos),u=$a(t,n.Animations);const s=function(n,e,t,r){switch(t.tag){case 1:case 3:return[n,e,t];case 0:{let i;return i=er((function(n,e){let i;const o=e.TorpedoPositionGetter(r);switch(o.tag){case 2:i=null;break;case 1:i=vu(t.fields[0],o.fields[0],tu)?o.fields[0]:null;break;default:i=null}if(null==i)return[new x(e,n[0]),n[1],n[2]];{const t=i;return[new x(ku(e,r),n[0]),new x(Wu(t,r),n[1]),new hu(2,"ShipExploding",r)]}}),[new x,e,t],n),[i[0],i[1],i[2]]}default:return[n,e,t]}}(a,u,o,t),l=xu(n.Mines,s[1],s[2],t),c=function(n,e,t){switch(e.tag){case 1:case 3:return[n,e];case 0:{let r;if(r=cn(Bu(e.fields[0],ra,Du[0],Du[1]),Bu(e.fields[0],ia,Pu[0],Pu[1])),null!=r){return[new x(Wu(r,t),n),new hu(2,"ShipExploding",t)]}return[n,e]}default:return[n,e]}}(l[0],l[1],t),f=Xu(c[1],t),h=Ou(n.FleetStats,f,t);r=new wu(h[0],s[0],n.Mines,c[0],h[1])}var i;return 3===r.Ship.tag?r.FleetStats.ShipsSuccess>0?new Yo(1,"GoToNextChapter2",r):new Yo(2,"GameOver2",r):new Yo(0,"StayOnThisChapter2",r)}const Nu=new na(Math.fround(124),Math.fround(75)),Ku=new x(new ta(Math.fround(86),Math.fround(75),Math.fround(276),Math.fround(139)),new x),Ru=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const ju=b((function(n,e,t,r){this.ScoreAndHiScore=n,this.ShipsThrough=e,this.AlliedState=t,this.EnemyFleetCentre=r}),X);function Uu(n,e){return new ju(n,e,new Ru(0,"AlliedFleetInPlay",Nu),fa)}function Ju(n,e,t){let r;if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[1]>ha){const e=new Ru(2,"PostPassageScreenOver");r=new ju(n.ScoreAndHiScore,n.ShipsThrough,e,n.EnemyFleetCentre)}else r=n}else if(2===n.AlliedState.tag)r=n;else{const a=pa(n.AlliedState.fields[0],e,Ku),u=Sa(n.EnemyFleetCentre,a),s=(o=t,oa(u,sa,i=a)?new Ru(1,"Paused",i,o):new Ru(0,"AlliedFleetInPlay",i));r=new ju(n.ScoreAndHiScore,n.ShipsThrough,s,u)}var i,o;return 2===r.AlliedState.tag?new _o(1,"GoToNextChapter1",r):new _o(0,"StayOnThisChapter1",r)}const zu=b((function(n,e){this.ShellMechanicsObject=n,this.ShellStartTime=e}),X);const Vu=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const _u=b((function(n,e,t,r,i,o,a,u,s,l){this.GunType=n,this.GunLeftExtent=e,this.GunRightExtent=t,this.GunStepRatePerSecond=r,this.HighestShellY=i,this.GunRepeatTime=o,this.GunShellDuration=a,this.GunLowestElevation=u,this.GunHighestElevation=s,this.GunElevationStepRate=l}),X);const Yu=b((function(n,e,t,r,i){this.GunTraits=n,this.GunCentreX=e,this.GunElevation=t,this.Shells=r,this.LastFireTime=i}),X);function qu(n,e,t,r,i){const o=(a=r,new _u(n,Math.fround(20),Math.fround(300),Math.fround(80),Math.fround(0),Math.fround(.5),Math.fround(.699999988079071),Math.fround(5),Math.fround(80),a));var a;return new Yu(o,e,t,new x,i-o.GunRepeatTime)}function Zu(n){const e=So*Math.fround(.6000000238418579);return[n-e,n+e]}function $u(n,e){const t=e.GunElevation/Math.fround(10),r=~~(Math.fround(9.5)+Math.fround(.15199999511241913)*t),i=~~(Math.fround(15.5)+Math.fround(.10400000214576721)*t);return[i,r,n-i,n-(i+r)]}function Qu(n,e,t,r){const i=function(r){const i=$u(e,t),o=r-po/Math.fround(2),a=r-So/Math.fround(2);Go(n,o,i[2],Xo(to),po,i[0]),Go(n,a,i[3],Xo(eo),So,i[1])};if(1===t.GunTraits.GunType.tag){const n=Zu(t.GunCentreX);i(n[0]),i(n[1])}else i(t.GunCentreX);lr((function(e){const i=e.ShellMechanicsObject.PositionGetter(r);if(1===i.tag){const a=Math.fround(1)-(o=t.GunTraits,(r-e.ShellStartTime)/o.GunShellDuration),u=a*Math.fround(12)+Math.fround(4),s=a*Math.fround(5)+Math.fround(1),l=i.fields[0].ptx-u/Math.fround(2),c=i.fields[0].pty-s/Math.fround(2);Go(n,l,c,Xo(ro),u,s)}var o}),t.Shells)}function ns(n,e,t,r,i){const o=n.Up.Held&&n.Down.Held?i.GunElevation:n.Up.Held?C(M,i.GunTraits.GunLowestElevation,i.GunElevation-i.GunTraits.GunElevationStepRate*t):n.Down.Held?I(M,i.GunTraits.GunHighestElevation,i.GunElevation+i.GunTraits.GunElevationStepRate*t):i.GunElevation,a=n.Left.Held&&n.Right.Held?i.GunCentreX:n.Left.Held?C(M,i.GunTraits.GunLeftExtent,i.GunCentreX-i.GunTraits.GunStepRatePerSecond*t):n.Right.Held?I(M,i.GunTraits.GunRightExtent,i.GunCentreX+i.GunTraits.GunStepRatePerSecond*t):i.GunCentreX;let u;const s=e-i.LastFireTime;if(n.Fire.JustDown&&s>i.GunTraits.GunRepeatTime){const n=function(n){return function(n,e,t,r){const i=$u(e,t),o=new na(n,i[3]),a=new na(n,function(n,e,t){const r=n.GunHighestElevation-t,i=(e-n.HighestShellY)/n.GunHighestElevation;return n.HighestShellY+r*i}(t.GunTraits,i[3],t.GunElevation));return new zu(ja(Na,o,a,r,t.GunTraits.GunShellDuration),r)}(n,r,i,e)};if(1===i.GunTraits.GunType.tag){const t=Zu(i.GunCentreX);u=[new x(n(t[0]),new x(n(t[1]),i.Shells)),e]}else{u=[new x(n(i.GunCentreX),i.Shells),e]}}else u=[i.Shells,i.LastFireTime];return new Yu(i.GunTraits,a,o,u[0],u[1])}function es(n,e){let t;var r,i;return r=function(n){return n.ShellMechanicsObject},i=n,t=Xa((function(n){const e=r(n);return Ja(i,e)}),e.Shells),new Yu(e.GunTraits,e.GunCentreX,e.GunElevation,t,e.LastFireTime)}const ts=Math.fround(3),rs=Math.fround(6),is=b((function(n,e,...t){D.call(this,n,e,...t)}),D);function os(n){return n<=Math.fround(45)?n:Math.fround(90)-n}function as(n){let e,t;e=os(n);const r=Math.fround(0),i=Math.fround(45),o=Math.fround(1);let a,u;t=e*((Math.fround(0)-o)/(i-r))+o,a=t*t;const s=Math.fround(0),l=Math.fround(1),c=Math.fround(100);return u=a*((Math.fround(148)-c)/(l-s))+c,u+Math.fround(.5)}const us=b((function(n,e,t,r,i){this.CentreX=n,this.BaseY=e,this.ShipImage=t,this.SinkStartTime=r,this.ElevationToHit=i}),X);function ss(n,e,t){return new us(n,as(t),e,null,t)}function ls(){return cr([ss(Math.fround(29),Xo(Ei),Math.fround(44)),ss(Math.fround(143),Xo(bi),Math.fround(39.5)),ss(Math.fround(198),Xo(vi),Math.fround(36.5)),ss(Math.fround(248),Xo(Wi),Math.fround(41)),ss(Math.fround(288),Xo(xi),Math.fround(32.5))])}function cs(n,e){return Xa((function(e){return function(n,e){if(null!=e.SinkStartTime){return n-e.SinkStartTime<=rs}return!0}(n,e)}),e)}function fs(n,e,t){lr((function(e){let r,i;if(null!=e.SinkStartTime){const n=e.SinkStartTime;r=I(M,t-n,rs)/rs*e.ShipImage.EngineImageMetadata.ImageHeight}else r=Math.fround(0);i=e.ShipImage.EngineImageMetadata.ImageWidth;const o=e.ShipImage.EngineImageMetadata.ImageHeight-~~(r+Math.fround(.5))|0,a=e.CentreX-e.ShipImage.EngineImageMetadata.ImageWidth/Math.fround(2),u=e.BaseY-(e.ShipImage.EngineImageMetadata.ImageHeight-r);let s,l;s=e.ShipImage.EngineImageMetadata.ImageWidth,l=o;const c=new Wr(3,"DrawSubImageStretchedToTarget",0,0,i,o,a,u,s,l,e.ShipImage);n(c)}),e)}function hs(n){let e,t,r;e=Xo(Ii),t=e.EngineImageMetadata.ImageWidth,r=e.EngineImageMetadata.ImageHeight;const i=new Va(ts,[Xo(Ci),Xo(Ai),Xo(Ai),Xo(ki),Xo(ki)],new za(1,"Hidden"),new za(1,"Hidden")),o=Ra(new na(t/Math.fround(2),r/Math.fround(2)),n,ts);return new _a(i,n,o)}function ds(n){Ko(n,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,75,"STAGE COMPLETE")}function gs(n){Ko(n,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,75,"SHIP DESTROYED")}const ws=b((function(n,e){this.ExplosionsList=n,this.TotalScore=e}),X);function ps(n,e,t,r,i,o,a,u){let s;if(s=Sr((function(n){return t(n[0],n[1])}),ir(function(n,e){let t=!0;const r=[];return ke(n=>t?(t=!1,Pe(e=>(r.push(e),[n,e]),e)):r.map(e=>[n,e]),n)}(n,e))),null==s.tail)return[n,e,o,a];{let t,l,c,f,h,g;let w;return t=rr((function(n,e){return[new x(n[0],e[0]),new x(n[1],e[1])]}),s,[new x,new x]),l=Ir(r,t[0],{Equals:p,GetHashCode:d}),c=Ir(i,t[1],{Equals:p,GetHashCode:d}),f=Sr((function(n){return Ba(l,r,n)}),n),h=Sr((function(n){return Ba(c,i,n)}),e),w=er((function(n,e){const t=u(e);return new ws(new x(t[0],n.ExplosionsList),n.TotalScore+t[1])}),new ws(o,0),l),g=[w.ExplosionsList,w.TotalScore],[f,h,g[0],ma(g[1],a)]}}const Ss=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const Ms=Math.fround(30),ms=Math.fround(160),ys=Math.fround(6),Ts=Math.fround(4),Is=Math.fround(.75),Cs=Math.fround(6),As=Math.fround(3),ks=Math.fround(5),Es=Math.fround(1),bs=Math.fround(150),vs=Math.fround(30);function Ws(n){return qt(Xo,n,Array)}const xs=b((function(n,e){this.PlaneFlickBookInstance=n,this.PlaneHasReleasedBombs=e}),X);const Ds=b((function(n,e,t,r,i,o,a,u,s,l,c,f){this.ScoreAndHiScore=n,this.ShipsRemaining=e,this.Planes=t,this.PlaneBombs=r,this.PlanesRemaining=i,this.GunAim=o,this.AlliedState=a,this.SkyExplosion=u,this.Explosions=s,this.EnemyShips=l,this.Damage=c,this.LastSortieAt=f}),X);function Ps(n){return n.PlaneFlickBookInstance}function Hs(n,e){const t=new Va(Is,Ws([di,gi,wi]),new za(1,"Hidden"),new za(0,"Visible")),r=Ra(n,e,Is);return new _a(t,e,r)}function Bs(n,e,t,r,i){return ps(n,e,(function(n,e){return function(n,e,t){if(Ja(n,e.ShellMechanicsObject))return!1;{let r,i;return i=Ps(t),r=qa(n,i),oa(r,ys,e.ShellMechanicsObject.FinalPosition)}}(i,n,e)}),(function(n){return n.ShellStartTime}),(function(n){return n.PlaneFlickBookInstance.FlickBookStartTime}),t,r,(function(n){let e;return e=Ua(i,n.ShellMechanicsObject),[Hs(e,i),2e3]}))}function Xs(n){const e=~~n%4|0;return 0===e?[function(){return new Va(Cs,Ws([ni,ei,ti,ri,oi,si,fi]),new za(1,"Hidden"),new za(0,"Visible"))},Math.fround(-50)]:1===e?[function(){return new Va(Cs,Ws([ni,ei,ti,ri,ai,li,hi]),new za(1,"Hidden"),new za(0,"Visible"))},Math.fround(50)]:[function(){return new Va(Cs,Ws([ni,ei,ti,ri,ii,ui,ci]),new za(1,"Hidden"),new za(0,"Visible"))},Math.fround(0)]}function Fs(n){const e=Xs(n),t=~~n%24*10+40,r=t+e[1];return new xs(new _a(e[0](),n,ja(La,new na(t,Math.fround(90)),new na(r,Math.fround(-14)),n,Cs)),!1)}function Gs(n,e){let t;t=qa(e,n.PlaneFlickBookInstance);const r=new na(t.ptx,bs);return new _a(new Va(Es,Ws([Si,Mi,mi,yi,Ti]),new za(1,"Hidden"),new za(0,"Visible")),e,ja(La,t,r,e,Es))}function Os(n,e,t){return er((function(e,t){if(t.PlaneHasReleasedBombs)return[e[0],new x(t,e[1])];if(n-t.PlaneFlickBookInstance.FlickBookStartTime>=As){return[new x(Gs(t,n),e[0]),new x(new xs(t.PlaneFlickBookInstance,!0),e[1])]}return[e[0],new x(t,e[1])]}),[e,new x],t)}function Ls(n,e,t,r){let i;i=1===n.tag?20:40;const o=qu(new Vu(1,"DoubleBarrelGun"),ms,Ms,vs,r),a=new is(0,"AlliedShipInPlay"),u=new x,s=new x,l=ls();return new Ds(e,t,new x,new x,i,o,a,s,u,l,0,Math.fround(0))}function Ns(n,e,t,r){let i;if(2===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>Ts){const e=new is(3,"AirOrSeaBattleScreenOver");i=new Ds(n.ScoreAndHiScore,n.ShipsRemaining,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,n.SkyExplosion,n.Explosions,n.EnemyShips,n.Damage,n.LastSortieAt)}else i=n}else if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>Ts)if(n.ShipsRemaining>1){const e=new is(0,"AlliedShipInPlay"),t=n.ShipsRemaining-1,r=new x;i=new Ds(n.ScoreAndHiScore,t,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,r,n.Explosions,n.EnemyShips,0,n.LastSortieAt)}else{const e=new is(3,"AirOrSeaBattleScreenOver"),t=new x;i=new Ds(n.ScoreAndHiScore,0,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,t,n.Explosions,n.EnemyShips,n.Damage,n.LastSortieAt)}else i=n}else if(3===n.AlliedState.tag)i=n;else if(0===n.PlanesRemaining&&null==n.Planes.tail){const e=new is(2,"WonScreen",t);i=new Ds(n.ScoreAndHiScore,n.ShipsRemaining,n.Planes,n.PlaneBombs,n.PlanesRemaining,n.GunAim,e,n.SkyExplosion,n.Explosions,n.EnemyShips,n.Damage,n.LastSortieAt)}else{let l;let c,f,h;l=0|Xo(Ii).EngineImageMetadata.ImageHeight,c=$a(t,n.Explosions),f=$a(t,n.SkyExplosion),h=Za(t,Ps,n.Planes);const d=0|or(n.PlaneBombs);let g;g=$a(t,n.PlaneBombs);const w=0|or(g),p=n.Damage+(d-w>>>0),S=ns(e,t,r,l,n.GunAim),M=Os(t,g,h),m=(o=t,a=n.PlanesRemaining,u=n.LastSortieAt,s=M[1],a>0&&o>u+ks&&or(s)<3?[a-1,o,new x(Fs(o),s)]:[a,u,s]),y=p>=5?[new is(1,"ShipSinking",t),new x(hs(t),new x)]:[n.AlliedState,f],T=Bs(S.Shells,m[2],c,n.ScoreAndHiScore,t);let I;I=es(t,new Yu(S.GunTraits,S.GunCentreX,S.GunElevation,T[0],S.LastFireTime)),i=new Ds(T[3],n.ShipsRemaining,T[1],M[0],m[0],I,y[0],y[1],T[2],n.EnemyShips,p,m[1])}var o,a,u,s;return 3===i.AlliedState.tag?i.ShipsRemaining>0?new Yo(1,"GoToNextChapter2",i):new Yo(2,"GameOver2",i):new Yo(0,"StayOnThisChapter2",i)}const Ks=b((function(n,e){this.ToDoTime=n,this.ToDoData=e}),X);function Rs(n,e){return new Ks(n,e)}const js=b((function(n,e,...t){D.call(this,n,e,...t)}),D);function Us(n,e,t){const r=function(n,e){return n>=e.ToDoTime};if(yr(A(1,r,[n]),t[1])){let o,a;return a=tr(t[1]),o=er((function(t,i){if(r(n,i)){const r=e(t[0],i.ToDoData,n);return 1===r.tag?[r.fields[0],ar(r.fields[1],t[1])]:[r.fields[0],t[1]]}return[t[0],new x(i,t[1])]}),[t[0],new x],a),[(i=o)[0],tr(i[1])]}return[t[0],t[1]];var i}const Js=Math.fround(30),zs=Math.fround(160),Vs=Math.fround(4),_s=(Math.fround(.75),Math.fround(6),Math.fround(.20000000298023224)),Ys=Math.fround(3.5),qs=Math.fround(.30000001192092896),Zs=Math.fround(155),$s=Math.fround(140),Qs=Math.fround(4),nl=Math.fround(10),el=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const tl=b((function(n){this.HitShipX=n}),X);const rl=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const il=b((function(n,e,t,r,i,o,a,u,s,l,c,f,h,d){this.ScoreAndHiScore=n,this.ShipsRemaining=e,this.GunAim=t,this.AlliedState=r,this.AlliedCountToSink=0|i,this.EnemyShips=o,this.Decoratives=a,this.SkyExplosion=u,this.PendingIncoming=s,this.PendingDamage=l,this.PendingHits=c,this.PendingMessageTexts=f,this.PendingScoreChanges=h,this.MessageText=d}),X);function ol(n){return qt(Xo,n,Array)}function al(n,e,t){const r=new Va(_s,ol([pi]),new za(1,"Hidden"),new za(1,"Hidden")),i=Ra(new na(e,t),n,_s);return new _a(r,n,i)}function ul(n,e){return gr((function(n){const t=n.ShipImage.EngineImageMetadata.ImageWidth/Math.fround(2);return null==n.SinkStartTime&&(r=n.CentreX,i=t,o=e,Math.abs(r-o)<i);var r,i,o}),n)}const sl=new Va(Math.fround(.699999988079071),ol([Si,Mi]),new za(1,"Hidden"),new za(1,"Hidden")),ll=new Va(Math.fround(.699999988079071),ol([yi,Ti]),new za(1,"Hidden"),new za(1,"Hidden"));function cl(n,e,t,r,i,o){var a,u,s;if(null!=n.tail){if(null!=n.head.SinkStartTime)return new js(1,"PendingDoneWithAdditionalToDos",[n,e,t,r],new x((a=new rl(0,"IncomingChange",null),Rs(o+Qs,a)),new x));{const t=1===r,i=function(n,e,t,r){const i=n.BaseY-n.ShipImage.EngineImageMetadata.ImageHeight,o=t?Zs:$s,a=r+sl.FlickBookDuration+qs,u=a+ll.FlickBookDuration,s=u+Ys,l=new _a(sl,r,ja(La,new na(n.CentreX,i),new na(n.CentreX,Math.fround(-10)),r,sl.FlickBookDuration)),c=new _a(ll,a,ja(La,new na(n.CentreX,Math.fround(-100)),new na(n.CentreX,o),a,ll.FlickBookDuration)),f=t?e:new x(al(u,n.CentreX,o),e);return[new x(l,new x(c,f)),u,s]}(n.head,e,t,o),a=t?new x((u=new el(0,"DamageChange",null),Rs(i[1],u)),new x):new x,l=r-1|0;return new js(1,"PendingDoneWithAdditionalToDos",[n,i[0],a,l],new x((s=new rl(0,"IncomingChange",null),Rs(i[2],s)),new x))}}return new js(0,"PendingDone",[n,e,t,r])}function fl(n,e){let t;t=0|Xo(pi).EngineImageMetadata.ImageHeight;const r=as(n.GunElevation)-t/Math.fround(2);return al(e,n.GunCentreX,r)}const hl=b((function(n,e,...t){D.call(this,n,e,...t)}),D);function dl(n,e,t,r){var i,o,a,u,s,l,c;if(n.Fire.JustDown){const n=r+e.GunTraits.GunShellDuration*Math.fround(2);let f;if(f=ul(t,e.GunCentreX),null!=f){const t=f,r=function(n,e){const t=~~os(n.GunElevation)-~~e.ElevationToHit|0;return 0===t?new hl(0,"DirectHit"):t<0?new hl(2,"TooNearBy",kn(t)):new hl(1,"TooFarBy",t)}(e,t),h=2===r.tag?[null,(o=100*Math.abs(r.fields[0])|0,a=$e(Ze("%dM SHORT")),i=a(o),Rs(n,i)),null]:1===r.tag?[null,(s=100*Math.abs(r.fields[0])|0,l=$e(Ze("%dM LONG")),u=l(s),Rs(n,u)),null]:[(c=new tl(t.CentreX),Rs(n,c)),Rs(n,"DIRECT HIT"),Rs(n,2e3)],d=2===r.tag?fl(e,n):(r.tag,null);return[h[0],h[1],h[2],d]}return[null,null,null,fl(e,n)]}return[null,null,null,null]}function gl(n,e,t){return new il(n,e,qu(new Vu(1,"DoubleBarrelGun"),zs,Js,nl,t),new is(0,"AlliedShipInPlay"),5,ls(),new x,new x,new x(Rs(t,new rl(0,"IncomingChange",null)),new x),new x,new x,new x,new x,"")}function wl(n,e,t,r){let i;if(2===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>Vs){const e=new is(3,"AirOrSeaBattleScreenOver");i=new il(n.ScoreAndHiScore,n.ShipsRemaining,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText)}else i=n}else if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[0]>Vs)if(n.ShipsRemaining>1){const e=new is(0,"AlliedShipInPlay"),t=n.ShipsRemaining-1;i=new il(n.ScoreAndHiScore,t,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText)}else{const e=new is(3,"AirOrSeaBattleScreenOver");i=new il(n.ScoreAndHiScore,0,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText)}else i=n}else if(3===n.AlliedState.tag)i=n;else if(null==n.EnemyShips.tail){const e=new is(2,"WonScreen",t);i=new il(n.ScoreAndHiScore,n.ShipsRemaining,n.GunAim,e,n.AlliedCountToSink,n.EnemyShips,n.Decoratives,n.SkyExplosion,n.PendingIncoming,n.PendingDamage,n.PendingHits,n.PendingMessageTexts,n.PendingScoreChanges,n.MessageText)}else{let o,a,u,s;o=$a(t,n.SkyExplosion),a=$a(t,n.Decoratives),u=cs(t,n.EnemyShips),s=0|Xo(Ii).EngineImageMetadata.ImageHeight;const l=ns(e,t,r,s,n.GunAim);let c,f,h,d,g,w;c=Us(t,(function(n,e,t){return cl(n[0],n[1],n[2],n[3],0,t)}),[[u,a,n.PendingDamage,n.AlliedCountToSink],n.PendingIncoming]),f=Us(t,(function(n,e,t){return new js(0,"PendingDone",[new is(1,"ShipSinking",t),new x(hs(t),new x),5])}),[[n.AlliedState,o,c[0][3]],c[0][2]]),h=Us(t,(function(n,e,t){return new js(0,"PendingDone",(r=t,i=e.HitShipX,ur((function(n){if(n.CentreX===i){const e=r;return new us(n.CentreX,n.BaseY,n.ShipImage,e,n.ElevationToHit)}return n}),n)));var r,i}),[c[0][0],n.PendingHits]),d=Us(t,(function(n,e,t){return new js(0,"PendingDone",e)}),[n.MessageText,n.PendingMessageTexts]),g=Us(t,(function(n,e,t){return new js(0,"PendingDone",ma(e,n))}),[n.ScoreAndHiScore,n.PendingScoreChanges]),w=es(t,l);const p=dl(e,w,h[0],t),S=function(n,e){if(null!=n){return new x(ln(n),e)}return e},M=S(p[0],h[1]),m=S(p[1],d[1]),y=S(p[2],g[1]),T=S(p[3],c[0][1]);i=new il(g[0],n.ShipsRemaining,w,f[0][0],f[0][2],h[0],T,f[0][1],c[1],f[1],M,m,y,d[0])}return 3===i.AlliedState.tag?i.ShipsRemaining>0?new Yo(1,"GoToNextChapter2",i):new Yo(2,"GameOver2",i):new Yo(0,"StayOnThisChapter2",i)}const pl=new na(Math.fround(120),Math.fround(97)),Sl=cr([new ta(Math.fround(86),Math.fround(75),Math.fround(156),Math.fround(139)),wa]),Ml=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const ml=b((function(n,e,t){this.ScoreAndHiScore=n,this.ShipsThrough=e,this.AlliedState=t}),X);function yl(n,e){return new ml(n,e,new Ml(0,"FleetBeforeBeachLandingInPlay",pl))}function Tl(n,e,t){let r;if(1===n.AlliedState.tag){if(t-n.AlliedState.fields[1]>ha){const e=new Ml(2,"ScreenOver");r=new ml(n.ScoreAndHiScore,n.ShipsThrough,e)}else r=n}else if(2===n.AlliedState.tag)r=n;else{const a=pa(n.AlliedState.fields[0],e,Sl),u=(o=t,aa(wa,i=a)?new Ml(1,"EngagedBeachLanding",i,o):new Ml(0,"FleetBeforeBeachLandingInPlay",i));r=new ml(n.ScoreAndHiScore,n.ShipsThrough,u)}var i,o;return 0===r.AlliedState.tag?new _o(0,"StayOnThisChapter1",r):new _o(1,"GoToNextChapter1",r)}const Il=b((function(n,e,t,r){this.TilesHorizontally=0|n,this.TilesVertically=0|e,this.TileWidthPixels=t,this.TileHeightPixels=r}),X);const Cl=b((function(n,e,t,r){this.WindowLeft=n,this.WindowTop=e,this.WindowWidth=t,this.WindowHeight=r}),X);const Al=b((function(n,e){this.OffsetX=n,this.OffsetY=e}),X);function kl(n,e,t,r){const i=function(n,e){if(e<=0){const t=0|~~(kn(e)/n);return[e+n*t|0,t]}return[e,0]},o=i(n.TileWidthPixels,t.OffsetX),a=i(n.TileHeightPixels,t.OffsetY);if(e.WindowWidth>0&&e.WindowHeight>0){const t=e.WindowLeft+e.WindowWidth|0,i=e.WindowTop+e.WindowHeight|0;let u=e.WindowTop+a[0]|0,s=0|a[1];for(;u<i&&s<n.TilesVertically;){let i=e.WindowLeft+o[0]|0,a=0|o[1];for(;i<t&&a<n.TilesHorizontally;)r(i,u,a,s),i+=n.TileWidthPixels,a+=1;u+=n.TileHeightPixels,s+=1}}}const El=b((function(n){this.TargetLocation=n}),X);const bl=b((function(n,e){this.TargetsOnFinalBoss=n,this.TankBattleMapNumber=0|e}),X);const vl=cr([[Math.fround(169),Math.fround(50)],[Math.fround(134),Math.fround(71)],[Math.fround(194),Math.fround(90)],[Math.fround(123),Math.fround(111)],[Math.fround(221),Math.fround(68)],[Math.fround(74),Math.fround(108)],[Math.fround(249),Math.fround(116)],[Math.fround(163),Math.fround(83)],[Math.fround(104),Math.fround(70)],[Math.fround(231),Math.fround(96)]]);function Wl(){return new bl(ur((function(n){return new El(new na(n[0],n[1]))}),vl),0)}const xl=Math.fround(60),Dl=Math.fround(188),Pl=(xl+Dl)/Math.fround(2),Hl=xr-Math.fround(16),Bl=Math.fround(12),Xl=Math.fround(3),Fl=Math.fround(12),Gl=Math.fround(1),Ol=Math.fround(3),Ll=Math.fround(4),Nl=(Math.fround(120),Math.fround(15)),Kl=Math.fround(2.5),Rl=Math.fround(.20000000298023224),jl=Math.fround(.75),Ul=Math.fround(7);function Jl(n){return qt(Xo,n,Array)}function zl(n,e){return new _a(new Va(jl,Jl([qr,Zr,$r,Qr]),new za(1,"Hidden"),new za(1,"Hidden")),e,Ra(n,e,jl))}const Vl=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const _l=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const Yl=b((function(n,e){this.etmx=n,this.etmy=e}),X);const ql=b((function(n,e,t,r){this.ScreenStartTime=n,this.TileMatrixTraits=e,this.LevelMap=t,this.FinalBossAndTankBattleData=r}),X);const Zl=b((function(n,e,t,r,i,o,a,u){this.Constants=n,this.ScoreAndHiScore=e,this.TanksRemaining=t,this.AlliedState=r,this.Decoratives=i,this.AlliedMissiles=o,this.EnemyMissiles=a,this.EnemyTankLocations=u}),X);function $l(){return new Va(Math.fround(3),[Xo(_r)],new za(1,"Hidden"),new za(1,"Hidden"))}function Ql(n,e,t){switch(t.tag){case 2:case 0:return new ta(n-Math.fround(8),e-Math.fround(6),n+Math.fround(8),e+Math.fround(6));default:return new ta(n-Math.fround(8),e-Math.fround(4),n+Math.fround(8),e+Math.fround(4))}}function nc(n,e){let t;return t=0|~~(e*Math.fround(5)),16*kn(n)+320+t|0}function ec(n,e,t){return(0|kn(nc(n,e)))+(0|~~(t+Math.fround(.5)))|0}function tc(n,e,t){let r;let i;return r=0|nc(n,t),i=52,new na(r+e.etmx,52+e.etmy)}function rc(n,e,t,r){const i=Ql(Hl,n,e),o=new Cl(0|~~(i.Left+Math.fround(.5)),0|~~(i.Top+Math.fround(.5)),0|~~((u=i).Right-u.Left+Math.fround(.5)),0|~~((a=i).Bottom-a.Top+Math.fround(.5)));var a,u;const s=new Al(nc(r.LevelMap.TilesHorizontally,t)-o.WindowLeft,0|~~(-(i.Top-52)+Math.fround(.5)));let l=!0;return kl(r.TileMatrixTraits,o,s,(function(n,e,t,i){const o=r.LevelMap.TilesArray[i*r.LevelMap.TilesHorizontally+t];var a;l=!!l&&(!!p(a=o,Bi)||p(a,Pi))})),!l}function ic(n){switch(n.tag){case 0:return Jl([Li,Ri]);case 2:return Jl([Ni,ji]);default:return Jl([Oi,Ki])}}function oc(n,e,t,r){let i;const o=0|nc(n,e);let a;i=o,a=52,lr((function(n){t(n.etmx+i,n.etmy+52)}),r)}function ac(n,e,t){var r;const i=t-e.Constants.ScreenStartTime;let o;o=Xo(Gi);const a=function(){Uo(n,i),function(n,e,t){const r=new Cl(0,52,320,144),i=new Al(nc(e.LevelMap.TilesHorizontally,t),0);kl(e.TileMatrixTraits,r,i,(function(t,r,i,o){let a;a=Xo(e.LevelMap.TilesArray[o*e.LevelMap.TilesHorizontally+i]),Fo(n,t,r,a)}))}(n,e.Constants,i),eu(n,e.AlliedMissiles,i),eu(n,e.EnemyMissiles,i),oc(e.Constants.LevelMap.TilesHorizontally,i,(function(e,t){Oo(n,e,t,o)}),e.EnemyTankLocations)},u=function(){eu(n,e.Decoratives,i)},s=Math.fround(0);switch(1===e.AlliedState.tag?1:2===e.AlliedState.tag||3===e.AlliedState.tag?2:0){case 0:{a();const t=i-e.Constants.ScreenStartTime;Lo(n,Hl,e.AlliedState.fields[0],ic(e.AlliedState.fields[1]),Rl,t),u();break}case 1:a(),u()}!function(n,e,t,r){const i=e+2|0;let o;o=$e(Ze("SCORE  %d     TANKS  %d"))(t)(r),Ko(n,Br,new Jo(1,"CentreAlign"),new zo(0,"TopAlign"),160,i,o)}(n,(r=0|~~(s+Math.fround(.5)),r),e.ScoreAndHiScore.Score,e.TanksRemaining)}function uc(n,e,t,r,i){const o=function(n,e){const t=0|or(n);if(t<1)throw new Error("List of tank battle maps should never be empty");return pr(e%t,n)}(r,t.TankBattleMapNumber),a=new Il(o.TilesHorizontally,9,16,16),u=new ql(i,a,o,t);return new Zl(u,n,e,new _l(0,"AlliedTankInPlay",Pl,new Vl(1,"TankFacingLeft")),new x,new x,new x,ur((function(n){return new Yl(16*n.etx+8|0,16*n.ety+8|0)}),o.EnemyTanks))}function sc(n,e,t,r){if(e.Fire.JustDown&&function(n,e,t){let r;var i;if(r=null!=(i=n).tail?i.head.FlickBookStartTime:null,null!=r){return t-r>=e}return!0}(t,Kl,r)){return new x((i=Hl-Bl,o=n-Xl,a=r,new _a($l(),a,ja(Oa,new na(i,o),new na(i-xr,o),a,Kl))),t)}return t;var i,o,a}function lc(n,e){let t;return t=Ua(e,n.FlickBookMechanicsObject),zl(t,e)}function cc(n,e,t){return function(n,e){const t=n.ptx+Fl,r=n.pty-Gl;return new _a($l(),e,ja(Oa,new na(t,r),new na(t+xr,r),e,Kl))}(tc(e,n,t),t)}function fc(n,e,t,r,i,o){switch(n.tag){case 2:case 1:return[n,e];case 0:{const u=function(n,e,t){const r=t*Nl;switch(e.tag){case 2:return I(M,n+r,Dl);case 1:return n;default:return C(M,n-r,xl)}}(n.fields[0],n.fields[1],t),s=(a=r).Up.Held&&a.Down.Held?new Vl(1,"TankFacingLeft"):a.Up.Held?new Vl(0,"TankFacingUpLeft"):a.Down.Held?new Vl(2,"TankFacingDownLeft"):new Vl(1,"TankFacingLeft");if(rc(u,s,o,i)){const n=new x(zl(new na(Hl,u),o),e);return[new _l(1,"AlliedTankExploding",o),n]}return[new _l(0,"AlliedTankInPlay",u,s),e]}default:return[n,e]}var a}function hc(n,e,t,r,i){switch(n.tag){case 3:case 1:return[e,n,t,r];case 0:{const o=function(n,e,t,r,i,o,a){const u=ps(n,new x(e,new x),t,r,(function(n){return 1}),i,o,a),s=null==u[1].tail?new Ss(0,"PlayerDestroyed"):new Ss(1,"PlayerSurvives");return[u[0],s,u[2],u[3]]}(e,n.fields[0],(function(n,e){return function(n,e,t){const r=new na(Hl,t);let i;return i=qa(n,e),oa(r,Ul,i)}(i,n,e)}),Ya,t,r,(function(n){return[lc(n,i),0]}));return 0===o[1].tag?[o[0],new _l(1,"AlliedTankExploding",i),o[2],o[3]]:[o[0],n,o[2],o[3]]}default:return[e,n,t,r]}}function dc(n,e,t,r,i){switch(n.tag){case 2:case 1:return[n,e];case 0:if(function(n,e,t,r,i){const o=Ql(Hl,r,i),a=Xo(Gi).EngineImageMetadata;let u=!1;return oc(n,e,(function(n,e){if(u)u=!0;else{let t;const r=n-a.ImageWidth/Math.fround(2),i=e-a.ImageHeight/Math.fround(2);t=new ta(r,i,r+a.ImageWidth,i+a.ImageHeight),u=function(n,e){return!(n.Left>e.Right||n.Right<e.Left||n.Top>e.Bottom||n.Bottom<e.Top)}(t,o)}}),t),u}(r,i,t,n.fields[0],n.fields[1])){return[new _l(1,"AlliedTankExploding",i),new x(zl(new na(Hl,n.fields[0]),i),e)]}return[n,e];default:return[n,e]}}const gc=b((function(n,e,...t){D.call(this,n,e,...t)}),D);function wc(n,e,t,r){let i;var o,a,u;switch(2===n.AlliedState.tag||3===n.AlliedState.tag?0:1){case 0:i=n;break;case 1:{const o=t-n.Constants.ScreenStartTime,a=0|ec(n.Constants.LevelMap.TilesHorizontally,o,Hl);let u,s,l;u=$a(o,n.Decoratives),s=$a(o,n.AlliedMissiles),l=$a(o,n.EnemyMissiles);const c=function(n,e,t){switch(n.tag){case 2:case 0:return[n,e];case 1:return t-n.fields[0]>Ll?[new _l(3,"AlliedTankDestroyed"),e-1]:[n,e];default:return[n,e]}}(function(n,e){switch(n.tag){case 2:case 1:return n;case 0:return e<64?new _l(2,"AlliedTankReachedFort"):n;default:return n}}(n.AlliedState,a),n.TanksRemaining,o),f=fc(c[0],u,r,e,n.Constants,o),h=ps(function(n,e,t,r){switch(n.tag){case 2:case 1:return t;case 0:return sc(n.fields[0],e,t,r);default:return t}}(f[0],e,s,o),n.EnemyTankLocations,(function(e,t){return function(n,e,t,r){const i=tc(n,r,e);let o;return o=qa(e,t),oa(i,Ul,o)}(n.Constants.LevelMap.TilesHorizontally,o,e,t)}),Ya,(function(n){return n}),f[1],n.ScoreAndHiScore,(function(n){return[lc(n,o),1e3]})),d=hc(f[0],l,h[2],h[3],o),g=dc(d[1],d[2],h[1],n.Constants.LevelMap.TilesHorizontally,o),w=function(n,e,t,r){var i;let o,a,u,s;if(a=ec(n,r,Math.fround(0)),o=a,s=ec(n,r,xr),u=s,i=r-Ol,r-(null!=t.tail?t.head.FlickBookStartTime:i)>=Ol){let i,a;a=Xa((function(n){return n.etmx>=o&&n.etmx<=u}),e);const s=0|or(a);if(s>0){i=pr(~~r%s|0,a)}else i=null;if(null!=i){return new x(cc(i,n,r),t)}return t}return t}(n.Constants.LevelMap.TilesHorizontally,h[1],d[0],o);i=new Zl(n.Constants,d[3],c[1],g[0],g[1],h[0],w,h[1]);break}}switch(3===i.AlliedState.tag?1:0===i.AlliedState.tag||1===i.AlliedState.tag?2:0){case 0:return new gc(2,"TankCompletedCourseSuccessfully",new Zl((u=(o=i).Constants.FinalBossAndTankBattleData.TankBattleMapNumber+1|0,a=new bl(o.Constants.FinalBossAndTankBattleData.TargetsOnFinalBoss,u),new ql(o.Constants.ScreenStartTime,o.Constants.TileMatrixTraits,o.Constants.LevelMap,a)),o.ScoreAndHiScore,o.TanksRemaining,o.AlliedState,o.Decoratives,o.AlliedMissiles,o.EnemyMissiles,o.EnemyTankLocations));case 1:return i.TanksRemaining>0?new gc(3,"RestartTankBattle",i):new gc(1,"GameOverOnTankBattleScreen",i);case 2:return new gc(0,"StayOnTankBattleScreen",i)}}const pc=Math.fround(3),Sc=Math.fround(160),Mc=new na(Math.fround(160),Math.fround(20)),mc=Math.fround(4),yc=Math.fround(20),Tc=Math.fround(.75),Ic=Math.fround(.5),Cc=Math.fround(30),Ac=Math.fround(30);function kc(n){return qt(Xo,n,Array)}const Ec=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const bc=b((function(n,e,t,r,i,o,a,u){this.FinalBossAndTankBattleData=n,this.ScoreAndHiScore=e,this.TanksRemaining=t,this.ScreenStartTime=r,this.GunAim=i,this.AlliedState=o,this.Explosions=a,this.BossGunFlickBook=u}),X);function vc(n,e){const t=new Va(Tc,kc([qr,Zr,$r,Qr]),new za(0,"Visible"),new za(0,"Visible")),r=Ra(n,e,Tc);return new _a(t,e,r)}function Wc(n,e,t,r,i){return ps(n,e,(function(n,t){return!!p(t.TargetLocation,function(n){if(null!=n.tail)return n.head;throw new Error("List was empty")}(e).TargetLocation)&&(!Ja(i,n.ShellMechanicsObject)&&oa(t.TargetLocation,pc,n.ShellMechanicsObject.FinalPosition))}),(function(n){return n.ShellStartTime}),(function(n){return n.TargetLocation.ptx}),t,r,(function(n){let e;return e=Ua(i,n.ShellMechanicsObject),[vc(e,i),2e3]}))}function xc(n,e,t){let r;r=Xo(Ui);const i=function(){Fo(n,0,0,r)},o=function(t){Qu(n,r.EngineImageMetadata.ImageHeight,e.GunAim,t)};if(1===e.AlliedState.tag){i();const r=t-e.ScreenStartTime;Lo(n,Mc.ptx,Mc.pty,kc([Zi,$i]),Ic,r),eu(n,e.Explosions,t),o(t)}else if(2===e.AlliedState.tag)No(n,0,0,320,200,new vr(0,"SolidColour",0)),Ko(n,Dr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,100,"TANK DESTROYED");else if(3===e.AlliedState.tag);else{i(),function(e,t){for(;;){const r=e,i=t;if(null==i.tail)break;{const o=r?Qi:no;Oo(n,i.head.TargetLocation.ptx,i.head.TargetLocation.pty,Xo(o)),e=!1,t=i.tail}}}(!0,e.FinalBossAndTankBattleData.TargetsOnFinalBoss),Qa(n,e.BossGunFlickBook,t),eu(n,e.Explosions,t),o(t)}const a=new ka(e.ScoreAndHiScore,0,0,e.TanksRemaining,0,10,e.GunAim.GunElevation);Ia(n,r.EngineImageMetadata.ImageHeight),Ea(n,r.EngineImageMetadata.ImageHeight,a)}function Dc(n,e,t,r){return new bc(t,n,e,r,qu(new Vu(0,"SingleBarrelGun"),Sc,Ac,Cc,r),new Ec(0,"AlliedTankInPlay"),new x,new _a(new Va(yc,kc([Ji,zi,Vi,_i,Yi,qi]),new za(0,"Visible"),new za(0,"Visible")),r,Ra(Mc,r,yc)))}const Pc=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const Hc=b((function(n,e,t){this.ScoreAndHiScore=n,this.HiScoreText=e,this.RestartNow=t}),X);function Bc(n){return new Hc(n,"HI SCORE   "+n.HiScore.toString(),!1)}const Xc=Math.fround(4),Fc=b((function(n,e){this.EndTime=n,this.NextChapterConstructor=e}),X);function Gc(n,e){return new Fc(n+Xc,e)}const Oc=b((function(n,e,t,r,i,o){this.ScoreAndHiScore=n,this.ScoreText=e,this.HiScoreText=t,this.NextAnimStageTime=r,this.AnimationStage=i,this.RestartNow=o}),X);const Lc=Math.fround(1),Nc=cr(["----|--x","----|--x","----|P-x","----|PCx","----|-Cx","----|---","----|---"]),Kc=cr(["---P|---","123P|---","123P|---","123P|---","123-|---"]),Rc=cr(["---P|---","-23P|---","-23P|---","-23P|---","-23-|---","1---|---","1--P|---","123P|---","123P|---","123P|---","123-|---"]),jc=cr(["----|---","----|---","----|---","----|---"]),Uc=ar(Nc,ar(Kc,jc)),Jc=ar(Nc,ar(Rc,jc));function zc(n,e,t){Fo(n,0,0,Xo(oo)),null!=e.AnimationStage.tail?function(n,e){const t=function(n,e,t,r){return Oo(n,e,t,Xo(r))},r="x"===e[7],i="C"===e[6],o="P"===e[5],a="P"===e[3],u="3"===e[2],s="2"===e[1],l="1"===e[0],c=Math.fround(100),f=Math.fround(80);t(n,Math.fround(256),c,a?go:o?ho:wo),t(n,Math.fround(192),c,u?uo:i?ao:so),t(n,r?o||i?Math.fround(224):Math.fround(256):Math.fround(192),f,fo),t(n,Math.fround(128),c,s?lo:co),t(n,Math.fround(64),c,l?lo:co)}(n,e.AnimationStage.head):(Ko(n,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,75,"CONGRATULATIONS"),Ko(n,Dr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,100,"MISSION COMPLETE"),Ko(n,Hr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,125,e.ScoreText),Ko(n,Hr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,150,e.HiScoreText))}function Vc(n,e){return new Oc(n,"FINAL SCORE   "+n.Score.toString(),"HI SCORE   "+n.HiScore.toString(),e+Lc,e%Math.fround(4)<Math.fround(1)?Jc:Uc,!1)}const _c=b((function(n,e,t,r){this.Name=n,this.SelectorIndex=0|e,this.MaxNameLength=0|t,this.Complete=r}),X);const Yc=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const qc="ABCDEFGHIJKLMNOPQRSTUVWXYZ .X ";function Zc(n,e){const t=qc.length-1|0,r=t-1|0;switch(n.tag){case 1:{const n=0|(e.SelectorIndex===t?0:e.SelectorIndex+1);return new _c(e.Name,n,e.MaxNameLength,e.Complete)}case 2:{const n=e.Name.length===e.MaxNameLength,t=n?e.Name:e.SelectorIndex===r?0===e.Name.length?e.Name:it(e.Name,0,e.Name.length-1):e.Name+qc[e.SelectorIndex];return new _c(t,e.SelectorIndex,e.MaxNameLength,n)}default:{const n=0|(0===e.SelectorIndex?t:e.SelectorIndex-1);return new _c(e.Name,n,e.MaxNameLength,e.Complete)}}}function $c(n,e){const t=0|n.length,r=e-(0|~~(t/2))|0,i=0|(r<0?r+t:r);return it(n,i)+it(n,0,i)}function Qc(n){return cr(["ENTER YOUR NAME","","",(e=n.Name,t=n.MaxNameLength,r=".",rt(e,t,r,!0)),"",""," .",$c(qc,n.SelectorIndex)]);var e,t,r}const nf=b((function(n,e,t){this.ScoreAndHiScore=n,this.DataModel=e,this.MemoizedText=t}),X);function ef(n){const e=new _c("",0,12,!1);return new nf(n,e,Qc(e))}function tf(n,e,t,r){if(xo(n,e.ScoreAndHiScore.Score)){let r;const l=(u=e.DataModel,(s=t).Fire.JustDown?Zc(new Yc(2,"SelectLetter"),u):s.Left.JustDown?Zc(new Yc(0,"RotateLeft"),u):s.Right.JustDown?Zc(new Yc(1,"RotateRight"),u):null);if(null!=l){const n=l;let t;t=Qc(n),r=new nf(e.ScoreAndHiScore,n,t)}else r=e;return r.DataModel.Complete?new _o(1,"GoToNextChapter1",[(i=r.DataModel,o=e.ScoreAndHiScore.Score,a=n,Do(new bo(i.Name,o),a)),r]):new _o(0,"StayOnThisChapter1",[n,r])}return new _o(1,"GoToNextChapter1",[n,e]);var i,o,a,u,s}const rf=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const of=b((function(n){this.TankMapsList=n}),X);function af(n,e,t){switch(e.tag){case 1:!function(n,e){let t;var r,i;switch(t=Xo(Or),Fo(n,0,0,t),1===e.AlliedState.tag?(r=0,i=e.AlliedState.fields[0]):3===e.AlliedState.tag||2===e.AlliedState.tag?r=1:(r=0,i=e.AlliedState.fields[0]),r){case 0:Oo(n,i.ptx,i.pty,Xo(Lr)),Oo(n,e.EnemyFleetCentre.ptx,e.EnemyFleetCentre.pty,Xo(Nr))}Ia(n,t.EngineImageMetadata.ImageHeight);const o=new ka(e.ScoreAndHiScore,0,e.NumShips,Ca(e.NumShips),0,10,Math.fround(0));Ea(n,t.EngineImageMetadata.ImageHeight,o)}(n,e.fields[0]);break;case 2:Fu(n,t,e.fields[0]);break;case 3:!function(n,e){let t;var r,i;switch(t=Xo(Or),Fo(n,0,0,t),1===e.AlliedState.tag?(r=0,i=e.AlliedState.fields[0]):2===e.AlliedState.tag?r=1:(r=0,i=e.AlliedState.fields[0]),r){case 0:Oo(n,i.ptx,i.pty,Xo(Lr)),Oo(n,e.EnemyFleetCentre.ptx,e.EnemyFleetCentre.pty,Xo(Nr))}Ia(n,t.EngineImageMetadata.ImageHeight);const o=new ka(e.ScoreAndHiScore,0,e.ShipsThrough,Ca(e.ShipsThrough),0,10,Math.fround(0));Ea(n,t.EngineImageMetadata.ImageHeight,o)}(n,e.fields[0]);break;case 4:!function(n,e,t){const r=0|Xo(Ii).EngineImageMetadata.ImageHeight,i=function(t){Qu(n,r,e.GunAim,t)},o=function(){Fo(n,0,0,Xo(Ii)),eu(n,e.SkyExplosion,t),fs(n,e.EnemyShips,t),nu(n,Ps,e.Planes,t),eu(n,e.PlaneBombs,t),eu(n,e.Explosions,t)};2===e.AlliedState.tag?(o(),i(t),ds(n)):1===e.AlliedState.tag?(o(),gs(n)):3===e.AlliedState.tag||(o(),i(t));const a=new ka(e.ScoreAndHiScore,e.ShipsRemaining,0,Ca(e.ShipsRemaining),e.Damage,10,e.GunAim.GunElevation);Ia(n,r),Ea(n,r,a)}(n,e.fields[0],t);break;case 5:!function(n,e,t){let r;r=Xo(Ii);const i=function(t){Qu(n,r.EngineImageMetadata.ImageHeight,e.GunAim,t)},o=function(){Fo(n,0,0,r),eu(n,e.SkyExplosion,t),fs(n,e.EnemyShips,t),eu(n,e.Decoratives,t)};2===e.AlliedState.tag?(o(),i(t),ds(n)):1===e.AlliedState.tag?(o(),gs(n)):3===e.AlliedState.tag||(o(),i(t));const a=new ka(e.ScoreAndHiScore,0,e.ShipsRemaining,Ca(e.ShipsRemaining),0,10,e.GunAim.GunElevation);Ko(n,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,15,e.MessageText),Ia(n,r.EngineImageMetadata.ImageHeight),Ea(n,r.EngineImageMetadata.ImageHeight,a)}(n,e.fields[0],t);break;case 6:!function(n,e){let t;var r,i;switch(t=Xo(Or),Fo(n,0,0,t),1===e.AlliedState.tag?(r=0,i=e.AlliedState.fields[0]):2===e.AlliedState.tag?r=1:(r=0,i=e.AlliedState.fields[0]),r){case 0:Oo(n,i.ptx,i.pty,Xo(Lr))}Ia(n,t.EngineImageMetadata.ImageHeight);const o=new ka(e.ScoreAndHiScore,0,e.ShipsThrough,Ca(e.ShipsThrough),0,10,Math.fround(0));Ea(n,t.EngineImageMetadata.ImageHeight,o)}(n,e.fields[0]);break;case 7:ac(n,e.fields[0],t);break;case 8:xc(n,e.fields[0],t);break;case 9:!function(n,e,t){No(n,0,0,320,200,new vr(0,"SolidColour",0)),Ko(n,Pr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,100,"GAME OVER"),Ko(n,Hr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,125,e.HiScoreText)}(n,e.fields[0]);break;case 10:!function(n,e,t){Fo(n,0,0,Xo(io)),Ko(n,Pr,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,100,"GET READY")}(n,e.fields[0]);break;case 11:zc(n,e.fields[0]);break;case 12:!function(n,e,t){Uo(n,t),jo(n,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,75,10,e.MemoizedText)}(n,e.fields[0],t);break;default:!function(n,e,t){Uo(n,t/Math.fround(4)),Oo(n,Math.fround(160),Math.fround(68),Xo(Gr));const r=Po(30,e.GameGlobalState.GameScoreBoard);jo(n,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,94,20,r),Ko(n,Br,new Jo(1,"CentreAlign"),new zo(1,"MiddleAlign"),160,180,"USE CURSOR KEYS ... Z TO FIRE")}(n,e.fields[0],t)}}const uf=b((function(n,e,...t){D.call(this,n,e,...t)}),D);function sf(n,e){return function(n,e,t){switch(t.tag){case 1:{const n=Da(10,new Ma(0,12345));return new rf(1,"InitialMapChapter",n)}case 2:return new rf(10,"IntermissionChapter",Gc(e,(function(n){return new rf(2,"SecretPassageChapter",Gu(new Ma(0,1e4),7,n))})));case 3:{const n=Gu(new Ma(0,1e4),7,e);return new rf(2,"SecretPassageChapter",n)}case 4:{const n=Uu(new Ma(0,1e4),5);return new rf(3,"MapPostPassageChapter",n)}case 5:{const n=Ls(new Aa(0,"StrongEnemy"),new Ma(100,1e3),4,e);return new rf(4,"AirBattleChapter",n)}case 6:{const n=gl(new Ma(100,1e3),4,e);return new rf(5,"SeaBattleChapter",n)}case 7:{const n=yl(new Ma(100,1e3),4);return new rf(6,"MapBeforeBeachLandingChapter",n)}case 8:{const t=Wl(),r=uc(new Ma(100,1e3),8,t,n.TankMapsList,e);return new rf(7,"TankBattleChapter",r)}case 9:{const n=Wl(),t=Dc(new Ma(100,1e3),3,n,e);return new rf(8,"FinalBossChapter",t)}case 10:{const n=Vc(new Ma(25e3,37e3),e);return new rf(11,"VictoryChapter",n)}case 11:{const n=ef(new Ma(25e3,25e3));return new rf(12,"PotentialEnterYourNameChapter",n)}case 12:{const n=Bc(new Ma(25e3,25e3));return new rf(9,"GameOverChapter",n)}default:return new rf(0,"GameTitleChapter",Qo(2e3,Bo(),e))}}(n,e,new uf(0,"RunGameNormally"))}function lf(n,e,t,r,i,o){var a,u,s,l,c,f,h,d,g,w,p,S,M,m,y,T,I,C,A,k,E,b;const v=function(n){return new rf(10,"IntermissionChapter",Gc(i,n))};switch(t.tag){case 1:return new Vo(0,"NextStoryboard",1===(a=Ha(t.fields[0],r,i)).tag?v((function(n){const e=Gu(a.fields[0].ScoreAndHiScore,a.fields[0].NumShips,n);return new rf(2,"SecretPassageChapter",e)})):2===a.tag?v((function(n){const e=Ls(new Aa(0,"StrongEnemy"),a.fields[0].ScoreAndHiScore,a.fields[0].NumShips,n);return new rf(4,"AirBattleChapter",e)})):new rf(1,"InitialMapChapter",a.fields[0]));case 2:return new Vo(0,"NextStoryboard",1===(u=Lu(t.fields[0],r,i)).tag?v((function(n){const e=Uu(u.fields[0].FleetStats.Score,u.fields[0].FleetStats.ShipsSuccess);return new rf(3,"MapPostPassageChapter",e)})):2===u.tag?(s=Bc(u.fields[0].FleetStats.Score),new rf(9,"GameOverChapter",s)):new rf(2,"SecretPassageChapter",u.fields[0]));case 3:return new Vo(0,"NextStoryboard",1===(l=Ju(t.fields[0],r,i)).tag?(c=Ls(new Aa(1,"WeakerEnemy"),l.fields[0].ScoreAndHiScore,t.fields[0].ShipsThrough,i),new rf(4,"AirBattleChapter",c)):new rf(3,"MapPostPassageChapter",l.fields[0]));case 4:return new Vo(0,"NextStoryboard",1===(f=Ns(t.fields[0],r,i,o)).tag?(h=gl(f.fields[0].ScoreAndHiScore,f.fields[0].ShipsRemaining,i),new rf(5,"SeaBattleChapter",h)):2===f.tag?(d=Bc(f.fields[0].ScoreAndHiScore),new rf(9,"GameOverChapter",d)):new rf(4,"AirBattleChapter",f.fields[0]));case 5:return new Vo(0,"NextStoryboard",1===(g=wl(t.fields[0],r,i,o)).tag?(w=yl(g.fields[0].ScoreAndHiScore,g.fields[0].ShipsRemaining),new rf(6,"MapBeforeBeachLandingChapter",w)):2===g.tag?(p=Bc(g.fields[0].ScoreAndHiScore),new rf(9,"GameOverChapter",p)):new rf(5,"SeaBattleChapter",g.fields[0]));case 6:return new Vo(0,"NextStoryboard",1===(S=Tl(t.fields[0],r,i)).tag?v((function(e){const t=Wl(),r=uc(S.fields[0].ScoreAndHiScore,Ca(S.fields[0].ShipsThrough),t,n.TankMapsList,e);return new rf(7,"TankBattleChapter",r)})):new rf(6,"MapBeforeBeachLandingChapter",S.fields[0]));case 7:return new Vo(0,"NextStoryboard",2===(M=wc(t.fields[0],r,i,o)).tag?v((function(n){const e=Dc(M.fields[0].ScoreAndHiScore,M.fields[0].TanksRemaining,M.fields[0].Constants.FinalBossAndTankBattleData,n);return new rf(8,"FinalBossChapter",e)})):1===M.tag?(m=Bc(M.fields[0].ScoreAndHiScore),new rf(9,"GameOverChapter",m)):3===M.tag?v((function(e){const t=uc(M.fields[0].ScoreAndHiScore,M.fields[0].TanksRemaining,M.fields[0].Constants.FinalBossAndTankBattleData,n.TankMapsList,e);return new rf(7,"TankBattleChapter",t)})):new rf(7,"TankBattleChapter",M.fields[0]));case 8:return new Vo(0,"NextStoryboard",1===(y=function(n,e,t,r){let i;var o,a;switch(1===n.AlliedState.tag||2===n.AlliedState.tag?(o=1,a=n.AlliedState.fields[0]):o=3===n.AlliedState.tag?2:0,o){case 0:{const o=t-n.ScreenStartTime;if(null==n.FinalBossAndTankBattleData.TargetsOnFinalBoss.tail){const e=new Ec(1,"WonScreen",t);i=new bc(n.FinalBossAndTankBattleData,n.ScoreAndHiScore,n.TanksRemaining,n.ScreenStartTime,n.GunAim,e,n.Explosions,n.BossGunFlickBook)}else if(o>yc){const e=new Ec(2,"TankIsShot",t);i=new bc(n.FinalBossAndTankBattleData,n.ScoreAndHiScore,n.TanksRemaining,n.ScreenStartTime,n.GunAim,e,n.Explosions,n.BossGunFlickBook)}else{let o,a;o=$a(t,n.Explosions),a=0|Xo(Ui).EngineImageMetadata.ImageHeight;const u=ns(e,t,r,a,n.GunAim),s=Wc(u.Shells,n.FinalBossAndTankBattleData.TargetsOnFinalBoss,o,n.ScoreAndHiScore,t);let l;l=es(t,new Yu(u.GunTraits,u.GunCentreX,u.GunElevation,s[0],u.LastFireTime)),i=new bc(new bl(s[1],n.FinalBossAndTankBattleData.TankBattleMapNumber),s[3],n.TanksRemaining,n.ScreenStartTime,l,n.AlliedState,s[2],n.BossGunFlickBook)}break}case 1:if(t-a>mc){const e=new Ec(3,"FinalBossScreenOver"),t=n.TanksRemaining-1;i=new bc(n.FinalBossAndTankBattleData,n.ScoreAndHiScore,t,n.ScreenStartTime,n.GunAim,e,n.Explosions,n.BossGunFlickBook)}else i=n;break;case 2:i=n}return 3===i.AlliedState.tag?null==i.FinalBossAndTankBattleData.TargetsOnFinalBoss.tail?new Pc(1,"Victory",i):i.TanksRemaining>0?new Pc(2,"FinalBossDestroyedTheTank",i):new Pc(3,"GameOverBecauseOfFinalBoss",i):new Pc(0,"StayOnFinalBossScreen",i)}(t.fields[0],r,i,o)).tag?(T=Vc(y.fields[0].ScoreAndHiScore,i),new rf(11,"VictoryChapter",T)):2===y.tag?(I=uc(y.fields[0].ScoreAndHiScore,y.fields[0].TanksRemaining,y.fields[0].FinalBossAndTankBattleData,n.TankMapsList,i),new rf(7,"TankBattleChapter",I)):3===y.tag?(C=Bc(y.fields[0].ScoreAndHiScore),new rf(9,"GameOverChapter",C)):new rf(8,"FinalBossChapter",y.fields[0]));case 10:return new Vo(0,"NextStoryboard",(W=t.fields[0],1===(A=i>=W.EndTime?new _o(1,"GoToNextChapter1",W):new _o(0,"StayOnThisChapter1",W)).tag?A.fields[0].NextChapterConstructor(i):new rf(10,"IntermissionChapter",A.fields[0])));case 9:return new Vo(0,"NextStoryboard",1===(k=function(n,e,t){const r=e.Fire.JustDown?new Hc(n.ScoreAndHiScore,n.HiScoreText,!0):n;return r.RestartNow?new _o(1,"GoToNextChapter1",r):new _o(0,"StayOnThisChapter1",r)}(t.fields[0],r)).tag?new rf(12,"PotentialEnterYourNameChapter",ef(k.fields[0].ScoreAndHiScore)):new rf(9,"GameOverChapter",k.fields[0]));case 11:return new Vo(0,"NextStoryboard",1===(E=function(n,e,t){let r;if(e.Fire.JustDown)r=new Oc(n.ScoreAndHiScore,n.ScoreText,n.HiScoreText,n.NextAnimStageTime,n.AnimationStage,!0);else{const e=null!=n.AnimationStage.tail&&t>n.NextAnimStageTime?[t+Lc,n.AnimationStage.tail]:[n.NextAnimStageTime,n.AnimationStage];r=new Oc(n.ScoreAndHiScore,n.ScoreText,n.HiScoreText,e[0],e[1],n.RestartNow)}return r.RestartNow?new _o(1,"GoToNextChapter1",r):new _o(0,"StayOnThisChapter1",r)}(t.fields[0],r,i)).tag?new rf(12,"PotentialEnterYourNameChapter",ef(E.fields[0].ScoreAndHiScore)):new rf(11,"VictoryChapter",E.fields[0]));case 12:{let n;const o=tf(e.GameScoreBoard,t.fields[0],r);if(1===o.tag){const e=new Ho(o.fields[0][0]);n=[e,new rf(0,"GameTitleChapter",Qo(o.fields[0][1].ScoreAndHiScore.HiScore,e,i))]}else{n=[new Ho(o.fields[0][0]),new rf(12,"PotentialEnterYourNameChapter",o.fields[0][1])]}return new Vo(1,"NextStoryboardAndGlobals",n[0],n[1])}default:return new Vo(0,"NextStoryboard",1===(b=function(n,e,t){var r;if(1===n.State.tag)return new _o(0,"StayOnThisChapter1",n);if(e.Fire.JustDown){return t>n.ScreenStartTime+qo?new _o(1,"GoToNextChapter1",(r=new Zo(1,"GameTitleScreenOver"),new $o(n.ScreenStartTime,n.GameGlobalState,n.HiScore,r))):new _o(0,"StayOnThisChapter1",n)}return new _o(0,"StayOnThisChapter1",n)}(t.fields[0],r,i)).tag?new rf(1,"InitialMapChapter",Da(10,new Ma(0,b.fields[0].HiScore))):new rf(0,"GameTitleChapter",b.fields[0]))}var W}const cf=b((function(n,e){this.JustDown=n,this.Held=e}),X);const ff=new cf(!1,!1),hf=b((function(n,e,t,r,i){this.Left=n,this.Right=e,this.Up=t,this.Down=r,this.Fire=i}),X);new hf(ff,ff,ff,ff,ff);function df(n){var e,t,r,i,o,a;switch(null!=n.MutableKeyStatesList.tail&&null!=n.MutableKeyStatesList.tail.tail&&null!=n.MutableKeyStatesList.tail.tail.tail&&null!=n.MutableKeyStatesList.tail.tail.tail.tail&&null!=n.MutableKeyStatesList.tail.tail.tail.tail.tail&&null==n.MutableKeyStatesList.tail.tail.tail.tail.tail.tail?(e=0,t=n.MutableKeyStatesList.tail.tail.tail.head,r=n.MutableKeyStatesList.tail.tail.tail.tail.head,i=n.MutableKeyStatesList.head,o=n.MutableKeyStatesList.tail.head,a=n.MutableKeyStatesList.tail.tail.head):e=1,e){case 0:return new hf(new cf(i.MutJustPressed,i.MutHeld),new cf(o.MutJustPressed,o.MutHeld),new cf(a.MutJustPressed,a.MutHeld),new cf(t.MutJustPressed,t.MutHeld),new cf(r.MutJustPressed,r.MutHeld));case 1:throw new Error("Immutable key record needs extending")}}const gf=b((function(n,e,...t){D.call(this,n,e,...t)}),D);const wf=b((function(n,e,t,r){this.ThisKeyScanCode=n,this.MutHeld=e,this.MutJustPressed=t,this.MutWaitingRelease=r}),X);function pf(n){return new wf(n,!1,!1,!1)}const Sf=b((function(n,e,t){this.MutableKeyStatesList=n,this.PauseKey=e,this.GameIsPaused=t}),X);const Mf=b((function(n,e,t){this.SystemKeyStateStore=n,this.UserKeyStatesSnapshot=e,this.SnapshotObtainer=t}),X);function mf(n,e){let t;if(t=gr((function(n){return p(n.ThisKeyScanCode,e)}),n.MutableKeyStatesList),null==t)return p(e,n.PauseKey.ThisKeyScanCode)?n.PauseKey:null;return t}function yf(n,e){0===e.tag||(n.UserKeyStatesSnapshot=n.SnapshotObtainer(n.SystemKeyStateStore))}function Tf(n,e){let t;const r=mf(n.SystemKeyStateStore,e);if(null!=r){const e=r;e.MutWaitingRelease?t=new gf(0,"NoKeyStateChanged"):(p(e.ThisKeyScanCode,n.SystemKeyStateStore.PauseKey.ThisKeyScanCode)&&((i=n).SystemKeyStateStore.GameIsPaused=!i.SystemKeyStateStore.GameIsPaused),e.MutHeld=!0,e.MutJustPressed=!0,e.MutWaitingRelease=!0,t=new gf(1,"KeyStateChanged"))}else t=new gf(0,"NoKeyStateChanged");var i;return yf(n,t),t}function If(n,e){let t;const r=mf(n.SystemKeyStateStore,e);if(null!=r){const n=r;n.MutHeld=!1,n.MutWaitingRelease=!1,t=new gf(1,"KeyStateChanged")}else t=new gf(0,"NoKeyStateChanged");return yf(n,t),t}const Cf=b((function(n,e){this.Fonts=n,this.Images=e}),X);function Af(){return J("App.JavascriptGraphicResources",[],Cf,()=>[["Fonts",V(on())],["Images",V(on())]])}function kf(n,e,t,r,i,o){const a=[];!function n(e,o,u){if(null!=e.tail){const i=o(e.head),s=u(e.head),l=0|t(e.head),c=0|r(e.head);loadImageThenDo(i,s,(function(t){$t(new rn(new nn(i,s?new Q(1,"MagentaColourKey"):new Q(0,"NoColourKey"),l,c),new tn(0,"HostImageObject",t)),a),n(e.tail,o,u)}))}else i(a.slice())}(o,n,e)}function Ef(n){const e=function(n){return n.ImageFileName},t=function(n){return 1===n.ImageColourKey.tag},r=function(n){return n.ImageWidth},i=function(n){return n.ImageHeight};kf(e,t,r,i,(function(o){kf(e,t,r,i,(function(e){n(o,e)}),kr)}),Ar)}function bf(n,e,t){const r=function(n){return~~(n+Math.fround(.5))};switch(t.tag){case 2:{let n,i;n=t.fields[2].EngineImageMetadata.ImageWidth,i=t.fields[2].EngineImageMetadata.ImageHeight;const o=0|r(t.fields[0]),a=0|r(t.fields[1]),u=0|r(t.fields[3]),s=0|r(t.fields[4]);return e.drawImage(t.fields[2].HostImageObject.fields[0],0,0,n,i,o,a,u,s)}case 3:{const n=0|r(t.fields[4]),i=0|r(t.fields[5]),o=0|r(t.fields[6]),a=0|r(t.fields[7]);return e.drawImage(t.fields[8].HostImageObject.fields[0],t.fields[0],t.fields[1],t.fields[2],t.fields[3],n,i,o,a)}case 4:{let r;if(!(t.fields[3].fields[0]>=0&&t.fields[3].fields[0]<n.Fonts.length))throw new Error("invalid font resource index");r=n.Fonts[t.fields[3].fields[0]];const i=8*~~t.fields[2]|0;let o,a;return o=t.fields[0],a=t.fields[1],e.drawImage(r.HostImageObject.fields[0],i,0,8,8,o,a,8,8)}case 1:{let n,r,i,o;n=t.fields[2],r=t.fields[3],i=t.fields[0],o=t.fields[1];const a="#"+nt("{0:x6}",t.fields[4].fields[0]);return e.fillStyle=a,e.fillRect(i,o,n,r)}default:{const n=0|t.fields[0],r=0|t.fields[1];return e.drawImage(t.fields[2].HostImageObject.fields[0],n,r)}}}function vf(n,e){const t=new Cf(n,e);Er(e);const r=document.getElementById("gameScreen").getContext("2d"),i=function(){let n,e;return e=ur(Eo,ir(He(0,1,3))),n=mo((function(n){return 1===n.tag?new Mo(1,"SecondList",n.fields[0]):new Mo(0,"FirstList",n.fields[0])}),e),null==n[1].tail?new fn(0,"Ok",n[0]):new fn(1,"Error",tt("\n",n[1]))}();if(1===i.tag)console.log(i.fields[0]);else{const n=Math.fround(0),e=new of(i.fields[0]),o=sf(e,n),a=Math.fround(.019999999552965164),u=Bo(),s=function(n,e,t){const r=new Sf(ur(pf,t),pf(e),!1);return new Mf(r,n(r),n)}(df,80,cr([37,39,38,40,90])),l=function(n,e){document.addEventListener(n,(function(n){0===e(s,~~n.keyCode).tag||n.preventDefault()}))};l("keydown",Tf),l("keyup",If),function n(i,o,u,l){const c=u+1,f=c/Math.fround(50);let h;af((function(n){bf(t,r,n)}),o,f);const d=lf(e,i,o,s.UserKeyStatesSnapshot,f,a);h=1===d.tag?[d.fields[0],d.fields[1]]:[i,d.fields[0]],function(n){let e;yr((function(n){return n.MutJustPressed}),n.SystemKeyStateStore.MutableKeyStatesList)?(lr((function(n){n.MutJustPressed=!1}),n.SystemKeyStateStore.MutableKeyStatesList),e=new gf(1,"KeyStateChanged")):e=new gf(0,"NoKeyStateChanged"),yf(n,e)}(s);window.setTimeout(A(1,n,[h[0],h[1],c]),20)}(u,o,0,null)}}Ef(vf),t.d(e,"JavascriptGraphicResources",(function(){return Cf})),t.d(e,"JavascriptGraphicResources$reflection",(function(){return Af})),t.d(e,"LoadFileListThenDo",(function(){return kf})),t.d(e,"LoadResourceFilesThenDo",(function(){return Ef})),t.d(e,"RenderToWebCanvas",(function(){return bf})),t.d(e,"StartGame",(function(){return vf}))}]);